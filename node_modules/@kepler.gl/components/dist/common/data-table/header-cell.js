// Copyright (c) 2022 Uber Technologies, Inc.
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireDefault(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _classnames2 = _interopRequireDefault(require("classnames"));

var _button = _interopRequireDefault(require("./button"));

var _icons = require("../../common/icons");

var _optionDropdown = _interopRequireDefault(require("./option-dropdown"));

var _constants = require("@kepler.gl/constants");

var _fieldToken = _interopRequireDefault(require("../../common/field-token"));

var _templateObject;

var StyledHeaderCell = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  border-bottom: 1px solid ", ";\n  border-top: 1px solid ", ";\n  padding-top: ", "px;\n  padding-right: 0;\n  padding-bottom: ", "px;\n  padding-left: ", "px;\n  align-items: center;\n  justify-content: space-between;\n  display: flex;\n  flex-direction: row;\n  background-color: ", ";\n\n  &:hover {\n    .more {\n      color: ", ";\n    }\n  }\n  .n-sort-idx {\n    font-size: 9px;\n  }\n  .details {\n    font-weight: 500;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    height: 100%;\n    overflow: hidden;\n    flex-grow: 1;\n\n    .col-name {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      cursor: pointer;\n\n      .col-name__left {\n        display: flex;\n        align-items: center;\n        overflow: hidden;\n        svg {\n          margin-left: 6px;\n        }\n      }\n      .col-name__name {\n        overflow: hidden;\n        white-space: nowrap;\n      }\n    }\n  }\n\n  .more {\n    color: transparent;\n    margin-left: 5px;\n  }\n"])), function (props) {
  return props.theme.headerCellBorderColor;
}, function (props) {
  return props.theme.headerCellBorderColor;
}, function (props) {
  return props.theme.headerPaddingTop;
}, function (props) {
  return props.theme.headerPaddingBottom;
}, function (props) {
  return props.theme.cellPaddingSide;
}, function (props) {
  return props.theme.headerCellBackground;
}, function (props) {
  return props.theme.headerCellIconColor;
});

var HeaderCellFactory = function HeaderCellFactory(FieldToken) {
  var HeaderCell = function HeaderCell(_ref) {
    var _classnames;

    var cellInfo = _ref.cellInfo,
        columns = _ref.columns,
        isPinned = _ref.isPinned,
        props = _ref.props,
        toggleMoreOptions = _ref.toggleMoreOptions,
        moreOptionsColumn = _ref.moreOptionsColumn;
    var columnIndex = cellInfo.columnIndex,
        key = cellInfo.key,
        style = cellInfo.style;
    var colMeta = props.colMeta,
        _props$sortColumn = props.sortColumn,
        sortColumn = _props$sortColumn === void 0 ? {} : _props$sortColumn,
        _sortTableColumn = props.sortTableColumn,
        _pinTableColumn = props.pinTableColumn,
        _copyTableColumn = props.copyTableColumn;
    var column = columns[columnIndex];
    var isGhost = column.ghost;
    var isSorted = sortColumn[column];
    var firstCell = columnIndex === 0;
    return /*#__PURE__*/_react["default"].createElement(StyledHeaderCell, {
      className: (0, _classnames2["default"])('header-cell', (_classnames = {}, (0, _defineProperty2["default"])(_classnames, "column-".concat(columnIndex), true), (0, _defineProperty2["default"])(_classnames, 'pinned-header-cell', isPinned), (0, _defineProperty2["default"])(_classnames, 'first-cell', firstCell), _classnames)),
      key: key,
      style: style,
      onClick: function onClick(e) {
        e.shiftKey ? _sortTableColumn(column) : null;
      },
      onDoubleClick: function onDoubleClick() {
        return _sortTableColumn(column);
      },
      title: column
    }, isGhost ? /*#__PURE__*/_react["default"].createElement("div", null) : /*#__PURE__*/_react["default"].createElement(_react["default"].Fragment, null, /*#__PURE__*/_react["default"].createElement("section", {
      className: "details"
    }, /*#__PURE__*/_react["default"].createElement("div", {
      className: "col-name"
    }, /*#__PURE__*/_react["default"].createElement("div", {
      className: "col-name__left"
    }, /*#__PURE__*/_react["default"].createElement("div", {
      className: "col-name__name"
    }, colMeta[column].name), /*#__PURE__*/_react["default"].createElement(_button["default"], {
      className: "col-name__sort",
      onClick: function onClick() {
        return _sortTableColumn(column);
      }
    }, isSorted ? isSorted === _constants.SORT_ORDER.ASCENDING ? /*#__PURE__*/_react["default"].createElement(_icons.ArrowUp, {
      height: "14px"
    }) : /*#__PURE__*/_react["default"].createElement(_icons.ArrowDown, {
      height: "14px"
    }) : null)), /*#__PURE__*/_react["default"].createElement(_button["default"], {
      className: "more",
      onClick: function onClick() {
        return toggleMoreOptions(column);
      }
    }, /*#__PURE__*/_react["default"].createElement(_icons.VertThreeDots, {
      height: "14px"
    }))), /*#__PURE__*/_react["default"].createElement(FieldToken, {
      type: colMeta[column].type
    })), /*#__PURE__*/_react["default"].createElement("section", {
      className: "options"
    }, /*#__PURE__*/_react["default"].createElement(_optionDropdown["default"], {
      isOpened: moreOptionsColumn === column,
      column: column,
      toggleMoreOptions: toggleMoreOptions,
      sortTableColumn: function sortTableColumn(mode) {
        return _sortTableColumn(column, mode);
      },
      pinTableColumn: function pinTableColumn() {
        return _pinTableColumn(column);
      },
      copyTableColumn: function copyTableColumn() {
        return _copyTableColumn(column);
      }
    }))));
  };

  return HeaderCell;
};

HeaderCellFactory.deps = [_fieldToken["default"]];
var _default = HeaderCellFactory;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21tb24vZGF0YS10YWJsZS9oZWFkZXItY2VsbC50c3giXSwibmFtZXMiOlsiU3R5bGVkSGVhZGVyQ2VsbCIsInN0eWxlZCIsImRpdiIsInByb3BzIiwidGhlbWUiLCJoZWFkZXJDZWxsQm9yZGVyQ29sb3IiLCJoZWFkZXJQYWRkaW5nVG9wIiwiaGVhZGVyUGFkZGluZ0JvdHRvbSIsImNlbGxQYWRkaW5nU2lkZSIsImhlYWRlckNlbGxCYWNrZ3JvdW5kIiwiaGVhZGVyQ2VsbEljb25Db2xvciIsIkhlYWRlckNlbGxGYWN0b3J5IiwiRmllbGRUb2tlbiIsIkhlYWRlckNlbGwiLCJjZWxsSW5mbyIsImNvbHVtbnMiLCJpc1Bpbm5lZCIsInRvZ2dsZU1vcmVPcHRpb25zIiwibW9yZU9wdGlvbnNDb2x1bW4iLCJjb2x1bW5JbmRleCIsImtleSIsInN0eWxlIiwiY29sTWV0YSIsInNvcnRDb2x1bW4iLCJzb3J0VGFibGVDb2x1bW4iLCJwaW5UYWJsZUNvbHVtbiIsImNvcHlUYWJsZUNvbHVtbiIsImNvbHVtbiIsImlzR2hvc3QiLCJnaG9zdCIsImlzU29ydGVkIiwiZmlyc3RDZWxsIiwiZSIsInNoaWZ0S2V5IiwibmFtZSIsIlNPUlRfT1JERVIiLCJBU0NFTkRJTkciLCJ0eXBlIiwibW9kZSIsImRlcHMiLCJGaWVsZFRva2VuRmFjdG9yeSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBR0EsSUFBTUEsZ0JBQWdCLEdBQUdDLDZCQUFPQyxHQUFWLGduQ0FDTyxVQUFBQyxLQUFLO0FBQUEsU0FBSUEsS0FBSyxDQUFDQyxLQUFOLENBQVlDLHFCQUFoQjtBQUFBLENBRFosRUFFSSxVQUFBRixLQUFLO0FBQUEsU0FBSUEsS0FBSyxDQUFDQyxLQUFOLENBQVlDLHFCQUFoQjtBQUFBLENBRlQsRUFHTCxVQUFBRixLQUFLO0FBQUEsU0FBSUEsS0FBSyxD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Q2U3QixpQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwge0NTU1Byb3BlcnRpZXN9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBzdHlsZWQgZnJvbSAnc3R5bGVkLWNvbXBvbmVudHMnO1xuaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJy4vYnV0dG9uJztcbmltcG9ydCB7QXJyb3dVcCwgQXJyb3dEb3duLCBWZXJ0VGhyZWVEb3RzfSBmcm9tICcuLi8uLi9jb21tb24vaWNvbnMnO1xuaW1wb3J0IE9wdGlvbkRyb3Bkb3duIGZyb20gJy4vb3B0aW9uLWRyb3Bkb3duJztcbmltcG9ydCB7U09SVF9PUkRFUn0gZnJvbSAnQGtlcGxlci5nbC9jb25zdGFudHMnO1xuaW1wb3J0IEZpZWxkVG9rZW5GYWN0b3J5LCB7RmllbGRUb2tlblByb3BzfSBmcm9tICcuLi8uLi9jb21tb24vZmllbGQtdG9rZW4nO1xuaW1wb3J0IHtEYXRhVGFibGVQcm9wc30gZnJvbSAnLi9pbmRleCc7XG5cbmNvbnN0IFN0eWxlZEhlYWRlckNlbGwgPSBzdHlsZWQuZGl2YFxuICBib3JkZXItYm90dG9tOiAxcHggc29saWQgJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5oZWFkZXJDZWxsQm9yZGVyQ29sb3J9O1xuICBib3JkZXItdG9wOiAxcHggc29saWQgJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5oZWFkZXJDZWxsQm9yZGVyQ29sb3J9O1xuICBwYWRkaW5nLXRvcDogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5oZWFkZXJQYWRkaW5nVG9wfXB4O1xuICBwYWRkaW5nLXJpZ2h0OiAwO1xuICBwYWRkaW5nLWJvdHRvbTogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5oZWFkZXJQYWRkaW5nQm90dG9tfXB4O1xuICBwYWRkaW5nLWxlZnQ6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuY2VsbFBhZGRpbmdTaWRlfXB4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gIGJhY2tncm91bmQtY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuaGVhZGVyQ2VsbEJhY2tncm91bmR9O1xuXG4gICY6aG92ZXIge1xuICAgIC5tb3JlIHtcbiAgICAgIGNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmhlYWRlckNlbGxJY29uQ29sb3J9O1xuICAgIH1cbiAgfVxuICAubi1zb3J0LWlkeCB7XG4gICAgZm9udC1zaXplOiA5cHg7XG4gIH1cbiAgLmRldGFpbHMge1xuICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcbiAgICBoZWlnaHQ6IDEwMCU7XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICBmbGV4LWdyb3c6IDE7XG5cbiAgICAuY29sLW5hbWUge1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gICAgICBjdXJzb3I6IHBvaW50ZXI7XG5cbiAgICAgIC5jb2wtbmFtZV9fbGVmdCB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgICAgIHN2ZyB7XG4gICAgICAgICAgbWFyZ2luLWxlZnQ6IDZweDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLmNvbC1uYW1lX19uYW1lIHtcbiAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAubW9yZSB7XG4gICAgY29sb3I6IHRyYW5zcGFyZW50O1xuICAgIG1hcmdpbi1sZWZ0OiA1cHg7XG4gIH1cbmA7XG5cbnR5cGUgQ2VsbEluZm8gPSB7XG4gIGNvbHVtbkluZGV4OiBudW1iZXI7XG4gIGlzU2Nyb2xsaW5nOiBib29sZWFuO1xuICBpc1Zpc2libGU6IGJvb2xlYW47XG4gIGtleTogc3RyaW5nO1xuICBwYXJlbnQ6IGFueTtcbiAgcm93SW5kZXg6IG51bWJlcjtcbiAgc3R5bGU6IENTU1Byb3BlcnRpZXM7XG59O1xuXG50eXBlIEhlYWRlckNlbGxQcm9wcyA9IHtcbiAgLy8gcGFzc2VkIGRvd24gZnJvbSByZWFjdCB2aXJ0dWFsaXplZCBHcmlkXG4gIGNlbGxJbmZvOiBDZWxsSW5mbztcbiAgY29sdW1uczogRGF0YVRhYmxlUHJvcHNbJ2NvbHVtbnMnXTtcbiAgaXNQaW5uZWQ/OiBib29sZWFuO1xuICBwcm9wczogRGF0YVRhYmxlUHJvcHM7XG4gIHRvZ2dsZU1vcmVPcHRpb25zOiAobW9yZU9wdGlvbnNDb2x1bW46IHN0cmluZykgPT4gdm9pZDtcbiAgbW9yZU9wdGlvbnNDb2x1bW46IG51bGwgfCBzdHJpbmc7XG59O1xuXG5jb25zdCBIZWFkZXJDZWxsRmFjdG9yeSA9IChGaWVsZFRva2VuOiBSZWFjdC5GQzxGaWVsZFRva2VuUHJvcHM+KSA9PiB7XG4gIGNvbnN0IEhlYWRlckNlbGwgPSAoe1xuICAgIGNlbGxJbmZvLFxuICAgIGNvbHVtbnMsXG4gICAgaXNQaW5uZWQsXG4gICAgcHJvcHMsXG4gICAgdG9nZ2xlTW9yZU9wdGlvbnMsXG4gICAgbW9yZU9wdGlvbnNDb2x1bW5cbiAgfTogSGVhZGVyQ2VsbFByb3BzKSA9PiB7XG4gICAgY29uc3Qge2NvbHVtbkluZGV4LCBrZXksIHN0eWxlfSA9IGNlbGxJbmZvO1xuICAgIGNvbnN0IHtjb2xNZXRhLCBzb3J0Q29sdW1uID0ge30sIHNvcnRUYWJsZUNvbHVtbiwgcGluVGFibGVDb2x1bW4sIGNvcHlUYWJsZUNvbHVtbn0gPSBwcm9wcztcbiAgICBjb25zdCBjb2x1bW4gPSBjb2x1bW5zW2NvbHVtbkluZGV4XTtcblxuICAgIGNvbnN0IGlzR2hvc3QgPSBjb2x1bW4uZ2hvc3Q7XG4gICAgY29uc3QgaXNTb3J0ZWQgPSBzb3J0Q29sdW1uW2NvbHVtbl07XG4gICAgY29uc3QgZmlyc3RDZWxsID0gY29sdW1uSW5kZXggPT09IDA7XG4gICAgcmV0dXJuIChcbiAgICAgIDxTdHlsZWRIZWFkZXJDZWxsXG4gICAgICAgIGNsYXNzTmFtZT17Y2xhc3NuYW1lcygnaGVhZGVyLWNlbGwnLCB7XG4gICAgICAgICAgW2Bjb2x1bW4tJHtjb2x1bW5JbmRleH1gXTogdHJ1ZSxcbiAgICAgICAgICAncGlubmVkLWhlYWRlci1jZWxsJzogaXNQaW5uZWQsXG4gICAgICAgICAgJ2ZpcnN0LWNlbGwnOiBmaXJzdENlbGxcbiAgICAgICAgfSl9XG4gICAgICAgIGtleT17a2V5fVxuICAgICAgICBzdHlsZT17c3R5bGV9XG4gICAgICAgIG9uQ2xpY2s9e2UgPT4ge1xuICAgICAgICAgIGUuc2hpZnRLZXkgPyBzb3J0VGFibGVDb2x1bW4oY29sdW1uKSA6IG51bGw7XG4gICAgICAgIH19XG4gICAgICAgIG9uRG91YmxlQ2xpY2s9eygpID0+IHNvcnRUYWJsZUNvbHVtbihjb2x1bW4pfVxuICAgICAgICB0aXRsZT17Y29sdW1ufVxuICAgICAgPlxuICAgICAgICB7aXNHaG9zdCA/IChcbiAgICAgICAgICA8ZGl2IC8+XG4gICAgICAgICkgOiAoXG4gICAgICAgICAgPD5cbiAgICAgICAgICAgIDxzZWN0aW9uIGNsYXNzTmFtZT1cImRldGFpbHNcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wtbmFtZVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sLW5hbWVfX2xlZnRcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sLW5hbWVfX25hbWVcIj57Y29sTWV0YVtjb2x1bW5dLm5hbWV9PC9kaXY+XG4gICAgICAgICAgICAgICAgICA8QnV0dG9uIGNsYXNzTmFtZT1cImNvbC1uYW1lX19zb3J0XCIgb25DbGljaz17KCkgPT4gc29ydFRhYmxlQ29sdW1uKGNvbHVtbil9PlxuICAgICAgICAgICAgICAgICAgICB7aXNTb3J0ZWQgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgaXNTb3J0ZWQgPT09IFNPUlRfT1JERVIuQVNDRU5ESU5HID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPEFycm93VXAgaGVpZ2h0PVwiMTRweFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxBcnJvd0Rvd24gaGVpZ2h0PVwiMTRweFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxCdXR0b24gY2xhc3NOYW1lPVwibW9yZVwiIG9uQ2xpY2s9eygpID0+IHRvZ2dsZU1vcmVPcHRpb25zKGNvbHVtbil9PlxuICAgICAgICAgICAgICAgICAgPFZlcnRUaHJlZURvdHMgaGVpZ2h0PVwiMTRweFwiIC8+XG4gICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8RmllbGRUb2tlbiB0eXBlPXtjb2xNZXRhW2NvbHVtbl0udHlwZX0gLz5cbiAgICAgICAgICAgIDwvc2VjdGlvbj5cblxuICAgICAgICAgICAgPHNlY3Rpb24gY2xhc3NOYW1lPVwib3B0aW9uc1wiPlxuICAgICAgICAgICAgICA8T3B0aW9uRHJvcGRvd25cbiAgICAgICAgICAgICAgICBpc09wZW5lZD17bW9yZU9wdGlvbnNDb2x1bW4gPT09IGNvbHVtbn1cbiAgICAgICAgICAgICAgICBjb2x1bW49e2NvbHVtbn1cbiAgICAgICAgICAgICAgICB0b2dnbGVNb3JlT3B0aW9ucz17dG9nZ2xlTW9yZU9wdGlvbnN9XG4gICAgICAgICAgICAgICAgc29ydFRhYmxlQ29sdW1uPXttb2RlID0+IHNvcnRUYWJsZUNvbHVtbihjb2x1bW4sIG1vZGUpfVxuICAgICAgICAgICAgICAgIHBpblRhYmxlQ29sdW1uPXsoKSA9PiBwaW5UYWJsZUNvbHVtbihjb2x1bW4pfVxuICAgICAgICAgICAgICAgIGNvcHlUYWJsZUNvbHVtbj17KCkgPT4gY29weVRhYmxlQ29sdW1uKGNvbHVtbil9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L3NlY3Rpb24+XG4gICAgICAgICAgPC8+XG4gICAgICAgICl9XG4gICAgICA8L1N0eWxlZEhlYWRlckNlbGw+XG4gICAgKTtcbiAgfTtcbiAgcmV0dXJuIEhlYWRlckNlbGw7XG59O1xuSGVhZGVyQ2VsbEZhY3RvcnkuZGVwcyA9IFtGaWVsZFRva2VuRmFjdG9yeV07XG5leHBvcnQgZGVmYXVsdCBIZWFkZXJDZWxsRmFjdG9yeTtcbiJdfQ==