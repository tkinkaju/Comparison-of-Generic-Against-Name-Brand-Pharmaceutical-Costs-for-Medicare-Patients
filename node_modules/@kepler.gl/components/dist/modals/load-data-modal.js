// Copyright (c) 2022 Uber Technologies, Inc.
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.LoadDataModalFactory = LoadDataModalFactory;
exports["default"] = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _lodash = _interopRequireDefault(require("lodash.get"));

var _reactIntl = require("react-intl");

var _fileUpload = _interopRequireDefault(require("../common/file-uploader/file-upload"));

var _loadStorageMap = _interopRequireDefault(require("./load-storage-map"));

var _modalTabs = _interopRequireDefault(require("./modal-tabs"));

var _loadingDialog = _interopRequireDefault(require("./loading-dialog"));

var _constants = require("@kepler.gl/constants");

var _templateObject;

/** @typedef {import('./load-data-modal').LoadDataModalProps} LoadDataModalProps */
var StyledLoadDataModal = _styledComponents["default"].div.attrs({
  className: 'load-data-modal'
})(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  padding: ", ";\n  min-height: 440px;\n  display: flex;\n  flex-direction: column;\n"])), function (props) {
  return props.theme.modalPadding;
});

var noop = function noop() {};

var getDefaultMethod = function getDefaultMethod() {
  var methods = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  return Array.isArray(methods) ? (0, _lodash["default"])(methods, [0]) : null;
};

LoadDataModalFactory.deps = [_modalTabs["default"], _fileUpload["default"], _loadStorageMap["default"]];

function LoadDataModalFactory(ModalTabs, FileUpload, LoadStorageMap) {
  /** @type {React.FunctionComponent<LoadDataModalProps>} */
  var LoadDataModal = function LoadDataModal(props) {
    var intl = (0, _reactIntl.useIntl)();
    var loadingMethods = props.loadingMethods,
        isCloudMapLoading = props.isCloudMapLoading;

    var _useState = (0, _react.useState)(getDefaultMethod(loadingMethods)),
        _useState2 = (0, _slicedToArray2["default"])(_useState, 2),
        currentMethod = _useState2[0],
        toggleMethod = _useState2[1];

    var ElementType = currentMethod === null || currentMethod === void 0 ? void 0 : currentMethod.elementType;
    return /*#__PURE__*/_react["default"].createElement(StyledLoadDataModal, null, /*#__PURE__*/_react["default"].createElement(ModalTabs, {
      currentMethod: currentMethod === null || currentMethod === void 0 ? void 0 : currentMethod.id,
      loadingMethods: loadingMethods,
      toggleMethod: toggleMethod
    }), isCloudMapLoading ? /*#__PURE__*/_react["default"].createElement(_loadingDialog["default"], {
      size: 64
    }) : ElementType && /*#__PURE__*/_react["default"].createElement(ElementType, (0, _extends2["default"])({
      key: currentMethod === null || currentMethod === void 0 ? void 0 : currentMethod.id,
      intl: intl
    }, props)));
  };

  LoadDataModal.defaultProps = {
    onFileUpload: noop,
    fileLoading: false,
    loadingMethods: [{
      id: _constants.LOADING_METHODS.upload,
      label: 'modal.loadData.upload',
      elementType: FileUpload
    }, {
      id: _constants.LOADING_METHODS.storage,
      label: 'modal.loadData.storage',
      elementType: LoadStorageMap
    }]
  };
  return LoadDataModal;
}

var _default = LoadDataModalFactory;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tb2RhbHMvbG9hZC1kYXRhLW1vZGFsLnRzeCJdLCJuYW1lcyI6WyJTdHlsZWRMb2FkRGF0YU1vZGFsIiwic3R5bGVkIiwiZGl2IiwiYXR0cnMiLCJjbGFzc05hbWUiLCJwcm9wcyIsInRoZW1lIiwibW9kYWxQYWRkaW5nIiwibm9vcCIsImdldERlZmF1bHRNZXRob2QiLCJtZXRob2RzIiwiQXJyYXkiLCJpc0FycmF5IiwiTG9hZERhdGFNb2RhbEZhY3RvcnkiLCJkZXBzIiwiTW9kYWxUYWJzRmFjdG9yeSIsIkZpbGVVcGxvYWRGYWN0b3J5IiwiTG9hZFN0b3JhZ2VNYXBGYWN0b3J5IiwiTW9kYWxUYWJzIiwiRmlsZVVwbG9hZCIsIkxvYWRTdG9yYWdlTWFwIiwiTG9hZERhdGFNb2RhbCIsImludGwiLCJsb2FkaW5nTWV0aG9kcyIsImlzQ2xvdWRNYXBMb2FkaW5nIiwiY3VycmVudE1ldGhvZCIsInRvZ2dsZU1ldGhvZCIsIkVsZW1lbnRUeXBlIiwiZWxlbWVudFR5cGUiLCJpZCIsImRlZmF1bHRQcm9wcyIsIm9uRmlsZVVwbG9hZCIsImZpbGVMb2FkaW5nIiwiTE9BRElOR19NRVRIT0RTIiwidXBsb2FkIiwibGFiZWwiLCJzdG9yYWdlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFvQkE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7Ozs7QUFLQTtBQUVBLElBQU1BLG1CQUFtQixHQUFHQyw2QkFBT0MsR0FBUCxDQUFXQyxLQUFYLENBQWlCO0FBQzNDQyxFQUFBQSxTQUFTLEVBQUU7QUFEZ0MsQ0FBakIsQ0FBSCw4S0FHWixVQUFBQyxLQUFLO0FBQUEsU0FBSUEsS0FBSyxDQUFDQyxLQUFOLENBQVlDLFlBQWhCO0FBQUEsQ0FITyxDQUF6Qjs7QUFTQSxJQUFNQyxJQUFJLEdBQUcsU0FBUEEsSUFBTyxHQUFNLENBQUUsQ0FBckI7O0FBQ0EsSUFBTUMsZ0JBQWdCLEdBQUcsU0FBbkJBLGdCQUFtQjtBQUFBLE1BQUtDLE9BQUwsdUVBQW9CLEVBQXBCO0FBQUEsU0FDdkJDLEtBQUssQ0FBQ0MsT0FBTixDQUFjRixPQUFkLElBQXlCLHdCQUFJQSxPQUFKLEVBQWEsQ0FBQyxDQUFELENBQWIsQ0FBekIsR0FBNkMsSUFEdEI7QUFBQSxDQUF6Qjs7QUErQkFHLG9CQUFvQixDQUFDQyxJQUFyQixHQUE0QixDQUFDQyxxQkFBRCxFQUFtQkMsc0JBQW5CLEVBQXNDQywwQkFBdEMsQ0FBNUI7O0FBRU8sU0FBU0osb0JBQVQsQ0FDTEssU0FESyxFQUVMQyxVQUZLLEVBR0xDLGNBSEssRUFJTDtBQUNBO0FBQ0EsTUFBTUMsYUFBMkMsR0FBRyxTQUE5Q0EsYUFBOEMsQ0FBQWhCLEtBQUssRUFBSTtBQUMzRCxRQUFNaUIsSUFBSSxHQUFHLHlCQUFiO0FBRDJELFFBRXBEQyxjQUZvRCxHQUVmbEIsS0FGZSxDQUVwRGtCLGNBRm9EO0FBQUEsUUFFcENDLGlCQUZvQyxHQUVmbkIsS0FGZSxDQUVwQ21CLGlCQUZvQzs7QUFBQSxvQkFHckIscUJBQVNmLGdCQUFnQixDQUFDYyxjQUFELENBQXpCLENBSHFCO0FBQUE7QUFBQSxRQUdwREUsYUFIb0Q7QUFBQSxRQUdyQ0MsWUFIcUM7O0FBSzNELFFBQU1DLFdBQVcsR0FBR0YsYUFBSCxhQUFHQSxhQUFILHVCQUFHQSxhQUFhLENBQUVHLFdBQW5DO0FBRUEsd0JBQ0UsZ0NBQUMsbUJBQUQscUJBQ0UsZ0NBQUMsU0FBRDtBQUNFLE1BQUEsYUFBYSxFQUFFSCxhQUFGLGFBQUVBLGFBQUYsdUJBQUVBLGFBQWEsQ0FBRUksRUFEaEM7QUFFRSxNQUFBLGNBQWMsRUFBRU4sY0FGbEI7QUFHRSxNQUFBLFlBQVksRUFBRUc7QUFIaEIsTUFERixFQU1HRixpQkFBaUIsZ0JBQ2hCLGdDQUFDLHlCQUFEO0FBQWUsTUFBQSxJQUFJLEVBQUU7QUFBckIsTUFEZ0IsR0FHaEJHLFdBQVcsaUJBQUksZ0NBQUMsV0FBRDtBQUFhLE1BQUEsR0FBRyxFQUFFRixhQUFGLGFBQUVBLGFBQUYsdUJBQUVBLGFBQWEsQ0FBRUksRUFBakM7QUFBcUMsTUFBQSxJQUFJLEVBQUVQO0FBQTNDLE9BQXFEakIsS0FBckQsRUFUbkIsQ0FERjtBQWNELEdBckJEOztBQXVCQWdCLEVBQUFBLGFBQWEsQ0FBQ1MsWUFBZCxHQUE2QjtBQUMzQkMsSUFBQUEsWUFBWSxFQUFFdkIsSUFEYTtBQUUzQndCLElBQUFBLFdBQVcsRUFBRSxLQUZjO0FBRzNCVCxJQUFBQSxjQUFjLEVBQUUsQ0FDZDtBQUNFTSxNQUFBQSxFQUFFLEVBQUVJLDJCQUFnQkMsTUFEdEI7QUFFRUMsTUFBQUEsS0FBSyxFQUFFLHVCQUZUO0FBR0VQLE1BQUFBLFdBQVcsRUFBRVQ7QUFIZixLQURjLEVBTWQ7QUFDRVUsTUFBQUEsRUFBRSxFQUFFSSwyQkFBZ0JHLE9BRHRCO0FBRUVELE1BQUFBLEtBQUssRUFBRSx3QkFGVDtBQUdFUCxNQUFBQSxXQUFXLEVBQUVSO0FBSGYsS0FOYztBQUhXLEdBQTdCO0FBaUJBLFNBQU9DLGFBQVA7QUFDRDs7ZUFFY1Isb0IiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIDIwMjIgVWJlciBUZWNobm9sb2dpZXMsIEluYy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4vLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4vLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4vLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1Jcbi8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4vLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4vLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuLy8gVEhFIFNPRlRXQVJFLlxuXG5pbXBvcnQgUmVhY3QsIHt1c2VTdGF0ZX0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5pbXBvcnQgZ2V0IGZyb20gJ2xvZGFzaC5nZXQnO1xuaW1wb3J0IHtJbnRsU2hhcGUsIHVzZUludGx9IGZyb20gJ3JlYWN0LWludGwnO1xuXG5pbXBvcnQgRmlsZVVwbG9hZEZhY3RvcnkgZnJvbSAnLi4vY29tbW9uL2ZpbGUtdXBsb2FkZXIvZmlsZS11cGxvYWQnO1xuaW1wb3J0IExvYWRTdG9yYWdlTWFwRmFjdG9yeSBmcm9tICcuL2xvYWQtc3RvcmFnZS1tYXAnO1xuaW1wb3J0IE1vZGFsVGFic0ZhY3RvcnkgZnJvbSAnLi9tb2RhbC10YWJzJztcbmltcG9ydCBMb2FkaW5nRGlhbG9nIGZyb20gJy4vbG9hZGluZy1kaWFsb2cnO1xuXG5pbXBvcnQge0xPQURJTkdfTUVUSE9EU30gZnJvbSAnQGtlcGxlci5nbC9jb25zdGFudHMnO1xuaW1wb3J0IHtGaWxlTG9hZGluZywgRmlsZUxvYWRpbmdQcm9ncmVzcywgTG9hZEZpbGVzfSBmcm9tICdAa2VwbGVyLmdsL3R5cGVzJztcbmltcG9ydCB7UHJvdmlkZXJ9IGZyb20gJ0BrZXBsZXIuZ2wvY2xvdWQtcHJvdmlkZXJzJztcbmltcG9ydCB7U2V0Q2xvdWRQcm92aWRlclBheWxvYWQsIFByb3ZpZGVyQWN0aW9ucywgQWN0aW9uSGFuZGxlcn0gZnJvbSAnQGtlcGxlci5nbC9hY3Rpb25zJztcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4vbG9hZC1kYXRhLW1vZGFsJykuTG9hZERhdGFNb2RhbFByb3BzfSBMb2FkRGF0YU1vZGFsUHJvcHMgKi9cblxuY29uc3QgU3R5bGVkTG9hZERhdGFNb2RhbCA9IHN0eWxlZC5kaXYuYXR0cnMoe1xuICBjbGFzc05hbWU6ICdsb2FkLWRhdGEtbW9kYWwnXG59KWBcbiAgcGFkZGluZzogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5tb2RhbFBhZGRpbmd9O1xuICBtaW4taGVpZ2h0OiA0NDBweDtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbmA7XG5cbmNvbnN0IG5vb3AgPSAoKSA9PiB7fTtcbmNvbnN0IGdldERlZmF1bHRNZXRob2QgPSA8VCw+KG1ldGhvZHM6IFRbXSA9IFtdKSA9PlxuICBBcnJheS5pc0FycmF5KG1ldGhvZHMpID8gZ2V0KG1ldGhvZHMsIFswXSkgOiBudWxsO1xuZXhwb3J0IGludGVyZmFjZSBMb2FkaW5nTWV0aG9kIHtcbiAgaWQ6IHN0cmluZztcbiAgbGFiZWw6IHN0cmluZztcbiAgZWxlbWVudFR5cGU6IFJlYWN0LkNvbXBvbmVudFR5cGU8YW55PjtcbiAgdGFiRWxlbWVudFR5cGU/OiBSZWFjdC5Db21wb25lbnRUeXBlPHtvbkNsaWNrOiBSZWFjdC5Nb3VzZUV2ZW50SGFuZGxlcjsgaW50bDogSW50bFNoYXBlfT47XG59XG5cbnR5cGUgTG9hZERhdGFNb2RhbFByb3BzID0ge1xuICAvLyBjYWxsIGJhY2tzXG4gIG9uRmlsZVVwbG9hZDogKGZpbGVzOiBGaWxlW10pID0+IHZvaWQ7XG4gIG9uTG9hZENsb3VkTWFwOiAocHJvdmlkZXI6IGFueSwgdmlzOiBhbnkpID0+IHZvaWQ7XG4gIGZpbGVMb2FkaW5nOiBGaWxlTG9hZGluZyB8IGZhbHNlO1xuICBsb2FkaW5nTWV0aG9kcz86IExvYWRpbmdNZXRob2RbXTtcbiAgLyoqIEEgbGlzdCBvZiBuYW1lcyBvZiBzdXBwb3J0ZWQgZm9ybWF0cyBzdWl0YWJsZSB0byBwcmVzZW50IHRvIHVzZXIgKi9cbiAgZmlsZUZvcm1hdE5hbWVzOiBzdHJpbmdbXTtcbiAgLyoqIEEgbGlzdCBvZiB0eXBpY2FsbHkgMyBsZXR0ZXIgZXh0ZW5zaW9ucyAod2l0aG91dCAnLicpIGZvciBmaWxlIG1hdGNoaW5nICovXG4gIGZpbGVFeHRlbnNpb25zOiBzdHJpbmdbXTtcbiAgaXNDbG91ZE1hcExvYWRpbmc6IGJvb2xlYW47XG4gIC8qKiBTZXQgdG8gdHJ1ZSBpZiBhcHAgd2FudHMgdG8gZG8gaXRzIG93biBmaWxlIGZpbHRlcmluZyAqL1xuICBkaXNhYmxlRXh0ZW5zaW9uRmlsdGVyPzogYm9vbGVhbjtcbiAgb25DbG9zZT86ICguLi5hcmdzOiBhbnkpID0+IGFueTtcbiAgY2xvdWRQcm92aWRlcnM/OiBQcm92aWRlcltdO1xuXG4gIG9uU2V0Q2xvdWRQcm92aWRlcjogKHByb3ZpZGVyOiBTZXRDbG91ZFByb3ZpZGVyUGF5bG9hZCkgPT4gdm9pZDtcbiAgZ2V0U2F2ZWRNYXBzOiBBY3Rpb25IYW5kbGVyPHR5cGVvZiBQcm92aWRlckFjdGlvbnNbJ2dldFNhdmVkTWFwcyddPjtcbiAgbG9hZEZpbGVzOiBMb2FkRmlsZXM7XG4gIGZpbGVMb2FkaW5nUHJvZ3Jlc3M6IEZpbGVMb2FkaW5nUHJvZ3Jlc3M7XG59O1xuXG5Mb2FkRGF0YU1vZGFsRmFjdG9yeS5kZXBzID0gW01vZGFsVGFic0ZhY3RvcnksIEZpbGVVcGxvYWRGYWN0b3J5LCBMb2FkU3RvcmFnZU1hcEZhY3RvcnldO1xuXG5leHBvcnQgZnVuY3Rpb24gTG9hZERhdGFNb2RhbEZhY3RvcnkoXG4gIE1vZGFsVGFiczogUmV0dXJuVHlwZTx0eXBlb2YgTW9kYWxUYWJzRmFjdG9yeT4sXG4gIEZpbGVVcGxvYWQ6IFJldHVyblR5cGU8dHlwZW9mIEZpbGVVcGxvYWRGYWN0b3J5PixcbiAgTG9hZFN0b3JhZ2VNYXA6IFJldHVyblR5cGU8dHlwZW9mIExvYWRTdG9yYWdlTWFwRmFjdG9yeT5cbikge1xuICAvKiogQHR5cGUge1JlYWN0LkZ1bmN0aW9uQ29tcG9uZW50PExvYWREYXRhTW9kYWxQcm9wcz59ICovXG4gIGNvbnN0IExvYWREYXRhTW9kYWw6IFJlYWN0LkZDPExvYWREYXRhTW9kYWxQcm9wcz4gPSBwcm9wcyA9PiB7XG4gICAgY29uc3QgaW50bCA9IHVzZUludGwoKTtcbiAgICBjb25zdCB7bG9hZGluZ01ldGhvZHMsIGlzQ2xvdWRNYXBMb2FkaW5nfSA9IHByb3BzO1xuICAgIGNvbnN0IFtjdXJyZW50TWV0aG9kLCB0b2dnbGVNZXRob2RdID0gdXNlU3RhdGUoZ2V0RGVmYXVsdE1ldGhvZChsb2FkaW5nTWV0aG9kcykpO1xuXG4gICAgY29uc3QgRWxlbWVudFR5cGUgPSBjdXJyZW50TWV0aG9kPy5lbGVtZW50VHlwZTtcblxuICAgIHJldHVybiAoXG4gICAgICA8U3R5bGVkTG9hZERhdGFNb2RhbD5cbiAgICAgICAgPE1vZGFsVGFic1xuICAgICAgICAgIGN1cnJlbnRNZXRob2Q9e2N1cnJlbnRNZXRob2Q/LmlkfVxuICAgICAgICAgIGxvYWRpbmdNZXRob2RzPXtsb2FkaW5nTWV0aG9kc31cbiAgICAgICAgICB0b2dnbGVNZXRob2Q9e3RvZ2dsZU1ldGhvZH1cbiAgICAgICAgLz5cbiAgICAgICAge2lzQ2xvdWRNYXBMb2FkaW5nID8gKFxuICAgICAgICAgIDxMb2FkaW5nRGlhbG9nIHNpemU9ezY0fSAvPlxuICAgICAgICApIDogKFxuICAgICAgICAgIEVsZW1lbnRUeXBlICYmIDxFbGVtZW50VHlwZSBrZXk9e2N1cnJlbnRNZXRob2Q/LmlkfSBpbnRsPXtpbnRsfSB7Li4ucHJvcHN9IC8+XG4gICAgICAgICl9XG4gICAgICA8L1N0eWxlZExvYWREYXRhTW9kYWw+XG4gICAgKTtcbiAgfTtcblxuICBMb2FkRGF0YU1vZGFsLmRlZmF1bHRQcm9wcyA9IHtcbiAgICBvbkZpbGVVcGxvYWQ6IG5vb3AsXG4gICAgZmlsZUxvYWRpbmc6IGZhbHNlLFxuICAgIGxvYWRpbmdNZXRob2RzOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiBMT0FESU5HX01FVEhPRFMudXBsb2FkLFxuICAgICAgICBsYWJlbDogJ21vZGFsLmxvYWREYXRhLnVwbG9hZCcsXG4gICAgICAgIGVsZW1lbnRUeXBlOiBGaWxlVXBsb2FkXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogTE9BRElOR19NRVRIT0RTLnN0b3JhZ2UsXG4gICAgICAgIGxhYmVsOiAnbW9kYWwubG9hZERhdGEuc3RvcmFnZScsXG4gICAgICAgIGVsZW1lbnRUeXBlOiBMb2FkU3RvcmFnZU1hcFxuICAgICAgfVxuICAgIF1cbiAgfTtcblxuICByZXR1cm4gTG9hZERhdGFNb2RhbDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgTG9hZERhdGFNb2RhbEZhY3Rvcnk7XG4iXX0=