{"version":3,"file":"cesium-ion-loader.js","names":["preload","url","options","accessToken","assetId","Number","isFinite","matched","match","getIonTilesetMetadata","CesiumIonLoader","Tiles3DLoader","id","name","parse","data","context","loader"],"sources":["../../src/cesium-ion-loader.ts"],"sourcesContent":["import type {LoaderWithParser} from '@loaders.gl/loader-utils';\nimport {Tiles3DLoader} from './tiles-3d-loader';\nimport {getIonTilesetMetadata} from './lib/ion/ion';\n\nasync function preload(url, options = {}) {\n  options = options['cesium-ion'] || {};\n  // @ts-ignore\n  const {accessToken} = options;\n  // @ts-ignore\n  let assetId = options.assetId;\n  if (!Number.isFinite(assetId)) {\n    const matched = url.match(/\\/([0-9]+)\\/tileset.json/);\n    assetId = matched && matched[1];\n  }\n  return getIonTilesetMetadata(accessToken, assetId);\n}\n\n/**\n * Loader for 3D tiles from Cesium ION\n */\nexport const CesiumIonLoader: LoaderWithParser = {\n  ...Tiles3DLoader,\n  id: 'cesium-ion',\n  name: 'Cesium Ion',\n  // @ts-ignore\n  preload,\n  parse: async (data, options?, context?) => {\n    options = {...options};\n    options['3d-tiles'] = options['cesium-ion'];\n    // @ts-ignore\n    options.loader = CesiumIonLoader;\n    return Tiles3DLoader.parse(data, options, context); // , loader);\n  },\n  options: {\n    'cesium-ion': {\n      ...Tiles3DLoader.options['3d-tiles'],\n      accessToken: null\n    }\n  }\n};\n"],"mappings":";;;;;;;;;;AACA;AACA;AAAoD;AAAA;AAAA,SAErCA,OAAO;EAAA;AAAA;AAAA;EAAA,qEAAtB,kBAAuBC,GAAG;IAAA;MAAA;MAAA;MAAA;MAAA;MAAA;IAAA;MAAA;QAAA;UAAA;YAAEC,OAAO,8DAAG,CAAC,CAAC;YACtCA,OAAO,GAAGA,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;YAAC,WAEhBA,OAAO,EAAtBC,WAAW,YAAXA,WAAW;YAEdC,OAAO,GAAGF,OAAO,CAACE,OAAO;YAC7B,IAAI,CAACC,MAAM,CAACC,QAAQ,CAACF,OAAO,CAAC,EAAE;cACvBG,OAAO,GAAGN,GAAG,CAACO,KAAK,CAAC,0BAA0B,CAAC;cACrDJ,OAAO,GAAGG,OAAO,IAAIA,OAAO,CAAC,CAAC,CAAC;YACjC;YAAC,kCACM,IAAAE,0BAAqB,EAACN,WAAW,EAAEC,OAAO,CAAC;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CACnD;EAAA;AAAA;AAKM,IAAMM,eAAiC,mCACzCC,4BAAa;EAChBC,EAAE,EAAE,YAAY;EAChBC,IAAI,EAAE,YAAY;EAElBb,OAAO,EAAPA,OAAO;EACPc,KAAK;IAAA,uEAAE,iBAAOC,IAAI,EAAEb,OAAQ,EAAEc,OAAQ;MAAA;QAAA;UAAA;YAAA;cACpCd,OAAO,qBAAOA,OAAO,CAAC;cACtBA,OAAO,CAAC,UAAU,CAAC,GAAGA,OAAO,CAAC,YAAY,CAAC;cAE3CA,OAAO,CAACe,MAAM,GAAGP,eAAe;cAAC,iCAC1BC,4BAAa,CAACG,KAAK,CAACC,IAAI,EAAEb,OAAO,EAAEc,OAAO,CAAC;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CACnD;IAAA;MAAA;IAAA;IAAA;EAAA;EACDd,OAAO,EAAE;IACP,YAAY,kCACPS,4BAAa,CAACT,OAAO,CAAC,UAAU,CAAC;MACpCC,WAAW,EAAE;IAAI;EAErB;AAAC,EACF;AAAC"}