(()=>{var J=Object.defineProperty;var Be=e=>J(e,"__esModule",{value:!0});var n=(e,t)=>()=>(e&&(t=e(e=0)),t);var De=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Pe=(e,t)=>{Be(e);for(var r in t)J(e,r,{get:t[r],enumerable:!0})};var B,S=n(()=>{B=typeof __VERSION__!="undefined"?__VERSION__:"latest"});function f(e,t){if(!e)throw new Error(t||"loader assertion failed.")}var q=n(()=>{});var p,Ee,Le,Ae,Se,l,z,Oe,H=n(()=>{p={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof global!="undefined"&&global,document:typeof document!="undefined"&&document},Ee=p.self||p.window||p.global||{},Le=p.window||p.self||p.global||{},Ae=p.global||p.self||p.window||{},Se=p.document||{},l=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser),z=typeof process!="undefined"&&process.version&&/v([0-9]*)/.exec(process.version),Oe=z&&parseFloat(z[1])||0});function O(e){for(let t in Q)if(e.startsWith(t)){let r=Q[t];e=e.replace(t,r)}return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`${_e}${e}`),e}var _e,Q,Y=n(()=>{_e="",Q={}});var c=n(()=>{q();H();Y()});function D(e){switch(e){case"auto":return U||_||k;case"imagebitmap":return U;case"image":return _;case"data":return k;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}function P(){if(U)return"imagebitmap";if(_)return"image";if(k)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}var Ue,_,U,ke,k,N=n(()=>{c();({_parseImageNode:Ue}=globalThis),_=typeof Image!="undefined",U=typeof ImageBitmap!="undefined",ke=Boolean(Ue),k=l?!0:ke});function X(e){return Boolean(K(e))}function M(e){let t=K(e);if(!t)throw new Error("Not an image");return t}function u(e){return w(e)}function w(e){switch(M(e)){case"data":return e;case"image":case"imagebitmap":let t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("getImageData");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function K(e){return typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap?"imagebitmap":typeof Image!="undefined"&&e instanceof Image?"image":e&&typeof e=="object"&&e.data&&e.width&&e.height?"data":null}var I=n(()=>{});function E(e){return e&&(Ne.test(e)||Me.test(e))}function Z(e,t){if(E(t)){let a=new TextDecoder().decode(e);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(a=unescape(encodeURIComponent(a)))}catch(o){throw new Error(o.message)}return`data:image/svg+xml;base64,${btoa(a)}`}return v(e,t)}function v(e,t){if(E(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}var Ne,Me,V=n(()=>{Ne=/^data:image\/svg\+xml/,Me=/\.svg((\?|#).*)?$/});async function x(e,t,r){let a=Z(e,r),i=self.URL||self.webkitURL,o=typeof a!="string"&&i.createObjectURL(a);try{return await ve(o||a,t)}finally{o&&i.revokeObjectURL(o)}}async function ve(e,t){let r=new Image;return r.src=e,t.image&&t.image.decode&&r.decode?(await r.decode(),r):await new Promise((a,i)=>{try{r.onload=()=>a(r),r.onerror=o=>i(new Error(`Could not load image ${e}: ${o}`))}catch(o){i(o)}})}var R=n(()=>{V()});async function j(e,t,r){let a;E(r)?a=await x(e,t,r):a=v(e,r);let i=t&&t.imagebitmap;return await Re(a,i)}async function Re(e,t=null){if((je(t)||!ee)&&(t=null),t)try{return await createImageBitmap(e,t)}catch(r){console.warn(r),ee=!1}return await createImageBitmap(e)}function je(e){for(let t in e||Ve)return!1;return!0}var Ve,ee,te=n(()=>{V();R();Ve={},ee=!0});function y(e){let t=T(e);return We(t)||Ce(t)||Fe(t)||Ge(t)}function We(e){let t=T(e);return t.byteLength>=24&&t.getUint32(0,g)===2303741511?{mimeType:"image/png",width:t.getUint32(16,g),height:t.getUint32(20,g)}:null}function Fe(e){let t=T(e);return t.byteLength>=10&&t.getUint32(0,g)===1195984440?{mimeType:"image/gif",width:t.getUint16(6,h),height:t.getUint16(8,h)}:null}function Ge(e){let t=T(e);return t.byteLength>=14&&t.getUint16(0,g)===16973&&t.getUint32(2,h)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,h),height:t.getUint32(22,h)}:null}function Ce(e){let t=T(e);if(!(t.byteLength>=3&&t.getUint16(0,g)===65496&&t.getUint8(2)===255))return null;let{tableMarkers:a,sofMarkers:i}=$e(),o=2;for(;o+9<t.byteLength;){let s=t.getUint16(o,g);if(i.has(s))return{mimeType:"image/jpeg",height:t.getUint16(o+5,g),width:t.getUint16(o+7,g)};if(!a.has(s))return null;o+=2,o+=t.getUint16(o,g)}return null}function $e(){let e=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)e.add(r);let t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}function T(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}var g,h,L=n(()=>{g=!1,h=!0});async function W(e,t){let{mimeType:r}=y(e)||{},a=globalThis._parseImageNode;return f(a),await a(e,r)}var re=n(()=>{c();L()});async function b(e,t,r){t=t||{};let i=(t.image||{}).type||"auto",{url:o}=r||{},s=Je(i),m;switch(s){case"imagebitmap":m=await j(e,t,o);break;case"image":m=await x(e,t,o);break;case"data":m=await W(e,t);break;default:f(!1)}return i==="data"&&(m=w(m)),m}function Je(e){switch(e){case"auto":case"data":return P();default:return D(e),e}}var F=n(()=>{c();N();I();R();te();re()});var qe,ze,He,ae,oe=n(()=>{S();F();L();qe=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],ze=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],He={image:{type:"auto",decode:!0}},ae={id:"image",module:"images",name:"Images",version:B,mimeTypes:ze,extensions:qe,parse:b,tests:[e=>Boolean(y(new DataView(e)))],options:He}});async function ne(e,t){return t=t||{},t.image=t.image||{},ie?ie(e,{type:t.image.mimeType}):Qe(e,t)}async function Qe(e,t){let{mimeType:r,jpegQuality:a}=t.image,{width:i,height:o}=u(e),s=document.createElement("canvas");s.width=i,s.height=o,Ye(e,s);let m=await new Promise(d=>{if(a&&se)try{s.toBlob(d,r,a);return}catch{se=!1}s.toBlob(d,r)});if(!m)throw new Error("image encoding failed");return await m.arrayBuffer()}function Ye(e,t,r=0,a=0){if(r===0&&a===0&&typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap){let o=t.getContext("bitmaprenderer");if(o)return o.transferFromImageBitmap(e),t}let i=t.getContext("2d");if(e.data){let o=new Uint8ClampedArray(e.data),s=new ImageData(o,e.width,e.height);return i.putImageData(s,0,0),t}return i.drawImage(e,0,0),t}var ie,se,me=n(()=>{I();({_encodeImageNode:ie}=globalThis);se=!0});var pe,ge=n(()=>{S();me();pe={name:"Images",id:"image",module:"images",version:B,extensions:["jpeg"],options:{image:{mimeType:"image/png",jpegQuality:null}},encode:ne}});function fe(e){return G[e]===void 0&&(G[e]=Ke(e)),G[e]}function Ke(e){switch(e){case"image/webp":return Ze();case"image/svg":return l;default:if(!l){let{_parseImageNode:t}=globalThis;return Boolean(t)&&Xe.includes(e)}return!0}}function Ze(){if(!l)return!1;try{return document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")===0}catch{return!1}}var Xe,G,le=n(()=>{c();Xe=["image/png","image/jpeg","image/gif"],G={}});function A(e,t,r){let a=e;typeof e=="function"&&(a=e({...t,...r})),f(typeof a=="string");let{baseUrl:i}=t;return i&&(a=i[i.length-1]==="/"?`${i}${a}`:`${i}/${a}`),O(a)}var ce=n(()=>{c()});async function de(e,t,r={}){return await C(e,t,r)}async function C(e,t,r){return Array.isArray(e)?await rt(e,t,r):et(e)?await tt(e,t,r):await t(e,r)}async function tt(e,t,r){let a=[],i={};for(let o in e){let s=e[o],m=C(s,t,r).then(d=>{i[o]=d});a.push(m)}return await Promise.all(a),i}async function rt(e,t,r={}){let a=e.map(i=>C(i,t,r));return await Promise.all(a)}var et,ue=n(()=>{et=e=>e&&typeof e=="object"});async function ye(e,t,r){return await de(e,a=>$(a,t,r))}async function $(e,t,r){let i=await(await fetch(e,r.fetch)).arrayBuffer();return await t(i,r)}var be=n(()=>{ue()});async function we(e,t={}){let r=await at(e,t);return await ye(r,b,t)}async function at(e,t,r={}){let a=t&&t.image&&t.image.mipLevels||0;return a!==0?await ot(e,a,t,r):A(e,t,r)}async function ot(e,t,r,a){let i=[];if(t==="auto"){let o=A(e,r,{...a,lod:0}),s=await $(o,b,r),{width:m,height:d}=u(s);t=it({width:m,height:d}),i.push(o)}f(t>0);for(let o=i.length;o<t;++o){let s=A(e,r,{...a,lod:o});i.push(s)}return i}function it({width:e,height:t}){return 1+Math.floor(Math.log2(Math.max(e,t)))}var Ie=n(()=>{c();F();I();ce();be()});var xe={};Pe(xe,{ImageLoader:()=>ae,ImageWriter:()=>pe,_isImageFormatSupported:()=>fe,getBinaryImageMetadata:()=>y,getDefaultImageType:()=>P,getImageData:()=>w,getImageSize:()=>u,getImageType:()=>M,isImage:()=>X,isImageTypeSupported:()=>D,loadImage:()=>we});var he=n(()=>{oe();ge();L();N();I();le();Ie()});var st=De((yr,Te)=>{var nt=(he(),xe);globalThis.loaders=globalThis.loaders||{};Te.exports=Object.assign(globalThis.loaders,nt)});st();})();
//# sourceMappingURL=dist.min.js.map
