{"version":3,"file":"create-image-source.js","names":["SERVICES","WMSService","ArcGISImageService","ImageService","createImageSource","props","type","serviceType","guessServiceType","url","Error","Service","testURL"],"sources":["../../../../src/lib/data-sources/create-image-source.ts"],"sourcesContent":["// loaders.gl, MIT license\n\nimport {ImageSource} from './image-source';\nimport {ImageService, ImageServiceProps} from './image-services/image-service';\nimport {WMSService} from './image-services/wms-service';\nimport {ArcGISImageService} from './image-services/arcgis-image-service';\n\nexport type ImageServiceType = 'wms' | 'arcgis-image-server' | 'template';\n\nconst SERVICES = [WMSService, ArcGISImageService, ImageService];\n\ntype Props = ImageServiceProps & {\n  type?: ImageServiceType | 'auto';\n};\n\n/**\n * Creates an image source\n * If type is not supplied, will try to automatically detec the the\n * @param url URL to the image source\n * @param type type of source. if not known, set to 'auto'\n * @returns an ImageSource instance\n */\nexport function createImageSource(props: Props): ImageSource {\n  const {type = 'auto'} = props;\n  const serviceType = type === 'auto' ? guessServiceType(props.url) : type;\n  switch (serviceType) {\n    case 'template':\n      return new ImageService(props);\n    case 'wms':\n      return new WMSService(props);\n    default:\n      // currently only wms service supported\n      throw new Error('Not a valid image source type');\n  }\n}\n\n/** Guess service type from URL */\nfunction guessServiceType(url: string): ImageServiceType {\n  for (const Service of SERVICES) {\n    if (Service.testURL && Service.testURL(url)) {\n      return Service.type;\n    }\n  }\n  // If all else fails, guess that this is MS service\n  return 'wms';\n}\n"],"mappings":";;;;;;AAGA;AACA;AACA;AAAyE;AAAA;AAAA;AAIzE,IAAMA,QAAQ,GAAG,CAACC,sBAAU,EAAEC,sCAAkB,EAAEC,0BAAY,CAAC;AAaxD,SAASC,iBAAiB,CAACC,KAAY,EAAe;EAC3D,kBAAwBA,KAAK,CAAtBC,IAAI;IAAJA,IAAI,4BAAG,MAAM;EACpB,IAAMC,WAAW,GAAGD,IAAI,KAAK,MAAM,GAAGE,gBAAgB,CAACH,KAAK,CAACI,GAAG,CAAC,GAAGH,IAAI;EACxE,QAAQC,WAAW;IACjB,KAAK,UAAU;MACb,OAAO,IAAIJ,0BAAY,CAACE,KAAK,CAAC;IAChC,KAAK,KAAK;MACR,OAAO,IAAIJ,sBAAU,CAACI,KAAK,CAAC;IAC9B;MAEE,MAAM,IAAIK,KAAK,CAAC,+BAA+B,CAAC;EAAC;AAEvD;;AAGA,SAASF,gBAAgB,CAACC,GAAW,EAAoB;EAAA,2CACjCT,QAAQ;IAAA;EAAA;IAA9B,oDAAgC;MAAA,IAArBW,OAAO;MAChB,IAAIA,OAAO,CAACC,OAAO,IAAID,OAAO,CAACC,OAAO,CAACH,GAAG,CAAC,EAAE;QAC3C,OAAOE,OAAO,CAACL,IAAI;MACrB;IACF;EAAC;IAAA;EAAA;IAAA;EAAA;EAED,OAAO,KAAK;AACd"}