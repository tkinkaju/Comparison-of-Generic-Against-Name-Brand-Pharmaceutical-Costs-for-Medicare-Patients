{"version":3,"file":"register-loaders.js","names":["getGlobalLoaderRegistry","state","getGlobalLoaderState","loaderRegistry","registerLoaders","loaders","Array","isArray","loader","normalizedLoader","normalizeLoader","find","registeredLoader","unshift","getRegisteredLoaders","_unregisterLoaders"],"sources":["../../../../src/lib/api/register-loaders.ts"],"sourcesContent":["import {Loader} from '@loaders.gl/loader-utils';\nimport {normalizeLoader} from '../loader-utils/normalize-loader';\nimport {getGlobalLoaderState} from '../loader-utils/option-utils';\n\n// Store global registered loaders on the global object to increase chances of cross loaders-version interoperability\n// This use case is not reliable but can help when testing new versions of loaders.gl with existing frameworks\nconst getGlobalLoaderRegistry = () => {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = state.loaderRegistry || [];\n  return state.loaderRegistry;\n};\n\n/** Register a list of global loaders */\nexport function registerLoaders(loaders: Loader[] | Loader) {\n  const loaderRegistry = getGlobalLoaderRegistry();\n\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n\n  for (const loader of loaders) {\n    const normalizedLoader = normalizeLoader(loader);\n    if (!loaderRegistry.find((registeredLoader) => normalizedLoader === registeredLoader)) {\n      // add to the beginning of the loaderRegistry, so the last registeredLoader get picked\n      loaderRegistry.unshift(normalizedLoader);\n    }\n  }\n}\n\nexport function getRegisteredLoaders(): Loader[] {\n  return getGlobalLoaderRegistry();\n}\n\n/** @deprecated For testing only  */\nexport function _unregisterLoaders() {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = [];\n}\n"],"mappings":";;;;;;;;AACA;AACA;AAAkE;AAAA;AAAA;AAIlE,IAAMA,uBAAuB,GAAG,SAA1BA,uBAAuB,GAAS;EACpC,IAAMC,KAAK,GAAG,IAAAC,iCAAoB,GAAE;EACpCD,KAAK,CAACE,cAAc,GAAGF,KAAK,CAACE,cAAc,IAAI,EAAE;EACjD,OAAOF,KAAK,CAACE,cAAc;AAC7B,CAAC;;AAGM,SAASC,eAAe,CAACC,OAA0B,EAAE;EAC1D,IAAMF,cAAc,GAAGH,uBAAuB,EAAE;EAEhDK,OAAO,GAAGC,KAAK,CAACC,OAAO,CAACF,OAAO,CAAC,GAAGA,OAAO,GAAG,CAACA,OAAO,CAAC;EAAC,2CAElCA,OAAO;IAAA;EAAA;IAAA;MAAA,IAAjBG,MAAM;MACf,IAAMC,gBAAgB,GAAG,IAAAC,gCAAe,EAACF,MAAM,CAAC;MAChD,IAAI,CAACL,cAAc,CAACQ,IAAI,CAAC,UAACC,gBAAgB;QAAA,OAAKH,gBAAgB,KAAKG,gBAAgB;MAAA,EAAC,EAAE;QAErFT,cAAc,CAACU,OAAO,CAACJ,gBAAgB,CAAC;MAC1C;IAAC;IALH,oDAA8B;MAAA;IAM9B;EAAC;IAAA;EAAA;IAAA;EAAA;AACH;AAEO,SAASK,oBAAoB,GAAa;EAC/C,OAAOd,uBAAuB,EAAE;AAClC;;AAGO,SAASe,kBAAkB,GAAG;EACnC,IAAMd,KAAK,GAAG,IAAAC,iCAAoB,GAAE;EACpCD,KAAK,CAACE,cAAc,GAAG,EAAE;AAC3B"}