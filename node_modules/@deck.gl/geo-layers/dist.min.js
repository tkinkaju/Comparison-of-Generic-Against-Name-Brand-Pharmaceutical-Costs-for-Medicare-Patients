(function webpackUniversalModuleDefinition(root, factory) {
  if (typeof exports === 'object' && typeof module === 'object')
    module.exports = factory();
  else if (typeof define === 'function' && define.amd) define([], factory);
        else if (typeof exports === 'object') exports['deck'] = factory();
  else root['deck'] = factory();})(globalThis, function () {
"use strict";var __exports__=(()=>{var zB=Object.create;var uo=Object.defineProperty;var WB=Object.getOwnPropertyDescriptor;var JB=Object.getOwnPropertyNames;var qB=Object.getPrototypeOf,XB=Object.prototype.hasOwnProperty;var Fm=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof require<"u"?require:r)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var K=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),It=(e,r)=>{for(var t in r)uo(e,t,{get:r[t],enumerable:!0})},so=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of JB(r))!XB.call(e,a)&&a!==t&&uo(e,a,{get:()=>r[a],enumerable:!(n=WB(r,a))||n.enumerable});return e},Tr=(e,r,t)=>(so(e,r,"default"),t&&so(t,r,"default")),m=(e,r,t)=>(t=e!=null?zB(qB(e)):{},so(r||!e||!e.__esModule?uo(t,"default",{value:e,enumerable:!0}):t,e)),YB=e=>so(uo({},"__esModule",{value:!0}),e);var Pt=K((sU,Lm)=>{Lm.exports=globalThis.deck});var Gm=K((fU,Dm)=>{function KB(e){if(Array.isArray(e))return e}Dm.exports=KB});var Um=K((lU,Nm)=>{function QB(e,r){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]"){var t=[],n=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(t.push(s.value),!(r&&t.length===r));n=!0);}catch(u){a=!0,i=u}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return t}}Nm.exports=QB});var Hm=K((cU,jm)=>{function ZB(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}jm.exports=ZB});var ce=K((hU,Vm)=>{var $B=Gm(),e2=Um(),t2=Hm();function r2(e,r){return $B(e)||e2(e,r)||t2()}Vm.exports=r2});var X=K((dU,Wm)=>{function zm(e,r,t,n,a,i,o){try{var s=e[i](o),u=s.value}catch(f){t(f);return}s.done?r(u):Promise.resolve(u).then(n,a)}function n2(e){return function(){var r=this,t=arguments;return new Promise(function(n,a){var i=e.apply(r,t);function o(u){zm(i,n,a,o,s,"next",u)}function s(u){zm(i,n,a,o,s,"throw",u)}o(void 0)})}}Wm.exports=n2});var H=K((pU,Jm)=>{function a2(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Jm.exports=a2});var z=K((mU,Xm)=>{function qm(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i2(e,r,t){return r&&qm(e.prototype,r),t&&qm(e,t),e}Xm.exports=i2});var at=K((vU,Ym)=>{function o2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}Ym.exports=o2});var Ae=K((gU,ff)=>{function uf(e){return ff.exports=uf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},uf(e)}ff.exports=uf});var Qm=K((yU,Km)=>{var s2=Ae();function u2(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&(e=s2(e),e!==null););return e}Km.exports=u2});var Zr=K((AU,lo)=>{var f2=Qm();function fo(e,r,t){return typeof Reflect<"u"&&Reflect.get?lo.exports=fo=Reflect.get:lo.exports=fo=function(a,i,o){var s=f2(a,i);if(s){var u=Object.getOwnPropertyDescriptor(s,i);return u.get?u.get.call(o):u.value}},fo(e,r,t||e)}lo.exports=fo});var hf=K((_U,cf)=>{function lf(e,r){return cf.exports=lf=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},lf(e,r)}cf.exports=lf});var Te=K((bU,Zm)=>{var l2=hf();function c2(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&l2(e,r)}Zm.exports=c2});var Xe=K((TU,ho)=>{function co(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ho.exports=co=function(t){return typeof t}:ho.exports=co=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},co(e)}ho.exports=co});var xe=K((xU,$m)=>{var h2=Xe(),d2=at();function p2(e,r){return r&&(h2(r)==="object"||typeof r=="function")?r:d2(e)}$m.exports=p2});var W=K((EU,ev)=>{function m2(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}ev.exports=m2});var rv=K((SU,df)=>{var tv=function(e){"use strict";var r=Object.prototype,t=r.hasOwnProperty,n,a=typeof Symbol=="function"?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(M,O,P,U){var G=O&&O.prototype instanceof v?O:v,j=Object.create(G.prototype),q=new F(U||[]);return j._invoke=B(M,P,q),j}e.wrap=u;function f(M,O,P){try{return{type:"normal",arg:M.call(O,P)}}catch(U){return{type:"throw",arg:U}}}var l="suspendedStart",c="suspendedYield",h="executing",d="completed",p={};function v(){}function g(){}function y(){}var b={};b[i]=function(){return this};var E=Object.getPrototypeOf,T=E&&E(E(k([])));T&&T!==r&&t.call(T,i)&&(b=T);var S=y.prototype=v.prototype=Object.create(b);g.prototype=S.constructor=y,y.constructor=g,y[s]=g.displayName="GeneratorFunction";function I(M){["next","throw","return"].forEach(function(O){M[O]=function(P){return this._invoke(O,P)}})}e.isGeneratorFunction=function(M){var O=typeof M=="function"&&M.constructor;return O?O===g||(O.displayName||O.name)==="GeneratorFunction":!1},e.mark=function(M){return Object.setPrototypeOf?Object.setPrototypeOf(M,y):(M.__proto__=y,s in M||(M[s]="GeneratorFunction")),M.prototype=Object.create(S),M},e.awrap=function(M){return{__await:M}};function L(M){function O(G,j,q,ne){var Re=f(M[G],M,j);if(Re.type==="throw")ne(Re.arg);else{var we=Re.arg,nt=we.value;return nt&&typeof nt=="object"&&t.call(nt,"__await")?Promise.resolve(nt.__await).then(function(je){O("next",je,q,ne)},function(je){O("throw",je,q,ne)}):Promise.resolve(nt).then(function(je){we.value=je,q(we)},function(je){return O("throw",je,q,ne)})}}var P;function U(G,j){function q(){return new Promise(function(ne,Re){O(G,j,ne,Re)})}return P=P?P.then(q,q):q()}this._invoke=U}I(L.prototype),L.prototype[o]=function(){return this},e.AsyncIterator=L,e.async=function(M,O,P,U){var G=new L(u(M,O,P,U));return e.isGeneratorFunction(O)?G:G.next().then(function(j){return j.done?j.value:G.next()})};function B(M,O,P){var U=l;return function(j,q){if(U===h)throw new Error("Generator is already running");if(U===d){if(j==="throw")throw q;return D()}for(P.method=j,P.arg=q;;){var ne=P.delegate;if(ne){var Re=C(ne,P);if(Re){if(Re===p)continue;return Re}}if(P.method==="next")P.sent=P._sent=P.arg;else if(P.method==="throw"){if(U===l)throw U=d,P.arg;P.dispatchException(P.arg)}else P.method==="return"&&P.abrupt("return",P.arg);U=h;var we=f(M,O,P);if(we.type==="normal"){if(U=P.done?d:c,we.arg===p)continue;return{value:we.arg,done:P.done}}else we.type==="throw"&&(U=d,P.method="throw",P.arg=we.arg)}}}function C(M,O){var P=M.iterator[O.method];if(P===n){if(O.delegate=null,O.method==="throw"){if(M.iterator.return&&(O.method="return",O.arg=n,C(M,O),O.method==="throw"))return p;O.method="throw",O.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var U=f(P,M.iterator,O.arg);if(U.type==="throw")return O.method="throw",O.arg=U.arg,O.delegate=null,p;var G=U.arg;if(!G)return O.method="throw",O.arg=new TypeError("iterator result is not an object"),O.delegate=null,p;if(G.done)O[M.resultName]=G.value,O.next=M.nextLoc,O.method!=="return"&&(O.method="next",O.arg=n);else return G;return O.delegate=null,p}I(S),S[s]="Generator",S[i]=function(){return this},S.toString=function(){return"[object Generator]"};function _(M){var O={tryLoc:M[0]};1 in M&&(O.catchLoc=M[1]),2 in M&&(O.finallyLoc=M[2],O.afterLoc=M[3]),this.tryEntries.push(O)}function R(M){var O=M.completion||{};O.type="normal",delete O.arg,M.completion=O}function F(M){this.tryEntries=[{tryLoc:"root"}],M.forEach(_,this),this.reset(!0)}e.keys=function(M){var O=[];for(var P in M)O.push(P);return O.reverse(),function U(){for(;O.length;){var G=O.pop();if(G in M)return U.value=G,U.done=!1,U}return U.done=!0,U}};function k(M){if(M){var O=M[i];if(O)return O.call(M);if(typeof M.next=="function")return M;if(!isNaN(M.length)){var P=-1,U=function G(){for(;++P<M.length;)if(t.call(M,P))return G.value=M[P],G.done=!1,G;return G.value=n,G.done=!0,G};return U.next=U}}return{next:D}}e.values=k;function D(){return{value:n,done:!0}}return F.prototype={constructor:F,reset:function(M){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(R),!M)for(var O in this)O.charAt(0)==="t"&&t.call(this,O)&&!isNaN(+O.slice(1))&&(this[O]=n)},stop:function(){this.done=!0;var M=this.tryEntries[0],O=M.completion;if(O.type==="throw")throw O.arg;return this.rval},dispatchException:function(M){if(this.done)throw M;var O=this;function P(Re,we){return j.type="throw",j.arg=M,O.next=Re,we&&(O.method="next",O.arg=n),!!we}for(var U=this.tryEntries.length-1;U>=0;--U){var G=this.tryEntries[U],j=G.completion;if(G.tryLoc==="root")return P("end");if(G.tryLoc<=this.prev){var q=t.call(G,"catchLoc"),ne=t.call(G,"finallyLoc");if(q&&ne){if(this.prev<G.catchLoc)return P(G.catchLoc,!0);if(this.prev<G.finallyLoc)return P(G.finallyLoc)}else if(q){if(this.prev<G.catchLoc)return P(G.catchLoc,!0)}else if(ne){if(this.prev<G.finallyLoc)return P(G.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(M,O){for(var P=this.tryEntries.length-1;P>=0;--P){var U=this.tryEntries[P];if(U.tryLoc<=this.prev&&t.call(U,"finallyLoc")&&this.prev<U.finallyLoc){var G=U;break}}G&&(M==="break"||M==="continue")&&G.tryLoc<=O&&O<=G.finallyLoc&&(G=null);var j=G?G.completion:{};return j.type=M,j.arg=O,G?(this.method="next",this.next=G.finallyLoc,p):this.complete(j)},complete:function(M,O){if(M.type==="throw")throw M.arg;return M.type==="break"||M.type==="continue"?this.next=M.arg:M.type==="return"?(this.rval=this.arg=M.arg,this.method="return",this.next="end"):M.type==="normal"&&O&&(this.next=O),p},finish:function(M){for(var O=this.tryEntries.length-1;O>=0;--O){var P=this.tryEntries[O];if(P.finallyLoc===M)return this.complete(P.completion,P.afterLoc),R(P),p}},catch:function(M){for(var O=this.tryEntries.length-1;O>=0;--O){var P=this.tryEntries[O];if(P.tryLoc===M){var U=P.completion;if(U.type==="throw"){var G=U.arg;R(P)}return G}}throw new Error("illegal catch attempt")},delegateYield:function(M,O,P){return this.delegate={iterator:k(M),resultName:O,nextLoc:P},this.method==="next"&&(this.arg=n),p}},e}(typeof df=="object"?df.exports:{});try{regeneratorRuntime=tv}catch{Function("r","regeneratorRuntime = r")(tv)}});var Y=K((CU,nv)=>{nv.exports=rv()});var Rt=K((wU,av)=>{av.exports=globalThis.deck});var pf=K(er=>{"use strict";var iv=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",v2=iv+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",ov="["+iv+"]["+v2+"]*",g2=new RegExp("^"+ov+"$"),y2=function(r,t){for(var n=[],a=t.exec(r);a;){var i=[];i.startIndex=t.lastIndex-a[0].length;for(var o=a.length,s=0;s<o;s++)i.push(a[s]);n.push(i),a=t.exec(r)}return n},A2=function(r){var t=g2.exec(r);return!(t===null||typeof t>"u")};er.isExist=function(e){return typeof e<"u"};er.isEmptyObject=function(e){return Object.keys(e).length===0};er.merge=function(e,r,t){if(r)for(var n=Object.keys(r),a=n.length,i=0;i<a;i++)t==="strict"?e[n[i]]=[r[n[i]]]:e[n[i]]=r[n[i]]};er.getValue=function(e){return er.isExist(e)?e:""};er.isName=A2;er.getAllMatches=y2;er.nameRegexp=ov});var vf=K(cv=>{"use strict";var mf=pf(),_2={allowBooleanAttributes:!1,unpairedTags:[]};cv.validate=function(e,r){r=Object.assign({},_2,r);var t=[],n=!1,a=!1;e[0]==="\uFEFF"&&(e=e.substr(1));for(var i=0;i<e.length;i++)if(e[i]==="<"&&e[i+1]==="?"){if(i+=2,i=uv(e,i),i.err)return i}else if(e[i]==="<"){var o=i;if(i++,e[i]==="!"){i=fv(e,i);continue}else{var s=!1;e[i]==="/"&&(s=!0,i++);for(var u="";i<e.length&&e[i]!==">"&&e[i]!==" "&&e[i]!=="	"&&e[i]!==`
`&&e[i]!=="\r";i++)u+=e[i];if(u=u.trim(),u[u.length-1]==="/"&&(u=u.substring(0,u.length-1),i--),!B2(u)){var f=void 0;return u.trim().length===0?f="Invalid space after '<'.":f="Tag '"+u+"' is an invalid name.",Ge("InvalidTag",f,ht(e,i))}var l=x2(e,i);if(l===!1)return Ge("InvalidAttr","Attributes for '"+u+"' have open quote.",ht(e,i));var c=l.value;if(i=l.index,c[c.length-1]==="/"){var h=i-c.length;c=c.substring(0,c.length-1);var d=lv(c,r);if(d===!0)n=!0;else return Ge(d.err.code,d.err.msg,ht(e,h+d.err.line))}else if(s)if(l.tagClosed){if(c.trim().length>0)return Ge("InvalidTag","Closing tag '"+u+"' can't have attributes or invalid starting.",ht(e,o));var p=t.pop();if(u!==p.tagName){var v=ht(e,p.tagStartPos);return Ge("InvalidTag","Expected closing tag '"+p.tagName+"' (opened in line "+v.line+", col "+v.col+") instead of closing tag '"+u+"'.",ht(e,o))}t.length==0&&(a=!0)}else return Ge("InvalidTag","Closing tag '"+u+"' doesn't have proper closing.",ht(e,i));else{var g=lv(c,r);if(g!==!0)return Ge(g.err.code,g.err.msg,ht(e,i-c.length+g.err.line));if(a===!0)return Ge("InvalidXml","Multiple possible root nodes found.",ht(e,i));r.unpairedTags.indexOf(u)!==-1||t.push({tagName:u,tagStartPos:o}),n=!0}for(i++;i<e.length;i++)if(e[i]==="<")if(e[i+1]==="!"){i++,i=fv(e,i);continue}else if(e[i+1]==="?"){if(i=uv(e,++i),i.err)return i}else break;else if(e[i]==="&"){var y=C2(e,i);if(y==-1)return Ge("InvalidChar","char '&' is not expected.",ht(e,i));i=y}else if(a===!0&&!sv(e[i]))return Ge("InvalidXml","Extra text at the end",ht(e,i));e[i]==="<"&&i--}}else{if(sv(e[i]))continue;return Ge("InvalidChar","char '"+e[i]+"' is not expected.",ht(e,i))}if(n){if(t.length==1)return Ge("InvalidTag","Unclosed tag '"+t[0].tagName+"'.",ht(e,t[0].tagStartPos));if(t.length>0)return Ge("InvalidXml","Invalid '"+JSON.stringify(t.map(function(b){return b.tagName}),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return Ge("InvalidXml","Start tag expected.",1);return!0};function sv(e){return e===" "||e==="	"||e===`
`||e==="\r"}function uv(e,r){for(var t=r;r<e.length;r++)if(e[r]=="?"||e[r]==" "){var n=e.substr(t,r-t);if(r>5&&n==="xml")return Ge("InvalidXml","XML declaration allowed only at the start of the document.",ht(e,r));if(e[r]=="?"&&e[r+1]==">"){r++;break}else continue}return r}function fv(e,r){if(e.length>r+5&&e[r+1]==="-"&&e[r+2]==="-"){for(r+=3;r<e.length;r++)if(e[r]==="-"&&e[r+1]==="-"&&e[r+2]===">"){r+=2;break}}else if(e.length>r+8&&e[r+1]==="D"&&e[r+2]==="O"&&e[r+3]==="C"&&e[r+4]==="T"&&e[r+5]==="Y"&&e[r+6]==="P"&&e[r+7]==="E"){var t=1;for(r+=8;r<e.length;r++)if(e[r]==="<")t++;else if(e[r]===">"&&(t--,t===0))break}else if(e.length>r+9&&e[r+1]==="["&&e[r+2]==="C"&&e[r+3]==="D"&&e[r+4]==="A"&&e[r+5]==="T"&&e[r+6]==="A"&&e[r+7]==="["){for(r+=8;r<e.length;r++)if(e[r]==="]"&&e[r+1]==="]"&&e[r+2]===">"){r+=2;break}}return r}var b2='"',T2="'";function x2(e,r){for(var t="",n="",a=!1;r<e.length;r++){if(e[r]===b2||e[r]===T2)n===""?n=e[r]:n!==e[r]||(n="");else if(e[r]===">"&&n===""){a=!0;break}t+=e[r]}return n!==""?!1:{value:t,index:r,tagClosed:a}}var E2=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function lv(e,r){for(var t=mf.getAllMatches(e,E2),n={},a=0;a<t.length;a++){if(t[a][1].length===0)return Ge("InvalidAttr","Attribute '"+t[a][2]+"' has no space in starting.",Ua(t[a]));if(t[a][3]!==void 0&&t[a][4]===void 0)return Ge("InvalidAttr","Attribute '"+t[a][2]+"' is without value.",Ua(t[a]));if(t[a][3]===void 0&&!r.allowBooleanAttributes)return Ge("InvalidAttr","boolean attribute '"+t[a][2]+"' is not allowed.",Ua(t[a]));var i=t[a][2];if(!w2(i))return Ge("InvalidAttr","Attribute '"+i+"' is an invalid name.",Ua(t[a]));if(!n.hasOwnProperty(i))n[i]=1;else return Ge("InvalidAttr","Attribute '"+i+"' is repeated.",Ua(t[a]))}return!0}function S2(e,r){var t=/\d/;for(e[r]==="x"&&(r++,t=/[\da-fA-F]/);r<e.length;r++){if(e[r]===";")return r;if(!e[r].match(t))break}return-1}function C2(e,r){if(r++,e[r]===";")return-1;if(e[r]==="#")return r++,S2(e,r);for(var t=0;r<e.length;r++,t++)if(!(e[r].match(/\w/)&&t<20)){if(e[r]===";")break;return-1}return r}function Ge(e,r,t){return{err:{code:e,msg:r,line:t.line||t,col:t.col}}}function w2(e){return mf.isName(e)}function B2(e){return mf.isName(e)}function ht(e,r){var t=e.substring(0,r).split(/\r?\n/);return{line:t.length,col:t[t.length-1].length+1}}function Ua(e){return e.startIndex+e[1].length}});var dv=K(gf=>{var hv={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(r,t){return t},attributeValueProcessor:function(r,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:function(){return!1},commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1},M2=function(r){return Object.assign({},hv,r)};gf.buildOptions=M2;gf.defaultOptions=hv});var gv=K((PU,vv)=>{"use strict";var ja=m(W()),pv=m(H()),mv=m(z()),O2=function(){function e(r){(0,pv.default)(this,e),this.tagname=r,this.child=[],this[":@"]={}}return(0,mv.default)(e,[{key:"add",value:function(t,n){t==="__proto__"&&(t="#__proto__"),this.child.push((0,ja.default)({},t,n))}},{key:"addChild",value:function(t){if(t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0){var n;this.child.push((n={},(0,ja.default)(n,t.tagname,t.child),(0,ja.default)(n,":@",t[":@"]),n))}else this.child.push((0,ja.default)({},t.tagname,t.child))}}]),e}();vv.exports=O2});var Av=K((RU,yv)=>{function I2(e,r){var t={};if(e[r+3]==="O"&&e[r+4]==="C"&&e[r+5]==="T"&&e[r+6]==="Y"&&e[r+7]==="P"&&e[r+8]==="E"){r=r+9;for(var n=1,a=!1,i=!1,o=!1,s="";r<e.length;r++)if(e[r]==="<"&&!o){if(a&&e[r+1]==="!"&&e[r+2]==="E"&&e[r+3]==="N"&&e[r+4]==="T"&&e[r+5]==="I"&&e[r+6]==="T"&&e[r+7]==="Y")r+=7,i=!0;else if(a&&e[r+1]==="!"&&e[r+2]==="E"&&e[r+3]==="L"&&e[r+4]==="E"&&e[r+5]==="M"&&e[r+6]==="E"&&e[r+7]==="N"&&e[r+8]==="T")r+=8;else if(a&&e[r+1]==="!"&&e[r+2]==="A"&&e[r+3]==="T"&&e[r+4]==="T"&&e[r+5]==="L"&&e[r+6]==="I"&&e[r+7]==="S"&&e[r+8]==="T")r+=8;else if(a&&e[r+1]==="!"&&e[r+2]==="N"&&e[r+3]==="O"&&e[r+4]==="T"&&e[r+5]==="A"&&e[r+6]==="T"&&e[r+7]==="I"&&e[r+8]==="O"&&e[r+9]==="N")r+=9;else if(e[r+1]==="!"&&e[r+2]==="-"&&e[r+3]==="-")o=!0;else throw new Error("Invalid DOCTYPE");n++,s=""}else if(e[r]===">"){if(o?e[r-1]==="-"&&e[r-2]==="-"&&(o=!1,n--):(i&&(R2(s,t),i=!1),n--),n===0)break}else e[r]==="["?a=!0:s+=e[r];if(n!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:t,i:r}}var P2=RegExp(`^\\s([a-zA-z0-0]+)[ 	](['"])([^&]+)\\2`);function R2(e,r){var t=P2.exec(e);t&&(r[t[1]]={regx:RegExp("&".concat(t[1],";"),"g"),val:t[3]})}yv.exports=I2});var bv=K((FU,_v)=>{var F2=/^[-+]?0x[a-fA-F0-9]+$/,L2=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);var k2={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function D2(e,r={}){if(r=Object.assign({},k2,r),!e||typeof e!="string")return e;let t=e.trim();if(r.skipLike!==void 0&&r.skipLike.test(t))return e;if(r.hex&&F2.test(t))return Number.parseInt(t,16);{let n=L2.exec(t);if(n){let a=n[1],i=n[2],o=G2(n[3]),s=n[4]||n[6];if(!r.leadingZeros&&i.length>0&&a&&t[2]!==".")return e;if(!r.leadingZeros&&i.length>0&&!a&&t[1]!==".")return e;{let u=Number(t),f=""+u;return f.search(/[eE]/)!==-1||s?r.eNotation?u:e:t.indexOf(".")!==-1?f==="0"&&o===""||f===o||a&&f==="-"+o?u:e:i?o===f||a+o===f?u:e:t===f||t===a+f?u:e}}else return e}}function G2(e){return e&&e.indexOf(".")!==-1&&(e=e.replace(/0+$/,""),e==="."?e="0":e[0]==="."?e="0"+e:e[e.length-1]==="."&&(e=e.substr(0,e.length-1))),e}_v.exports=D2});var Ev=K((kU,xv)=>{"use strict";var yf=m(W()),Va=m(Xe()),Tv=m(H()),bf=pf(),Ha=gv(),N2=Av(),U2=bv(),LU="<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,bf.nameRegexp),j2=function e(r){(0,Tv.default)(this,e),this.options=r,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"}},this.addExternalEntities=H2,this.parseXml=q2,this.parseTextData=V2,this.resolveNameSpace=z2,this.buildAttributesMap=J2,this.isItStopNode=K2,this.replaceEntitiesValue=X2,this.readStopNodeData=Z2,this.saveTextToParentTag=Y2};function H2(e){for(var r=Object.keys(e),t=0;t<r.length;t++){var n=r[t];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:e[n]}}}function V2(e,r,t,n,a,i,o){if(e!==void 0&&(this.options.trimValues&&!n&&(e=e.trim()),e.length>0)){o||(e=this.replaceEntitiesValue(e));var s=this.options.tagValueProcessor(r,e,t,a,i);if(s==null)return e;if((0,Va.default)(s)!==(0,Va.default)(e)||s!==e)return s;if(this.options.trimValues)return _f(e,this.options.parseTagValue,this.options.numberParseOptions);var u=e.trim();return u===e?_f(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function z2(e){if(this.options.removeNSPrefix){var r=e.split(":"),t=e.charAt(0)==="/"?"/":"";if(r[0]==="xmlns")return"";r.length===2&&(e=t+r[1])}return e}var W2=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function J2(e,r){if(!this.options.ignoreAttributes&&typeof e=="string"){for(var t=bf.getAllMatches(e,W2),n=t.length,a={},i=0;i<n;i++){var o=this.resolveNameSpace(t[i][1]),s=t[i][4],u=this.options.attributeNamePrefix+o;if(o.length)if(this.options.transformAttributeName&&(u=this.options.transformAttributeName(u)),u==="__proto__"&&(u="#__proto__"),s!==void 0){this.options.trimValues&&(s=s.trim()),s=this.replaceEntitiesValue(s);var f=this.options.attributeValueProcessor(o,s,r);f==null?a[u]=s:(0,Va.default)(f)!==(0,Va.default)(s)||f!==s?a[u]=f:a[u]=_f(s,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(a[u]=!0)}if(!Object.keys(a).length)return;if(this.options.attributesGroupName){var l={};return l[this.options.attributesGroupName]=a,l}return a}}var q2=function(r){r=r.replace(/\r\n?/g,`
`);for(var t=new Ha("!xml"),n=t,a="",i="",o=0;o<r.length;o++){var s=r[o];if(s==="<")if(r[o+1]==="/"){var u=$r(r,">",o,"Closing Tag is not closed."),f=r.substring(o+2,u).trim();if(this.options.removeNSPrefix){var l=f.indexOf(":");l!==-1&&(f=f.substr(l+1))}this.options.transformTagName&&(f=this.options.transformTagName(f)),n&&(a=this.saveTextToParentTag(a,n,i)),i=i.substr(0,i.lastIndexOf(".")),n=this.tagsNodeStack.pop(),a="",o=u}else if(r[o+1]==="?"){var c=Af(r,o,!1,"?>");if(!c)throw new Error("Pi Tag is not closed.");if(a=this.saveTextToParentTag(a,n,i),!(this.options.ignoreDeclaration&&c.tagName==="?xml"||this.options.ignorePiTags)){var h=new Ha(c.tagName);h.add(this.options.textNodeName,""),c.tagName!==c.tagExp&&c.attrExpPresent&&(h[":@"]=this.buildAttributesMap(c.tagExp,i)),n.addChild(h)}o=c.closeIndex+1}else if(r.substr(o+1,3)==="!--"){var d=$r(r,"-->",o+4,"Comment is not closed.");if(this.options.commentPropName){var p=r.substring(o+4,d-2);a=this.saveTextToParentTag(a,n,i),n.add(this.options.commentPropName,[(0,yf.default)({},this.options.textNodeName,p)])}o=d}else if(r.substr(o+1,2)==="!D"){var v=N2(r,o);this.docTypeEntities=v.entities,o=v.i}else if(r.substr(o+1,2)==="!["){var g=$r(r,"]]>",o,"CDATA is not closed.")-2,y=r.substring(o+9,g);if(a=this.saveTextToParentTag(a,n,i),this.options.cdataPropName)n.add(this.options.cdataPropName,[(0,yf.default)({},this.options.textNodeName,y)]);else{var b=this.parseTextData(y,n.tagname,i,!0,!1,!0);b==null&&(b=""),n.add(this.options.textNodeName,b)}o=g+2}else{var E=Af(r,o,this.options.removeNSPrefix),T=E.tagName,S=E.tagExp,I=E.attrExpPresent,L=E.closeIndex;this.options.transformTagName&&(T=this.options.transformTagName(T)),n&&a&&n.tagname!=="!xml"&&(a=this.saveTextToParentTag(a,n,i,!1)),T!==t.tagname&&(i+=i?"."+T:T);var B=n;if(B&&this.options.unpairedTags.indexOf(B.tagname)!==-1&&(n=this.tagsNodeStack.pop()),this.isItStopNode(this.options.stopNodes,i,T)){var C="";if(S.length>0&&S.lastIndexOf("/")===S.length-1)o=E.closeIndex;else if(this.options.unpairedTags.indexOf(T)!==-1)o=E.closeIndex;else{var _=this.readStopNodeData(r,T,L+1);if(!_)throw new Error("Unexpected end of ".concat(T));o=_.i,C=_.tagContent}var R=new Ha(T);T!==S&&I&&(R[":@"]=this.buildAttributesMap(S,i)),C&&(C=this.parseTextData(C,T,i,!0,I,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),R.add(this.options.textNodeName,C),n.addChild(R)}else{if(S.length>0&&S.lastIndexOf("/")===S.length-1){T[T.length-1]==="/"?(T=T.substr(0,T.length-1),S=T):S=S.substr(0,S.length-1),this.options.transformTagName&&(T=this.options.transformTagName(T));var F=new Ha(T);T!==S&&I&&(F[":@"]=this.buildAttributesMap(S,i)),i=i.substr(0,i.lastIndexOf(".")),n.addChild(F)}else{var k=new Ha(T);this.tagsNodeStack.push(n),T!==S&&I&&(k[":@"]=this.buildAttributesMap(S,i)),n.addChild(k),n=k}a="",o=L}}else a+=r[o]}return t.child},X2=function(r){if(this.options.processEntities){for(var t in this.docTypeEntities){var n=this.docTypeEntities[t];r=r.replace(n.regx,n.val)}for(var a in this.lastEntities){var i=this.lastEntities[a];r=r.replace(i.regex,i.val)}if(this.options.htmlEntities)for(var o in this.htmlEntities){var s=this.htmlEntities[o];r=r.replace(s.regex,s.val)}r=r.replace(this.ampEntity.regex,this.ampEntity.val)}return r};function Y2(e,r,t,n){return e&&(n===void 0&&(n=Object.keys(r.child).length===0),e=this.parseTextData(e,r.tagname,t,!1,r[":@"]?Object.keys(r[":@"]).length!==0:!1,n),e!==void 0&&e!==""&&r.add(this.options.textNodeName,e),e=""),e}function K2(e,r,t){var n="*."+t;for(var a in e){var i=e[a];if(n===i||r===i)return!0}return!1}function Q2(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:">",n,a="",i=r;i<e.length;i++){var o=e[i];if(n)o===n&&(n="");else if(o==='"'||o==="'")n=o;else if(o===t[0])if(t[1]){if(e[i+1]===t[1])return{data:a,index:i}}else return{data:a,index:i};else o==="	"&&(o=" ");a+=o}}function $r(e,r,t,n){var a=e.indexOf(r,t);if(a===-1)throw new Error(n);return a+r.length-1}function Af(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:">",a=Q2(e,r+1,n);if(a){var i=a.data,o=a.index,s=i.search(/\s/),u=i,f=!0;if(s!==-1&&(u=i.substr(0,s).replace(/\s\s*$/,""),i=i.substr(s+1)),t){var l=u.indexOf(":");l!==-1&&(u=u.substr(l+1),f=u!==a.data.substr(l+1))}return{tagName:u,tagExp:i,closeIndex:o,attrExpPresent:f}}}function Z2(e,r,t){for(var n=t,a=1;t<e.length;t++)if(e[t]==="<")if(e[t+1]==="/"){var i=$r(e,">",t,"".concat(r," is not closed")),o=e.substring(t+2,i).trim();if(o===r&&(a--,a===0))return{tagContent:e.substring(n,t),i};t=i}else if(e[t+1]==="?"){var s=$r(e,"?>",t+1,"StopNode is not closed.");t=s}else if(e.substr(t+1,3)==="!--"){var u=$r(e,"-->",t+3,"StopNode is not closed.");t=u}else if(e.substr(t+1,2)==="!["){var f=$r(e,"]]>",t,"StopNode is not closed.")-2;t=f}else{var l=Af(e,t,">");if(l){var c=l&&l.tagName;c===r&&l.tagExp[l.tagExp.length-1]!=="/"&&a++,t=l.closeIndex}}}function _f(e,r,t){if(r&&typeof e=="string"){var n=e.trim();return n==="true"?!0:n==="false"?!1:U2(e,t)}else return bf.isExist(e)?e:""}xv.exports=j2});var wv=K(Cv=>{"use strict";function $2(e,r){return Sv(e,r)}function Sv(e,r,t){for(var n,a={},i=0;i<e.length;i++){var o=e[i],s=eM(o),u="";if(t===void 0?u=s:u=t+"."+s,s===r.textNodeName)n===void 0?n=o[s]:n+=""+o[s];else{if(s===void 0)continue;if(o[s]){var f=Sv(o[s],r,u),l=rM(f,r);o[":@"]?tM(f,o[":@"],u,r):Object.keys(f).length===1&&f[r.textNodeName]!==void 0&&!r.alwaysCreateTextNode?f=f[r.textNodeName]:Object.keys(f).length===0&&(r.alwaysCreateTextNode?f[r.textNodeName]="":f=""),a[s]!==void 0&&a.hasOwnProperty(s)?(Array.isArray(a[s])||(a[s]=[a[s]]),a[s].push(f)):r.isArray(s,u,l)?a[s]=[f]:a[s]=f}}}return typeof n=="string"?n.length>0&&(a[r.textNodeName]=n):n!==void 0&&(a[r.textNodeName]=n),a}function eM(e){for(var r=Object.keys(e),t=0;t<r.length;t++){var n=r[t];if(n!==":@")return n}}function tM(e,r,t,n){if(r)for(var a=Object.keys(r),i=a.length,o=0;o<i;o++){var s=a[o];n.isArray(s,t+"."+s,!0,!0)?e[s]=[r[s]]:e[s]=r[s]}}function rM(e,r){var t=Object.keys(e).length;return!!(t===0||t===1&&e[r.textNodeName])}Cv.prettify=$2});var Iv=K((GU,Ov)=>{var Bv=m(H()),Mv=m(z()),nM=dv(),aM=nM.buildOptions,iM=Ev(),oM=wv(),sM=oM.prettify,uM=vf(),fM=function(){function e(r){(0,Bv.default)(this,e),this.externalEntities={},this.options=aM(r)}return(0,Mv.default)(e,[{key:"parse",value:function(t,n){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(n){n===!0&&(n={});var a=uM.validate(t,n);if(a!==!0)throw Error("".concat(a.err.msg,":").concat(a.err.line,":").concat(a.err.col))}var i=new iM(this.options);i.addExternalEntities(this.externalEntities);var o=i.parseXml(t);return this.options.preserveOrder||o===void 0?o:sM(o,this.options)}},{key:"addEntity",value:function(t,n){if(n.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(n==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=n}}]),e}();Ov.exports=fM});var kv=K((NU,Lv)=>{var lM=`
`;function cM(e,r){var t="";return r.format&&r.indentBy.length>0&&(t=lM),Rv(e,r,"",t)}function Rv(e,r,t,n){for(var a="",i=!1,o=0;o<e.length;o++){var s=e[o],u=hM(s),f="";if(t.length===0?f=u:f="".concat(t,".").concat(u),u===r.textNodeName){var l=s[u];dM(f,r)||(l=r.tagValueProcessor(u,l),l=Fv(l,r)),i&&(a+=n),a+=l,i=!1;continue}else if(u===r.cdataPropName){i&&(a+=n),a+="<![CDATA[".concat(s[u][0][r.textNodeName],"]]>"),i=!1;continue}else if(u===r.commentPropName){a+=n+"<!--".concat(s[u][0][r.textNodeName],"-->"),i=!0;continue}else if(u[0]==="?"){var c=Pv(s[":@"],r),h=u==="?xml"?"":n,d=s[u][0][r.textNodeName];d=d.length!==0?" "+d:"",a+=h+"<".concat(u).concat(d).concat(c,"?>"),i=!0;continue}var p=n;p!==""&&(p+=r.indentBy);var v=Pv(s[":@"],r),g=n+"<".concat(u).concat(v),y=Rv(s[u],r,f,p);r.unpairedTags.indexOf(u)!==-1?r.suppressUnpairedNode?a+=g+">":a+=g+"/>":(!y||y.length===0)&&r.suppressEmptyNode?a+=g+"/>":y&&y.endsWith(">")?a+=g+">".concat(y).concat(n,"</").concat(u,">"):(a+=g+">",y&&n!==""&&(y.includes("/>")||y.includes("</"))?a+=n+r.indentBy+y+n:a+=y,a+="</".concat(u,">")),i=!0}return a}function hM(e){for(var r=Object.keys(e),t=0;t<r.length;t++){var n=r[t];if(n!==":@")return n}}function Pv(e,r){var t="";if(e&&!r.ignoreAttributes)for(var n in e){var a=r.attributeValueProcessor(n,e[n]);a=Fv(a,r),a===!0&&r.suppressBooleanAttributes?t+=" ".concat(n.substr(r.attributeNamePrefix.length)):t+=" ".concat(n.substr(r.attributeNamePrefix.length),'="').concat(a,'"')}return t}function dM(e,r){e=e.substr(0,e.length-r.textNodeName.length-1);var t=e.substr(e.lastIndexOf(".")+1);for(var n in r.stopNodes)if(r.stopNodes[n]===e||r.stopNodes[n]==="*."+t)return!0;return!1}function Fv(e,r){if(e&&e.length>0&&r.processEntities)for(var t=0;t<r.entities.length;t++){var n=r.entities[t];e=e.replace(n.regex,n.val)}return e}Lv.exports=cM});var Nv=K((UU,Gv)=>{"use strict";var Tf=m(Xe()),Dv=m(W()),pM=kv(),mM={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(r,t){return t},attributeValueProcessor:function(r,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[]};function xr(e){this.options=Object.assign({},mM,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=yM),this.processTextOrObjNode=vM,this.options.format?(this.indentate=gM,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}xr.prototype.build=function(e){return this.options.preserveOrder?pM(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e=(0,Dv.default)({},this.options.arrayNodeName,e)),this.j2x(e,0).val)};xr.prototype.j2x=function(e,r){var t="",n="";for(var a in e)if(!(typeof e[a]>"u"))if(e[a]===null)a[0]==="?"?n+=this.indentate(r)+"<"+a+"?"+this.tagEndChar:n+=this.indentate(r)+"<"+a+"/"+this.tagEndChar;else if(e[a]instanceof Date)n+=this.buildTextValNode(e[a],a,"",r);else if((0,Tf.default)(e[a])!=="object"){var i=this.isAttribute(a);if(i)t+=this.buildAttrPairStr(i,""+e[a]);else if(a===this.options.textNodeName){var o=this.options.tagValueProcessor(a,""+e[a]);n+=this.replaceEntitiesValue(o)}else n+=this.buildTextValNode(e[a],a,"",r)}else if(Array.isArray(e[a]))for(var s=e[a].length,u=0;u<s;u++){var f=e[a][u];typeof f>"u"||(f===null?a[0]==="?"?n+=this.indentate(r)+"<"+a+"?"+this.tagEndChar:n+=this.indentate(r)+"<"+a+"/"+this.tagEndChar:(0,Tf.default)(f)==="object"?n+=this.processTextOrObjNode(f,a,r):n+=this.buildTextValNode(f,a,"",r))}else if(this.options.attributesGroupName&&a===this.options.attributesGroupName)for(var l=Object.keys(e[a]),c=l.length,h=0;h<c;h++)t+=this.buildAttrPairStr(l[h],""+e[a][l[h]]);else n+=this.processTextOrObjNode(e[a],a,r);return{attrStr:t,val:n}};xr.prototype.buildAttrPairStr=function(e,r){return r=this.options.attributeValueProcessor(e,""+r),r=this.replaceEntitiesValue(r),this.options.suppressBooleanAttributes&&r==="true"?" "+e:" "+e+'="'+r+'"'};function vM(e,r,t){var n=this.j2x(e,t+1);return e[this.options.textNodeName]!==void 0&&Object.keys(e).length===1?this.buildTextValNode(e[this.options.textNodeName],r,n.attrStr,t):this.buildObjectNode(n.val,r,n.attrStr,t)}xr.prototype.buildObjectNode=function(e,r,t,n){if(e==="")return r[0]==="?"?this.indentate(n)+"<"+r+t+"?"+this.tagEndChar:this.indentate(n)+"<"+r+t+this.closeTag(r)+this.tagEndChar;var a="</"+r+this.tagEndChar,i="";return r[0]==="?"&&(i="?",a=""),t&&e.indexOf("<")===-1?this.indentate(n)+"<"+r+t+i+">"+e+a:this.options.commentPropName!==!1&&r===this.options.commentPropName&&i.length===0?this.indentate(n)+"<!--".concat(e,"-->")+this.newLine:this.indentate(n)+"<"+r+t+i+this.tagEndChar+e+this.indentate(n)+a};xr.prototype.closeTag=function(e){var r="";return this.options.unpairedTags.indexOf(e)!==-1?this.options.suppressUnpairedNode||(r="/"):this.options.suppressEmptyNode?r="/":r="></".concat(e),r};xr.prototype.buildTextValNode=function(e,r,t,n){if(this.options.cdataPropName!==!1&&r===this.options.cdataPropName)return this.indentate(n)+"<![CDATA[".concat(e,"]]>")+this.newLine;if(this.options.commentPropName!==!1&&r===this.options.commentPropName)return this.indentate(n)+"<!--".concat(e,"-->")+this.newLine;if(r[0]==="?")return this.indentate(n)+"<"+r+t+"?"+this.tagEndChar;var a=this.options.tagValueProcessor(r,e);return a=this.replaceEntitiesValue(a),a===""?this.indentate(n)+"<"+r+t+this.closeTag(r)+this.tagEndChar:this.indentate(n)+"<"+r+t+">"+a+"</"+r+this.tagEndChar};xr.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(var r=0;r<this.options.entities.length;r++){var t=this.options.entities[r];e=e.replace(t.regex,t.val)}return e};function gM(e){return this.options.indentBy.repeat(e)}function yM(e){return e.startsWith(this.options.attributeNamePrefix)?e.substr(this.attrPrefixLen):!1}Gv.exports=xr});var jv=K((jU,Uv)=>{"use strict";var AM=vf(),_M=Iv(),bM=Nv();Uv.exports={XMLParser:_M,XMLValidator:AM,XMLBuilder:bM}});var lg=K(()=>{});var iy=K((Z6,ay)=>{function MO(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}ay.exports=MO});var sy=K(($6,oy)=>{function OO(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}oy.exports=OO});var fy=K((e4,uy)=>{function IO(){throw new TypeError("Invalid attempt to spread non-iterable instance")}uy.exports=IO});var St=K((t4,ly)=>{var PO=iy(),RO=sy(),FO=fy();function LO(e){return PO(e)||RO(e)||FO()}ly.exports=LO});var jl=K((c0,ci)=>{(function(e,r){typeof define=="function"&&define.amd?define([],r):typeof Fm=="function"&&typeof ci=="object"&&ci&&ci.exports?ci.exports=r():(e.dcodeIO=e.dcodeIO||{}).Long=r()})(c0,function(){"use strict";function e(C,_,R){this.low=C|0,this.high=_|0,this.unsigned=!!R}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1});function r(C){return(C&&C.__isLong__)===!0}e.isLong=r;var t={},n={};function a(C,_){var R,F,k;return _?(C>>>=0,(k=0<=C&&C<256)&&(F=n[C],F)?F:(R=o(C,(C|0)<0?-1:0,!0),k&&(n[C]=R),R)):(C|=0,(k=-128<=C&&C<128)&&(F=t[C],F)?F:(R=o(C,C<0?-1:0,!1),k&&(t[C]=R),R))}e.fromInt=a;function i(C,_){if(isNaN(C)||!isFinite(C))return _?y:g;if(_){if(C<0)return y;if(C>=d)return I}else{if(C<=-p)return L;if(C+1>=p)return S}return C<0?i(-C,_).neg():o(C%h|0,C/h|0,_)}e.fromNumber=i;function o(C,_,R){return new e(C,_,R)}e.fromBits=o;var s=Math.pow;function u(C,_,R){if(C.length===0)throw Error("empty string");if(C==="NaN"||C==="Infinity"||C==="+Infinity"||C==="-Infinity")return g;if(typeof _=="number"?(R=_,_=!1):_=!!_,R=R||10,R<2||36<R)throw RangeError("radix");var F;if((F=C.indexOf("-"))>0)throw Error("interior hyphen");if(F===0)return u(C.substring(1),_,R).neg();for(var k=i(s(R,8)),D=g,M=0;M<C.length;M+=8){var O=Math.min(8,C.length-M),P=parseInt(C.substring(M,M+O),R);if(O<8){var U=i(s(R,O));D=D.mul(U).add(i(P))}else D=D.mul(k),D=D.add(i(P))}return D.unsigned=_,D}e.fromString=u;function f(C){return C instanceof e?C:typeof C=="number"?i(C):typeof C=="string"?u(C):o(C.low,C.high,C.unsigned)}e.fromValue=f;var l=1<<16,c=1<<24,h=l*l,d=h*h,p=d/2,v=a(c),g=a(0);e.ZERO=g;var y=a(0,!0);e.UZERO=y;var b=a(1);e.ONE=b;var E=a(1,!0);e.UONE=E;var T=a(-1);e.NEG_ONE=T;var S=o(-1,2147483647,!1);e.MAX_VALUE=S;var I=o(-1,-1,!0);e.MAX_UNSIGNED_VALUE=I;var L=o(0,-2147483648,!1);e.MIN_VALUE=L;var B=e.prototype;return B.toInt=function(){return this.unsigned?this.low>>>0:this.low},B.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},B.toString=function(_){if(_=_||10,_<2||36<_)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(L)){var R=i(_),F=this.div(R),k=F.mul(R).sub(this);return F.toString(_)+k.toInt().toString(_)}else return"-"+this.neg().toString(_);for(var D=i(s(_,6),this.unsigned),M=this,O="";;){var P=M.div(D),U=M.sub(P.mul(D)).toInt()>>>0,G=U.toString(_);if(M=P,M.isZero())return G+O;for(;G.length<6;)G="0"+G;O=""+G+O}},B.getHighBits=function(){return this.high},B.getHighBitsUnsigned=function(){return this.high>>>0},B.getLowBits=function(){return this.low},B.getLowBitsUnsigned=function(){return this.low>>>0},B.getNumBitsAbs=function(){if(this.isNegative())return this.eq(L)?64:this.neg().getNumBitsAbs();for(var _=this.high!=0?this.high:this.low,R=31;R>0&&!(_&1<<R);R--);return this.high!=0?R+33:R+1},B.isZero=function(){return this.high===0&&this.low===0},B.isNegative=function(){return!this.unsigned&&this.high<0},B.isPositive=function(){return this.unsigned||this.high>=0},B.isOdd=function(){return(this.low&1)===1},B.isEven=function(){return(this.low&1)===0},B.equals=function(_){return r(_)||(_=f(_)),this.unsigned!==_.unsigned&&this.high>>>31===1&&_.high>>>31===1?!1:this.high===_.high&&this.low===_.low},B.eq=B.equals,B.notEquals=function(_){return!this.eq(_)},B.neq=B.notEquals,B.lessThan=function(_){return this.comp(_)<0},B.lt=B.lessThan,B.lessThanOrEqual=function(_){return this.comp(_)<=0},B.lte=B.lessThanOrEqual,B.greaterThan=function(_){return this.comp(_)>0},B.gt=B.greaterThan,B.greaterThanOrEqual=function(_){return this.comp(_)>=0},B.gte=B.greaterThanOrEqual,B.compare=function(_){if(r(_)||(_=f(_)),this.eq(_))return 0;var R=this.isNegative(),F=_.isNegative();return R&&!F?-1:!R&&F?1:this.unsigned?_.high>>>0>this.high>>>0||_.high===this.high&&_.low>>>0>this.low>>>0?-1:1:this.sub(_).isNegative()?-1:1},B.comp=B.compare,B.negate=function(){return!this.unsigned&&this.eq(L)?L:this.not().add(b)},B.neg=B.negate,B.add=function(_){r(_)||(_=f(_));var R=this.high>>>16,F=this.high&65535,k=this.low>>>16,D=this.low&65535,M=_.high>>>16,O=_.high&65535,P=_.low>>>16,U=_.low&65535,G=0,j=0,q=0,ne=0;return ne+=D+U,q+=ne>>>16,ne&=65535,q+=k+P,j+=q>>>16,q&=65535,j+=F+O,G+=j>>>16,j&=65535,G+=R+M,G&=65535,o(q<<16|ne,G<<16|j,this.unsigned)},B.subtract=function(_){return r(_)||(_=f(_)),this.add(_.neg())},B.sub=B.subtract,B.multiply=function(_){if(this.isZero()||(r(_)||(_=f(_)),_.isZero()))return g;if(this.eq(L))return _.isOdd()?L:g;if(_.eq(L))return this.isOdd()?L:g;if(this.isNegative())return _.isNegative()?this.neg().mul(_.neg()):this.neg().mul(_).neg();if(_.isNegative())return this.mul(_.neg()).neg();if(this.lt(v)&&_.lt(v))return i(this.toNumber()*_.toNumber(),this.unsigned);var R=this.high>>>16,F=this.high&65535,k=this.low>>>16,D=this.low&65535,M=_.high>>>16,O=_.high&65535,P=_.low>>>16,U=_.low&65535,G=0,j=0,q=0,ne=0;return ne+=D*U,q+=ne>>>16,ne&=65535,q+=k*U,j+=q>>>16,q&=65535,q+=D*P,j+=q>>>16,q&=65535,j+=F*U,G+=j>>>16,j&=65535,j+=k*P,G+=j>>>16,j&=65535,j+=D*O,G+=j>>>16,j&=65535,G+=R*U+F*P+k*O+D*M,G&=65535,o(q<<16|ne,G<<16|j,this.unsigned)},B.mul=B.multiply,B.divide=function(_){if(r(_)||(_=f(_)),_.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?y:g;var R,F,k;if(this.unsigned){if(_.unsigned||(_=_.toUnsigned()),_.gt(this))return y;if(_.gt(this.shru(1)))return E;k=y}else{if(this.eq(L)){if(_.eq(b)||_.eq(T))return L;if(_.eq(L))return b;var D=this.shr(1);return R=D.div(_).shl(1),R.eq(g)?_.isNegative()?b:T:(F=this.sub(_.mul(R)),k=R.add(F.div(_)),k)}else if(_.eq(L))return this.unsigned?y:g;if(this.isNegative())return _.isNegative()?this.neg().div(_.neg()):this.neg().div(_).neg();if(_.isNegative())return this.div(_.neg()).neg();k=g}for(F=this;F.gte(_);){R=Math.max(1,Math.floor(F.toNumber()/_.toNumber()));for(var M=Math.ceil(Math.log(R)/Math.LN2),O=M<=48?1:s(2,M-48),P=i(R),U=P.mul(_);U.isNegative()||U.gt(F);)R-=O,P=i(R,this.unsigned),U=P.mul(_);P.isZero()&&(P=b),k=k.add(P),F=F.sub(U)}return k},B.div=B.divide,B.modulo=function(_){return r(_)||(_=f(_)),this.sub(this.div(_).mul(_))},B.mod=B.modulo,B.not=function(){return o(~this.low,~this.high,this.unsigned)},B.and=function(_){return r(_)||(_=f(_)),o(this.low&_.low,this.high&_.high,this.unsigned)},B.or=function(_){return r(_)||(_=f(_)),o(this.low|_.low,this.high|_.high,this.unsigned)},B.xor=function(_){return r(_)||(_=f(_)),o(this.low^_.low,this.high^_.high,this.unsigned)},B.shiftLeft=function(_){return r(_)&&(_=_.toInt()),(_&=63)===0?this:_<32?o(this.low<<_,this.high<<_|this.low>>>32-_,this.unsigned):o(0,this.low<<_-32,this.unsigned)},B.shl=B.shiftLeft,B.shiftRight=function(_){return r(_)&&(_=_.toInt()),(_&=63)===0?this:_<32?o(this.low>>>_|this.high<<32-_,this.high>>_,this.unsigned):o(this.high>>_-32,this.high>=0?0:-1,this.unsigned)},B.shr=B.shiftRight,B.shiftRightUnsigned=function(_){if(r(_)&&(_=_.toInt()),_&=63,_===0)return this;var R=this.high;if(_<32){var F=this.low;return o(F>>>_|R<<32-_,R>>>_,this.unsigned)}else return _===32?o(R,0,this.unsigned):o(R>>>_-32,0,this.unsigned)},B.shru=B.shiftRightUnsigned,B.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},B.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},B.toBytes=function(C){return C?this.toBytesLE():this.toBytesBE()},B.toBytesLE=function(){var C=this.high,_=this.low;return[_&255,_>>>8&255,_>>>16&255,_>>>24&255,C&255,C>>>8&255,C>>>16&255,C>>>24&255]},B.toBytesBE=function(){var C=this.high,_=this.low;return[C>>>24&255,C>>>16&255,C>>>8&255,C&255,_>>>24&255,_>>>16&255,_>>>8&255,_&255]},e})});var Ic=K((xz,$1)=>{$1.exports=globalThis.h3||{}});var kc=K((Mz,yA)=>{yA.exports=globalThis.luma});var ys=K((Oz,AA)=>{AA.exports=globalThis.deck});var s_=K((RJ,Rs)=>{var eR=hf();function tR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Ps(e,r,t){return tR()?Rs.exports=Ps=Reflect.construct:Rs.exports=Ps=function(a,i,o){var s=[null];s.push.apply(s,i);var u=Function.bind.apply(a,s),f=new u;return o&&eR(f,o.prototype),f},Ps.apply(null,arguments)}Rs.exports=Ps});var ba=K((cX,Tb)=>{Tb.exports=globalThis.loaders});var sw=K((Lee,ow)=>{ow.exports=globalThis.deck});var Ow=K(gm=>{gm.read=function(e,r,t,n,a){var i,o,s=a*8-n-1,u=(1<<s)-1,f=u>>1,l=-7,c=t?a-1:0,h=t?-1:1,d=e[r+c];for(c+=h,i=d&(1<<-l)-1,d>>=-l,l+=s;l>0;i=i*256+e[r+c],c+=h,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=n;l>0;o=o*256+e[r+c],c+=h,l-=8);if(i===0)i=1-f;else{if(i===u)return o?NaN:(d?-1:1)*(1/0);o=o+Math.pow(2,n),i=i-f}return(d?-1:1)*o*Math.pow(2,i-n)};gm.write=function(e,r,t,n,a,i){var o,s,u,f=i*8-a-1,l=(1<<f)-1,c=l>>1,h=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,p=n?1:-1,v=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(s=isNaN(r)?1:0,o=l):(o=Math.floor(Math.log(r)/Math.LN2),r*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+c>=1?r+=h/u:r+=h*Math.pow(2,1-c),r*u>=2&&(o++,u/=2),o+c>=l?(s=0,o=l):o+c>=1?(s=(r*u-1)*Math.pow(2,a),o=o+c):(s=r*Math.pow(2,c-1)*Math.pow(2,a),o=0));a>=8;e[t+d]=s&255,d+=p,s/=256,a-=8);for(o=o<<a|s,f+=a;f>0;e[t+d]=o&255,d+=p,o/=256,f-=8);e[t+d-p]|=v*128}});var kw=K((Tte,Lw)=>{"use strict";Lw.exports=me;var Zu=Ow();function me(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}me.Varint=0;me.Fixed64=1;me.Bytes=2;me.Fixed32=5;var ym=(1<<16)*(1<<16),Iw=1/ym,$G=12,Fw=typeof TextDecoder>"u"?null:new TextDecoder("utf8");me.prototype={destroy:function(){this.buf=null},readFields:function(e,r,t){for(t=t||this.length;this.pos<t;){var n=this.readVarint(),a=n>>3,i=this.pos;this.type=n&7,e(a,r,this),this.pos===i&&this.skip(n)}return r},readMessage:function(e,r){return this.readFields(e,r,this.readVarint()+this.pos)},readFixed32:function(){var e=$u(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Rw(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=$u(this.buf,this.pos)+$u(this.buf,this.pos+4)*ym;return this.pos+=8,e},readSFixed64:function(){var e=$u(this.buf,this.pos)+Rw(this.buf,this.pos+4)*ym;return this.pos+=8,e},readFloat:function(){var e=Zu.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Zu.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var r=this.buf,t,n;return n=r[this.pos++],t=n&127,n<128||(n=r[this.pos++],t|=(n&127)<<7,n<128)||(n=r[this.pos++],t|=(n&127)<<14,n<128)||(n=r[this.pos++],t|=(n&127)<<21,n<128)?t:(n=r[this.pos],t|=(n&15)<<28,eN(t,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,r=this.pos;return this.pos=e,e-r>=$G&&Fw?pN(this.buf,r,e):dN(this.buf,r,e)},readBytes:function(){var e=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,e);return this.pos=e,r},readPackedVarint:function(e,r){if(this.type!==me.Bytes)return e.push(this.readVarint(r));var t=_r(this);for(e=e||[];this.pos<t;)e.push(this.readVarint(r));return e},readPackedSVarint:function(e){if(this.type!==me.Bytes)return e.push(this.readSVarint());var r=_r(this);for(e=e||[];this.pos<r;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==me.Bytes)return e.push(this.readBoolean());var r=_r(this);for(e=e||[];this.pos<r;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==me.Bytes)return e.push(this.readFloat());var r=_r(this);for(e=e||[];this.pos<r;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==me.Bytes)return e.push(this.readDouble());var r=_r(this);for(e=e||[];this.pos<r;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==me.Bytes)return e.push(this.readFixed32());var r=_r(this);for(e=e||[];this.pos<r;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==me.Bytes)return e.push(this.readSFixed32());var r=_r(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==me.Bytes)return e.push(this.readFixed64());var r=_r(this);for(e=e||[];this.pos<r;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==me.Bytes)return e.push(this.readSFixed64());var r=_r(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed64());return e},skip:function(e){var r=e&7;if(r===me.Varint)for(;this.buf[this.pos++]>127;);else if(r===me.Bytes)this.pos=this.readVarint()+this.pos;else if(r===me.Fixed32)this.pos+=4;else if(r===me.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+r)},writeTag:function(e,r){this.writeVarint(e<<3|r)},realloc:function(e){for(var r=this.length||16;r<this.pos+e;)r*=2;if(r!==this.length){var t=new Uint8Array(r);t.set(this.buf),this.buf=t,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Na(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Na(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Na(this.buf,e&-1,this.pos),Na(this.buf,Math.floor(e*Iw),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Na(this.buf,e&-1,this.pos),Na(this.buf,Math.floor(e*Iw),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){tN(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var r=this.pos;this.pos=mN(this.buf,e,this.pos);var t=this.pos-r;t>=128&&Pw(r,t,this),this.pos=r-1,this.writeVarint(t),this.pos+=t},writeFloat:function(e){this.realloc(4),Zu.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Zu.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var r=e.length;this.writeVarint(r),this.realloc(r);for(var t=0;t<r;t++)this.buf[this.pos++]=e[t]},writeRawMessage:function(e,r){this.pos++;var t=this.pos;e(r,this);var n=this.pos-t;n>=128&&Pw(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,r,t){this.writeTag(e,me.Bytes),this.writeRawMessage(r,t)},writePackedVarint:function(e,r){r.length&&this.writeMessage(e,aN,r)},writePackedSVarint:function(e,r){r.length&&this.writeMessage(e,iN,r)},writePackedBoolean:function(e,r){r.length&&this.writeMessage(e,uN,r)},writePackedFloat:function(e,r){r.length&&this.writeMessage(e,oN,r)},writePackedDouble:function(e,r){r.length&&this.writeMessage(e,sN,r)},writePackedFixed32:function(e,r){r.length&&this.writeMessage(e,fN,r)},writePackedSFixed32:function(e,r){r.length&&this.writeMessage(e,lN,r)},writePackedFixed64:function(e,r){r.length&&this.writeMessage(e,cN,r)},writePackedSFixed64:function(e,r){r.length&&this.writeMessage(e,hN,r)},writeBytesField:function(e,r){this.writeTag(e,me.Bytes),this.writeBytes(r)},writeFixed32Field:function(e,r){this.writeTag(e,me.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(e,r){this.writeTag(e,me.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(e,r){this.writeTag(e,me.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(e,r){this.writeTag(e,me.Fixed64),this.writeSFixed64(r)},writeVarintField:function(e,r){this.writeTag(e,me.Varint),this.writeVarint(r)},writeSVarintField:function(e,r){this.writeTag(e,me.Varint),this.writeSVarint(r)},writeStringField:function(e,r){this.writeTag(e,me.Bytes),this.writeString(r)},writeFloatField:function(e,r){this.writeTag(e,me.Fixed32),this.writeFloat(r)},writeDoubleField:function(e,r){this.writeTag(e,me.Fixed64),this.writeDouble(r)},writeBooleanField:function(e,r){this.writeVarintField(e,Boolean(r))}};function eN(e,r,t){var n=t.buf,a,i;if(i=n[t.pos++],a=(i&112)>>4,i<128||(i=n[t.pos++],a|=(i&127)<<3,i<128)||(i=n[t.pos++],a|=(i&127)<<10,i<128)||(i=n[t.pos++],a|=(i&127)<<17,i<128)||(i=n[t.pos++],a|=(i&127)<<24,i<128)||(i=n[t.pos++],a|=(i&1)<<31,i<128))return Ga(e,a,r);throw new Error("Expected varint not more than 10 bytes")}function _r(e){return e.type===me.Bytes?e.readVarint()+e.pos:e.pos+1}function Ga(e,r,t){return t?r*4294967296+(e>>>0):(r>>>0)*4294967296+(e>>>0)}function tN(e,r){var t,n;if(e>=0?(t=e%4294967296|0,n=e/4294967296|0):(t=~(-e%4294967296),n=~(-e/4294967296),t^4294967295?t=t+1|0:(t=0,n=n+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),rN(t,n,r),nN(n,r)}function rN(e,r,t){t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos++]=e&127|128,e>>>=7,t.buf[t.pos]=e&127}function nN(e,r){var t=(e&7)<<4;r.buf[r.pos++]|=t|((e>>>=3)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127|((e>>>=7)?128:0),e&&(r.buf[r.pos++]=e&127)))))}function Pw(e,r,t){var n=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(Math.LN2*7));t.realloc(n);for(var a=t.pos-1;a>=e;a--)t.buf[a+n]=t.buf[a]}function aN(e,r){for(var t=0;t<e.length;t++)r.writeVarint(e[t])}function iN(e,r){for(var t=0;t<e.length;t++)r.writeSVarint(e[t])}function oN(e,r){for(var t=0;t<e.length;t++)r.writeFloat(e[t])}function sN(e,r){for(var t=0;t<e.length;t++)r.writeDouble(e[t])}function uN(e,r){for(var t=0;t<e.length;t++)r.writeBoolean(e[t])}function fN(e,r){for(var t=0;t<e.length;t++)r.writeFixed32(e[t])}function lN(e,r){for(var t=0;t<e.length;t++)r.writeSFixed32(e[t])}function cN(e,r){for(var t=0;t<e.length;t++)r.writeFixed64(e[t])}function hN(e,r){for(var t=0;t<e.length;t++)r.writeSFixed64(e[t])}function $u(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16)+e[r+3]*16777216}function Na(e,r,t){e[t]=r,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24}function Rw(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16)+(e[r+3]<<24)}function dN(e,r,t){for(var n="",a=r;a<t;){var i=e[a],o=null,s=i>239?4:i>223?3:i>191?2:1;if(a+s>t)break;var u,f,l;s===1?i<128&&(o=i):s===2?(u=e[a+1],(u&192)===128&&(o=(i&31)<<6|u&63,o<=127&&(o=null))):s===3?(u=e[a+1],f=e[a+2],(u&192)===128&&(f&192)===128&&(o=(i&15)<<12|(u&63)<<6|f&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):s===4&&(u=e[a+1],f=e[a+2],l=e[a+3],(u&192)===128&&(f&192)===128&&(l&192)===128&&(o=(i&15)<<18|(u&63)<<12|(f&63)<<6|l&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,s=1):o>65535&&(o-=65536,n+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),n+=String.fromCharCode(o),a+=s}return n}function pN(e,r,t){return Fw.decode(e.subarray(r,t))}function mN(e,r,t){for(var n=0,a,i;n<r.length;n++){if(a=r.charCodeAt(n),a>55295&&a<57344)if(i)if(a<56320){e[t++]=239,e[t++]=191,e[t++]=189,i=a;continue}else a=i-55296<<10|a-56320|65536,i=null;else{a>56319||n+1===r.length?(e[t++]=239,e[t++]=191,e[t++]=189):i=a;continue}else i&&(e[t++]=239,e[t++]=191,e[t++]=189,i=null);a<128?e[t++]=a:(a<2048?e[t++]=a>>6|192:(a<65536?e[t++]=a>>12|224:(e[t++]=a>>18|240,e[t++]=a>>12&63|128),e[t++]=a>>6&63|128),e[t++]=a&63|128)}return t}});var oo={};It(oo,{GeohashLayer:()=>sf,GreatCircleLayer:()=>No,H3ClusterLayer:()=>gs,H3HexagonLayer:()=>yn,MVTLayer:()=>of,QuadkeyLayer:()=>zo,S2Layer:()=>Ho,TerrainLayer:()=>Wu,Tile3DLayer:()=>ku,TileLayer:()=>sr,TripsLayer:()=>ps,_GeoCellLayer:()=>Ct,_Tile2DHeader:()=>pi,_Tileset2D:()=>_i,_WMSLayer:()=>Go,_getURLFromTemplate:()=>qt});var Nt={},km=m(Pt());Tr(Nt,m(Pt()));if(!km.GeoJsonLayer)throw new Error("@deck.gl/layers is not found");Tr(oo,Nt);var kl=m(ce()),ko=m(X()),Xy=m(H()),Yy=m(z()),Ky=m(at()),Qy=m(Zr()),Zy=m(Te()),$y=m(xe()),Do=m(Ae()),li=m(W()),cn=m(Y()),hn=m(Rt()),e0=m(Pt());var $v=m(W()),eg=m(X()),Mf=m(Y());var qv=m(ce());var Wv=m(X()),Ef=m(Y());var Vv=m(W());function A(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var zv=m(jv());function Hv(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function TM(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Hv(Object(t),!0).forEach(function(n){(0,Vv.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Hv(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function xf(e,r){var t=new zv.XMLParser(TM({ignoreAttributes:!1,attributeNamePrefix:""},r?.xml)),n=t.parse(e);return n}var xM="3.3.3",en={name:"XML",id:"xml",module:"xml",version:xM,worker:!1,extensions:["xml"],mimeTypes:["application/xml","text/xml"],testText:EM,options:{xml:{}},parse:function(){var e=(0,Wv.default)(Ef.default.mark(function t(n,a){return Ef.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",xf(new TextDecoder().decode(n),a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseTextSync:function(r,t){return xf(r,t)}};function EM(e){return e.startsWith("<?xml")}function Xv(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=SM(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function SM(e,r){if(e){if(typeof e=="string")return Jv(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Jv(e,r)}}function Jv(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Sf(e,r){var t=en.parseTextSync(e,r),n=t.WMT_MS_Capabilities||t.WMS_Capabilities||t;return CM(n)}function CM(e){var r,t,n,a={name:((r=e.Service)===null||r===void 0?void 0:r.Name)||"unnamed",title:(t=e.Service)===null||t===void 0?void 0:t.Title,keywords:[],requests:{},layer:Yv((n=e.Capability)===null||n===void 0?void 0:n.Layer),raw:e},i=Xv(((u=e.Service)===null||u===void 0||(f=u.KeywordList)===null||f===void 0?void 0:f.Keyword)||[]),o;try{for(i.s();!(o=i.n()).done;){var s=o.value,u,f;a.keywords.push(s)}}catch(g){i.e(g)}finally{i.f()}for(var l=0,c=Object.entries(((v=e.Capability)===null||v===void 0?void 0:v.Request)||{});l<c.length;l++){var h=(0,qv.default)(c[l],2),d=h[0],p=h[1],v;a.requests[d]=wM(d,p)}return a}function wM(e,r){var t=r?.Format,n=Array.isArray(t)?t:[t];return{name:e,mimeTypes:n}}function Yv(e){var r={name:e?.Name,title:e?.Title,srs:e?.SRS||[],layers:[]},t=BM(e?.Layer),n=Xv(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value,o;(o=r.layers)===null||o===void 0||o.push(Yv(i))}}catch(s){n.e(s)}finally{n.f()}return r}function BM(e){return Array.isArray(e)?e:e?[e]:[]}function Cf(e,r){var t,n=en.parseTextSync(e,r),a=((t=n.FeatureInfoResponse)===null||t===void 0?void 0:t.FIELDS)||[],i=Array.isArray(a)?a:[a];return{features:i.map(function(o){return MM(o)})}}function MM(e){var r=e||{};return{attributes:r,type:"",bounds:{bottom:0,top:0,left:0,right:0}}}function wf(e,r){var t=en.parseTextSync(e,r);return t}function Kv(e,r){var t,n,a,i=(t=en.parseTextSync)===null||t===void 0?void 0:t.call(en,e,r),o=(i==null||(n=i.ServiceExceptionReport)===null||n===void 0?void 0:n.ServiceException)||(i==null||(a=i["ogc:ServiceExceptionReport"])===null||a===void 0?void 0:a["ogc:ServiceException"]),s=typeof o=="string"?o:o["#text"]||o.code||"Unknown error";return s}function Qv(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Zv(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Qv(Object(t),!0).forEach(function(n){(0,$v.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Qv(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var OM="3.3.3",qn={id:"wms-error",name:"WMS Error",module:"wms",version:OM,worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.se_xml","application/xml","text/xml"],testText:IM,options:{wms:{throwOnError:!1}},parse:function(){var e=(0,eg.default)(Mf.default.mark(function t(n,a){return Mf.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Bf(new TextDecoder().decode(n),a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseSync:function(r,t){return Bf(new TextDecoder().decode(r),t)},parseTextSync:function(r,t){return Bf(r,t)}};function IM(e){return e.startsWith("<?xml")}function Bf(e,r){var t=Zv(Zv({},qn.options.wms),r?.wms),n=Kv(e,t),a=t.minimalErrors?n:"WMS Service error: ".concat(n);if(t.throwOnError)throw new Error(a);return a}var tg=m(X()),Of=m(Y());var PM="3.3.3",tn={id:"wms-capabilities",name:"WMS Capabilities",module:"wms",version:PM,worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.wms_xml","application/xml","text/xml"],testText:RM,options:{wms:{}},parse:function(){var e=(0,tg.default)(Of.default.mark(function t(n,a){return Of.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Sf(new TextDecoder().decode(n),a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseTextSync:function(r,t){return Sf(r,t)}};function RM(e){return e.startsWith("<?xml")}var rg=m(H()),tr=function e(){(0,rg.default)(this,e)};var Pg=m(W()),rl=m(ce()),nl=m(X()),Rg=m(H()),Fg=m(z()),al=m(at()),Lg=m(Te()),kg=m(xe()),il=m(Ae()),ei=m(Y());var ng="3.3.3";var Og=m(X()),Qf=m(Y());function te(e,r){if(!e)throw new Error(r||"loader assertion failed.")}var ig=m(Xe()),Ut={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},FM=Ut.self||Ut.window||Ut.global||{},LM=Ut.window||Ut.self||Ut.global||{},kM=Ut.global||Ut.self||Ut.window||{},DM=Ut.document||{};var rn=Boolean((typeof process>"u"?"undefined":(0,ig.default)(process))!=="object"||String(process)!=="[object process]"||process.browser);var ag=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),GM=ag&&parseFloat(ag[1])||0;function og(e,r){if(!e)throw new Error(r||"loaders.gl assertion failed.")}var ug=m(Xe()),jt={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},a8=jt.self||jt.window||jt.global||{},i8=jt.window||jt.self||jt.global||{},fg=jt.global||jt.self||jt.window||{},o8=jt.document||{};var rr=(typeof process>"u"?"undefined":(0,ug.default)(process))!=="object"||String(process)!=="[object process]"||process.browser,za=typeof importScripts=="function",s8=typeof window<"u"&&typeof window.orientation<"u",sg=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),u8=sg&&parseFloat(sg[1])||0;var Ff=m(X()),Wa=m(Y());var nn=m(lg());var NM="3.3.3",If={};function Ht(e){return Pf.apply(this,arguments)}function Pf(){return Pf=(0,Ff.default)(Wa.default.mark(function e(r){var t,n,a=arguments;return Wa.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=a.length>1&&a[1]!==void 0?a[1]:null,n=a.length>2&&a[2]!==void 0?a[2]:{},t&&(r=cg(r,t,n)),If[r]=If[r]||UM(r),o.next=6,If[r];case 6:return o.abrupt("return",o.sent);case 7:case"end":return o.stop()}},e)})),Pf.apply(this,arguments)}function cg(e,r,t){if(e.startsWith("http"))return e;var n=t.modules||{};return n[e]?n[e]:rr?t.CDN?(og(t.CDN.startsWith("http")),"".concat(t.CDN,"/").concat(r,"@").concat(NM,"/dist/libs/").concat(e)):za?"../src/libs/".concat(e):"modules/".concat(r,"/src/libs/").concat(e):"modules/".concat(r,"/dist/libs/").concat(e)}function UM(e){return Rf.apply(this,arguments)}function Rf(){return Rf=(0,Ff.default)(Wa.default.mark(function e(r){var t,n,a;return Wa.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!r.endsWith("wasm")){o.next=7;break}return o.next=3,fetch(r);case 3:return t=o.sent,o.next=6,t.arrayBuffer();case 6:return o.abrupt("return",o.sent);case 7:if(rr){o.next=20;break}if(o.prev=8,o.t0=nn&&nn.requireFromFile,!o.t0){o.next=14;break}return o.next=13,nn.requireFromFile(r);case 13:o.t0=o.sent;case 14:return o.abrupt("return",o.t0);case 17:return o.prev=17,o.t1=o.catch(8),o.abrupt("return",null);case 20:if(!za){o.next=22;break}return o.abrupt("return",importScripts(r));case 22:return o.next=24,fetch(r);case 24:return n=o.sent,o.next=27,n.text();case 27:return a=o.sent,o.abrupt("return",jM(a,r));case 29:case"end":return o.stop()}},e,null,[[8,17]])})),Rf.apply(this,arguments)}function jM(e,r){if(!rr)return nn.requireFromString&&nn.requireFromString(e,r);if(za)return eval.call(fg,e),null;var t=document.createElement("script");t.id=r;try{t.appendChild(document.createTextNode(e))}catch{t.text=e}return document.body.appendChild(t),null}function dg(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;if(typeof e=="string")return e.slice(0,r);if(ArrayBuffer.isView(e))return hg(e.buffer,e.byteOffset,r);if(e instanceof ArrayBuffer){var t=0;return hg(e,t,r)}return""}function hg(e,r,t){if(e.byteLength<=r+t)return"";for(var n=new DataView(e),a="",i=0;i<t;i++)a+=String.fromCharCode(n.getUint8(r+i));return a}function Lf(e){try{return JSON.parse(e)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(dg(e),'"'))}}function Ja(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=r,a=n&&n.length>1&&n[0].constructor||null;if(!a)throw new Error('"concatenateTypedArrays" - incorrect quantity of arguments or arguments have incompatible data types');for(var i=n.reduce(function(c,h){return c+h.length},0),o=new a(i),s=0,u=0,f=n;u<f.length;u++){var l=f[u];o.set(l,s),s+=l.length}return o}function an(e,r,t){var n=t!==void 0?new Uint8Array(e).subarray(r,r+t):new Uint8Array(e).subarray(r),a=new Uint8Array(n);return a.buffer}function Er(e,r){return te(e>=0),te(r>0),e+(r-1)&~(r-1)}function kf(e,r,t){var n;if(e instanceof ArrayBuffer)n=new Uint8Array(e);else{var a=e.byteOffset,i=e.byteLength;n=new Uint8Array(e.buffer||e.arrayBuffer,a,i)}return r.set(n,t),t+Er(n.byteLength,4)}var _g=m(W()),bg=m(H()),Tg=m(z());var vg=m(H()),gg=m(z());var pg=m(H()),mg=m(z());function qa(){var e;if(typeof window<"u"&&window.performance)e=window.performance.now();else if(typeof process<"u"&&process.hrtime){var r=process.hrtime();e=r[0]*1e3+r[1]/1e6}else e=Date.now();return e}var po=function(){function e(r,t){(0,pg.default)(this,e),A(this,"name",void 0),A(this,"type",void 0),A(this,"sampleSize",1),A(this,"time",void 0),A(this,"count",void 0),A(this,"samples",void 0),A(this,"lastTiming",void 0),A(this,"lastSampleTime",void 0),A(this,"lastSampleCount",void 0),A(this,"_count",0),A(this,"_time",0),A(this,"_samples",0),A(this,"_startTime",0),A(this,"_timerPending",!1),this.name=r,this.type=t,this.reset()}return(0,mg.default)(e,[{key:"setSampleSize",value:function(t){return this.sampleSize=t,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(t){return this._count+=t,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(t){return this._count-=t,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=qa(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(qa()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),e}();var on=function(){function e(r){(0,vg.default)(this,e),A(this,"id",void 0),A(this,"stats",{}),this.id=r.id,this.stats={},this._initializeStats(r.stats),Object.seal(this)}return(0,gg.default)(e,[{key:"get",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:t,type:n})}},{key:"size",get:function(){return Object.keys(this.stats).length}},{key:"reset",value:function(){for(var t in this.stats)this.stats[t].reset();return this}},{key:"forEach",value:function(t){for(var n in this.stats)t(this.stats[n])}},{key:"getTable",value:function(){var t={};return this.forEach(function(n){t[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),t}},{key:"_initializeStats",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];n.forEach(function(a){return t._getOrCreate(a)})}},{key:"_getOrCreate",value:function(t){if(!t||!t.name)return null;var n=t.name,a=t.type;return this.stats[n]||(t instanceof po?this.stats[n]=t:this.stats[n]=new po(n,a)),this.stats[n]}}]),e}();function yg(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ag(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?yg(Object(t),!0).forEach(function(n){(0,_g.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):yg(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var HM="Queued Requests",VM="Active Requests",zM="Cancelled Requests",WM="Queued Requests Ever",JM="Active Requests Ever",qM={id:"request-scheduler",throttleRequests:!0,maxRequests:6},Xa=function(){function e(){(0,bg.default)(this,e);var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};A(this,"props",void 0),A(this,"stats",void 0),A(this,"activeRequestCount",0),A(this,"requestQueue",[]),A(this,"requestMap",new Map),A(this,"deferredUpdate",null),this.props=Ag(Ag({},qM),r),this.stats=new on({id:this.props.id}),this.stats.get(HM),this.stats.get(VM),this.stats.get(zM),this.stats.get(WM),this.stats.get(JM)}return(0,Tg.default)(e,[{key:"scheduleRequest",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return 0};if(!this.props.throttleRequests)return Promise.resolve({done:function(){}});if(this.requestMap.has(t))return this.requestMap.get(t);var a={handle:t,priority:0,getPriority:n},i=new Promise(function(o){return a.resolve=o,a});return this.requestQueue.push(a),this.requestMap.set(t,i),this._issueNewRequests(),i}},{key:"_issueRequest",value:function(t){var n=this,a=t.handle,i=t.resolve,o=!1,s=function(){o||(o=!0,n.requestMap.delete(a),n.activeRequestCount--,n._issueNewRequests())};return this.activeRequestCount++,i?i({done:s}):Promise.resolve({done:s})}},{key:"_issueNewRequests",value:function(){var t=this;this.deferredUpdate||(this.deferredUpdate=setTimeout(function(){return t._issueNewRequestsAsync()},0))}},{key:"_issueNewRequestsAsync",value:function(){this.deferredUpdate=null;var t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(t!==0){this._updateAllRequests();for(var n=0;n<t;++n){var a=this.requestQueue.shift();a&&this._issueRequest(a)}}}},{key:"_updateAllRequests",value:function(){for(var t=this.requestQueue,n=0;n<t.length;++n){var a=t[n];this._updateRequest(a)||(t.splice(n,1),this.requestMap.delete(a.handle),n--)}t.sort(function(i,o){return i.priority-o.priority})}},{key:"_updateRequest",value:function(t){return t.priority=t.getPriority(t.handle),t.priority<0?(t.resolve(null),!1):!0}}]),e}();var Xn={};It(Xn,{dirname:()=>YM,filename:()=>XM,join:()=>KM});function XM(e){var r=e&&e.lastIndexOf("/");return r>=0?e.substr(r+1):""}function YM(e){var r=e&&e.lastIndexOf("/");return r>=0?e.substr(0,r):""}function KM(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n="/";return r=r.map(function(a,i){return i&&(a=a.replace(new RegExp("^".concat(n)),"")),i!==r.length-1&&(a=a.replace(new RegExp("".concat(n,"$")),"")),a}),r.join(n)}var QM=globalThis._parseImageNode,Df=typeof Image<"u",Gf=typeof ImageBitmap<"u",ZM=Boolean(QM),Nf=rn?!0:ZM;function xg(e){switch(e){case"auto":return Gf||Df||Nf;case"imagebitmap":return Gf;case"image":return Df;case"data":return Nf;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}function Eg(){if(Gf)return"imagebitmap";if(Df)return"image";if(Nf)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}var Sg=m(Xe());function $M(e){var r=eO(e);if(!r)throw new Error("Not an image");return r}function Cg(e){switch($M(e)){case"data":return e;case"image":case"imagebitmap":var r=document.createElement("canvas"),t=r.getContext("2d");if(!t)throw new Error("getImageData");return r.width=e.width,r.height=e.height,t.drawImage(e,0,0),t.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function eO(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&e instanceof Image?"image":e&&(0,Sg.default)(e)==="object"&&e.data&&e.width&&e.height?"data":null}var Vf=m(X()),Ya=m(Y());var tO=/^data:image\/svg\+xml/,rO=/\.svg((\?|#).*)?$/;function mo(e){return e&&(tO.test(e)||rO.test(e))}function wg(e,r){if(mo(r)){var t=new TextDecoder,n=t.decode(e);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(i){throw new Error(i.message)}var a="data:image/svg+xml;base64,".concat(btoa(n));return a}return Uf(e,r)}function Uf(e,r){if(mo(r))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}function Ka(e,r,t){return jf.apply(this,arguments)}function jf(){return jf=(0,Vf.default)(Ya.default.mark(function e(r,t,n){var a,i,o;return Ya.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=wg(r,n),i=self.URL||self.webkitURL,o=typeof a!="string"&&i.createObjectURL(a),u.prev=3,u.next=6,nO(o||a,t);case 6:return u.abrupt("return",u.sent);case 7:return u.prev=7,o&&i.revokeObjectURL(o),u.finish(7);case 10:case"end":return u.stop()}},e,null,[[3,,7,10]])})),jf.apply(this,arguments)}function nO(e,r){return Hf.apply(this,arguments)}function Hf(){return Hf=(0,Vf.default)(Ya.default.mark(function e(r,t){var n;return Ya.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n=new Image,n.src=r,!(t.image&&t.image.decode&&n.decode)){i.next=6;break}return i.next=5,n.decode();case 5:return i.abrupt("return",n);case 6:return i.next=8,new Promise(function(o,s){try{n.onload=function(){return o(n)},n.onerror=function(u){return s(new Error("Could not load image ".concat(r,": ").concat(u)))}}catch(u){s(u)}});case 8:return i.abrupt("return",i.sent);case 9:case"end":return i.stop()}},e)})),Hf.apply(this,arguments)}var Jf=m(X()),Qa=m(Y());var aO={},Bg=!0;function qf(e,r,t){return zf.apply(this,arguments)}function zf(){return zf=(0,Jf.default)(Qa.default.mark(function e(r,t,n){var a,i,o;return Qa.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!mo(n)){u.next=7;break}return u.next=3,Ka(r,t,n);case 3:i=u.sent,a=i,u.next=8;break;case 7:a=Uf(r,n);case 8:return o=t&&t.imagebitmap,u.next=11,iO(a,o);case 11:return u.abrupt("return",u.sent);case 12:case"end":return u.stop()}},e)})),zf.apply(this,arguments)}function iO(e){return Wf.apply(this,arguments)}function Wf(){return Wf=(0,Jf.default)(Qa.default.mark(function e(r){var t,n=arguments;return Qa.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(t=n.length>1&&n[1]!==void 0?n[1]:null,(oO(t)||!Bg)&&(t=null),!t){i.next=13;break}return i.prev=3,i.next=6,createImageBitmap(r,t);case 6:return i.abrupt("return",i.sent);case 9:i.prev=9,i.t0=i.catch(3),console.warn(i.t0),Bg=!1;case 13:return i.next=15,createImageBitmap(r);case 15:return i.abrupt("return",i.sent);case 16:case"end":return i.stop()}},e,null,[[3,9]])})),Wf.apply(this,arguments)}function oO(e){for(var r in e||aO)return!1;return!0}var Mg=m(X()),Xf=m(Y());var Vt=!1,Za=!0;function sn(e){var r=$a(e);return sO(r)||lO(r)||uO(r)||fO(r)}function sO(e){var r=$a(e),t=r.byteLength>=24&&r.getUint32(0,Vt)===2303741511;return t?{mimeType:"image/png",width:r.getUint32(16,Vt),height:r.getUint32(20,Vt)}:null}function uO(e){var r=$a(e),t=r.byteLength>=10&&r.getUint32(0,Vt)===1195984440;return t?{mimeType:"image/gif",width:r.getUint16(6,Za),height:r.getUint16(8,Za)}:null}function fO(e){var r=$a(e),t=r.byteLength>=14&&r.getUint16(0,Vt)===16973&&r.getUint32(2,Za)===r.byteLength;return t?{mimeType:"image/bmp",width:r.getUint32(18,Za),height:r.getUint32(22,Za)}:null}function lO(e){var r=$a(e),t=r.byteLength>=3&&r.getUint16(0,Vt)===65496&&r.getUint8(2)===255;if(!t)return null;for(var n=cO(),a=n.tableMarkers,i=n.sofMarkers,o=2;o+9<r.byteLength;){var s=r.getUint16(o,Vt);if(i.has(s))return{mimeType:"image/jpeg",height:r.getUint16(o+5,Vt),width:r.getUint16(o+7,Vt)};if(!a.has(s))return null;o+=2,o+=r.getUint16(o,Vt)}return null}function cO(){for(var e=new Set([65499,65476,65484,65501,65534]),r=65504;r<65520;++r)e.add(r);var t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}function $a(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}function Kf(e,r){return Yf.apply(this,arguments)}function Yf(){return Yf=(0,Mg.default)(Xf.default.mark(function e(r,t){var n,a,i;return Xf.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=sn(r)||{},a=n.mimeType,i=globalThis._parseImageNode,te(i),s.next=5,i(r,a);case 5:return s.abrupt("return",s.sent);case 6:case"end":return s.stop()}},e)})),Yf.apply(this,arguments)}function $f(e,r,t){return Zf.apply(this,arguments)}function Zf(){return Zf=(0,Og.default)(Qf.default.mark(function e(r,t,n){var a,i,o,s,u,f;return Qf.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:t=t||{},a=t.image||{},i=a.type||"auto",o=n||{},s=o.url,u=hO(i),c.t0=u,c.next=c.t0==="imagebitmap"?8:c.t0==="image"?12:c.t0==="data"?16:20;break;case 8:return c.next=10,qf(r,t,s);case 10:return f=c.sent,c.abrupt("break",21);case 12:return c.next=14,Ka(r,t,s);case 14:return f=c.sent,c.abrupt("break",21);case 16:return c.next=18,Kf(r,t);case 18:return f=c.sent,c.abrupt("break",21);case 20:te(!1);case 21:return i==="data"&&(f=Cg(f)),c.abrupt("return",f);case 23:case"end":return c.stop()}},e)})),Zf.apply(this,arguments)}function hO(e){switch(e){case"auto":case"data":return Eg();default:return xg(e),e}}var dO=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],pO=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],mO={image:{type:"auto",decode:!0}},nr={id:"image",module:"images",name:"Images",version:ng,mimeTypes:pO,extensions:dO,parse:$f,tests:[function(e){return Boolean(sn(new DataView(e)))}],options:mO};var vO=["image/png","image/jpeg","image/gif"],el={};function tl(e){return el[e]===void 0&&(el[e]=gO(e)),el[e]}function gO(e){switch(e){case"image/webp":return yO();case"image/svg":return rn;default:if(!rn){var r=globalThis._parseImageNode;return Boolean(r)&&vO.includes(e)}return!0}}function yO(){if(!rn)return!1;try{var e=document.createElement("canvas");return e.toDataURL("image/webp").indexOf("data:image/webp")===0}catch{return!1}}function Ig(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Yn(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Ig(Object(t),!0).forEach(function(n){(0,Pg.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ig(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function AO(e){var r=_O();return function(){var n=(0,il.default)(e),a;if(r){var i=(0,il.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,kg.default)(this,a)}}function _O(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ti=function(e){(0,Lg.default)(t,e);var r=AO(t);function t(n){var a;return(0,Rg.default)(this,t),a=r.call(this),A((0,al.default)(a),"props",void 0),A((0,al.default)(a),"fetch",void 0),a.props=ri(n),a.fetch=Kn(n),a}return(0,Fg.default)(t,[{key:"getMetadata",value:function(){var n=(0,nl.default)(ei.default.mark(function i(){return ei.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:throw new Error("ImageSource.getMetadata not implemented");case 1:case"end":return s.stop()}},i)}));function a(){return n.apply(this,arguments)}return a}()},{key:"getImage",value:function(){var n=(0,nl.default)(ei.default.mark(function i(o){var s,u,f,l;return ei.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return s=this.getGranularParameters(o),u=this.getURLFromTemplate(s),h.next=4,this.fetch(u);case 4:return f=h.sent,h.next=7,f.arrayBuffer();case 7:return l=h.sent,h.next=10,nr.parse(l);case 10:return h.abrupt("return",h.sent);case 11:case"end":return h.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getGranularParameters",value:function(a){var i=(0,rl.default)(a.bbox,4),o=i[0],s=i[1],u=i[2],f=i[3];return Yn(Yn({},a),{},{east:o,north:s,south:f,west:u})}},{key:"getURLFromTemplate",value:function(a){for(var i=this.props.url,o=0,s=Object.entries(a);o<s.length;o++){var u=(0,rl.default)(s[o],2),f=u[0],l=u[1];i=i.replace("${".concat(f,"}"),String(l)),i=i.replace("{".concat(f,"}"),String(l))}return i}}]),t}(tr);A(ti,"type","template");A(ti,"testURL",function(e){return e.toLowerCase().includes("{")});function Kn(e){var r=e?.fetch;if(r&&typeof r=="function")return function(n,a){return r(n,a)};var t=e?.fetch;return t&&typeof t!="function"?function(n){return fetch(n,t)}:function(n){return fetch(n)}}function ri(e){return Yn(Yn({},e),{},{loadOptions:Yn(Yn({},e.loadOptions),{},{fetch:Kn(e.loadOptions)})})}var Jg=m(ce()),un=m(X()),qg=m(W()),Xg=m(H()),Yg=m(z()),ni=m(at()),Kg=m(Te()),Qg=m(xe()),ll=m(Ae()),_t=m(Y());var Ng=m(X()),Ug=m(W()),ol=m(Y());function Dg(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Gg(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Dg(Object(t),!0).forEach(function(n){(0,Ug.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Dg(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var sl=Gg(Gg({},tn),{},{id:"wms-feature-info",name:"WMS FeatureInfo",parse:function(){var e=(0,Ng.default)(ol.default.mark(function t(n,a){return ol.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Cf(new TextDecoder().decode(n),a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseTextSync:function(r,t){return Cf(r,t)}});var Vg=m(X()),zg=m(W()),ul=m(Y());function jg(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Hg(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?jg(Object(t),!0).forEach(function(n){(0,zg.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):jg(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var fl=Hg(Hg({},tn),{},{id:"wms-layer-description",name:"WMS DescribeLayer",parse:function(){var e=(0,Vg.default)(ul.default.mark(function t(n,a){return ul.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",wf(new TextDecoder().decode(n),a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseTextSync:function(r,t){return wf(r,t)}});function Wg(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ze(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Wg(Object(t),!0).forEach(function(n){(0,qg.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Wg(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function bO(e){var r=TO();return function(){var n=(0,ll.default)(e),a;if(r){var i=(0,ll.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,Qg.default)(this,a)}}function TO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ai=function(e){(0,Kg.default)(t,e);var r=bO(t);function t(n){var a;(0,Xg.default)(this,t);var i;return a=r.call(this),A((0,ni.default)(a),"props",void 0),A((0,ni.default)(a),"fetch",void 0),A((0,ni.default)(a),"capabilities",null),A((0,ni.default)(a),"loaders",[nr,qn,tn,sl,fl]),a.props=ri(n),a.fetch=Kn(a.props),a.props.loadOptions=Ze(Ze({},a.props.loadOptions),{},{wms:Ze(Ze({},(i=a.props.loadOptions)===null||i===void 0?void 0:i.wms),{},{throwOnError:!0})}),a}return(0,Yg.default)(t,[{key:"getMetadata",value:function(){return this.getCapabilities()}},{key:"getImage",value:function(a){return this.getMap(a)}},{key:"getCapabilities",value:function(){var n=(0,un.default)(_t.default.mark(function i(o,s){var u,f,l,c;return _t.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return u=this.getCapabilitiesURL(o,s),d.next=3,this.fetch(u);case 3:return f=d.sent,d.next=6,f.arrayBuffer();case 6:return l=d.sent,this._checkResponse(f,l),d.next=10,tn.parse(l,this.props.loadOptions);case 10:return c=d.sent,this.capabilities=c,d.abrupt("return",c);case 13:case"end":return d.stop()}},i,this)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getMap",value:function(){var n=(0,un.default)(_t.default.mark(function i(o,s){var u,f,l;return _t.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u=this.getMapURL(o,s),h.next=3,this.fetch(u);case 3:return f=h.sent,h.next=6,f.arrayBuffer();case 6:return l=h.sent,this._checkResponse(f,l),h.prev=8,h.next=11,nr.parse(l,this.props.loadOptions);case 11:return h.abrupt("return",h.sent);case 14:throw h.prev=14,h.t0=h.catch(8),this._parseError(l);case 17:case"end":return h.stop()}},i,this,[[8,14]])}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getFeatureInfo",value:function(){var n=(0,un.default)(_t.default.mark(function i(o,s){var u,f,l;return _t.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u=this.getFeatureInfoURL(o,s),h.next=3,this.fetch(u);case 3:return f=h.sent,h.next=6,f.arrayBuffer();case 6:return l=h.sent,this._checkResponse(f,l),h.next=10,sl.parse(l,this.props.loadOptions);case 10:return h.abrupt("return",h.sent);case 11:case"end":return h.stop()}},i,this)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getFeatureInfoText",value:function(){var n=(0,un.default)(_t.default.mark(function i(o,s){var u,f,l;return _t.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=Ze(Ze({},o),{},{info_format:"text/plain"}),u=this.getFeatureInfoURL(o,s),h.next=4,this.fetch(u);case 4:return f=h.sent,h.next=7,f.arrayBuffer();case 7:return l=h.sent,this._checkResponse(f,l),h.abrupt("return",new TextDecoder().decode(l));case 10:case"end":return h.stop()}},i,this)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"describeLayer",value:function(){var n=(0,un.default)(_t.default.mark(function i(o,s){var u,f,l;return _t.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u=this.describeLayerURL(o,s),h.next=3,this.fetch(u);case 3:return f=h.sent,h.next=6,f.arrayBuffer();case 6:return l=h.sent,this._checkResponse(f,l),h.next=10,fl.parse(l,this.props.loadOptions);case 10:return h.abrupt("return",h.sent);case 11:case"end":return h.stop()}},i,this)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getLegendGraphic",value:function(){var n=(0,un.default)(_t.default.mark(function i(o,s){var u,f,l;return _t.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u=this.getLegendGraphicURL(o,s),h.next=3,this.fetch(u);case 3:return f=h.sent,h.next=6,f.arrayBuffer();case 6:return l=h.sent,this._checkResponse(f,l),h.prev=8,h.next=11,nr.parse(l,this.props.loadOptions);case 11:return h.abrupt("return",h.sent);case 14:throw h.prev=14,h.t0=h.catch(8),this._parseError(l);case 17:case"end":return h.stop()}},i,this,[[8,14]])}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getCapabilitiesURL",value:function(a,i){var o=Ze(Ze({service:"WMS",version:"1.1.1",request:"GetCapabilities"},a),i);return this._getWMSUrl(o,i)}},{key:"getMapURL",value:function(a,i){var o=Ze(Ze({service:"WMS",version:"1.1.1",request:"GetMap",styles:void 0,srs:"EPSG:4326",format:"image/png"},a),i);return this._getWMSUrl(o,i)}},{key:"getFeatureInfoURL",value:function(a,i){var o=Ze(Ze({service:"WMS",version:"1.1.1",request:"GetFeatureInfo",srs:"EPSG:4326",format:"image/png",info_format:"text/plain",styles:void 0},a),i);return this._getWMSUrl(o,i)}},{key:"describeLayerURL",value:function(a,i){var o=Ze(Ze({service:"WMS",version:"1.1.1",request:"DescribeLayer"},a),i);return this._getWMSUrl(o,i)}},{key:"getLegendGraphicURL",value:function(a,i){var o=Ze(Ze({service:"WMS",version:"1.1.1",request:"GetLegendGraphic"},a),i);return this._getWMSUrl(o,i)}},{key:"_getWMSUrl",value:function(a,i){for(var o=this.props.url,s=!0,u=0,f=Object.entries(a);u<f.length;u++){var l=(0,Jg.default)(f[u],2),c=l[0],h=l[1];o+=s?"?":"&",s=!1,Array.isArray(h)?o+="".concat(c.toUpperCase(),"=").concat(h.join(",")):o+="".concat(c.toUpperCase(),"=").concat(h?String(h):"")}return encodeURI(o)}},{key:"_checkResponse",value:function(a,i){var o=a.headers["content-type"];if(!a.ok||qn.mimeTypes.includes(o)){var s=qn.parseSync(i,this.props.loadOptions);throw new Error(s)}}},{key:"_parseError",value:function(a){var i=qn.parseSync(a,this.props.loadOptions);return new Error(i)}}]),t}(tr);A(ai,"type","wms");A(ai,"testURL",function(e){return e.toLowerCase().includes("wms")});var Zg=m(ce()),ii=m(X()),$g=m(H()),ey=m(z()),cl=m(at()),ty=m(Te()),ry=m(xe()),hl=m(Ae()),ar=m(Y());function xO(e){var r=EO();return function(){var n=(0,hl.default)(e),a;if(r){var i=(0,hl.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,ry.default)(this,a)}}function EO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vo=function(e){(0,ty.default)(t,e);var r=xO(t);function t(n){var a;return(0,$g.default)(this,t),a=r.call(this),A((0,cl.default)(a),"props",void 0),A((0,cl.default)(a),"fetch",void 0),a.props=ri(n),a.fetch=Kn(a.props),a}return(0,ey.default)(t,[{key:"getMetadata",value:function(){var n=(0,ii.default)(ar.default.mark(function i(){return ar.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.info();case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"getImage",value:function(){var n=(0,ii.default)(ar.default.mark(function i(o){return ar.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:throw new Error("not implemented");case 1:case"end":return u.stop()}},i)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"info",value:function(){var n=(0,ii.default)(ar.default.mark(function i(){return ar.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:throw new Error("not implemented");case 1:case"end":return s.stop()}},i)}));function a(){return n.apply(this,arguments)}return a}()},{key:"exportImage",value:function(a){throw new Error("not implemented")}},{key:"infoURL",value:function(a){return this.props.url}},{key:"exportImageURL",value:function(a){return this.props.url}},{key:"getUrl",value:function(a,i){for(var o="".concat(this.props.url),s=!0,u=0,f=Object.entries(a);u<f.length;u++){var l=(0,Zg.default)(f[u],2),c=l[0],h=l[1];o+=s?"?":"&",s=!1,Array.isArray(h)?o+="".concat(c.toUpperCase(),"=").concat(h.join(",")):o+="".concat(c.toUpperCase(),"=").concat(h?String(h):"")}return o}},{key:"checkResponse",value:function(){var n=(0,ii.default)(ar.default.mark(function i(o){return ar.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(o.ok){u.next=2;break}throw new Error("error");case 2:case"end":return u.stop()}},i)}));function a(i){return n.apply(this,arguments)}return a}()}]),t}(tr);A(vo,"type","arcgis-image-server");A(vo,"testURL",function(e){return e.toLowerCase().includes("ImageServer")});function SO(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=CO(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function CO(e,r){if(e){if(typeof e=="string")return ny(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ny(e,r)}}function ny(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var wO=[ai,vo,ti];function dl(e){var r=e.type,t=r===void 0?"auto":r,n=t==="auto"?BO(e.url):t;switch(n){case"template":return new ti(e);case"wms":return new ai(e);default:throw new Error("Not a valid image source type")}}function BO(e){var r=SO(wO),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.testURL&&n.testURL(e))return n.type}}catch(a){r.e(a)}finally{r.f()}return"wms"}function Qn(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function pl(e){if(Array.isArray(e))return Qn(e)}function ml(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oi(e,r){if(e){if(typeof e=="string")return Qn(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Qn(e,r)}}function vl(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zn(e){return pl(e)||ml(e)||oi(e)||vl()}function gl(e){if(Array.isArray(e))return e}function yl(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],a=!0,i=!1,o,s;try{for(t=t.call(e);!(a=(o=t.next()).done)&&(n.push(o.value),!(r&&n.length===r));a=!0);}catch(u){i=!0,s=u}finally{try{!a&&t.return!=null&&t.return()}finally{if(i)throw s}}return n}}function Al(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $e(e,r){return gl(e)||yl(e,r)||oi(e,r)||Al()}function _l(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function cy(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bl(e,r,t){return r&&cy(e.prototype,r),t&&cy(e,t),e}function Ee(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var _e=1e-6,Qe=typeof Float32Array<"u"?Float32Array:Array;var B4=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});function kO(){var e=new Qe(4);return Qe!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function hy(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e}function go(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e}function dy(e){var r=e[0],t=e[1],n=e[2],a=e[3];return Math.hypot(r,t,n,a)}function py(e){var r=e[0],t=e[1],n=e[2],a=e[3];return r*r+t*t+n*n+a*a}function my(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=t*t+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t*o,e[1]=n*o,e[2]=a*o,e[3]=i*o,e}function vy(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]}function gy(e,r,t,n){var a=r[0],i=r[1],o=r[2],s=r[3];return e[0]=a+n*(t[0]-a),e[1]=i+n*(t[1]-i),e[2]=o+n*(t[2]-o),e[3]=s+n*(t[3]-s),e}function yo(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3];return e[0]=t[0]*n+t[4]*a+t[8]*i+t[12]*o,e[1]=t[1]*n+t[5]*a+t[9]*i+t[13]*o,e[2]=t[2]*n+t[6]*a+t[10]*i+t[14]*o,e[3]=t[3]*n+t[7]*a+t[11]*i+t[15]*o,e}function yy(e,r,t){var n=r[0],a=r[1],i=r[2],o=t[0],s=t[1],u=t[2],f=t[3],l=f*n+s*i-u*a,c=f*a+u*n-o*i,h=f*i+o*a-s*n,d=-o*n-s*a-u*i;return e[0]=l*f+d*-o+c*-u-h*-s,e[1]=c*f+d*-s+h*-o-l*-u,e[2]=h*f+d*-u+l*-s-c*-o,e[3]=r[3],e}var M4=function(){var e=kO();return function(r,t,n,a,i,o){var s,u;for(t||(t=4),n||(n=0),a?u=Math.min(a*t+n,r.length):u=r.length,s=n;s<u;s+=t)e[0]=r[s],e[1]=r[s+1],e[2]=r[s+2],e[3]=r[s+3],i(e,e,o),r[s]=e[0],r[s+1]=e[1],r[s+2]=e[2],r[s+3]=e[3];return r}}();function ea(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Sr(e,r){var t=yo([],r,e);return go(t,t,1/t[3]),t}function si(e,r,t){return e<r?r:e>t?t:e}function DO(e){return Math.log(e)*Math.LOG2E}var Ao=Math.log2||DO;function GO(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ay(e,r){if(e===r){var t=r[1],n=r[2],a=r[3],i=r[6],o=r[7],s=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=t,e[6]=r[9],e[7]=r[13],e[8]=n,e[9]=i,e[11]=r[14],e[12]=a,e[13]=o,e[14]=s}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function _o(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=r[4],s=r[5],u=r[6],f=r[7],l=r[8],c=r[9],h=r[10],d=r[11],p=r[12],v=r[13],g=r[14],y=r[15],b=t*s-n*o,E=t*u-a*o,T=t*f-i*o,S=n*u-a*s,I=n*f-i*s,L=a*f-i*u,B=l*v-c*p,C=l*g-h*p,_=l*y-d*p,R=c*g-h*v,F=c*y-d*v,k=h*y-d*g,D=b*k-E*F+T*R+S*_-I*C+L*B;return D?(D=1/D,e[0]=(s*k-u*F+f*R)*D,e[1]=(a*F-n*k-i*R)*D,e[2]=(v*L-g*I+y*S)*D,e[3]=(h*I-c*L-d*S)*D,e[4]=(u*_-o*k-f*C)*D,e[5]=(t*k-a*_+i*C)*D,e[6]=(g*T-p*L-y*E)*D,e[7]=(l*L-h*T+d*E)*D,e[8]=(o*F-s*_+f*B)*D,e[9]=(n*_-t*F-i*B)*D,e[10]=(p*I-v*T+y*b)*D,e[11]=(c*T-l*I-d*b)*D,e[12]=(s*C-o*R-u*B)*D,e[13]=(t*R-n*C+a*B)*D,e[14]=(v*E-p*S-g*b)*D,e[15]=(l*S-c*E+h*b)*D,e):null}function _y(e){var r=e[0],t=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],u=e[7],f=e[8],l=e[9],c=e[10],h=e[11],d=e[12],p=e[13],v=e[14],g=e[15],y=r*o-t*i,b=r*s-n*i,E=r*u-a*i,T=t*s-n*o,S=t*u-a*o,I=n*u-a*s,L=f*p-l*d,B=f*v-c*d,C=f*g-h*d,_=l*v-c*p,R=l*g-h*p,F=c*g-h*v;return y*F-b*R+E*_+T*C-S*B+I*L}function fn(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],l=r[7],c=r[8],h=r[9],d=r[10],p=r[11],v=r[12],g=r[13],y=r[14],b=r[15],E=t[0],T=t[1],S=t[2],I=t[3];return e[0]=E*n+T*s+S*c+I*v,e[1]=E*a+T*u+S*h+I*g,e[2]=E*i+T*f+S*d+I*y,e[3]=E*o+T*l+S*p+I*b,E=t[4],T=t[5],S=t[6],I=t[7],e[4]=E*n+T*s+S*c+I*v,e[5]=E*a+T*u+S*h+I*g,e[6]=E*i+T*f+S*d+I*y,e[7]=E*o+T*l+S*p+I*b,E=t[8],T=t[9],S=t[10],I=t[11],e[8]=E*n+T*s+S*c+I*v,e[9]=E*a+T*u+S*h+I*g,e[10]=E*i+T*f+S*d+I*y,e[11]=E*o+T*l+S*p+I*b,E=t[12],T=t[13],S=t[14],I=t[15],e[12]=E*n+T*s+S*c+I*v,e[13]=E*a+T*u+S*h+I*g,e[14]=E*i+T*f+S*d+I*y,e[15]=E*o+T*l+S*p+I*b,e}function ln(e,r,t){var n=t[0],a=t[1],i=t[2],o,s,u,f,l,c,h,d,p,v,g,y;return r===e?(e[12]=r[0]*n+r[4]*a+r[8]*i+r[12],e[13]=r[1]*n+r[5]*a+r[9]*i+r[13],e[14]=r[2]*n+r[6]*a+r[10]*i+r[14],e[15]=r[3]*n+r[7]*a+r[11]*i+r[15]):(o=r[0],s=r[1],u=r[2],f=r[3],l=r[4],c=r[5],h=r[6],d=r[7],p=r[8],v=r[9],g=r[10],y=r[11],e[0]=o,e[1]=s,e[2]=u,e[3]=f,e[4]=l,e[5]=c,e[6]=h,e[7]=d,e[8]=p,e[9]=v,e[10]=g,e[11]=y,e[12]=o*n+l*a+p*i+r[12],e[13]=s*n+c*a+v*i+r[13],e[14]=u*n+h*a+g*i+r[14],e[15]=f*n+d*a+y*i+r[15]),e}function ta(e,r,t){var n=t[0],a=t[1],i=t[2];return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*a,e[5]=r[5]*a,e[6]=r[6]*a,e[7]=r[7]*a,e[8]=r[8]*i,e[9]=r[9]*i,e[10]=r[10]*i,e[11]=r[11]*i,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function by(e,r,t,n){var a=n[0],i=n[1],o=n[2],s=Math.hypot(a,i,o),u,f,l,c,h,d,p,v,g,y,b,E,T,S,I,L,B,C,_,R,F,k,D,M;return s<_e?null:(s=1/s,a*=s,i*=s,o*=s,u=Math.sin(t),f=Math.cos(t),l=1-f,c=r[0],h=r[1],d=r[2],p=r[3],v=r[4],g=r[5],y=r[6],b=r[7],E=r[8],T=r[9],S=r[10],I=r[11],L=a*a*l+f,B=i*a*l+o*u,C=o*a*l-i*u,_=a*i*l-o*u,R=i*i*l+f,F=o*i*l+a*u,k=a*o*l+i*u,D=i*o*l-a*u,M=o*o*l+f,e[0]=c*L+v*B+E*C,e[1]=h*L+g*B+T*C,e[2]=d*L+y*B+S*C,e[3]=p*L+b*B+I*C,e[4]=c*_+v*R+E*F,e[5]=h*_+g*R+T*F,e[6]=d*_+y*R+S*F,e[7]=p*_+b*R+I*F,e[8]=c*k+v*D+E*M,e[9]=h*k+g*D+T*M,e[10]=d*k+y*D+S*M,e[11]=p*k+b*D+I*M,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function bo(e,r,t){var n=Math.sin(t),a=Math.cos(t),i=r[4],o=r[5],s=r[6],u=r[7],f=r[8],l=r[9],c=r[10],h=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=i*a+f*n,e[5]=o*a+l*n,e[6]=s*a+c*n,e[7]=u*a+h*n,e[8]=f*a-i*n,e[9]=l*a-o*n,e[10]=c*a-s*n,e[11]=h*a-u*n,e}function Ty(e,r,t){var n=Math.sin(t),a=Math.cos(t),i=r[0],o=r[1],s=r[2],u=r[3],f=r[8],l=r[9],c=r[10],h=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=i*a-f*n,e[1]=o*a-l*n,e[2]=s*a-c*n,e[3]=u*a-h*n,e[8]=i*n+f*a,e[9]=o*n+l*a,e[10]=s*n+c*a,e[11]=u*n+h*a,e}function To(e,r,t){var n=Math.sin(t),a=Math.cos(t),i=r[0],o=r[1],s=r[2],u=r[3],f=r[4],l=r[5],c=r[6],h=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=i*a+f*n,e[1]=o*a+l*n,e[2]=s*a+c*n,e[3]=u*a+h*n,e[4]=f*a-i*n,e[5]=l*a-o*n,e[6]=c*a-s*n,e[7]=h*a-u*n,e}function xy(e,r){var t=r[0],n=r[1],a=r[2],i=r[4],o=r[5],s=r[6],u=r[8],f=r[9],l=r[10];return e[0]=Math.hypot(t,n,a),e[1]=Math.hypot(i,o,s),e[2]=Math.hypot(u,f,l),e}function Ey(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=t+t,s=n+n,u=a+a,f=t*o,l=n*o,c=n*s,h=a*o,d=a*s,p=a*u,v=i*o,g=i*s,y=i*u;return e[0]=1-c-p,e[1]=l+y,e[2]=h-g,e[3]=0,e[4]=l-y,e[5]=1-f-p,e[6]=d+v,e[7]=0,e[8]=h+g,e[9]=d-v,e[10]=1-f-c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Sy(e,r,t,n,a,i,o){var s=1/(t-r),u=1/(a-n),f=1/(i-o);return e[0]=i*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i*2*u,e[6]=0,e[7]=0,e[8]=(t+r)*s,e[9]=(a+n)*u,e[10]=(o+i)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*i*2*f,e[15]=0,e}function NO(e,r,t,n,a){var i=1/Math.tan(r/2),o;return e[0]=i/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(o=1/(n-a),e[10]=(a+n)*o,e[14]=2*a*n*o):(e[10]=-1,e[14]=-2*n),e}var xo=NO;function UO(e,r,t,n,a,i,o){var s=1/(r-t),u=1/(n-a),f=1/(i-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(r+t)*s,e[13]=(a+n)*u,e[14]=(o+i)*f,e[15]=1,e}var Cy=UO;function wy(e,r,t,n){var a,i,o,s,u,f,l,c,h,d,p=r[0],v=r[1],g=r[2],y=n[0],b=n[1],E=n[2],T=t[0],S=t[1],I=t[2];return Math.abs(p-T)<_e&&Math.abs(v-S)<_e&&Math.abs(g-I)<_e?GO(e):(l=p-T,c=v-S,h=g-I,d=1/Math.hypot(l,c,h),l*=d,c*=d,h*=d,a=b*h-E*c,i=E*l-y*h,o=y*c-b*l,d=Math.hypot(a,i,o),d?(d=1/d,a*=d,i*=d,o*=d):(a=0,i=0,o=0),s=c*o-h*i,u=h*a-l*o,f=l*i-c*a,d=Math.hypot(s,u,f),d?(d=1/d,s*=d,u*=d,f*=d):(s=0,u=0,f=0),e[0]=a,e[1]=s,e[2]=l,e[3]=0,e[4]=i,e[5]=u,e[6]=c,e[7]=0,e[8]=o,e[9]=f,e[10]=h,e[11]=0,e[12]=-(a*p+i*v+o*g),e[13]=-(s*p+u*v+f*g),e[14]=-(l*p+c*v+h*g),e[15]=1,e)}function El(e,r){var t=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],f=e[7],l=e[8],c=e[9],h=e[10],d=e[11],p=e[12],v=e[13],g=e[14],y=e[15],b=r[0],E=r[1],T=r[2],S=r[3],I=r[4],L=r[5],B=r[6],C=r[7],_=r[8],R=r[9],F=r[10],k=r[11],D=r[12],M=r[13],O=r[14],P=r[15];return Math.abs(t-b)<=_e*Math.max(1,Math.abs(t),Math.abs(b))&&Math.abs(n-E)<=_e*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(a-T)<=_e*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(i-S)<=_e*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(o-I)<=_e*Math.max(1,Math.abs(o),Math.abs(I))&&Math.abs(s-L)<=_e*Math.max(1,Math.abs(s),Math.abs(L))&&Math.abs(u-B)<=_e*Math.max(1,Math.abs(u),Math.abs(B))&&Math.abs(f-C)<=_e*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(l-_)<=_e*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(c-R)<=_e*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(h-F)<=_e*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(d-k)<=_e*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(p-D)<=_e*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(v-M)<=_e*Math.max(1,Math.abs(v),Math.abs(M))&&Math.abs(g-O)<=_e*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(y-P)<=_e*Math.max(1,Math.abs(y),Math.abs(P))}function jO(){var e=new Qe(2);return Qe!=Float32Array&&(e[0]=0,e[1]=0),e}function Sl(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e}function By(e,r){return e[0]=-r[0],e[1]=-r[1],e}function So(e,r,t,n){var a=r[0],i=r[1];return e[0]=a+n*(t[0]-a),e[1]=i+n*(t[1]-i),e}function My(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a,e[1]=t[1]*n+t[3]*a,e}function Oy(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a+t[4],e[1]=t[1]*n+t[3]*a+t[5],e}function Co(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[3]*a+t[6],e[1]=t[1]*n+t[4]*a+t[7],e}function wo(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[4]*a+t[12],e[1]=t[1]*n+t[5]*a+t[13],e}var P4=function(){var e=jO();return function(r,t,n,a,i,o){var s,u;for(t||(t=2),n||(n=0),a?u=Math.min(a*t+n,r.length):u=r.length,s=n;s<u;s+=t)e[0]=r[s],e[1]=r[s+1],i(e,e,o),r[s]=e[0],r[s+1]=e[1];return r}}();function Cl(){var e=new Qe(3);return Qe!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function wl(e){var r=e[0],t=e[1],n=e[2];return Math.hypot(r,t,n)}function Bl(e,r,t){var n=new Qe(3);return n[0]=e,n[1]=r,n[2]=t,n}function Iy(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e}function HO(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e}function Py(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e}function Ry(e,r){var t=r[0],n=r[1],a=r[2],i=t*t+n*n+a*a;return i>0&&(i=1/Math.sqrt(i)),e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e}function ui(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function na(e,r,t){var n=r[0],a=r[1],i=r[2],o=t[0],s=t[1],u=t[2];return e[0]=a*u-i*s,e[1]=i*o-n*u,e[2]=n*s-a*o,e}function aa(e,r,t){var n=r[0],a=r[1],i=r[2],o=t[3]*n+t[7]*a+t[11]*i+t[15];return o=o||1,e[0]=(t[0]*n+t[4]*a+t[8]*i+t[12])/o,e[1]=(t[1]*n+t[5]*a+t[9]*i+t[13])/o,e[2]=(t[2]*n+t[6]*a+t[10]*i+t[14])/o,e}function Bo(e,r,t){var n=r[0],a=r[1],i=r[2];return e[0]=n*t[0]+a*t[3]+i*t[6],e[1]=n*t[1]+a*t[4]+i*t[7],e[2]=n*t[2]+a*t[5]+i*t[8],e}function Mo(e,r,t){var n=t[0],a=t[1],i=t[2],o=t[3],s=r[0],u=r[1],f=r[2],l=a*f-i*u,c=i*s-n*f,h=n*u-a*s,d=a*h-i*c,p=i*l-n*h,v=n*c-a*l,g=o*2;return l*=g,c*=g,h*=g,d*=2,p*=2,v*=2,e[0]=s+l+d,e[1]=u+c+p,e[2]=f+h+v,e}function Fy(e,r,t,n){var a=[],i=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function Ly(e,r,t,n){var a=[],i=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function ky(e,r,t,n){var a=[],i=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function Dy(e,r){var t=e[0],n=e[1],a=e[2],i=r[0],o=r[1],s=r[2],u=Math.sqrt(t*t+n*n+a*a),f=Math.sqrt(i*i+o*o+s*s),l=u*f,c=l&&ui(e,r)/l;return Math.acos(Math.min(Math.max(c,-1),1))}var Gy=HO;var Ny=wl;var R4=function(){var e=Cl();return function(r,t,n,a,i,o){var s,u;for(t||(t=3),n||(n=0),a?u=Math.min(a*t+n,r.length):u=r.length,s=n;s<u;s+=t)e[0]=r[s],e[1]=r[s+1],e[2]=r[s+2],i(e,e,o),r[s]=e[0],r[s+1]=e[1],r[s+2]=e[2];return r}}();function Ft(e,r){if(!e)throw new Error(r||"@math.gl/web-mercator: assertion failed.")}var Lt=Math.PI,jy=Lt/4,zt=Lt/180,Ml=180/Lt,fi=512,Uy=4003e4,oa=85.051129,Ol=1.5;function Oo(e){return Math.pow(2,e)}function it(e){var r=$e(e,2),t=r[0],n=r[1];Ft(Number.isFinite(t)),Ft(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");var a=t*zt,i=n*zt,o=fi*(a+Lt)/(2*Lt),s=fi*(Lt+Math.log(Math.tan(jy+i*.5)))/(2*Lt);return[o,s]}function dt(e){var r=$e(e,2),t=r[0],n=r[1],a=t/fi*(2*Lt)-Lt,i=2*(Math.atan(Math.exp(n/fi*(2*Lt)-Lt))-jy);return[a*Ml,i*Ml]}function Il(e){var r=e.latitude,t=e.longitude,n=e.highPrecision,a=n===void 0?!1:n;Ft(Number.isFinite(r)&&Number.isFinite(t));var i=fi,o=Math.cos(r*zt),s=i/360,u=s/o,f=i/Uy/o,l={unitsPerMeter:[f,f,f],metersPerUnit:[1/f,1/f,1/f],unitsPerDegree:[s,u,f],degreesPerUnit:[1/s,1/u,1/f]};if(a){var c=zt*Math.tan(r*zt)/o,h=s*c/2,d=i/Uy*c,p=d/u*f;l.unitsPerDegree2=[0,h,d],l.unitsPerMeter2=[p,0,p]}return l}function Pl(e){var r=e.height,t=e.pitch,n=e.bearing,a=e.altitude,i=e.scale,o=e.center,s=ea();ln(s,s,[0,0,-a]),bo(s,s,-t*zt),To(s,s,n*zt);var u=i/r;return ta(s,s,[u,u,u]),o&&ln(s,s,Py([],o)),s}function Hy(e){var r=e.width,t=e.height,n=e.altitude,a=e.pitch,i=a===void 0?0:a,o=e.offset,s=e.center,u=e.scale,f=e.nearZMultiplier,l=f===void 0?1:f,c=e.farZMultiplier,h=c===void 0?1:c,d=e.fovy,p=d===void 0?ia(Ol):d;n!==void 0&&(p=ia(n));var v=p*zt,g=i*zt,y=Io(p),b=y;s&&(b+=s[2]*u/Math.cos(g)/t);var E=v*(.5+(o?o[1]:0)/t),T=Math.sin(E)*b/Math.sin(si(Math.PI/2-g-E,.01,Math.PI-.01)),S=Math.sin(g)*T+b,I=b*10,L=Math.min(S*h,I);return{fov:v,aspect:r/t,focalDistance:y,near:l,far:L}}function Rl(e){var r=Hy(e),t=r.fov,n=r.aspect,a=r.near,i=r.far,o=xo([],t,n,a,i);return o}function ia(e){return 2*Math.atan(.5/e)*Ml}function Io(e){return .5/Math.tan(.5*e*zt)}function Fl(e,r){var t=$e(e,3),n=t[0],a=t[1],i=t[2],o=i===void 0?0:i;return Ft(Number.isFinite(n)&&Number.isFinite(a)&&Number.isFinite(o)),Sr(r,[n,a,o,1])}function Po(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=$e(e,3),a=n[0],i=n[1],o=n[2];if(Ft(Number.isFinite(a)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(o)){var s=Sr(r,[a,i,o,1]);return s}var u=Sr(r,[a,i,0,1]),f=Sr(r,[a,i,1,1]),l=u[2],c=f[2],h=l===c?0:((t||0)-l)/(c-l);return So([],u,f,h)}function Ro(e){var r=e.width,t=e.height,n=e.bounds,a=e.minExtent,i=a===void 0?0:a,o=e.maxZoom,s=o===void 0?24:o,u=e.offset,f=u===void 0?[0,0]:u,l=$e(n,2),c=$e(l[0],2),h=c[0],d=c[1],p=$e(l[1],2),v=p[0],g=p[1],y=VO(e.padding),b=it([h,si(g,-oa,oa)]),E=it([v,si(d,-oa,oa)]),T=[Math.max(Math.abs(E[0]-b[0]),i),Math.max(Math.abs(E[1]-b[1]),i)],S=[r-y.left-y.right-Math.abs(f[0])*2,t-y.top-y.bottom-Math.abs(f[1])*2];Ft(S[0]>0&&S[1]>0);var I=S[0]/T[0],L=S[1]/T[1],B=(y.right-y.left)/2/I,C=(y.bottom-y.top)/2/L,_=[(E[0]+b[0])/2+B,(E[1]+b[1])/2+C],R=dt(_),F=Math.min(s,Ao(Math.abs(Math.min(I,L))));return Ft(Number.isFinite(F)),{longitude:R[0],latitude:R[1],zoom:F}}function VO(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:(Ft(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e)}var Vy=Math.PI/180;function Fo(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=e.width,n=e.height,a=e.unproject,i={targetZ:r},o=a([0,n],i),s=a([t,n],i),u,f,l=e.fovy?.5*e.fovy*Vy:Math.atan(.5/e.altitude),c=(90-e.pitch)*Vy;return l>c-.01?(u=zy(e,0,r),f=zy(e,t,r)):(u=a([0,0],i),f=a([t,0],i)),[o,s,f,u]}function zy(e,r,t){var n=e.pixelUnprojectionMatrix,a=Sr(n,[r,0,1,1]),i=Sr(n,[r,e.height,1,1]),o=t*e.distanceScales.unitsPerMeter[2],s=(o-a[2])/(i[2]-a[2]),u=So([],a,i,s),f=dt(u);return f.push(t),f}var Wy=function(){function e(){var r=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{width:1,height:1};_l(this,e),Ee(this,"latitude",void 0),Ee(this,"longitude",void 0),Ee(this,"zoom",void 0),Ee(this,"pitch",void 0),Ee(this,"bearing",void 0),Ee(this,"altitude",void 0),Ee(this,"fovy",void 0),Ee(this,"meterOffset",void 0),Ee(this,"center",void 0),Ee(this,"width",void 0),Ee(this,"height",void 0),Ee(this,"scale",void 0),Ee(this,"distanceScales",void 0),Ee(this,"viewMatrix",void 0),Ee(this,"projectionMatrix",void 0),Ee(this,"viewProjectionMatrix",void 0),Ee(this,"pixelProjectionMatrix",void 0),Ee(this,"pixelUnprojectionMatrix",void 0),Ee(this,"equals",function(F){return F instanceof e?F.width===r.width&&F.height===r.height&&El(F.projectionMatrix,r.projectionMatrix)&&El(F.viewMatrix,r.viewMatrix):!1}),Ee(this,"project",function(F){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=k.topLeft,M=D===void 0?!0:D,O=r.projectPosition(F),P=Fl(O,r.pixelProjectionMatrix),U=$e(P,2),G=U[0],j=U[1],q=M?j:r.height-j;return F.length===2?[G,q]:[G,q,P[2]]}),Ee(this,"unproject",function(F){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=k.topLeft,M=D===void 0?!0:D,O=k.targetZ,P=O===void 0?void 0:O,U=$e(F,3),G=U[0],j=U[1],q=U[2],ne=M?j:r.height-j,Re=P&&P*r.distanceScales.unitsPerMeter[2],we=Po([G,ne,q],r.pixelUnprojectionMatrix,Re),nt=r.unprojectPosition(we),je=$e(nt,3),br=je[0],Et=je[1],Jn=je[2];return Number.isFinite(q)?[br,Et,Jn]:Number.isFinite(P)?[br,Et,P]:[br,Et]}),Ee(this,"projectPosition",function(F){var k=it(F),D=$e(k,2),M=D[0],O=D[1],P=(F[2]||0)*r.distanceScales.unitsPerMeter[2];return[M,O,P]}),Ee(this,"unprojectPosition",function(F){var k=dt(F),D=$e(k,2),M=D[0],O=D[1],P=(F[2]||0)*r.distanceScales.metersPerUnit[2];return[M,O,P]});var n=t.width,a=t.height,i=t.altitude,o=i===void 0?null:i,s=t.fovy,u=s===void 0?null:s,f=t.latitude,l=f===void 0?0:f,c=t.longitude,h=c===void 0?0:c,d=t.zoom,p=d===void 0?0:d,v=t.pitch,g=v===void 0?0:v,y=t.bearing,b=y===void 0?0:y,E=t.position,T=E===void 0?null:E,S=t.nearZMultiplier,I=S===void 0?.02:S,L=t.farZMultiplier,B=L===void 0?1.01:L;n=n||1,a=a||1,u===null&&o===null?(o=Ol,u=ia(o)):u===null?u=ia(o):o===null&&(o=Io(u));var C=Oo(p);o=Math.max(.75,o);var _=Il({longitude:h,latitude:l}),R=it([h,l]);R.push(0),T&&Iy(R,R,Gy([],T,_.unitsPerMeter)),this.projectionMatrix=Rl({width:n,height:a,scale:C,center:R,pitch:g,fovy:u,nearZMultiplier:I,farZMultiplier:B}),this.viewMatrix=Pl({height:a,scale:C,center:R,pitch:g,bearing:b,altitude:o}),this.width=n,this.height=a,this.scale=C,this.latitude=l,this.longitude=h,this.zoom=p,this.pitch=g,this.bearing=b,this.altitude=o,this.fovy=u,this.center=R,this.meterOffset=T||[0,0,0],this.distanceScales=_,this._initMatrices(),Object.freeze(this)}return bl(e,[{key:"_initMatrices",value:function(){var t=this.width,n=this.height,a=this.projectionMatrix,i=this.viewMatrix,o=ea();fn(o,o,a),fn(o,o,i),this.viewProjectionMatrix=o;var s=ea();ta(s,s,[t/2,-n/2,1]),ln(s,s,[1,-1,0]),fn(s,s,o);var u=_o(ea(),s);if(!u)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=s,this.pixelUnprojectionMatrix=u}},{key:"projectFlat",value:function(t){return it(t)}},{key:"unprojectFlat",value:function(t){return dt(t)}},{key:"getMapCenterByLngLatPosition",value:function(t){var n=t.lngLat,a=t.pos,i=Po(a,this.pixelUnprojectionMatrix),o=it(n),s=Sl([],o,By([],i)),u=Sl([],this.center,s);return dt(u)}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.width,i=this.height,o=Ro(Object.assign({width:a,height:i,bounds:t},n)),s=o.longitude,u=o.latitude,f=o.zoom;return new e({width:a,height:i,longitude:s,latitude:u,zoom:f})}},{key:"getBounds",value:function(t){var n=this.getBoundingRegion(t),a=Math.min.apply(Math,Zn(n.map(function(u){return u[0]}))),i=Math.max.apply(Math,Zn(n.map(function(u){return u[0]}))),o=Math.min.apply(Math,Zn(n.map(function(u){return u[1]}))),s=Math.max.apply(Math,Zn(n.map(function(u){return u[1]})));return[[a,o],[i,s]]}},{key:"getBoundingRegion",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Fo(this,t.z||0)}},{key:"getLocationAtPoint",value:function(t){var n=t.lngLat,a=t.pos;return this.getMapCenterByLngLatPosition({lngLat:n,pos:a})}}]),e}();var Jy=6378137*Math.PI;function Ll(e){var r=it(e);return r[0]=(r[0]/256-1)*Jy,r[1]=(r[1]/256-1)*Jy,r}function qy(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Lo(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?qy(Object(t),!0).forEach(function(n){(0,li.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):qy(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function WO(e){var r=JO();return function(){var n=(0,Do.default)(e),a;if(r){var i=(0,Do.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,$y.default)(this,a)}}function JO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qO={id:"imagery-layer",data:"",serviceType:"auto",srs:"auto",layers:{type:"array",compare:!0,value:[]},onMetadataLoad:{type:"function",value:function(){}},onMetadataLoadError:{type:"function",value:console.error},onImageLoadStart:{type:"function",value:function(){}},onImageLoad:{type:"function",value:function(){}},onImageLoadError:{type:"function",compare:!1,value:function(r,t){return console.error(t,r)}}},Go=function(e){(0,Zy.default)(t,e);var r=WO(t);function t(){var n;(0,Xy.default)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=r.call.apply(r,[this].concat(i)),(0,li.default)((0,Ky.default)(n),"state",void 0),n}return(0,Yy.default)(t,[{key:"isLoaded",get:function(){return Boolean(this.state)&&this.state.loadCounter===0&&(0,Qy.default)((0,Do.default)(t.prototype),"isLoaded",this)}},{key:"shouldUpdateState",value:function(){return!0}},{key:"initializeState",value:function(){this.state._nextRequestId=0,this.state.lastRequestId=-1,this.state.loadCounter=0}},{key:"updateState",value:function(a){var i=this,o=a.changeFlags,s=a.props,u=a.oldProps,f=this.context.viewport;o.dataChanged||s.serviceType!==u.serviceType?(this.state.imageSource=this._createImageSource(s),this._loadMetadata(),this.debounce(function(){return i.loadImage(f,"image source changed")},0)):(0,hn._deepEqual)(s.layers,u.layers,1)?o.viewportChanged&&this.debounce(function(){return i.loadImage(f,"viewport changed")}):this.debounce(function(){return i.loadImage(f,"layers changed")},0)}},{key:"finalizeState",value:function(){}},{key:"renderLayers",value:function(){var a=this.state,i=a.bounds,o=a.image,s=a.lastRequestParameters;return o&&new e0.BitmapLayer(Lo(Lo({},this.getSubLayerProps({id:"bitmap"})),{},{_imageCoordinateSystem:s.srs==="EPSG:4326"?hn.COORDINATE_SYSTEM.LNGLAT:hn.COORDINATE_SYSTEM.CARTESIAN,bounds:i,image:o}))}},{key:"getFeatureInfoText",value:function(){var n=(0,ko.default)(cn.default.mark(function i(o,s){var u,f,l,c;return cn.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(u=this.state.lastRequestParameters,!u){d.next=6;break}return d.next=4,(f=(l=this.state.imageSource).getFeatureInfoText)===null||f===void 0?void 0:f.call(l,Lo(Lo({},u),{},{query_layers:u.layers,x:o,y:s,info_format:"application/vnd.ogc.gml"}));case 4:return c=d.sent,d.abrupt("return",c);case 6:return d.abrupt("return","");case 7:case"end":return d.stop()}},i,this)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"_createImageSource",value:function(a){if(a.data instanceof tr)return a.data;if(typeof a.data=="string")return dl({url:a.data,loadOptions:a.loadOptions,type:a.serviceType});throw new Error("invalid image source in props.data")}},{key:"_loadMetadata",value:function(){var n=(0,ko.default)(cn.default.mark(function i(){var o,s,u,f;return cn.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=this.state.imageSource,c.prev=1,this.state.loadCounter++,c.next=5,o.getMetadata();case 5:s=c.sent,this.state.imageSource===o&&((u=this.getCurrentLayer())===null||u===void 0||u.props.onMetadataLoad(s)),c.next=12;break;case 9:c.prev=9,c.t0=c.catch(1),(f=this.getCurrentLayer())===null||f===void 0||f.props.onMetadataLoadError(c.t0);case 12:return c.prev=12,this.state.loadCounter--,c.finish(12);case 15:case"end":return c.stop()}},i,this,[[1,9,12,15]])}));function a(){return n.apply(this,arguments)}return a}()},{key:"loadImage",value:function(){var n=(0,ko.default)(cn.default.mark(function i(o,s){var u,f,l,c,h,d,p,v,g,y,b,E,T,S,I,L,B,C,_,R;return cn.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(u=this.props,f=u.layers,l=u.serviceType,!(l==="wms"&&f.length===0)){k.next=3;break}return k.abrupt("return");case 3:return c=o.getBounds(),h=o.width,d=o.height,p=this.getRequestId(),v=this.props.srs,v==="auto"&&(v=o.resolution?"EPSG:4326":"EPSG:3857"),g={width:h,height:d,bbox:c,layers:f,srs:v},v==="EPSG:3857"&&(y=Ll([c[0],c[1]]),b=(0,kl.default)(y,2),E=b[0],T=b[1],S=Ll([c[2],c[3]]),I=(0,kl.default)(S,2),L=I[0],B=I[1],g.bbox=[E,T,L,B]),k.prev=10,this.state.loadCounter++,this.props.onImageLoadStart(p),k.next=15,this.state.imageSource.getImage(g);case 15:C=k.sent,this.state.lastRequestId<p&&((_=this.getCurrentLayer())===null||_===void 0||_.props.onImageLoad(p),this.setState({image:C,bounds:c,lastRequestParameters:g,lastRequestId:p})),k.next=23;break;case 19:k.prev=19,k.t0=k.catch(10),this.raiseError(k.t0,"Load image"),(R=this.getCurrentLayer())===null||R===void 0||R.props.onImageLoadError(p,k.t0);case 23:return k.prev=23,this.state.loadCounter--,k.finish(23);case 26:case"end":return k.stop()}},i,this,[[10,19,23,26]])}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"getRequestId",value:function(){return this.state._nextRequestId++}},{key:"debounce",value:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:500;clearTimeout(this.state._timeoutId),this.state._timeoutId=setTimeout(function(){return a()},i)}}]),t}(hn.CompositeLayer);(0,li.default)(Go,"layerName","WMSLayer");(0,li.default)(Go,"defaultProps",qO);var t0=m(H()),r0=m(Te()),n0=m(xe()),Dl=m(Ae()),Gl=m(W()),a0=m(Pt());function XO(e){var r=YO();return function(){var n=(0,Dl.default)(e),a;if(r){var i=(0,Dl.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,n0.default)(this,a)}}function YO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var KO={getHeight:{type:"accessor",value:0},greatCircle:!0},No=function(e){(0,r0.default)(t,e);var r=XO(t);function t(){return(0,t0.default)(this,t),r.apply(this,arguments)}return t}(a0.ArcLayer);(0,Gl.default)(No,"layerName","GreatCircleLayer");(0,Gl.default)(No,"defaultProps",KO);var T0=m(H()),x0=m(z()),E0=m(Te()),S0=m(xe()),Vl=m(Ae()),zl=m(W());var o0=m(H()),s0=m(z()),u0=m(Te()),f0=m(xe()),Nl=m(Ae()),Uo=m(W()),l0=m(Rt()),Ul=m(Pt());function QO(e){var r=ZO();return function(){var n=(0,Nl.default)(e),a;if(r){var i=(0,Nl.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,f0.default)(this,a)}}function ZO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function i0(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function $O(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?i0(Object(t),!0).forEach(function(n){(0,Uo.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i0(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var eI=$O({},Ul.PolygonLayer.defaultProps),Ct=function(e){(0,u0.default)(t,e);var r=QO(t);function t(){return(0,o0.default)(this,t),r.apply(this,arguments)}return(0,s0.default)(t,[{key:"indexToBounds",value:function(){return null}},{key:"renderLayers",value:function(){var a=this.props,i=a.elevationScale,o=a.extruded,s=a.wireframe,u=a.filled,f=a.stroked,l=a.lineWidthUnits,c=a.lineWidthScale,h=a.lineWidthMinPixels,d=a.lineWidthMaxPixels,p=a.lineJointRounded,v=a.lineMiterLimit,g=a.lineDashJustified,y=a.getElevation,b=a.getFillColor,E=a.getLineColor,T=a.getLineWidth,S=this.props,I=S.updateTriggers,L=S.material,B=S.transitions,C=this.getSubLayerClass("cell",Ul.PolygonLayer);return new C({filled:u,wireframe:s,extruded:o,elevationScale:i,stroked:f,lineWidthUnits:l,lineWidthScale:c,lineWidthMinPixels:h,lineWidthMaxPixels:d,lineJointRounded:p,lineMiterLimit:v,lineDashJustified:g,material:L,transitions:B,getElevation:y,getFillColor:b,getLineColor:E,getLineWidth:T},this.getSubLayerProps({id:"cell",updateTriggers:I&&{getElevation:I.getElevation,getFillColor:I.getFillColor,getLineColor:I.getLineColor,getLineWidth:I.getLineWidth}}),this.indexToBounds())}}]),t}(l0.CompositeLayer);(0,Uo.default)(Ct,"layerName","GeoCellLayer");(0,Uo.default)(Ct,"defaultProps",eI);var Hl=m(ce()),jo=m(jl()),tI=3,rI=30,nI=2*rI+1,h0=180/Math.PI;function p0(e,r,t){var n=1<<r;return[(e[0]+t[0])/n,(e[1]+t[1])/n]}function d0(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function m0(e){return[d0(e[0]),d0(e[1])]}function v0(e,r){var t=(0,Hl.default)(r,2),n=t[0],a=t[1];switch(e){case 0:return[1,n,a];case 1:return[-n,1,a];case 2:return[-n,-a,1];case 3:return[-1,-a,-n];case 4:return[a,-1,-n];case 5:return[a,n,-1];default:throw new Error("Invalid face")}}function g0(e){var r=(0,Hl.default)(e,3),t=r[0],n=r[1],a=r[2],i=Math.atan2(a,Math.sqrt(t*t+n*n)),o=Math.atan2(n,t);return[o*h0,i*h0]}function y0(e){for(var r=jo.default.fromString(e,!0,10).toString(2);r.length<tI+nI;)r="0"+r;for(var t=r.lastIndexOf("1"),n=r.substring(0,3),a=r.substring(3,t),i=a.length/2,o=jo.default.fromString(n,!0,2).toString(10),s=jo.default.fromString(a,!0,2).toString(4);s.length<i;)s="0"+s;return"".concat(o,"/").concat(s)}function aI(e,r,t,n){if(n===0){t===1&&(r[0]=e-1-r[0],r[1]=e-1-r[1]);var a=r[0];r[0]=r[1],r[1]=a}}function A0(e){for(var r=e.split("/"),t=parseInt(r[0],10),n=r[1],a=n.length,i=[0,0],o,s=a-1;s>=0;s--){o=a-s;var u=n[s],f=0,l=0;u==="1"?l=1:u==="2"?(f=1,l=1):u==="3"&&(f=1);var c=Math.pow(2,o-1);aI(c,i,f,l),i[0]+=c*f,i[1]+=c*l}if(t%2===1){var h=i[0];i[0]=i[1],i[1]=h}return{face:t,ij:i,level:o}}var _0=m(jl());function iI(e){var r=e.padEnd(16,"0");return _0.default.fromString(r,16)}var oI=100;function sI(e){for(var r=e.face,t=e.ij,n=e.level,a=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(oI*Math.pow(2,-n))),o=new Float64Array(4*i*2+2),s=0,u=0,f=0;f<4;f++)for(var l=a[f].slice(0),c=a[f+1],h=(c[0]-l[0])/i,d=(c[1]-l[1])/i,p=0;p<i;p++){l[0]+=h,l[1]+=d;var v=p0(t,n,l),g=m0(v),y=v0(r,g),b=g0(y);Math.abs(b[1])>89.999&&(b[0]=u);var E=b[0]-u;b[0]+=E>180?-360:E<-180?360:0,o[s++]=b[0],o[s++]=b[1],u=b[0]}return o[s++]=o[0],o[s++]=o[1],o}function uI(e){if(typeof e=="string"){if(e.indexOf("/")>0)return e;e=iI(e)}return y0(e.toString())}function b0(e){var r=uI(e),t=A0(r);return sI(t)}function fI(e){var r=lI();return function(){var n=(0,Vl.default)(e),a;if(r){var i=(0,Vl.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,S0.default)(this,a)}}function lI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var cI={getS2Token:{type:"accessor",value:function(r){return r.token}}},Ho=function(e){(0,E0.default)(t,e);var r=fI(t);function t(){return(0,T0.default)(this,t),r.apply(this,arguments)}return(0,x0.default)(t,[{key:"indexToBounds",value:function(){var a=this.props,i=a.data,o=a.getS2Token;return{data:i,_normalize:!1,positionFormat:"XY",getPolygon:function(u,f){return b0(o(u,f))}}}}]),t}(Ct);(0,zl.default)(Ho,"layerName","S2Layer");(0,zl.default)(Ho,"defaultProps",cI);var w0=m(H()),B0=m(z()),M0=m(Te()),O0=m(xe()),Jl=m(Ae()),ql=m(W());var Vo=m(ce());var Wl=512;function hI(e){for(var r=0,t=0,n=1<<e.length,a=n/Wl,i=0;i<e.length;i++){n>>=1;var o=parseInt(e[i]);o%2&&(r|=n),o>1&&(t|=n)}return[[r/a,Wl-t/a],[(r+.99)/a,Wl-(t+.99)/a]]}function C0(e){var r=hI(e),t=(0,Vo.default)(r,2),n=t[0],a=t[1],i=dt(n),o=(0,Vo.default)(i,2),s=o[0],u=o[1],f=dt(a),l=(0,Vo.default)(f,2),c=l[0],h=l[1];return[c,u,c,h,s,h,s,u,c,u]}function dI(e){var r=pI();return function(){var n=(0,Jl.default)(e),a;if(r){var i=(0,Jl.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,O0.default)(this,a)}}function pI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mI={getQuadkey:{type:"accessor",value:function(r){return r.quadkey}}},zo=function(e){(0,M0.default)(t,e);var r=dI(t);function t(){return(0,w0.default)(this,t),r.apply(this,arguments)}return(0,B0.default)(t,[{key:"indexToBounds",value:function(){var a=this.props,i=a.data,o=a.getQuadkey;return{data:i,_normalize:!1,positionFormat:"XY",getPolygon:function(u,f){return C0(o(u,f))}}}}]),t}(Ct);(0,ql.default)(zo,"layerName","QuadkeyLayer");(0,ql.default)(zo,"defaultProps",mI);var j1=m(H()),H1=m(z()),V1=m(Te()),z1=m(xe()),Oc=m(Ae()),ls=m(W()),cs=m(Rt()),W1=m(Pt());var wc=m(ce()),k1=m(H()),D1=m(z()),De=m(W());function He(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function I0(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ve(e,r,t){return r&&I0(e.prototype,r),t&&I0(e,t),e}function hi(e,r){return hi=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},hi(e,r)}function ze(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&hi(e,r)}function dn(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?dn=function(t){return typeof t}:dn=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dn(e)}function Xl(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function We(e,r){if(r&&(dn(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xl(e)}function ve(e){return ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ve(e)}function ue(e,r){if(!e)throw new Error("math.gl assertion ".concat(r))}var vI=1/Math.PI*180,gI=1/180*Math.PI,be={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function Yl(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.precision,n=t===void 0?be.precision:t;return e=yI(e),"".concat(parseFloat(e.toPrecision(n)))}function ot(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Kl(e){return P0(e)}function Ql(e){return kt(e)}function P0(e,r){return Zl(e,function(t){return t*gI},r)}function kt(e,r){return Zl(e,function(t){return t*vI},r)}function Wo(e,r,t){return Zl(e,function(n){return Math.max(r,Math.min(t,n))})}function wr(e,r,t){return ot(e)?e.map(function(n,a){return wr(n,r[a],t)}):t*r+(1-t)*e}function Je(e,r,t){var n=be.EPSILON;t&&(be.EPSILON=t);try{if(e===r)return!0;if(ot(e)&&ot(r)){if(e.length!==r.length)return!1;for(var a=0;a<e.length;++a)if(!Je(e[a],r[a]))return!1;return!0}return e&&e.equals?e.equals(r):r&&r.equals?r.equals(e):typeof e=="number"&&typeof r=="number"?Math.abs(e-r)<=be.EPSILON*Math.max(1,Math.abs(e),Math.abs(r)):!1}finally{be.EPSILON=n}}function yI(e){return Math.round(e/be.EPSILON)*be.EPSILON}function AI(e){return e.clone?e.clone():new Array(e.length)}function Zl(e,r,t){if(ot(e)){var n=e;t=t||AI(n);for(var a=0;a<t.length&&a<n.length;++a)t[a]=r(e[a],a,t);return t}return r(e)}function _I(e){var r=bI();return function(){var n=ve(e),a;if(r){var i=ve(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return We(this,a)}}function bI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function TI(e){function r(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return r.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e,r}var sa=function(e){ze(t,e);var r=_I(t);function t(){return He(this,t),r.apply(this,arguments)}return Ve(t,[{key:"clone",value:function(){return new this.constructor().copy(this)}},{key:"fromArray",value:function(a){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=0;o<this.ELEMENTS;++o)this[o]=a[o+i];return this.check()}},{key:"toArray",value:function(){for(var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=0;o<this.ELEMENTS;++o)a[i+o]=this[o];return a}},{key:"from",value:function(a){return Array.isArray(a)?this.copy(a):this.fromObject(a)}},{key:"to",value:function(a){return a===this?this:ot(a)?this.toArray(a):this.toObject(a)}},{key:"toTarget",value:function(a){return a?this.to(a):this}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(be)}},{key:"formatString",value:function(a){for(var i="",o=0;o<this.ELEMENTS;++o)i+=(o>0?", ":"")+Yl(this[o],a);return"".concat(a.printTypes?this.constructor.name:"","[").concat(i,"]")}},{key:"equals",value:function(a){if(!a||this.length!==a.length)return!1;for(var i=0;i<this.ELEMENTS;++i)if(!Je(this[i],a[i]))return!1;return!0}},{key:"exactEquals",value:function(a){if(!a||this.length!==a.length)return!1;for(var i=0;i<this.ELEMENTS;++i)if(this[i]!==a[i])return!1;return!0}},{key:"negate",value:function(){for(var a=0;a<this.ELEMENTS;++a)this[a]=-this[a];return this.check()}},{key:"lerp",value:function(a,i,o){if(o===void 0)return this.lerp(this,a,i);for(var s=0;s<this.ELEMENTS;++s){var u=a[s];this[s]=u+o*(i[s]-u)}return this.check()}},{key:"min",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]=Math.min(a[i],this[i]);return this.check()}},{key:"max",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]=Math.max(a[i],this[i]);return this.check()}},{key:"clamp",value:function(a,i){for(var o=0;o<this.ELEMENTS;++o)this[o]=Math.min(Math.max(this[o],a[o]),i[o]);return this.check()}},{key:"add",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],l=0;l<this.ELEMENTS;++l)this[l]+=f[l];return this.check()}},{key:"subtract",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],l=0;l<this.ELEMENTS;++l)this[l]-=f[l];return this.check()}},{key:"scale",value:function(a){if(typeof a=="number")for(var i=0;i<this.ELEMENTS;++i)this[i]*=a;else for(var o=0;o<this.ELEMENTS&&o<a.length;++o)this[o]*=a[o];return this.check()}},{key:"multiplyByScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]*=a;return this.check()}},{key:"check",value:function(){if(be.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var a=this.length===this.ELEMENTS,i=0;i<this.ELEMENTS;++i)a=a&&Number.isFinite(this[i]);return a}},{key:"sub",value:function(a){return this.subtract(a)}},{key:"setScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]=a;return this.check()}},{key:"addScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]+=a;return this.check()}},{key:"subScalar",value:function(a){return this.addScalar(-a)}},{key:"multiplyScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]*=a;return this.check()}},{key:"divideScalar",value:function(a){return this.multiplyByScalar(1/a)}},{key:"clampScalar",value:function(a,i){for(var o=0;o<this.ELEMENTS;++o)this[o]=Math.min(Math.max(this[o],a),i);return this.check()}},{key:"elements",get:function(){return this}}]),t}(TI(Array));function xI(e,r){if(e.length!==r)return!1;for(var t=0;t<e.length;++t)if(!Number.isFinite(e[t]))return!1;return!0}function ie(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function Br(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(be.debug&&!xI(e,r))throw new Error("math.gl: ".concat(t," some fields set to invalid numbers'"));return e}function EI(e){var r=SI();return function(){var n=ve(e),a;if(r){var i=ve(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return We(this,a)}}function SI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ua=function(e){ze(t,e);var r=EI(t);function t(){return He(this,t),r.apply(this,arguments)}return Ve(t,[{key:"x",get:function(){return this[0]},set:function(a){this[0]=ie(a)}},{key:"y",get:function(){return this[1]},set:function(a){this[1]=ie(a)}},{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var a=0,i=0;i<this.ELEMENTS;++i)a+=this[i]*this[i];return a}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(a){return Math.sqrt(this.distanceSquared(a))}},{key:"distanceSquared",value:function(a){for(var i=0,o=0;o<this.ELEMENTS;++o){var s=this[o]-a[o];i+=s*s}return ie(i)}},{key:"dot",value:function(a){for(var i=0,o=0;o<this.ELEMENTS;++o)i+=this[o]*a[o];return ie(i)}},{key:"normalize",value:function(){var a=this.magnitude();if(a!==0)for(var i=0;i<this.ELEMENTS;++i)this[i]/=a;return this.check()}},{key:"multiply",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],l=0;l<this.ELEMENTS;++l)this[l]*=f[l];return this.check()}},{key:"divide",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],l=0;l<this.ELEMENTS;++l)this[l]/=f[l];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(a){return this.distance(a)}},{key:"distanceToSquared",value:function(a){return this.distanceSquared(a)}},{key:"getComponent",value:function(a){return ue(a>=0&&a<this.ELEMENTS,"index is out of range"),ie(this[a])}},{key:"setComponent",value:function(a,i){return ue(a>=0&&a<this.ELEMENTS,"index is out of range"),this[a]=i,this.check()}},{key:"addVectors",value:function(a,i){return this.copy(a).add(i)}},{key:"subVectors",value:function(a,i){return this.copy(a).subtract(i)}},{key:"multiplyVectors",value:function(a,i){return this.copy(a).multiply(i)}},{key:"addScaledVector",value:function(a,i){return this.add(new this.constructor(a).multiplyScalar(i))}}]),t}(sa);function Jo(e,r,t){var n=r[0],a=r[1],i=t[3]*n+t[7]*a||1;return e[0]=(t[0]*n+t[4]*a)/i,e[1]=(t[1]*n+t[5]*a)/i,e}function qo(e,r,t){var n=r[0],a=r[1],i=r[2],o=t[3]*n+t[7]*a+t[11]*i||1;return e[0]=(t[0]*n+t[4]*a+t[8]*i)/o,e[1]=(t[1]*n+t[5]*a+t[9]*i)/o,e[2]=(t[2]*n+t[6]*a+t[10]*i)/o,e}function R0(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a,e[1]=t[1]*n+t[3]*a,e[2]=r[2],e}function F0(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a,e[1]=t[1]*n+t[3]*a,e[2]=r[2],e[3]=r[3],e}function Xo(e,r,t){var n=r[0],a=r[1],i=r[2];return e[0]=t[0]*n+t[3]*a+t[6]*i,e[1]=t[1]*n+t[4]*a+t[7]*i,e[2]=t[2]*n+t[5]*a+t[8]*i,e[3]=r[3],e}function CI(e){var r=wI();return function(){var n=ve(e),a;if(r){var i=ve(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return We(this,a)}}function wI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var pn=function(e){ze(t,e);var r=CI(t);function t(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return He(this,t),n=r.call(this,2),ot(a)&&arguments.length===1?n.copy(a):(be.debug&&(ie(a),ie(i)),n[0]=a,n[1]=i),n}return Ve(t,[{key:"set",value:function(a,i){return this[0]=a,this[1]=i,this.check()}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this.check()}},{key:"fromObject",value:function(a){return be.debug&&(ie(a.x),ie(a.y)),this[0]=a.x,this[1]=a.y,this.check()}},{key:"toObject",value:function(a){return a.x=this[0],a.y=this[1],a}},{key:"ELEMENTS",get:function(){return 2}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"transform",value:function(a){return this.transformAsPoint(a)}},{key:"transformAsPoint",value:function(a){return wo(this,this,a),this.check()}},{key:"transformAsVector",value:function(a){return Jo(this,this,a),this.check()}},{key:"transformByMatrix3",value:function(a){return Co(this,this,a),this.check()}},{key:"transformByMatrix2x3",value:function(a){return Oy(this,this,a),this.check()}},{key:"transformByMatrix2",value:function(a){return My(this,this,a),this.check()}}]),t}(ua);function BI(e){var r=MI();return function(){var n=ve(e),a;if(r){var i=ve(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return We(this,a)}}function MI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var $l=[0,0,0],Yo,w=function(e){ze(t,e);var r=BI(t);function t(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return He(this,t),n=r.call(this,-0,-0,-0),arguments.length===1&&ot(a)?n.copy(a):(be.debug&&(ie(a),ie(i),ie(o)),n[0]=a,n[1]=i,n[2]=o),n}return Ve(t,[{key:"set",value:function(a,i,o){return this[0]=a,this[1]=i,this[2]=o,this.check()}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this.check()}},{key:"fromObject",value:function(a){return be.debug&&(ie(a.x),ie(a.y),ie(a.z)),this[0]=a.x,this[1]=a.y,this[2]=a.z,this.check()}},{key:"toObject",value:function(a){return a.x=this[0],a.y=this[1],a.z=this[2],a}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(a){this[2]=ie(a)}},{key:"angle",value:function(a){return Dy(this,a)}},{key:"cross",value:function(a){return na(this,this,a),this.check()}},{key:"rotateX",value:function(a){var i=a.radians,o=a.origin,s=o===void 0?$l:o;return Fy(this,this,s,i),this.check()}},{key:"rotateY",value:function(a){var i=a.radians,o=a.origin,s=o===void 0?$l:o;return Ly(this,this,s,i),this.check()}},{key:"rotateZ",value:function(a){var i=a.radians,o=a.origin,s=o===void 0?$l:o;return ky(this,this,s,i),this.check()}},{key:"transform",value:function(a){return this.transformAsPoint(a)}},{key:"transformAsPoint",value:function(a){return aa(this,this,a),this.check()}},{key:"transformAsVector",value:function(a){return qo(this,this,a),this.check()}},{key:"transformByMatrix3",value:function(a){return Bo(this,this,a),this.check()}},{key:"transformByMatrix2",value:function(a){return R0(this,this,a),this.check()}},{key:"transformByQuaternion",value:function(a){return Mo(this,this,a),this.check()}}],[{key:"ZERO",get:function(){return Yo||(Yo=new t(0,0,0),Object.freeze(Yo)),Yo}}]),t}(ua);function OI(e){var r=II();return function(){var n=ve(e),a;if(r){var i=ve(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return We(this,a)}}function II(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ko,L0=function(e){ze(t,e);var r=OI(t);function t(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return He(this,t),n=r.call(this,-0,-0,-0,-0),ot(a)&&arguments.length===1?n.copy(a):(be.debug&&(ie(a),ie(i),ie(o),ie(s)),n[0]=a,n[1]=i,n[2]=o,n[3]=s),n}return Ve(t,[{key:"set",value:function(a,i,o,s){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this.check()}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this.check()}},{key:"fromObject",value:function(a){return be.debug&&(ie(a.x),ie(a.y),ie(a.z),ie(a.w)),this[0]=a.x,this[1]=a.y,this[2]=a.z,this[3]=a.w,this}},{key:"toObject",value:function(a){return a.x=this[0],a.y=this[1],a.z=this[2],a.w=this[3],a}},{key:"ELEMENTS",get:function(){return 4}},{key:"z",get:function(){return this[2]},set:function(a){this[2]=ie(a)}},{key:"w",get:function(){return this[3]},set:function(a){this[3]=ie(a)}},{key:"transform",value:function(a){return aa(this,this,a),this.check()}},{key:"transformByMatrix3",value:function(a){return Xo(this,this,a),this.check()}},{key:"transformByMatrix2",value:function(a){return F0(this,this,a),this.check()}},{key:"transformByQuaternion",value:function(a){return Mo(this,this,a),this.check()}},{key:"applyMatrix4",value:function(a){return a.transform(this,this),this}}],[{key:"ZERO",get:function(){return Ko||(Ko=new t(0,0,0,0),Object.freeze(Ko)),Ko}}]),t}(ua);function PI(e){var r=RI();return function(){var n=ve(e),a;if(r){var i=ve(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return We(this,a)}}function RI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Qo=function(e){ze(t,e);var r=PI(t);function t(){return He(this,t),r.apply(this,arguments)}return Ve(t,[{key:"toString",value:function(){var a="[";if(be.printRowMajor){a+="row-major:";for(var i=0;i<this.RANK;++i)for(var o=0;o<this.RANK;++o)a+=" ".concat(this[o*this.RANK+i])}else{a+="column-major:";for(var s=0;s<this.ELEMENTS;++s)a+=" ".concat(this[s])}return a+="]",a}},{key:"getElementIndex",value:function(a,i){return i*this.RANK+a}},{key:"getElement",value:function(a,i){return this[i*this.RANK+a]}},{key:"setElement",value:function(a,i,o){return this[i*this.RANK+a]=ie(o),this}},{key:"getColumn",value:function(a){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Array(this.RANK).fill(-0),o=a*this.RANK,s=0;s<this.RANK;++s)i[s]=this[o+s];return i}},{key:"setColumn",value:function(a,i){for(var o=a*this.RANK,s=0;s<this.RANK;++s)this[o+s]=i[s];return this}}]),t}(sa);function k0(){var e=new Qe(9);return Qe!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function D0(e,r){if(e===r){var t=r[1],n=r[2],a=r[5];e[1]=r[3],e[2]=r[6],e[3]=t,e[5]=r[7],e[6]=n,e[7]=a}else e[0]=r[0],e[1]=r[3],e[2]=r[6],e[3]=r[1],e[4]=r[4],e[5]=r[7],e[6]=r[2],e[7]=r[5],e[8]=r[8];return e}function G0(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=r[4],s=r[5],u=r[6],f=r[7],l=r[8],c=l*o-s*f,h=-l*i+s*u,d=f*i-o*u,p=t*c+n*h+a*d;return p?(p=1/p,e[0]=c*p,e[1]=(-l*n+a*f)*p,e[2]=(s*n-a*o)*p,e[3]=h*p,e[4]=(l*t-a*u)*p,e[5]=(-s*t+a*i)*p,e[6]=d*p,e[7]=(-f*t+n*u)*p,e[8]=(o*t-n*i)*p,e):null}function N0(e){var r=e[0],t=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],u=e[7],f=e[8];return r*(f*i-o*u)+t*(-f*a+o*s)+n*(u*a-i*s)}function ec(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],l=r[7],c=r[8],h=t[0],d=t[1],p=t[2],v=t[3],g=t[4],y=t[5],b=t[6],E=t[7],T=t[8];return e[0]=h*n+d*o+p*f,e[1]=h*a+d*s+p*l,e[2]=h*i+d*u+p*c,e[3]=v*n+g*o+y*f,e[4]=v*a+g*s+y*l,e[5]=v*i+g*u+y*c,e[6]=b*n+E*o+T*f,e[7]=b*a+E*s+T*l,e[8]=b*i+E*u+T*c,e}function U0(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],l=r[7],c=r[8],h=t[0],d=t[1];return e[0]=n,e[1]=a,e[2]=i,e[3]=o,e[4]=s,e[5]=u,e[6]=h*n+d*o+f,e[7]=h*a+d*s+l,e[8]=h*i+d*u+c,e}function j0(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],l=r[7],c=r[8],h=Math.sin(t),d=Math.cos(t);return e[0]=d*n+h*o,e[1]=d*a+h*s,e[2]=d*i+h*u,e[3]=d*o-h*n,e[4]=d*s-h*a,e[5]=d*u-h*i,e[6]=f,e[7]=l,e[8]=c,e}function tc(e,r,t){var n=t[0],a=t[1];return e[0]=n*r[0],e[1]=n*r[1],e[2]=n*r[2],e[3]=a*r[3],e[4]=a*r[4],e[5]=a*r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function H0(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=t+t,s=n+n,u=a+a,f=t*o,l=n*o,c=n*s,h=a*o,d=a*s,p=a*u,v=i*o,g=i*s,y=i*u;return e[0]=1-c-p,e[3]=l-y,e[6]=h+g,e[1]=l+y,e[4]=1-f-p,e[7]=d-v,e[2]=h-g,e[5]=d+v,e[8]=1-f-c,e}function FI(e){var r=LI();return function(){var n=ve(e),a;if(r){var i=ve(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return We(this,a)}}function LI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var rc;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(rc||(rc={}));var kI=Object.freeze([1,0,0,0,1,0,0,0,1]),ye=function(e){ze(t,e);var r=FI(t);function t(n){for(var a,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return He(this,t),a=r.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(n)?a.copy(n):o.length>0?a.copy([n].concat(o)):a.identity(),a}return Ve(t,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return rc}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this[4]=a[4],this[5]=a[5],this[6]=a[6],this[7]=a[7],this[8]=a[8],this.check()}},{key:"identity",value:function(){return this.copy(kI)}},{key:"fromObject",value:function(a){return this.check()}},{key:"fromQuaternion",value:function(a){return H0(this,a),this.check()}},{key:"set",value:function(a,i,o,s,u,f,l,c,h){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this[4]=u,this[5]=f,this[6]=l,this[7]=c,this[8]=h,this.check()}},{key:"setRowMajor",value:function(a,i,o,s,u,f,l,c,h){return this[0]=a,this[1]=s,this[2]=l,this[3]=i,this[4]=u,this[5]=c,this[6]=o,this[7]=f,this[8]=h,this.check()}},{key:"determinant",value:function(){return N0(this)}},{key:"transpose",value:function(){return D0(this,this),this.check()}},{key:"invert",value:function(){return G0(this,this),this.check()}},{key:"multiplyLeft",value:function(a){return ec(this,a,this),this.check()}},{key:"multiplyRight",value:function(a){return ec(this,this,a),this.check()}},{key:"rotate",value:function(a){return j0(this,this,a),this.check()}},{key:"scale",value:function(a){return Array.isArray(a)?tc(this,this,a):tc(this,this,[a,a]),this.check()}},{key:"translate",value:function(a){return U0(this,this,a),this.check()}},{key:"transform",value:function(a,i){var o;switch(a.length){case 2:o=Co(i||[-0,-0],a,this);break;case 3:o=Bo(i||[-0,-0,-0],a,this);break;case 4:o=Xo(i||[-0,-0,-0,-0],a,this);break;default:throw new Error("Illegal vector")}return Br(o,a.length),o}},{key:"transformVector",value:function(a,i){return this.transform(a,i)}},{key:"transformVector2",value:function(a,i){return this.transform(a,i)}},{key:"transformVector3",value:function(a,i){return this.transform(a,i)}}],[{key:"IDENTITY",get:function(){return GI()}},{key:"ZERO",get:function(){return DI()}}]),t}(Qo);var Zo,$o;function DI(){return Zo||(Zo=new ye([0,0,0,0,0,0,0,0,0]),Object.freeze(Zo)),Zo}function GI(){return $o||($o=new ye,Object.freeze($o)),$o}function NI(e){var r=UI();return function(){var n=ve(e),a;if(r){var i=ve(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return We(this,a)}}function UI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ic;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(ic||(ic={}));var jI=45*Math.PI/180,HI=1,nc=.1,ac=500,VI=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),$=function(e){ze(t,e);var r=NI(t);function t(n){var a;return He(this,t),a=r.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(n)?a.copy(n):a.identity(),a}return Ve(t,[{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}},{key:"INDICES",get:function(){return ic}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this[4]=a[4],this[5]=a[5],this[6]=a[6],this[7]=a[7],this[8]=a[8],this[9]=a[9],this[10]=a[10],this[11]=a[11],this[12]=a[12],this[13]=a[13],this[14]=a[14],this[15]=a[15],this.check()}},{key:"set",value:function(a,i,o,s,u,f,l,c,h,d,p,v,g,y,b,E){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this[4]=u,this[5]=f,this[6]=l,this[7]=c,this[8]=h,this[9]=d,this[10]=p,this[11]=v,this[12]=g,this[13]=y,this[14]=b,this[15]=E,this.check()}},{key:"setRowMajor",value:function(a,i,o,s,u,f,l,c,h,d,p,v,g,y,b,E){return this[0]=a,this[1]=u,this[2]=h,this[3]=g,this[4]=i,this[5]=f,this[6]=d,this[7]=y,this[8]=o,this[9]=l,this[10]=p,this[11]=b,this[12]=s,this[13]=c,this[14]=v,this[15]=E,this.check()}},{key:"toRowMajor",value:function(a){return a[0]=this[0],a[1]=this[4],a[2]=this[8],a[3]=this[12],a[4]=this[1],a[5]=this[5],a[6]=this[9],a[7]=this[13],a[8]=this[2],a[9]=this[6],a[10]=this[10],a[11]=this[14],a[12]=this[3],a[13]=this[7],a[14]=this[11],a[15]=this[15],a}},{key:"identity",value:function(){return this.copy(VI)}},{key:"fromObject",value:function(a){return this.check()}},{key:"fromQuaternion",value:function(a){return Ey(this,a),this.check()}},{key:"frustum",value:function(a){var i=a.left,o=a.right,s=a.bottom,u=a.top,f=a.near,l=f===void 0?nc:f,c=a.far,h=c===void 0?ac:c;return h===1/0?JI(this,i,o,s,u,l):Sy(this,i,o,s,u,l,h),this.check()}},{key:"lookAt",value:function(a){var i=a.eye,o=a.center,s=o===void 0?[0,0,0]:o,u=a.up,f=u===void 0?[0,1,0]:u;return wy(this,i,s,f),this.check()}},{key:"ortho",value:function(a){var i=a.left,o=a.right,s=a.bottom,u=a.top,f=a.near,l=f===void 0?nc:f,c=a.far,h=c===void 0?ac:c;return Cy(this,i,o,s,u,l,h),this.check()}},{key:"orthographic",value:function(a){var i=a.fovy,o=i===void 0?jI:i,s=a.aspect,u=s===void 0?HI:s,f=a.focalDistance,l=f===void 0?1:f,c=a.near,h=c===void 0?nc:c,d=a.far,p=d===void 0?ac:d;z0(o);var v=o/2,g=l*Math.tan(v),y=g*u;return this.ortho({left:-y,right:y,bottom:-g,top:g,near:h,far:p})}},{key:"perspective",value:function(a){var i=a.fovy,o=i===void 0?45*Math.PI/180:i,s=a.aspect,u=s===void 0?1:s,f=a.near,l=f===void 0?.1:f,c=a.far,h=c===void 0?500:c;return z0(o),xo(this,o,u,l,h),this.check()}},{key:"determinant",value:function(){return _y(this)}},{key:"getScale",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return a[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),a[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),a[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),a}},{key:"getTranslation",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return a[0]=this[12],a[1]=this[13],a[2]=this[14],a}},{key:"getRotation",value:function(a,i){a=a||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],i=i||[-0,-0,-0];var o=this.getScale(i),s=1/o[0],u=1/o[1],f=1/o[2];return a[0]=this[0]*s,a[1]=this[1]*u,a[2]=this[2]*f,a[3]=0,a[4]=this[4]*s,a[5]=this[5]*u,a[6]=this[6]*f,a[7]=0,a[8]=this[8]*s,a[9]=this[9]*u,a[10]=this[10]*f,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{key:"getRotationMatrix3",value:function(a,i){a=a||[-0,-0,-0,-0,-0,-0,-0,-0,-0],i=i||[-0,-0,-0];var o=this.getScale(i),s=1/o[0],u=1/o[1],f=1/o[2];return a[0]=this[0]*s,a[1]=this[1]*u,a[2]=this[2]*f,a[3]=this[4]*s,a[4]=this[5]*u,a[5]=this[6]*f,a[6]=this[8]*s,a[7]=this[9]*u,a[8]=this[10]*f,a}},{key:"transpose",value:function(){return Ay(this,this),this.check()}},{key:"invert",value:function(){return _o(this,this),this.check()}},{key:"multiplyLeft",value:function(a){return fn(this,a,this),this.check()}},{key:"multiplyRight",value:function(a){return fn(this,this,a),this.check()}},{key:"rotateX",value:function(a){return bo(this,this,a),this.check()}},{key:"rotateY",value:function(a){return Ty(this,this,a),this.check()}},{key:"rotateZ",value:function(a){return To(this,this,a),this.check()}},{key:"rotateXYZ",value:function(a){return this.rotateX(a[0]).rotateY(a[1]).rotateZ(a[2])}},{key:"rotateAxis",value:function(a,i){return by(this,this,a,i),this.check()}},{key:"scale",value:function(a){return ta(this,this,Array.isArray(a)?a:[a,a,a]),this.check()}},{key:"translate",value:function(a){return ln(this,this,a),this.check()}},{key:"transform",value:function(a,i){return a.length===4?(i=yo(i||[-0,-0,-0,-0],a,this),Br(i,4),i):this.transformAsPoint(a,i)}},{key:"transformAsPoint",value:function(a,i){var o=a.length,s;switch(o){case 2:s=wo(i||[-0,-0],a,this);break;case 3:s=aa(i||[-0,-0,-0],a,this);break;default:throw new Error("Illegal vector")}return Br(s,a.length),s}},{key:"transformAsVector",value:function(a,i){var o;switch(a.length){case 2:o=Jo(i||[-0,-0],a,this);break;case 3:o=qo(i||[-0,-0,-0],a,this);break;default:throw new Error("Illegal vector")}return Br(o,a.length),o}},{key:"transformPoint",value:function(a,i){return this.transformAsPoint(a,i)}},{key:"transformVector",value:function(a,i){return this.transformAsPoint(a,i)}},{key:"transformDirection",value:function(a,i){return this.transformAsVector(a,i)}},{key:"makeRotationX",value:function(a){return this.identity().rotateX(a)}},{key:"makeTranslation",value:function(a,i,o){return this.identity().translate([a,i,o])}}],[{key:"IDENTITY",get:function(){return WI()}},{key:"ZERO",get:function(){return zI()}}]),t}(Qo);var es,ts;function zI(){return es||(es=new $([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(es)),es}function WI(){return ts||(ts=new $,Object.freeze(ts)),ts}function z0(e){if(e>Math.PI*2)throw Error("expected radians")}function JI(e,r,t,n,a,i){var o=2*i/(t-r),s=2*i/(a-n),u=(t+r)/(t-r),f=(a+n)/(a-n),l=-1,c=-1,h=-2*i;return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=u,e[9]=f,e[10]=l,e[11]=c,e[12]=0,e[13]=0,e[14]=h,e[15]=0,e}function W0(){var e=new Qe(4);return Qe!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function J0(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function oc(e,r,t){t=t*.5;var n=Math.sin(t);return e[0]=n*r[0],e[1]=n*r[1],e[2]=n*r[2],e[3]=Math.cos(t),e}function sc(e,r,t){var n=r[0],a=r[1],i=r[2],o=r[3],s=t[0],u=t[1],f=t[2],l=t[3];return e[0]=n*l+o*s+a*f-i*u,e[1]=a*l+o*u+i*s-n*f,e[2]=i*l+o*f+n*u-a*s,e[3]=o*l-n*s-a*u-i*f,e}function q0(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],s=Math.sin(t),u=Math.cos(t);return e[0]=n*u+o*s,e[1]=a*u+i*s,e[2]=i*u-a*s,e[3]=o*u-n*s,e}function X0(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],s=Math.sin(t),u=Math.cos(t);return e[0]=n*u-i*s,e[1]=a*u+o*s,e[2]=i*u+n*s,e[3]=o*u-a*s,e}function Y0(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],s=Math.sin(t),u=Math.cos(t);return e[0]=n*u+a*s,e[1]=a*u-n*s,e[2]=i*u+o*s,e[3]=o*u-i*s,e}function K0(e,r){var t=r[0],n=r[1],a=r[2];return e[0]=t,e[1]=n,e[2]=a,e[3]=Math.sqrt(Math.abs(1-t*t-n*n-a*a)),e}function di(e,r,t,n){var a=r[0],i=r[1],o=r[2],s=r[3],u=t[0],f=t[1],l=t[2],c=t[3],h,d,p,v,g;return d=a*u+i*f+o*l+s*c,d<0&&(d=-d,u=-u,f=-f,l=-l,c=-c),1-d>_e?(h=Math.acos(d),p=Math.sin(h),v=Math.sin((1-n)*h)/p,g=Math.sin(n*h)/p):(v=1-n,g=n),e[0]=v*a+g*u,e[1]=v*i+g*f,e[2]=v*o+g*l,e[3]=v*s+g*c,e}function Q0(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],o=t*t+n*n+a*a+i*i,s=o?1/o:0;return e[0]=-t*s,e[1]=-n*s,e[2]=-a*s,e[3]=i*s,e}function Z0(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=r[3],e}function uc(e,r){var t=r[0]+r[4]+r[8],n;if(t>0)n=Math.sqrt(t+1),e[3]=.5*n,n=.5/n,e[0]=(r[5]-r[7])*n,e[1]=(r[6]-r[2])*n,e[2]=(r[1]-r[3])*n;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[a*3+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;n=Math.sqrt(r[a*3+a]-r[i*3+i]-r[o*3+o]+1),e[a]=.5*n,n=.5/n,e[3]=(r[i*3+o]-r[o*3+i])*n,e[i]=(r[i*3+a]+r[a*3+i])*n,e[o]=(r[o*3+a]+r[a*3+o])*n}return e}var $0=hy;var e1=go,t1=vy,r1=gy,n1=dy;var a1=py;var i1=my;var o1=function(){var e=Cl(),r=Bl(1,0,0),t=Bl(0,1,0);return function(n,a,i){var o=ui(a,i);return o<-.999999?(na(e,r,a),Ny(e)<1e-6&&na(e,t,a),Ry(e,e),oc(n,e,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(na(e,a,i),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+o,i1(n,n))}}(),RH=function(){var e=W0(),r=W0();return function(t,n,a,i,o,s){return di(e,n,o,s),di(r,a,i,s),di(t,e,r,2*s*(1-s)),t}}(),FH=function(){var e=k0();return function(r,t,n,a){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-t[0],e[5]=-t[1],e[8]=-t[2],i1(r,uc(r,e))}}();function XI(e){var r=YI();return function(){var n=ve(e),a;if(r){var i=ve(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return We(this,a)}}function YI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var KI=[0,0,0,1],Mr=function(e){ze(t,e);var r=XI(t);function t(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;return He(this,t),n=r.call(this,-0,-0,-0,-0),Array.isArray(a)&&arguments.length===1?n.copy(a):n.set(a,i,o,s),n}return Ve(t,[{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this.check()}},{key:"set",value:function(a,i,o,s){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this.check()}},{key:"fromObject",value:function(a){return this[0]=a.x,this[1]=a.y,this[2]=a.z,this[3]=a.w,this.check()}},{key:"fromMatrix3",value:function(a){return uc(this,a),this.check()}},{key:"fromAxisRotation",value:function(a,i){return oc(this,a,i),this.check()}},{key:"identity",value:function(){return J0(this),this.check()}},{key:"setAxisAngle",value:function(a,i){return this.fromAxisRotation(a,i)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(a){this[0]=ie(a)}},{key:"y",get:function(){return this[1]},set:function(a){this[1]=ie(a)}},{key:"z",get:function(){return this[2]},set:function(a){this[2]=ie(a)}},{key:"w",get:function(){return this[3]},set:function(a){this[3]=ie(a)}},{key:"len",value:function(){return n1(this)}},{key:"lengthSquared",value:function(){return a1(this)}},{key:"dot",value:function(a){return t1(this,a)}},{key:"rotationTo",value:function(a,i){return o1(this,a,i),this.check()}},{key:"add",value:function(a){return $0(this,this,a),this.check()}},{key:"calculateW",value:function(){return K0(this,this),this.check()}},{key:"conjugate",value:function(){return Z0(this,this),this.check()}},{key:"invert",value:function(){return Q0(this,this),this.check()}},{key:"lerp",value:function(a,i,o){return o===void 0?this.lerp(this,a,i):(r1(this,a,i,o),this.check())}},{key:"multiplyRight",value:function(a){return sc(this,this,a),this.check()}},{key:"multiplyLeft",value:function(a){return sc(this,a,this),this.check()}},{key:"normalize",value:function(){var a=this.len(),i=a>0?1/a:0;return this[0]=this[0]*i,this[1]=this[1]*i,this[2]=this[2]*i,this[3]=this[3]*i,a===0&&(this[3]=1),this.check()}},{key:"rotateX",value:function(a){return q0(this,this,a),this.check()}},{key:"rotateY",value:function(a){return X0(this,this,a),this.check()}},{key:"rotateZ",value:function(a){return Y0(this,this,a),this.check()}},{key:"scale",value:function(a){return e1(this,this,a),this.check()}},{key:"slerp",value:function(a,i,o){var s,u,f;switch(arguments.length){case 1:var l=a.start;s=l===void 0?KI:l,u=a.target,f=a.ratio;break;case 2:s=this,u=a,f=i;break;default:s=a,u=i,f=o}return di(this,s,u,f),this.check()}},{key:"transformVector4",value:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new L0;return yy(i,a,this),Br(i,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(a,i){return this.setAxisAngle(a,i)}},{key:"premultiply",value:function(a){return this.multiplyLeft(a)}},{key:"multiply",value:function(a){return this.multiplyRight(a)}}]),t}(sa);var Wt={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2};var s1=m(X()),u1=m(H()),f1=m(z()),Ne=m(W()),fc=m(Y()),pi=function(){function e(r){(0,u1.default)(this,e),(0,Ne.default)(this,"index",void 0),(0,Ne.default)(this,"isVisible",void 0),(0,Ne.default)(this,"isSelected",void 0),(0,Ne.default)(this,"parent",void 0),(0,Ne.default)(this,"children",void 0),(0,Ne.default)(this,"content",void 0),(0,Ne.default)(this,"state",void 0),(0,Ne.default)(this,"layers",void 0),(0,Ne.default)(this,"id",void 0),(0,Ne.default)(this,"zoom",void 0),(0,Ne.default)(this,"userData",void 0),(0,Ne.default)(this,"boundingBox",void 0),(0,Ne.default)(this,"_abortController",void 0),(0,Ne.default)(this,"_loader",void 0),(0,Ne.default)(this,"_loaderId",void 0),(0,Ne.default)(this,"_isLoaded",void 0),(0,Ne.default)(this,"_isCancelled",void 0),(0,Ne.default)(this,"_needsReload",void 0),(0,Ne.default)(this,"_bbox",void 0),this.index=r,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}return(0,f1.default)(e,[{key:"bbox",get:function(){return this._bbox},set:function(t){this._bbox||(this._bbox=t,"west"in t?this.boundingBox=[[t.west,t.south],[t.east,t.north]]:this.boundingBox=[[t.left,t.top],[t.right,t.bottom]])}},{key:"data",get:function(){var t=this;return this.isLoading&&this._loader?this._loader.then(function(){return t.data}):this.content}},{key:"isLoaded",get:function(){return this._isLoaded&&!this._needsReload}},{key:"isLoading",get:function(){return Boolean(this._loader)&&!this._isCancelled}},{key:"needsReload",get:function(){return this._needsReload||this._isCancelled}},{key:"byteLength",get:function(){var t=this.content?this.content.byteLength:0;return Number.isFinite(t)||console.error("byteLength not defined in tile data"),t}},{key:"_loadData",value:function(){var r=(0,s1.default)(fc.default.mark(function n(a){var i,o,s,u,f,l,c,h,d,p,v,g,y,b;return fc.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return i=a.getData,o=a.requestScheduler,s=a.onLoad,u=a.onError,f=this.index,l=this.id,c=this.bbox,h=this.userData,d=this.zoom,p=this._loaderId,this._abortController=new AbortController,v=this._abortController.signal,T.next=7,o.scheduleRequest(this,function(S){return S.isSelected?1:-1});case 7:if(g=T.sent,g){T.next=11;break}return this._isCancelled=!0,T.abrupt("return");case 11:if(!this._isCancelled){T.next=14;break}return g.done(),T.abrupt("return");case 14:return y=null,T.prev=15,T.next=18,i({index:f,id:l,bbox:c,userData:h,zoom:d,signal:v});case 18:y=T.sent,T.next=24;break;case 21:T.prev=21,T.t0=T.catch(15),b=T.t0||!0;case 24:return T.prev=24,g.done(),T.finish(24);case 27:if(p===this._loaderId){T.next=29;break}return T.abrupt("return");case 29:if(this._loader=void 0,this.content=y,!(this._isCancelled&&!y)){T.next=34;break}return this._isLoaded=!1,T.abrupt("return");case 34:this._isLoaded=!0,this._isCancelled=!1,b?u(b,this):s(this);case 37:case"end":return T.stop()}},n,this,[[15,21,24,27]])}));function t(n){return r.apply(this,arguments)}return t}()},{key:"loadData",value:function(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}},{key:"setNeedsReload",value:function(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}},{key:"abort",value:function(){var t;this.isLoaded||(this._isCancelled=!0,(t=this._abortController)===null||t===void 0||t.abort())}}]),e}();var gn=m(ce()),gi=m(St());var _c=m(ce()),x1=m(H()),E1=m(z()),vn=m(W()),vi=m(Rt());var Le={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};function st(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function l1(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ut(e,r,t){return r&&l1(e.prototype,r),t&&l1(e,t),e}function J(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var c1=new w,QI=new w,rs=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=arguments.length>2?arguments[2]:void 0;st(this,e),J(this,"center",void 0),J(this,"halfDiagonal",void 0),J(this,"minimum",void 0),J(this,"maximum",void 0),n=n||c1.copy(r).add(t).scale(.5),this.center=new w(n),this.halfDiagonal=new w(t).subtract(this.center),this.minimum=new w(r),this.maximum=new w(t)}return ut(e,[{key:"clone",value:function(){return new e(this.minimum,this.maximum,this.center)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}},{key:"transform",value:function(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}},{key:"intersectPlane",value:function(t){var n=this.halfDiagonal,a=QI.from(t.normal),i=n.x*Math.abs(a.x)+n.y*Math.abs(a.y)+n.z*Math.abs(a.z),o=this.center.dot(a)+t.distance;return o-i>0?Le.INSIDE:o+i<0?Le.OUTSIDE:Le.INTERSECTING}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var n=c1.from(t).subtract(this.center),a=this.halfDiagonal,i=0,o;return o=Math.abs(n.x)-a.x,o>0&&(i+=o*o),o=Math.abs(n.y)-a.y,o>0&&(i+=o*o),o=Math.abs(n.z)-a.z,o>0&&(i+=o*o),i}}]),e}();var mi=new w,h1=new w,Or=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;st(this,e),J(this,"center",void 0),J(this,"radius",void 0),this.radius=-0,this.center=new w,this.fromCenterRadius(r,t)}return ut(e,[{key:"fromCenterRadius",value:function(t,n){return this.center.from(t),this.radius=n,this}},{key:"fromCornerPoints",value:function(t,n){return n=mi.from(n),this.center=new w().from(t).add(n).scale(.5),this.radius=this.center.distance(n),this}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}},{key:"clone",value:function(){return new e(this.center,this.radius)}},{key:"union",value:function(t){var n=this.center,a=this.radius,i=t.center,o=t.radius,s=mi.copy(i).subtract(n),u=s.magnitude();if(a>=u+o)return this.clone();if(o>=u+a)return t.clone();var f=(a+u+o)*.5;return h1.copy(s).scale((-a+f)/u).add(n),this.center.copy(h1),this.radius=f,this}},{key:"expand",value:function(t){var n=mi.from(t),a=n.subtract(this.center).magnitude();return a>this.radius&&(this.radius=a),this}},{key:"transform",value:function(t){this.center.transform(t);var n=xy(mi,t);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(t){var n=this.distanceTo(t);return n*n}},{key:"distanceTo",value:function(t){var n=mi.from(t),a=n.subtract(this.center);return Math.max(0,a.len()-this.radius)}},{key:"intersectPlane",value:function(t){var n=this.center,a=this.radius,i=t.normal,o=i.dot(n)+t.distance;return o<-a?Le.OUTSIDE:o<a?Le.INTERSECTING:Le.INSIDE}}]),e}();function fa(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function lc(e){if(Array.isArray(e))return fa(e)}function cc(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hc(e,r){if(e){if(typeof e=="string")return fa(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return fa(e,r)}}function dc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ir(e){return lc(e)||cc(e)||hc(e)||dc()}var ZI=new w,$I=new w,ns=new w,as=new w,is=new w,eP=new w,tP=new w,ir={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8},mn=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0,0,0,0,0,0,0];st(this,e),J(this,"center",void 0),J(this,"halfAxes",void 0),this.center=new w().from(r),this.halfAxes=new ye(t)}return ut(e,[{key:"halfSize",get:function(){var t=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),a=this.halfAxes.getColumn(2);return[new w(t).len(),new w(n).len(),new w(a).len()]}},{key:"quaternion",get:function(){var t=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),a=this.halfAxes.getColumn(2),i=new w(t).normalize(),o=new w(n).normalize(),s=new w(a).normalize();return new Mr().fromMatrix3(new ye([].concat(Ir(i),Ir(o),Ir(s))))}},{key:"fromCenterHalfSizeQuaternion",value:function(t,n,a){var i=new Mr(a),o=new ye().fromQuaternion(i);return o[0]=o[0]*n[0],o[1]=o[1]*n[0],o[2]=o[2]*n[0],o[3]=o[3]*n[1],o[4]=o[4]*n[1],o[5]=o[5]*n[1],o[6]=o[6]*n[2],o[7]=o[7]*n[2],o[8]=o[8]*n[2],this.center=new w().from(t),this.halfAxes=o,this}},{key:"clone",value:function(){return new e(this.center,this.halfAxes)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}},{key:"getBoundingSphere",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Or,n=this.halfAxes,a=n.getColumn(0,ns),i=n.getColumn(1,as),o=n.getColumn(2,is),s=ZI.copy(a).add(i).add(o);return t.center.copy(this.center),t.radius=s.magnitude(),t}},{key:"intersectPlane",value:function(t){var n=this.center,a=t.normal,i=this.halfAxes,o=a.x,s=a.y,u=a.z,f=Math.abs(o*i[ir.COLUMN0ROW0]+s*i[ir.COLUMN0ROW1]+u*i[ir.COLUMN0ROW2])+Math.abs(o*i[ir.COLUMN1ROW0]+s*i[ir.COLUMN1ROW1]+u*i[ir.COLUMN1ROW2])+Math.abs(o*i[ir.COLUMN2ROW0]+s*i[ir.COLUMN2ROW1]+u*i[ir.COLUMN2ROW2]),l=a.dot(n)+t.distance;return l<=-f?Le.OUTSIDE:l>=f?Le.INSIDE:Le.INTERSECTING}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var n=$I.from(t).subtract(this.center),a=this.halfAxes,i=a.getColumn(0,ns),o=a.getColumn(1,as),s=a.getColumn(2,is),u=i.magnitude(),f=o.magnitude(),l=s.magnitude();i.normalize(),o.normalize(),s.normalize();var c=0,h;return h=Math.abs(n.dot(i))-u,h>0&&(c+=h*h),h=Math.abs(n.dot(o))-f,h>0&&(c+=h*h),h=Math.abs(n.dot(s))-l,h>0&&(c+=h*h),c}},{key:"computePlaneDistances",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[-0,-0],i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=this.center,u=this.halfAxes,f=u.getColumn(0,ns),l=u.getColumn(1,as),c=u.getColumn(2,is),h=eP.copy(f).add(l).add(c).add(s),d=tP.copy(h).subtract(t),p=n.dot(d);return i=Math.min(p,i),o=Math.max(p,o),h.copy(s).add(f).add(l).subtract(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),h.copy(s).add(f).subtract(l).add(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),h.copy(s).add(f).subtract(l).subtract(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),s.copy(h).subtract(f).add(l).add(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),s.copy(h).subtract(f).add(l).subtract(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),s.copy(h).subtract(f).subtract(l).add(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),s.copy(h).subtract(f).subtract(l).subtract(c),d.copy(h).subtract(t),p=n.dot(d),i=Math.min(p,i),o=Math.max(p,o),a[0]=i,a[1]=o,a}},{key:"transform",value:function(t){this.center.transformAsPoint(t);var n=this.halfAxes.getColumn(0,ns);n.transformAsPoint(t);var a=this.halfAxes.getColumn(1,as);a.transformAsPoint(t);var i=this.halfAxes.getColumn(2,is);return i.transformAsPoint(t),this.halfAxes=new ye([].concat(Ir(n),Ir(a),Ir(i))),this}},{key:"getTransform",value:function(){throw new Error("not implemented")}}]),e}();var d1=new w,p1=new w,ke=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,1],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;st(this,e),J(this,"normal",void 0),J(this,"distance",void 0),this.normal=new w,this.distance=-0,this.fromNormalDistance(r,t)}return ut(e,[{key:"fromNormalDistance",value:function(t,n){return ue(Number.isFinite(n)),this.normal.from(t).normalize(),this.distance=n,this}},{key:"fromPointNormal",value:function(t,n){t=d1.from(t),this.normal.from(n).normalize();var a=-this.normal.dot(t);return this.distance=a,this}},{key:"fromCoefficients",value:function(t,n,a,i){return this.normal.set(t,n,a),ue(Je(this.normal.len(),1)),this.distance=i,this}},{key:"clone",value:function(){return new e(this.normal,this.distance)}},{key:"equals",value:function(t){return Je(this.distance,t.distance)&&Je(this.normal,t.normal)}},{key:"getPointDistance",value:function(t){return this.normal.dot(t)+this.distance}},{key:"transform",value:function(t){var n=p1.copy(this.normal).transformAsVector(t).normalize(),a=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(a,n)}},{key:"projectPointOntoPlane",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];t=d1.from(t);var a=this.getPointDistance(t),i=p1.copy(this.normal).scale(a);return t.subtract(i).to(n)}}]),e}();function m1(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=rP(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function rP(e,r){if(e){if(typeof e=="string")return v1(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return v1(e,r)}}function v1(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var g1=[new w([1,0,0]),new w([0,1,0]),new w([0,0,1])],y1=new w,nP=new w,a5=new ke(new w(1,0,0),0),pt=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];st(this,e),J(this,"planes",void 0),this.planes=r}return ut(e,[{key:"fromBoundingSphere",value:function(t){this.planes.length=2*g1.length;var n=t.center,a=t.radius,i=0,o=m1(g1),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,f=this.planes[i],l=this.planes[i+1];f||(f=this.planes[i]=new ke),l||(l=this.planes[i+1]=new ke);var c=y1.copy(u).scale(-a).add(n),h=-u.dot(c);f.fromPointNormal(c,u);var d=y1.copy(u).scale(a).add(n),p=nP.copy(u).negate(),v=-p.dot(d);l.fromPointNormal(d,p),i+=2}}catch(g){o.e(g)}finally{o.f()}return this}},{key:"computeVisibility",value:function(t){var n=Le.INSIDE,a=m1(this.planes),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.intersectPlane(o);switch(s){case Le.OUTSIDE:return Le.OUTSIDE;case Le.INTERSECTING:n=Le.INTERSECTING;break;default:}}}catch(u){a.e(u)}finally{a.f()}return n}},{key:"computeVisibilityWithPlaneMask",value:function(t,n){if(ue(Number.isFinite(n),"parentPlaneMask is required."),n===e.MASK_OUTSIDE||n===e.MASK_INSIDE)return n;for(var a=e.MASK_INSIDE,i=this.planes,o=0;o<this.planes.length;++o){var s=o<31?1<<o:0;if(!(o<31&&!(n&s))){var u=i[o],f=t.intersectPlane(u);if(f===Le.OUTSIDE)return e.MASK_OUTSIDE;f===Le.INTERSECTING&&(a|=s)}}return a}}]),e}();J(pt,"MASK_OUTSIDE",4294967295);J(pt,"MASK_INSIDE",0);J(pt,"MASK_INDETERMINATE",2147483647);var aP=new w,iP=new w,oP=new w,sP=new w,uP=new w,pc=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};st(this,e),J(this,"left",void 0),J(this,"_left",void 0),J(this,"right",void 0),J(this,"_right",void 0),J(this,"top",void 0),J(this,"_top",void 0),J(this,"bottom",void 0),J(this,"_bottom",void 0),J(this,"near",void 0),J(this,"_near",void 0),J(this,"far",void 0),J(this,"_far",void 0),J(this,"_cullingVolume",new pt([new ke,new ke,new ke,new ke,new ke,new ke])),J(this,"_perspectiveMatrix",new $),J(this,"_infinitePerspective",new $);var t=r.near,n=t===void 0?1:t,a=r.far,i=a===void 0?5e8:a;this.left=r.left,this._left=void 0,this.right=r.right,this._right=void 0,this.top=r.top,this._top=void 0,this.bottom=r.bottom,this._bottom=void 0,this.near=n,this._near=n,this.far=i,this._far=i}return ut(e,[{key:"clone",value:function(){return new e({right:this.right,left:this.left,top:this.top,bottom:this.bottom,near:this.near,far:this.far})}},{key:"equals",value:function(t){return t&&t instanceof e&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far}},{key:"projectionMatrix",get:function(){return this._update(),this._perspectiveMatrix}},{key:"infiniteProjectionMatrix",get:function(){return this._update(),this._infinitePerspective}},{key:"computeCullingVolume",value:function(t,n,a){ue(t,"position is required."),ue(n,"direction is required."),ue(a,"up is required.");var i=this._cullingVolume.planes;a=aP.copy(a).normalize();var o=iP.copy(n).cross(a).normalize(),s=oP.copy(n).multiplyByScalar(this.near).add(t),u=sP.copy(n).multiplyByScalar(this.far).add(t),f=uP;return f.copy(o).multiplyByScalar(this.left).add(s).subtract(t).cross(a),i[0].fromPointNormal(t,f),f.copy(o).multiplyByScalar(this.right).add(s).subtract(t).cross(a).negate(),i[1].fromPointNormal(t,f),f.copy(a).multiplyByScalar(this.bottom).add(s).subtract(t).cross(o).negate(),i[2].fromPointNormal(t,f),f.copy(a).multiplyByScalar(this.top).add(s).subtract(t).cross(o),i[3].fromPointNormal(t,f),f=new w().copy(n),i[4].fromPointNormal(s,f),f.negate(),i[5].fromPointNormal(u,f),this._cullingVolume}},{key:"getPixelDimensions",value:function(t,n,a,i){this._update(),ue(Number.isFinite(t)&&Number.isFinite(n)),ue(t>0),ue(n>0),ue(a>0),ue(i);var o=1/this.near,s=this.top*o,u=2*a*s/n;s=this.right*o;var f=2*a*s/t;return i.x=f,i.y=u,i}},{key:"_update",value:function(){ue(Number.isFinite(this.right)&&Number.isFinite(this.left)&&Number.isFinite(this.top)&&Number.isFinite(this.bottom)&&Number.isFinite(this.near)&&Number.isFinite(this.far));var t=this.top,n=this.bottom,a=this.right,i=this.left,o=this.near,s=this.far;(t!==this._top||n!==this._bottom||i!==this._left||a!==this._right||o!==this._near||s!==this._far)&&(ue(this.near>0&&this.near<this.far,"near must be greater than zero and less than far."),this._left=i,this._right=a,this._top=t,this._bottom=n,this._near=o,this._far=s,this._perspectiveMatrix=new $().frustum({left:i,right:a,bottom:n,top:t,near:o,far:s}),this._infinitePerspective=new $().frustum({left:i,right:a,bottom:n,top:t,near:o,far:1/0}))}}]),e}();var fP=function(r){return r!==null&&typeof r<"u"},lP=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};st(this,e),J(this,"_offCenterFrustum",new pc),J(this,"fov",void 0),J(this,"_fov",void 0),J(this,"_fovy",void 0),J(this,"_sseDenominator",void 0),J(this,"aspectRatio",void 0),J(this,"_aspectRatio",void 0),J(this,"near",void 0),J(this,"_near",void 0),J(this,"far",void 0),J(this,"_far",void 0),J(this,"xOffset",void 0),J(this,"_xOffset",void 0),J(this,"yOffset",void 0),J(this,"_yOffset",void 0);var t=r.fov,n=r.aspectRatio,a=r.near,i=a===void 0?1:a,o=r.far,s=o===void 0?5e8:o,u=r.xOffset,f=u===void 0?0:u,l=r.yOffset,c=l===void 0?0:l;this.fov=t,this.aspectRatio=n,this.near=i,this.far=s,this.xOffset=f,this.yOffset=c}return ut(e,[{key:"clone",value:function(){return new e({aspectRatio:this.aspectRatio,fov:this.fov,near:this.near,far:this.far})}},{key:"equals",value:function(t){return!fP(t)||!(t instanceof e)?!1:(this._update(),t._update(),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this.near===t.near&&this.far===t.far&&this._offCenterFrustum.equals(t._offCenterFrustum))}},{key:"projectionMatrix",get:function(){return this._update(),this._offCenterFrustum.projectionMatrix}},{key:"infiniteProjectionMatrix",get:function(){return this._update(),this._offCenterFrustum.infiniteProjectionMatrix}},{key:"fovy",get:function(){return this._update(),this._fovy}},{key:"sseDenominator",get:function(){return this._update(),this._sseDenominator}},{key:"computeCullingVolume",value:function(t,n,a){return this._update(),this._offCenterFrustum.computeCullingVolume(t,n,a)}},{key:"getPixelDimensions",value:function(t,n,a,i){return this._update(),this._offCenterFrustum.getPixelDimensions(t,n,a,i||new pn)}},{key:"_update",value:function(){ue(Number.isFinite(this.fov)&&Number.isFinite(this.aspectRatio)&&Number.isFinite(this.near)&&Number.isFinite(this.far));var t=this._offCenterFrustum;(this.fov!==this._fov||this.aspectRatio!==this._aspectRatio||this.near!==this._near||this.far!==this._far||this.xOffset!==this._xOffset||this.yOffset!==this._yOffset)&&(ue(this.fov>=0&&this.fov<Math.PI),ue(this.aspectRatio>0),ue(this.near>=0&&this.near<this.far),this._aspectRatio=this.aspectRatio,this._fov=this.fov,this._fovy=this.aspectRatio<=1?this.fov:Math.atan(Math.tan(this.fov*.5)/this.aspectRatio)*2,this._near=this.near,this._far=this.far,this._sseDenominator=2*Math.tan(.5*this._fovy),this._xOffset=this.xOffset,this._yOffset=this.yOffset,t.top=this.near*Math.tan(.5*this._fovy),t.bottom=-t.top,t.right=this.aspectRatio*t.top,t.left=-t.right,t.near=this.near,t.far=this.far,t.right+=this.xOffset,t.left+=this.xOffset,t.top+=this.yOffset,t.bottom+=this.yOffset)}}]),e}();var b5=new w,T5=new w,x5=new w,E5=new w,S5=new w,C5=new w,w5=new w,B5=new w,M5=new w,O5=new w,I5=new w,P5=new w,R5=4/3*Math.PI;var Jt=new ye,cP=new ye,hP=new ye,os=new ye,A1=new ye;function ss(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=Wt.EPSILON20,n=10,a=0,i=0,o=cP,s=hP;o.identity(),s.copy(e);for(var u=t*dP(s);i<n&&pP(s)>u;)mP(s,os),A1.copy(os).transpose(),s.multiplyRight(os),s.multiplyLeft(A1),o.multiplyRight(os),++a>2&&(++i,a=0);return r.unitary=o.toTarget(r.unitary),r.diagonal=s.toTarget(r.diagonal),r}function dP(e){for(var r=0,t=0;t<9;++t){var n=e[t];r+=n*n}return Math.sqrt(r)}var mc=[1,0,0],vc=[2,2,1];function pP(e){for(var r=0,t=0;t<3;++t){var n=e[Jt.getElementIndex(vc[t],mc[t])];r+=2*n*n}return Math.sqrt(r)}function mP(e,r){for(var t=Wt.EPSILON15,n=0,a=1,i=0;i<3;++i){var o=Math.abs(e[Jt.getElementIndex(vc[i],mc[i])]);o>n&&(a=i,n=o)}var s=mc[a],u=vc[a],f=1,l=0;if(Math.abs(e[Jt.getElementIndex(u,s)])>t){var c=e[Jt.getElementIndex(u,u)],h=e[Jt.getElementIndex(s,s)],d=e[Jt.getElementIndex(u,s)],p=(c-h)/2/d,v;p<0?v=-1/(-p+Math.sqrt(1+p*p)):v=1/(p+Math.sqrt(1+p*p)),f=1/Math.sqrt(1+v*v),l=v*f}return ye.IDENTITY.to(r),r[Jt.getElementIndex(s,s)]=r[Jt.getElementIndex(u,u)]=f,r[Jt.getElementIndex(u,s)]=l,r[Jt.getElementIndex(s,u)]=-l,r}function gc(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=vP(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function vP(e,r){if(e){if(typeof e=="string")return _1(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _1(e,r)}}function _1(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Pr=new w,gP=new w,yP=new w,AP=new w,_P=new w,bP=new ye,TP={diagonal:new ye,unitary:new ye};function yc(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new mn;if(!e||e.length===0)return r.halfAxes=new ye([0,0,0,0,0,0,0,0,0]),r.center=new w,r;var t=e.length,n=new w(0,0,0),a=gc(e),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;n.add(o)}}catch(j){a.e(j)}finally{a.f()}var s=1/t;n.multiplyByScalar(s);var u=0,f=0,l=0,c=0,h=0,d=0,p=gc(e),v;try{for(p.s();!(v=p.n()).done;){var g=v.value,y=Pr.copy(g).subtract(n);u+=y.x*y.x,f+=y.x*y.y,l+=y.x*y.z,c+=y.y*y.y,h+=y.y*y.z,d+=y.z*y.z}}catch(j){p.e(j)}finally{p.f()}u*=s,f*=s,l*=s,c*=s,h*=s,d*=s;var b=bP;b[0]=u,b[1]=f,b[2]=l,b[3]=f,b[4]=c,b[5]=h,b[6]=l,b[7]=h,b[8]=d;var E=ss(b,TP),T=E.unitary,S=r.halfAxes.copy(T),I=S.getColumn(0,yP),L=S.getColumn(1,AP),B=S.getColumn(2,_P),C=-Number.MAX_VALUE,_=-Number.MAX_VALUE,R=-Number.MAX_VALUE,F=Number.MAX_VALUE,k=Number.MAX_VALUE,D=Number.MAX_VALUE,M=gc(e),O;try{for(M.s();!(O=M.n()).done;){var P=O.value;Pr.copy(P),C=Math.max(Pr.dot(I),C),_=Math.max(Pr.dot(L),_),R=Math.max(Pr.dot(B),R),F=Math.min(Pr.dot(I),F),k=Math.min(Pr.dot(L),k),D=Math.min(Pr.dot(B),D)}}catch(j){M.e(j)}finally{M.f()}I=I.multiplyByScalar(.5*(F+C)),L=L.multiplyByScalar(.5*(k+_)),B=B.multiplyByScalar(.5*(D+R)),r.center.copy(I).add(L).add(B);var U=gP.set(C-F,_-k,R-D).multiplyByScalar(.5),G=new ye([U[0],0,0,0,U[1],0,0,0,U[2]]);return r.halfAxes.multiplyRight(G),r}function Ac(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=xP(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function xP(e,r){if(e){if(typeof e=="string")return b1(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return b1(e,r)}}function b1(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var la=512,T1=3,S1=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],C1=S1.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),EP=C1.concat([[.25,.5],[.75,.5]]),SP=function(){function e(r,t,n){(0,x1.default)(this,e),(0,vn.default)(this,"x",void 0),(0,vn.default)(this,"y",void 0),(0,vn.default)(this,"z",void 0),(0,vn.default)(this,"childVisible",void 0),(0,vn.default)(this,"selected",void 0),(0,vn.default)(this,"_children",void 0),this.x=r,this.y=t,this.z=n}return(0,E1.default)(e,[{key:"children",get:function(){if(!this._children){var t=this.x*2,n=this.y*2,a=this.z+1;this._children=[new e(t,n,a),new e(t,n+1,a),new e(t+1,n,a),new e(t+1,n+1,a)]}return this._children}},{key:"update",value:function(t){var n=t.viewport,a=t.cullingVolume,i=t.elevationBounds,o=t.minZ,s=t.maxZ,u=t.bounds,f=t.offset,l=t.project,c=this.getBoundingVolume(i,f,l);if(u&&!this.insideBounds(u))return!1;var h=a.computeVisibility(c);if(h<0)return!1;if(!this.childVisible){var d=this.z;if(d<s&&d>=o){var p=c.distanceTo(n.cameraPosition)*n.scale/n.height;d+=Math.floor(Math.log2(p))}if(d>=s)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;var v=Ac(this.children),g;try{for(v.s();!(g=v.n()).done;){var y=g.value;y.update(t)}}catch(b){v.e(b)}finally{v.f()}return!0}},{key:"getSelected",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(this.selected&&t.push(this),this._children){var n=Ac(this._children),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;i.getSelected(t)}}catch(o){n.e(o)}finally{n.f()}}return t}},{key:"insideBounds",value:function(t){var n=(0,_c.default)(t,4),a=n[0],i=n[1],o=n[2],s=n[3],u=Math.pow(2,this.z),f=la/u;return this.x*f<o&&this.y*f<s&&(this.x+1)*f>a&&(this.y+1)*f>i}},{key:"getBoundingVolume",value:function(t,n,a){if(a){var i=this.z<1?EP:this.z<2?C1:S1,o=[],s=Ac(i),u;try{for(s.s();!(u=s.n()).done;){var f=u.value,l=us(this.x+f[0],this.y+f[1],this.z);l[2]=t[0],o.push(a(l)),t[0]!==t[1]&&(l[2]=t[1],o.push(a(l)))}}catch(v){s.e(v)}finally{s.f()}return yc(o)}var c=Math.pow(2,this.z),h=la/c,d=this.x*h+n*la,p=la-(this.y+1)*h;return new rs([d,p,t[0]],[d+h,p+h,t[1]])}}]),e}();function w1(e,r,t,n){var a=e instanceof vi._GlobeViewport&&e.resolution?e.projectPosition:null,i=Object.values(e.getFrustumPlanes()).map(function(S){var I=S.normal,L=S.distance;return new ke(I.clone().negate(),L)}),o=new pt(i),s=e.distanceScales.unitsPerMeter[2],u=t&&t[0]*s||0,f=t&&t[1]*s||0,l=e instanceof vi.WebMercatorViewport&&e.pitch<=60?r:0;if(n){var c=n,h=(0,_c.default)(c,4),d=h[0],p=h[1],v=h[2],g=h[3],y=it([d,g]),b=it([v,p]);n=[y[0],la-y[1],b[0],la-b[1]]}var E=new SP(0,0,0),T={viewport:e,project:a,cullingVolume:o,elevationBounds:[u,f],minZ:l,maxZ:r,bounds:n,offset:0};if(E.update(T),e instanceof vi.WebMercatorViewport&&e.subViewports&&e.subViewports.length>1){for(T.offset=-1;E.update(T)&&!(--T.offset<-T1););for(T.offset=1;E.update(T)&&!(++T.offset>T1););}return E.getSelected()}var or=512,CP=[-1/0,-1/0,1/0,1/0],Rr={type:"object",value:null,validate:function(r,t){return t.optional&&r===null||typeof r=="string"||Array.isArray(r)&&r.every(function(n){return typeof n=="string"})},equal:function(r,t){if(r===t)return!0;if(!Array.isArray(r)||!Array.isArray(t))return!1;var n=r.length;if(n!==t.length)return!1;for(var a=0;a<n;a++)if(r[a]!==t[a])return!1;return!0}};function M1(e,r){var t=[r.transformAsPoint([e[0],e[1]]),r.transformAsPoint([e[2],e[1]]),r.transformAsPoint([e[0],e[3]]),r.transformAsPoint([e[2],e[3]])],n=[Math.min.apply(Math,(0,gi.default)(t.map(function(a){return a[0]}))),Math.min.apply(Math,(0,gi.default)(t.map(function(a){return a[1]}))),Math.max.apply(Math,(0,gi.default)(t.map(function(a){return a[0]}))),Math.max.apply(Math,(0,gi.default)(t.map(function(a){return a[1]})))];return n}function wP(e){return Math.abs(e.split("").reduce(function(r,t){return(r<<5)-r+t.charCodeAt(0)|0},0))}function qt(e,r){if(!e||!e.length)return null;var t=r.index,n=r.id;if(Array.isArray(e)){var a=wP(n)%e.length;e=e[a]}for(var i=e,o=0,s=Object.keys(t);o<s.length;o++){var u=s[o],f=new RegExp("{".concat(u,"}"),"g");i=i.replace(f,String(t[u]))}return Number.isInteger(t.y)&&Number.isInteger(t.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,t.z)-t.y-1))),i}function BP(e,r,t){var n;if(r&&r.length===2){var a=(0,gn.default)(r,2),i=a[0],o=a[1],s=e.getBounds({z:i}),u=e.getBounds({z:o});n=[Math.min(s[0],u[0]),Math.min(s[1],u[1]),Math.max(s[2],u[2]),Math.max(s[3],u[3])]}else n=e.getBounds();return e.isGeospatial?[Math.max(n[0],t[0]),Math.max(n[1],t[1]),Math.min(n[2],t[2]),Math.min(n[3],t[3])]:[Math.max(Math.min(n[0],t[2]),t[0]),Math.max(Math.min(n[1],t[3]),t[1]),Math.min(Math.max(n[2],t[0]),t[2]),Math.min(Math.max(n[3],t[1]),t[3])]}function O1(e){var r=e.viewport,t=e.z,n=t===void 0?0:t,a=e.cullRect,i=r.subViewports||[r];return i.map(function(o){return bc(o,n,a)})}function bc(e,r,t){if(!Array.isArray(r)){var n=t.x-e.x,a=t.y-e.y,i=t.width,o=t.height,s={targetZ:r},u=e.unproject([n,a],s),f=e.unproject([n+i,a],s),l=e.unproject([n,a+o],s),c=e.unproject([n+i,a+o],s);return[Math.min(u[0],f[0],l[0],c[0]),Math.min(u[1],f[1],l[1],c[1]),Math.max(u[0],f[0],l[0],c[0]),Math.max(u[1],f[1],l[1],c[1])]}var h=bc(e,r[0],t),d=bc(e,r[1],t);return[Math.min(h[0],d[0]),Math.min(h[1],d[1]),Math.max(h[2],d[2]),Math.max(h[3],d[3])]}function MP(e,r,t){if(t){var n=M1(e,t).map(function(a){return a*r/or});return n}return e.map(function(a){return a*r/or})}function Tc(e,r){return Math.pow(2,e)*or/r}function us(e,r,t){var n=Tc(t,or),a=e/n*360-180,i=Math.PI-2*Math.PI*r/n,o=180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)));return[a,o]}function B1(e,r,t,n){var a=Tc(t,n);return[e/a*or,r/a*or]}function xc(e,r,t,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:or;if(e.isGeospatial){var i=us(r,t,n),o=(0,gn.default)(i,2),s=o[0],u=o[1],f=us(r+1,t+1,n),l=(0,gn.default)(f,2),c=l[0],h=l[1];return{west:s,north:u,east:c,south:h}}var d=B1(r,t,n,a),p=(0,gn.default)(d,2),v=p[0],g=p[1],y=B1(r+1,t+1,n,a),b=(0,gn.default)(y,2),E=b[0],T=b[1];return{left:v,top:g,right:E,bottom:T}}function OP(e,r,t,n,a){for(var i=BP(e,null,n),o=Tc(r,t),s=MP(i,o,a),u=(0,gn.default)(s,4),f=u[0],l=u[1],c=u[2],h=u[3],d=[],p=Math.floor(f);p<c;p++)for(var v=Math.floor(l);v<h;v++)d.push({x:p,y:v,z:r});return d}function Ec(e){var r=e.viewport,t=e.maxZoom,n=e.minZoom,a=e.zRange,i=e.extent,o=e.tileSize,s=o===void 0?or:o,u=e.modelMatrix,f=e.modelMatrixInverse,l=e.zoomOffset,c=l===void 0?0:l,h=r.isGeospatial?Math.round(r.zoom+Math.log2(or/s))+c:Math.ceil(r.zoom)+c;if(typeof n=="number"&&Number.isFinite(n)&&h<n){if(!i)return[];h=n}typeof t=="number"&&Number.isFinite(t)&&h>t&&(h=t);var d=i;return u&&f&&i&&!r.isGeospatial&&(d=M1(i,u)),r.isGeospatial?w1(r,h,a,i):OP(r,h,s,d||CP,f)}function Sc(e){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(e)}function Cc(e){return Number.isFinite(e.west)&&Number.isFinite(e.north)&&Number.isFinite(e.east)&&Number.isFinite(e.south)}function I1(e){var r={},t;return function(n){for(var a in n)if(!IP(n[a],r[a])){t=e(n),r=n;break}return t}}function IP(e,r){if(e===r)return!0;if(Array.isArray(e)){var t=e.length;if(!r||r.length!==t)return!1;for(var n=0;n<t;n++)if(e[n]!==r[n])return!1;return!0}return!1}var yi;function Ye(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=PP(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function PP(e,r){if(e){if(typeof e=="string")return P1(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return P1(e,r)}}function P1(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function R1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function F1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?R1(Object(t),!0).forEach(function(n){(0,De.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var L1=1,fs=2,RP="never",FP="no-overlap",Ai="best-available",LP=5,kP=(yi={},(0,De.default)(yi,Ai,GP),(0,De.default)(yi,FP,NP),(0,De.default)(yi,RP,function(){}),yi),DP={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:function(){},onTileUnload:function(){},onTileError:function(){}},_i=function(){function e(r){var t=this;(0,k1.default)(this,e),(0,De.default)(this,"opts",void 0),(0,De.default)(this,"_requestScheduler",void 0),(0,De.default)(this,"_cache",void 0),(0,De.default)(this,"_dirty",void 0),(0,De.default)(this,"_tiles",void 0),(0,De.default)(this,"_cacheByteSize",void 0),(0,De.default)(this,"_viewport",void 0),(0,De.default)(this,"_zRange",void 0),(0,De.default)(this,"_selectedTiles",void 0),(0,De.default)(this,"_frameNumber",void 0),(0,De.default)(this,"_modelMatrix",void 0),(0,De.default)(this,"_modelMatrixInverse",void 0),(0,De.default)(this,"_maxZoom",void 0),(0,De.default)(this,"_minZoom",void 0),(0,De.default)(this,"onTileLoad",void 0),(0,De.default)(this,"_getCullBounds",I1(O1)),this.opts=F1(F1({},DP),r),this.onTileLoad=function(n){var a,i;(a=(i=t.opts).onTileLoad)===null||a===void 0||a.call(i,n),t.opts.maxCacheByteSize&&(t._cacheByteSize+=n.byteLength,t._resizeCache())},this._requestScheduler=new Xa({maxRequests:r.maxRequests,throttleRequests:Boolean(r.maxRequests&&r.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new $,this._modelMatrixInverse=new $,this.setOptions(r)}return(0,D1.default)(e,[{key:"tiles",get:function(){return this._tiles}},{key:"selectedTiles",get:function(){return this._selectedTiles}},{key:"isLoaded",get:function(){return this._selectedTiles!==null&&this._selectedTiles.every(function(t){return t.isLoaded})}},{key:"needsReload",get:function(){return this._selectedTiles!==null&&this._selectedTiles.some(function(t){return t.needsReload})}},{key:"setOptions",value:function(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}},{key:"finalize",value:function(){var t=Ye(this._cache.values()),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;a.isLoading&&a.abort()}}catch(i){t.e(i)}finally{t.f()}this._cache.clear(),this._tiles=[],this._selectedTiles=null}},{key:"reloadAll",value:function(){var t=Ye(this._cache.keys()),n;try{for(t.s();!(n=t.n()).done;){var a=n.value,i=this._cache.get(a);!this._selectedTiles||!this._selectedTiles.includes(i)?this._cache.delete(a):i.setNeedsReload()}}catch(o){t.e(o)}finally{t.f()}}},{key:"update",value:function(t){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=a.zRange,o=a.modelMatrix,s=new $(o),u=!s.equals(this._modelMatrix);if(!this._viewport||!t.equals(this._viewport)||!Je(this._zRange,i)||u){u&&(this._modelMatrixInverse=s.clone().invert(),this._modelMatrix=s),this._viewport=t,this._zRange=i;var f=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:i,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=f.map(function(c){return n._getTile(c,!0)}),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(function(c){return n._getTile(c.index,!0)}));var l=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),l&&this._frameNumber++,this._frameNumber}},{key:"isTileVisible",value:function(t,n){if(!t.isVisible)return!1;if(n&&this._viewport){var a=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),i=t.bbox,o=Ye(a),s;try{for(o.s();!(s=o.n()).done;){var u=(0,wc.default)(s.value,4),f=u[0],l=u[1],c=u[2],h=u[3],d=void 0;if("west"in i)d=i.west<c&&i.east>f&&i.south<h&&i.north>l;else{var p=Math.min(i.top,i.bottom),v=Math.max(i.top,i.bottom);d=i.left<c&&i.right>f&&p<h&&v>l}if(d)return!0}}catch(g){o.e(g)}finally{o.f()}return!1}return!0}},{key:"getTileIndices",value:function(t){var n=t.viewport,a=t.maxZoom,i=t.minZoom,o=t.zRange,s=t.modelMatrix,u=t.modelMatrixInverse,f=this.opts,l=f.tileSize,c=f.extent,h=f.zoomOffset;return Ec({viewport:n,maxZoom:a,minZoom:i,zRange:o,tileSize:l,extent:c,modelMatrix:s,modelMatrixInverse:u,zoomOffset:h})}},{key:"getTileId",value:function(t){return"".concat(t.x,"-").concat(t.y,"-").concat(t.z)}},{key:"getTileZoom",value:function(t){return t.z}},{key:"getTileMetadata",value:function(t){var n=this.opts.tileSize;return{bbox:xc(this._viewport,t.x,t.y,t.z,n)}}},{key:"getParentIndex",value:function(t){var n=Math.floor(t.x/2),a=Math.floor(t.y/2),i=t.z-1;return{x:n,y:a,z:i}}},{key:"updateTileStates",value:function(){var t=this.opts.refinementStrategy||Ai,n=new Array(this._cache.size),a=0,i=Ye(this._cache.values()),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;n[a++]=s.isVisible,s.isSelected=!1,s.isVisible=!1}}catch(p){i.e(p)}finally{i.f()}var u=Ye(this._selectedTiles),f;try{for(u.s();!(f=u.n()).done;){var l=f.value;l.isSelected=!0,l.isVisible=!0}}catch(p){u.e(p)}finally{u.f()}(typeof t=="function"?t:kP[t])(Array.from(this._cache.values())),a=0;var c=Ye(this._cache.values()),h;try{for(c.s();!(h=c.n()).done;){var d=h.value;if(n[a++]!==d.isVisible)return!0}}catch(p){c.e(p)}finally{c.f()}return!1}},{key:"_pruneRequests",value:function(){var t=this.opts.maxRequests,n=t===void 0?0:t,a=[],i=0,o=Ye(this._cache.values()),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;u.isLoading&&(i++,!u.isSelected&&!u.isVisible&&a.push(u))}}catch(l){o.e(l)}finally{o.f()}for(;n>0&&i>n&&a.length>0;){var f=a.shift();f.abort(),i--}}},{key:"_rebuildTree",value:function(){var t=this._cache,n=Ye(t.values()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;i.parent=null,i.children&&(i.children.length=0)}}catch(l){n.e(l)}finally{n.f()}var o=Ye(t.values()),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,f=this._getNearestAncestor(u);u.parent=f,f!=null&&f.children&&f.children.push(u)}}catch(l){o.e(l)}finally{o.f()}}},{key:"_resizeCache",value:function(){var t=this._cache,n=this.opts,a=n.maxCacheSize||(n.maxCacheByteSize?1/0:LP*this.selectedTiles.length),i=n.maxCacheByteSize||1/0,o=t.size>a||this._cacheByteSize>i;if(o){var s=Ye(t),u;try{for(s.s();!(u=s.n()).done;){var f=(0,wc.default)(u.value,2),l=f[0],c=f[1];if(!c.isVisible&&!c.isSelected){var h,d;this._cacheByteSize-=n.maxCacheByteSize?c.byteLength:0,t.delete(l),(h=(d=this.opts).onTileUnload)===null||h===void 0||h.call(d,c)}if(t.size<=a&&this._cacheByteSize<=i)break}}catch(p){s.e(p)}finally{s.f()}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(function(p,v){return p.zoom-v.zoom}),this._dirty=!1)}},{key:"_getTile",value:function(t,n){var a=this.getTileId(t),i=this._cache.get(a),o=!1;return!i&&n?(i=new pi(t),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:a,zoom:this.getTileZoom(i.index)}),o=!0,this._cache.set(a,i),this._dirty=!0):i&&i.needsReload&&(o=!0),i&&o&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}},{key:"_getNearestAncestor",value:function(t){for(var n=this._minZoom,a=n===void 0?0:n,i=t.index;this.getTileZoom(i)>a;){i=this.getParentIndex(i);var o=this._getTile(i);if(o)return o}return null}}]),e}();function GP(e){var r=Ye(e),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;n.state=0}}catch(l){r.e(l)}finally{r.f()}var a=Ye(e),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;o.isSelected&&!G1(o)&&Bc(o)}}catch(l){a.e(l)}finally{a.f()}var s=Ye(e),u;try{for(s.s();!(u=s.n()).done;){var f=u.value;f.isVisible=Boolean(f.state&fs)}}catch(l){s.e(l)}finally{s.f()}}function NP(e){var r=Ye(e),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;n.state=0}}catch(p){r.e(p)}finally{r.f()}var a=Ye(e),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;o.isSelected&&G1(o)}}catch(p){a.e(p)}finally{a.f()}var s=Array.from(e).sort(function(p,v){return p.zoom-v.zoom}),u=Ye(s),f;try{for(u.s();!(f=u.n()).done;){var l=f.value;if(l.isVisible=Boolean(l.state&fs),l.children&&(l.isVisible||l.state&L1)){var c=Ye(l.children),h;try{for(c.s();!(h=c.n()).done;){var d=h.value;d.state=L1}}catch(p){c.e(p)}finally{c.f()}}else l.isSelected&&Bc(l)}}catch(p){u.e(p)}finally{u.f()}}function G1(e){for(var r=e;r;){if(r.isLoaded||r.content)return r.state|=fs,!0;r=r.parent}return!1}function Bc(e){var r=Ye(e.children),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;n.isLoaded||n.content?n.state|=fs:Bc(n)}}catch(a){r.e(a)}finally{r.f()}}function N1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Mc(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?N1(Object(t),!0).forEach(function(n){(0,ls.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function UP(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=jP(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function jP(e,r){if(e){if(typeof e=="string")return U1(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return U1(e,r)}}function U1(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function HP(e){var r=VP();return function(){var n=(0,Oc.default)(e),a;if(r){var i=(0,Oc.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,z1.default)(this,a)}}function VP(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var zP={TilesetClass:_i,data:{type:"data",value:[]},dataComparator:Rr.equal,renderSubLayers:{type:"function",value:function(r){return new W1.GeoJsonLayer(r)}},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:function(r){}},onTileUnload:{type:"function",value:function(r){}},onTileError:{type:"function",value:function(r){return console.error(r)}},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:Ai,zRange:null,maxRequests:6,zoomOffset:0},sr=function(e){(0,V1.default)(t,e);var r=HP(t);function t(){return(0,j1.default)(this,t),r.apply(this,arguments)}return(0,H1.default)(t,[{key:"initializeState",value:function(){this.state={tileset:null,isLoaded:!1}}},{key:"finalizeState",value:function(){var a,i;(a=this.state)===null||a===void 0||(i=a.tileset)===null||i===void 0||i.finalize()}},{key:"isLoaded",get:function(){var a,i;return(a=this.state)===null||a===void 0||(i=a.tileset)===null||i===void 0?void 0:i.selectedTiles.every(function(o){return o.isLoaded&&o.layers&&o.layers.every(function(s){return s.isLoaded})})}},{key:"shouldUpdateState",value:function(a){var i=a.changeFlags;return i.somethingChanged}},{key:"updateState",value:function(a){var i=a.changeFlags,o=this.state.tileset,s=i.propsOrDataChanged||i.updateTriggersChanged,u=i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getTileData);o?s&&(o.setOptions(this._getTilesetOptions()),u?o.reloadAll():this.state.tileset.tiles.forEach(function(f){f.layers=null})):(o=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:o})),this._updateTileset()}},{key:"_getTilesetOptions",value:function(){var a=this.props,i=a.tileSize,o=a.maxCacheSize,s=a.maxCacheByteSize,u=a.refinementStrategy,f=a.extent,l=a.maxZoom,c=a.minZoom,h=a.maxRequests,d=a.zoomOffset;return{maxCacheSize:o,maxCacheByteSize:s,maxZoom:l,minZoom:c,tileSize:i,refinementStrategy:u,extent:f,maxRequests:h,zoomOffset:d,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}},{key:"_updateTileset",value:function(){var a=this.state.tileset,i=this.props,o=i.zRange,s=i.modelMatrix,u=a.update(this.context.viewport,{zRange:o,modelMatrix:s}),f=a.isLoaded,l=this.state.isLoaded!==f,c=this.state.frameNumber!==u;f&&(l||c)&&this._onViewportLoad(),c&&this.setState({frameNumber:u}),this.state.isLoaded=f}},{key:"_onViewportLoad",value:function(){var a=this.state.tileset,i=this.props.onViewportLoad;i&&i(a.selectedTiles)}},{key:"_onTileLoad",value:function(a){this.props.onTileLoad(a),a.layers=null,this.setNeedsUpdate()}},{key:"_onTileError",value:function(a,i){this.props.onTileError(a),i.layers=null,this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(a){this.props.onTileUnload(a)}},{key:"getTileData",value:function(a){var i=this.props,o=i.data,s=i.getTileData,u=i.fetch,f=a.signal;return a.url=typeof o=="string"||Array.isArray(o)?qt(o,a):null,s?s(a):u&&a.url?u(a.url,{propName:"data",layer:this,signal:f}):null}},{key:"renderSubLayers",value:function(a){return this.props.renderSubLayers(a)}},{key:"getSubLayerPropsByTile",value:function(a){return null}},{key:"getPickingInfo",value:function(a){var i=a.info,o=a.sourceLayer,s=o.props.tile;return i.picked&&(i.tile=s),i.sourceTile=s,i}},{key:"_updateAutoHighlight",value:function(a){var i=a.sourceTile;if(i&&i.layers){var o=UP(i.layers),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;u.updateAutoHighlight(a)}}catch(f){o.e(f)}finally{o.f()}}}},{key:"renderLayers",value:function(){var a=this;return this.state.tileset.tiles.map(function(i){var o=a.getSubLayerPropsByTile(i);if(!(!i.isLoaded&&!i.content))if(i.layers)o&&i.layers[0]&&Object.keys(o).some(function(u){return i.layers[0].props[u]!==o[u]})&&(i.layers=i.layers.map(function(u){return u.clone(o)}));else{var s=a.renderSubLayers(Mc(Mc({},a.props),{},{id:"".concat(a.id,"-").concat(i.id),data:i.content,_offset:0,tile:i}));i.layers=(0,cs._flatten)(s,Boolean).map(function(u){return u.clone(Mc({tile:i},o))})}return i.layers})}},{key:"filterSubLayer",value:function(a){var i=a.layer,o=a.cullRect,s=i.props.tile;return this.state.tileset.isTileVisible(s,o)}}]),t}(cs.CompositeLayer);(0,ls.default)(sr,"defaultProps",zP);(0,ls.default)(sr,"layerName","TileLayer");var X1=m(H()),Y1=m(z()),hs=m(Zr()),K1=m(Te()),Q1=m(xe()),ca=m(Ae()),ds=m(W()),Z1=m(Pt());function J1(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function q1(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?J1(Object(t),!0).forEach(function(n){(0,ds.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):J1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function WP(e){var r=JP();return function(){var n=(0,ca.default)(e),a;if(r){var i=(0,ca.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,Q1.default)(this,a)}}function JP(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qP={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:function(r){return r.timestamps}}},ps=function(e){(0,K1.default)(t,e);var r=WP(t);function t(){return(0,X1.default)(this,t),r.apply(this,arguments)}return(0,Y1.default)(t,[{key:"getShaders",value:function(){var a=(0,hs.default)((0,ca.default)(t.prototype),"getShaders",this).call(this);return a.inject={"vs:#decl":`uniform float trailLength;
attribute float instanceTimestamps;
attribute float instanceNextTimestamps;
varying float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`uniform bool fadeTrail;
uniform float trailLength;
uniform float currentTime;
varying float vTime;
`,"fs:#main-start":`if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(fadeTrail) {
  color.a *= 1.0 - (currentTime - vTime) / trailLength;
}
`},a}},{key:"initializeState",value:function(){(0,hs.default)((0,ca.default)(t.prototype),"initializeState",this).call(this);var a=this.getAttributeManager();a.addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}},{key:"draw",value:function(a){var i=this.props,o=i.fadeTrail,s=i.trailLength,u=i.currentTime;a.uniforms=q1(q1({},a.uniforms),{},{fadeTrail:o,trailLength:s,currentTime:u}),(0,hs.default)((0,ca.default)(t.prototype),"draw",this).call(this,a)}}]),t}(Z1.PathLayer);(0,ds.default)(ps,"layerName","TripsLayer");(0,ds.default)(ps,"defaultProps",qP);var hA=m(H()),dA=m(z()),pA=m(Te()),mA=m(xe()),Fc=m(Ae()),Lc=m(W()),vA=m(Ic()),gA=m(Rt());var nA=m(H()),aA=m(z()),iA=m(at()),oA=m(Te()),sA=m(xe()),Pc=m(Ae()),ha=m(W()),uA=m(Xe()),bi=m(ce()),et=m(Ic());var vs=m(Rt()),Ti=m(Pt());function XP(e){var r=YP();return function(){var n=(0,Pc.default)(e),a;if(r){var i=(0,Pc.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,sA.default)(this,a)}}function YP(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function eA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ms(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?eA(Object(t),!0).forEach(function(n){(0,ha.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Rc(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=KP(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function KP(e,r){if(e){if(typeof e=="string")return tA(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return tA(e,r)}}function tA(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var QP=10;function fA(e,r){r=r===void 0?e[0][0]:r;var t=Rc(e),n;try{for(t.s();!(n=t.n()).done;){var a=n.value,i=a[0]-r;i>180?a[0]-=360:i<-180&&(a[0]+=360)}}catch(o){t.e(o)}finally{t.f()}}function ZP(e,r,t){var n=(0,et.h3ToGeo)(e),a=(0,bi.default)(n,2),i=a[0],o=a[1],s=r.length;fA(r,o);for(var u=r[0]===r[s-1]?s-1:s,f=0;f<u;f++)r[f][0]=wr(o,r[f][0],t),r[f][1]=wr(i,r[f][1],t)}function $P(e,r,t){var n=e(r,t),a=(0,et.h3ToGeo)(n),i=(0,bi.default)(a,2),o=i[0],s=i[1];return[s,o]}function rA(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=(0,et.h3ToGeoBoundary)(e,!0);return r!==1?ZP(e,t,r):fA(t),t}function e3(e){var r=new Float64Array(e.length*2),t=0,n=Rc(e),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r[t++]=i[0],r[t++]=i[1]}}catch(o){n.e(o)}finally{n.f()}return r}function t3(e,r){var t;return e==null?t=r:(0,uA.default)(e)==="object"?t=ms(ms({},e),{},{coverage:r}):t={getHexagon:e,coverage:r},t}var r3=ms(ms({},Ti.PolygonLayer.defaultProps),{},{highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:function(r){return r.hexagon}},extruded:!0}),yn=function(e){(0,oA.default)(t,e);var r=XP(t);function t(){var n;(0,nA.default)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=r.call.apply(r,[this].concat(i)),(0,ha.default)((0,iA.default)(n),"state",void 0),n}return(0,aA.default)(t,[{key:"initializeState",value:function(){t._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}},{key:"shouldUpdateState",value:function(a){var i=a.changeFlags;return this._shouldUseHighPrecision()?i.propsOrDataChanged:i.somethingChanged}},{key:"updateState",value:function(a){var i=a.props,o=a.changeFlags;if(i.highPrecision!==!0&&(o.dataChanged||o.updateTriggersChanged&&o.updateTriggersChanged.getHexagon)){var s=this._calculateH3DataProps();this.setState(s)}this._updateVertices(this.context.viewport)}},{key:"_calculateH3DataProps",value:function(){var a=-1,i=!1,o=!1,s=(0,vs.createIterable)(this.props.data),u=s.iterable,f=s.objectInfo,l=Rc(u),c;try{for(l.s();!(c=l.n()).done;){var h=c.value;f.index++;var d=this.props.getHexagon(h,f),p=(0,et.h3GetResolution)(d);if(a<0){if(a=p,!this.props.highPrecision)break}else if(a!==p){o=!0;break}if((0,et.h3IsPentagon)(d)){i=!0;break}}}catch(v){l.e(v)}finally{l.f()}return{resolution:a,edgeLengthKM:a>=0?(0,et.edgeLength)(a,"km"):0,hasMultipleRes:o,hasPentagon:i}}},{key:"_shouldUseHighPrecision",value:function(){if(this.props.highPrecision==="auto"){var a=this.state,i=a.resolution,o=a.hasPentagon,s=a.hasMultipleRes,u=this.context.viewport;return Boolean(u?.resolution)||s||o||i>=0&&i<=5}return this.props.highPrecision}},{key:"_updateVertices",value:function(a){if(!this._shouldUseHighPrecision()){var i=this.state,o=i.resolution,s=i.edgeLengthKM,u=i.centerHex;if(!(o<0)){var f=this.props.centerHexagon||(0,et.geoToH3)(a.latitude,a.longitude,o);if(u!==f){if(u){var l=(0,et.h3Distance)(u,f);if(l>=0&&l*s<QP)return}var c=a.distanceScales.unitsPerMeter,h=rA(f),d=(0,et.h3ToGeo)(f),p=(0,bi.default)(d,2),v=p[0],g=p[1],y=a.projectFlat([g,v]),b=(0,bi.default)(y,2),E=b[0],T=b[1];h=h.map(function(S){var I=a.projectFlat(S);return[(I[0]-E)/c[0],(I[1]-T)/c[1]]}),this.setState({centerHex:f,vertices:h})}}}}},{key:"renderLayers",value:function(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}},{key:"_getForwardProps",value:function(){var a=this.props,i=a.elevationScale,o=a.material,s=a.coverage,u=a.extruded,f=a.wireframe,l=a.stroked,c=a.filled,h=a.lineWidthUnits,d=a.lineWidthScale,p=a.lineWidthMinPixels,v=a.lineWidthMaxPixels,g=a.getFillColor,y=a.getElevation,b=a.getLineColor,E=a.getLineWidth,T=a.transitions,S=a.updateTriggers;return{elevationScale:i,extruded:u,coverage:s,wireframe:f,stroked:l,filled:c,lineWidthUnits:h,lineWidthScale:d,lineWidthMinPixels:p,lineWidthMaxPixels:v,material:o,getElevation:y,getFillColor:g,getLineColor:b,getLineWidth:E,transitions:T,updateTriggers:{getFillColor:S.getFillColor,getElevation:S.getElevation,getLineColor:S.getLineColor,getLineWidth:S.getLineWidth}}}},{key:"_renderPolygonLayer",value:function(){var a=this.props,i=a.data,o=a.getHexagon,s=a.updateTriggers,u=a.coverage,f=this.getSubLayerClass("hexagon-cell-hifi",Ti.PolygonLayer),l=this._getForwardProps();return l.updateTriggers.getPolygon=t3(s.getHexagon,u),new f(l,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:l.updateTriggers}),{data:i,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:function(h,d){var p=o(h,d);return e3(rA(p,u))}})}},{key:"_renderColumnLayer",value:function(){var a=this.props,i=a.data,o=a.getHexagon,s=a.updateTriggers,u=this.getSubLayerClass("hexagon-cell",Ti.ColumnLayer),f=this._getForwardProps();return f.updateTriggers.getPosition=s.getHexagon,new u(f,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:f.updateTriggers}),{data:i,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:$P.bind(null,o)})}}]),t}(vs.CompositeLayer);(0,ha.default)(yn,"defaultProps",r3);(0,ha.default)(yn,"layerName","H3HexagonLayer");(0,ha.default)(yn,"_checkH3Lib",function(){});function lA(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=n3(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function n3(e,r){if(e){if(typeof e=="string")return cA(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return cA(e,r)}}function cA(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function a3(e){var r=i3();return function(){var n=(0,Fc.default)(e),a;if(r){var i=(0,Fc.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,mA.default)(this,a)}}function i3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var o3={getHexagons:{type:"accessor",value:function(r){return r.hexagons}}},gs=function(e){(0,pA.default)(t,e);var r=a3(t);function t(){return(0,hA.default)(this,t),r.apply(this,arguments)}return(0,dA.default)(t,[{key:"initializeState",value:function(){yn._checkH3Lib()}},{key:"updateState",value:function(a){var i=a.props,o=a.changeFlags;if(o.dataChanged||o.updateTriggersChanged&&o.updateTriggersChanged.getHexagons){var s=i.data,u=i.getHexagons,f=[],l=(0,gA.createIterable)(s),c=l.iterable,h=l.objectInfo,d=lA(c),p;try{for(d.s();!(p=d.n()).done;){var v=p.value;h.index++;var g=u(v,h),y=(0,vA.h3SetToMultiPolygon)(g,!0),b=lA(y),E;try{for(b.s();!(E=b.n()).done;){var T=E.value;f.push(this.getSubLayerRow({polygon:T},v,h.index))}}catch(S){b.e(S)}finally{b.f()}}}catch(S){d.e(S)}finally{d.f()}this.setState({polygons:f})}}},{key:"indexToBounds",value:function(){var a=this.props,i=a.getElevation,o=a.getFillColor,s=a.getLineColor,u=a.getLineWidth;return{data:this.state.polygons,getPolygon:function(l){return l.polygon},getElevation:this.getSubLayerAccessor(i),getFillColor:this.getSubLayerAccessor(o),getLineColor:this.getSubLayerAccessor(s),getLineWidth:this.getSubLayerAccessor(u)}}}]),t}(Ct);(0,Lc.default)(gs,"layerName","H3ClusterLayer");(0,Lc.default)(gs,"defaultProps",o3);var EC=m(X()),SC=m(H()),CC=m(z()),wC=m(at()),BC=m(Te()),MC=m(xe()),Xp=m(Ae()),Ki=m(W()),Yp=m(Y()),OC=m(kc()),qr=m(Rt()),IC=m(Pt()),PC=m(ys());var gb=m(H()),yb=m(z()),_a=m(Zr()),Ab=m(Te()),_b=m(xe()),Ur=m(Ae()),Ns=m(W());var xs=m(Xe()),xi=m(St()),FA=m(W()),LA=m(H()),kA=m(z());var _A=m(Xe());var As=m(Xe());function Dc(e){if(typeof window<"u"&&(0,As.default)(window.process)==="object"&&window.process.type==="renderer"||typeof process<"u"&&(0,As.default)(process.versions)==="object"&&Boolean(process.versions.electron))return!0;var r=(typeof navigator>"u"?"undefined":(0,As.default)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,t=e||r;return!!(t&&t.indexOf("Electron")>=0)}function ft(){var e=(typeof process>"u"?"undefined":(0,_A.default)(process))==="object"&&String(process)==="[object process]"&&!process.browser;return!e||Dc()}var bA=m(Xe()),Fr={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:(typeof process>"u"?"undefined":(0,bA.default)(process))==="object"&&process};var s3=Fr.self||Fr.window||Fr.global,da=Fr.window||Fr.self||Fr.global,u3=Fr.document||{},An=Fr.process||{};var _s="8.9.11",kz=ft();var TA=m(H()),xA=m(z());function f3(e){try{var r=window[e],t="__storage_test__";return r.setItem(t,t),r.removeItem(t),r}catch{return null}}var EA=function(){function e(r){(0,TA.default)(this,e);var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";A(this,"storage",void 0),A(this,"id",void 0),A(this,"config",{}),this.storage=f3(n),this.id=r,this.config={},Object.assign(this.config,t),this._loadConfiguration()}return(0,xA.default)(e,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(t){return this.config={},this.updateConfiguration(t)}},{key:"updateConfiguration",value:function(t){if(Object.assign(this.config,t),this.storage){var n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}return this}},{key:"_loadConfiguration",value:function(){var t={};if(this.storage){var n=this.storage.getItem(this.id);t=n?JSON.parse(n):{}}return Object.assign(this.config,t),this}}]),e}();function SA(e){var r;return e<10?r="".concat(e.toFixed(2),"ms"):e<100?r="".concat(e.toFixed(1),"ms"):e<1e3?r="".concat(e.toFixed(0),"ms"):r="".concat((e/1e3).toFixed(2),"s"),r}function CA(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,t=Math.max(r-e.length,0);return"".concat(" ".repeat(t)).concat(e)}function bs(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,a=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>n&&(t=Math.min(t,n/e.width));var i=e.width*t,o=e.height*t,s=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(i/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(a,");"),"background-size:".concat(i,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(r," %c+"),s]}var Ts;(function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ts||(Ts={}));function wA(e){return typeof e=="string"?Ts[e.toUpperCase()]||Ts.WHITE:e}function BA(e,r,t){return!ft&&typeof e=="string"&&(r&&(r=wA(r),e="\x1B[".concat(r,"m").concat(e,"\x1B[39m")),t&&(r=wA(t),e="\x1B[".concat(t+10,"m").concat(e,"\x1B[49m"))),e}function l3(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=c3(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function c3(e,r){if(e){if(typeof e=="string")return MA(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return MA(e,r)}}function MA(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function OA(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],t=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(t),a=l3(n),i;try{var o=function(){var u=i.value;typeof e[u]=="function"&&(r.find(function(f){return u===f})||(e[u]=e[u].bind(e)))};for(a.s();!(i=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}function pa(e,r){if(!e)throw new Error(r||"Assertion failed")}function _n(){var e;if(ft&&"performance"in da){var r,t;e=da===null||da===void 0||(r=da.performance)===null||r===void 0||(t=r.now)===null||t===void 0?void 0:t.call(r)}else if("hrtime"in An){var n,a=An===null||An===void 0||(n=An.hrtime)===null||n===void 0?void 0:n.call(An);e=a[0]*1e3+a[1]/1e6}else e=Date.now();return e}var ma={debug:ft&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},h3={enabled:!0,level:0};function wt(){}var IA={},PA={once:!0},va=function(){function e(){(0,LA.default)(this,e);var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""},t=r.id;A(this,"id",void 0),A(this,"VERSION",_s),A(this,"_startTs",_n()),A(this,"_deltaTs",_n()),A(this,"_storage",void 0),A(this,"userData",{}),A(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this._storage=new EA("__probe-".concat(this.id,"__"),h3),this.userData={},this.timeStamp("".concat(this.id," started")),OA(this),Object.seal(this)}return(0,kA.default)(e,[{key:"level",get:function(){return this.getLevel()},set:function(t){this.setLevel(t)}},{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((_n()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((_n()-this._deltaTs).toPrecision(10))}},{key:"priority",get:function(){return this.level},set:function(t){this.level=t}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:t}),this}},{key:"setLevel",value:function(t){return this._storage.updateConfiguration({level:t}),this}},{key:"get",value:function(t){return this._storage.config[t]}},{key:"set",value:function(t,n){this._storage.updateConfiguration((0,FA.default)({},t,n))}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"assert",value:function(t,n){pa(t,n)}},{key:"warn",value:function(t){return this._getLogFunction(0,t,ma.warn,arguments,PA)}},{key:"error",value:function(t){return this._getLogFunction(0,t,ma.error,arguments)}},{key:"deprecated",value:function(t,n){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}},{key:"removed",value:function(t,n){return this.error("`".concat(t,"` has been removed. Use `").concat(n,"` instead"))}},{key:"probe",value:function(t,n){return this._getLogFunction(t,n,ma.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(t,n){return this._getLogFunction(t,n,ma.debug,arguments)}},{key:"info",value:function(t,n){return this._getLogFunction(t,n,console.info,arguments)}},{key:"once",value:function(t,n){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return this._getLogFunction(t,n,ma.debug||ma.info,arguments,PA)}},{key:"table",value:function(t,n,a){return n?this._getLogFunction(t,n,console.table||wt,a&&[a],{tag:v3(n)}):wt}},{key:"image",value:function(t){var n=t.logLevel,a=t.priority,i=t.image,o=t.message,s=o===void 0?"":o,u=t.scale,f=u===void 0?1:u;return this._shouldLog(n||a)?ft?m3({image:i,message:s,scale:f}):p3({image:i,message:s,scale:f}):wt}},{key:"time",value:function(t,n){return this._getLogFunction(t,n,console.time?console.time:console.info)}},{key:"timeEnd",value:function(t,n){return this._getLogFunction(t,n,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(t,n){return this._getLogFunction(t,n,console.timeStamp||wt)}},{key:"group",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1},i=RA({logLevel:t,message:n,opts:a}),o=a.collapsed;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}},{key:"groupCollapsed",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(t,n,Object.assign({},a,{collapsed:!0}))}},{key:"groupEnd",value:function(t){return this._getLogFunction(t,"",console.groupEnd||wt)}},{key:"withGroup",value:function(t,n,a){this.group(t,n)();try{a()}finally{this.groupEnd(t)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(t){return this.isEnabled()&&this.getLevel()>=DA(t)}},{key:"_getLogFunction",value:function(t,n,a,i,o){if(this._shouldLog(t)){var s;o=RA({logLevel:t,message:n,args:i,opts:o}),a=a||o.method,pa(a),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=_n();var u=o.tag||o.message;if(o.once)if(!IA[u])IA[u]=_n();else return wt;return n=d3(this.id,o.message,o),(s=a).bind.apply(s,[console,n].concat((0,xi.default)(o.args)))}return wt}}]),e}();A(va,"VERSION",_s);function DA(e){if(!e)return 0;var r;switch((0,xs.default)(e)){case"number":r=e;break;case"object":r=e.logLevel||e.priority||0;break;default:return 0}return pa(Number.isFinite(r)&&r>=0),r}function RA(e){var r=e.logLevel,t=e.message;e.logLevel=DA(r);for(var n=e.args?Array.from(e.args):[];n.length&&n.shift()!==t;);switch((0,xs.default)(r)){case"string":case"function":t!==void 0&&n.unshift(t),e.message=r;break;case"object":Object.assign(e,r);break;default:}typeof e.message=="function"&&(e.message=e.message());var a=(0,xs.default)(e.message);return pa(a==="string"||a==="object"),Object.assign(e,{args:n},e.opts)}function d3(e,r,t){if(typeof r=="string"){var n=t.time?CA(SA(t.total)):"";r=t.time?"".concat(e,": ").concat(n,"  ").concat(r):"".concat(e,": ").concat(r),r=BA(r,t.color,t.background)}return r}function p3(e){var r=e.image,t=e.message,n=t===void 0?"":t,a=e.scale,i=a===void 0?1:a,o=null;try{o=module.require("asciify-image")}catch{}return o?function(){return o(r,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then(function(s){return console.log(s)})}:wt}function m3(e){var r=e.image,t=e.message,n=t===void 0?"":t,a=e.scale,i=a===void 0?1:a;if(typeof r=="string"){var o=new Image;return o.onload=function(){var l,c=bs(o,n,i);(l=console).log.apply(l,(0,xi.default)(c))},o.src=r,wt}var s=r.nodeName||"";if(s.toLowerCase()==="img"){var u;return(u=console).log.apply(u,(0,xi.default)(bs(r,n,i))),wt}if(s.toLowerCase()==="canvas"){var f=new Image;return f.onload=function(){var l;return(l=console).log.apply(l,(0,xi.default)(bs(f,n,i)))},f.src=r.toDataURL(),wt}return wt}function v3(e){for(var r in e)for(var t in e[r])return t||"untitled";return"empty"}var lW=new va({id:"@probe.gl/log"});var oe=new va({id:"luma.gl"});function Ue(e,r){if(!e)throw new Error(r||"luma.gl: assertion failed.")}var g3="Invalid WebGLRenderingContext";var y3="Requires WebGL2";function Es(e){return typeof WebGLRenderingContext<"u"&&e instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:Boolean(e&&Number.isFinite(e._version))}function he(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:Boolean(e&&e._version===2)}function Gc(e){return he(e)?e:null}function Ei(e){return Ue(Es(e),g3),e}function Ke(e){return Ue(he(e),y3),e}var Si={};function A3(e){globalThis.console&&globalThis.console.error&&globalThis.console.error(e)}function _3(e){globalThis.console&&globalThis.console.log&&globalThis.console.log(e)}function b3(e,r){Si[e]=!0,r!==void 0&&A3(r)}function T3(e){var r=e.getError;e.getError=function(){var n;do n=r.apply(e),n!==0&&(Si[n]=!0);while(n!==0);for(n in Si)if(Si[n])return delete Si[n],parseInt(n,10);return 0}}var Ci=function e(r){var t=r.gl;this.ext=r,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(r.maxVertexAttribs);for(var n=0;n<this.attribs.length;n++){var a=new e.VertexAttrib(t);this.attribs[n]=a}this.maxAttrib=0};Ci.VertexAttrib=function(r){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Ci.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var bn=function(r){var t=this;this.gl=r,T3(r);var n=this.original={getParameter:r.getParameter,enableVertexAttribArray:r.enableVertexAttribArray,disableVertexAttribArray:r.disableVertexAttribArray,bindBuffer:r.bindBuffer,getVertexAttrib:r.getVertexAttrib,vertexAttribPointer:r.vertexAttribPointer};r.getParameter=function(i){return i===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:n.getParameter.apply(this,arguments)},r.enableVertexAttribArray=function(i){var o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,i);var s=o.attribs[i];return s.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},r.disableVertexAttribArray=function(i){var o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,i);var s=o.attribs[i];return s.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},r.bindBuffer=function(i,o){switch(i){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o;break;default:}return n.bindBuffer.apply(this,arguments)},r.getVertexAttrib=function(i,o){var s=t.currentVertexArrayObject,u=s.attribs[i];switch(o){case 34975:return u.buffer;case 34338:return u.enabled;case 34339:return u.size;case 34340:return u.stride;case 34341:return u.type;case 34922:return u.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},r.vertexAttribPointer=function(i,o,s,u,f,l){var c=t.currentVertexArrayObject;c.maxAttrib=Math.max(c.maxAttrib,i);var h=c.attribs[i];return h.buffer=t.currentArrayBuffer,h.size=o,h.type=s,h.normalized=u,h.stride=f,h.offset=l,h.recache(),n.vertexAttribPointer.apply(this,arguments)},r.instrumentExtension&&r.instrumentExtension(this,"OES_vertex_array_object"),r.canvas&&r.canvas.addEventListener("webglcontextrestored",function(){_3("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};bn.prototype.VERTEX_ARRAY_BINDING_OES=34229;bn.prototype.reset_=function(){var r=this.vertexArrayObjects!==void 0;if(r)for(var t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;var n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Ci(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};bn.prototype.createVertexArrayOES=function(){var r=new Ci(this);return this.vertexArrayObjects.push(r),r};bn.prototype.deleteVertexArrayOES=function(r){r.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(r),1),this.currentVertexArrayObject===r&&this.bindVertexArrayOES(null)};bn.prototype.isVertexArrayOES=function(r){return!!(r&&r instanceof Ci&&r.hasBeenBound&&r.ext===this)};bn.prototype.bindVertexArrayOES=function(r){var t=this.gl;if(r&&!r.isAlive){b3(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}var n=this.original,a=this.currentVertexArrayObject;this.currentVertexArrayObject=r||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var i=this.currentVertexArrayObject;if(a!==i){(!a||i.elementArrayBuffer!==a.elementArrayBuffer)&&n.bindBuffer.call(t,34963,i.elementArrayBuffer);for(var o=this.currentArrayBuffer,s=Math.max(a?a.maxAttrib:0,i.maxAttrib),u=0;u<=s;u++){var f=i.attribs[u],l=a?a.attribs[u]:null;if((!a||f.enabled!==l.enabled)&&(f.enabled?n.enableVertexAttribArray.call(t,u):n.disableVertexAttribArray.call(t,u)),f.enabled){var c=!1;(!a||f.buffer!==l.buffer)&&(o!==f.buffer&&(n.bindBuffer.call(t,34962,f.buffer),o=f.buffer),c=!0),(c||f.cached!==l.cached)&&n.vertexAttribPointer.call(t,u,f.size,f.type,f.normalized,f.stride,f.offset)}}this.currentArrayBuffer!==o&&n.bindBuffer.call(t,34962,this.currentArrayBuffer)}};function GA(e){if(typeof e.createVertexArray!="function"){var r=e.getSupportedExtensions;e.getSupportedExtensions=function(){var a=r.call(this)||[];return a.indexOf("OES_vertex_array_object")<0&&a.push("OES_vertex_array_object"),a};var t=e.getExtension;e.getExtension=function(a){var i=t.call(this,a);return i||(a!=="OES_vertex_array_object"?null:(e.__OESVertexArrayObject||(this.__OESVertexArrayObject=new bn(this)),this.__OESVertexArrayObject))}}}var wi=m(W());var ae=m(W());var re,NA="OES_element_index",UA="WEBGL_draw_buffers",x3="EXT_disjoint_timer_query",E3="EXT_disjoint_timer_query_webgl2",S3="EXT_texture_filter_anisotropic",jA="WEBGL_debug_renderer_info",C3=35723,w3=4352,B3=36795,M3=34047,O3=37445,I3=37446,Se=function(r){return he(r)?void 0:0},P3=(re={},(0,ae.default)(re,3074,function(r){return he(r)?void 0:36064}),(0,ae.default)(re,C3,function(e){return he(e)?void 0:w3}),(0,ae.default)(re,35977,Se),(0,ae.default)(re,32937,Se),(0,ae.default)(re,B3,function(e,r){var t=he(e)?e.getExtension(E3):e.getExtension(x3);return t&&t.GPU_DISJOINT_EXT?r(t.GPU_DISJOINT_EXT):0}),(0,ae.default)(re,O3,function(e,r){var t=e.getExtension(jA);return r(t&&t.UNMASKED_VENDOR_WEBGL||7936)}),(0,ae.default)(re,I3,function(e,r){var t=e.getExtension(jA);return r(t&&t.UNMASKED_RENDERER_WEBGL||7937)}),(0,ae.default)(re,M3,function(e,r){var t=e.luma.extensions[S3];return t?r(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1}),(0,ae.default)(re,32883,Se),(0,ae.default)(re,35071,Se),(0,ae.default)(re,37447,Se),(0,ae.default)(re,36063,function(r,t){if(!he(r)){var n=r.getExtension(UA);return n?t(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}}),(0,ae.default)(re,35379,Se),(0,ae.default)(re,35374,Se),(0,ae.default)(re,35377,Se),(0,ae.default)(re,34852,function(r){if(!he(r)){var t=r.getExtension(UA);return t?t.MAX_DRAW_BUFFERS_WEBGL:0}}),(0,ae.default)(re,36203,function(r){return r.getExtension(NA)?2147483647:65535}),(0,ae.default)(re,33001,function(r){return r.getExtension(NA)?16777216:65535}),(0,ae.default)(re,33e3,function(r){return 16777216}),(0,ae.default)(re,37157,Se),(0,ae.default)(re,35373,Se),(0,ae.default)(re,35657,Se),(0,ae.default)(re,36183,Se),(0,ae.default)(re,37137,Se),(0,ae.default)(re,34045,Se),(0,ae.default)(re,35978,Se),(0,ae.default)(re,35979,Se),(0,ae.default)(re,35968,Se),(0,ae.default)(re,35376,Se),(0,ae.default)(re,35375,Se),(0,ae.default)(re,35659,Se),(0,ae.default)(re,37154,Se),(0,ae.default)(re,35371,Se),(0,ae.default)(re,35658,Se),(0,ae.default)(re,35076,Se),(0,ae.default)(re,35077,Se),(0,ae.default)(re,35380,Se),re);function HA(e,r,t){var n=P3[t],a=typeof n=="function"?n(e,r,t):n,i=a!==void 0?a:r(t);return i}var ga,R3="OES_vertex_array_object",VA="ANGLE_instanced_arrays",F3="WEBGL_draw_buffers",L3="EXT_disjoint_timer_query",k3="EXT_texture_filter_anisotropic",D3="VertexArray requires WebGL2 or OES_vertex_array_object extension";function G3(e,r){return{webgl2:he(e),ext:e.getExtension(r)}}var Nc=(ga={},(0,wi.default)(ga,R3,{meta:{suffix:"OES"},createVertexArray:function(){Ue(!1,D3)},deleteVertexArray:function(){},bindVertexArray:function(){},isVertexArray:function(){return!1}}),(0,wi.default)(ga,VA,{meta:{suffix:"ANGLE"},vertexAttribDivisor:function(r,t){Ue(t===0,"WebGL instanced rendering not supported")},drawElementsInstanced:function(){},drawArraysInstanced:function(){}}),(0,wi.default)(ga,F3,{meta:{suffix:"WEBGL"},drawBuffers:function(){Ue(!1)}}),(0,wi.default)(ga,L3,{meta:{suffix:"EXT"},createQuery:function(){Ue(!1)},deleteQuery:function(){Ue(!1)},beginQuery:function(){Ue(!1)},endQuery:function(){},getQuery:function(r,t){return this.getQueryObject(r,t)},getQueryParameter:function(r,t){return this.getQueryObject(r,t)},getQueryObject:function(){}}),ga),Ss={readBuffer:function(r,t,n){he(r)&&t(n)},getVertexAttrib:function(r,t,n,a){var i=G3(r,VA),o=i.webgl2,s=i.ext,u;switch(a){case 35069:u=o?void 0:!1;break;case 35070:u=!o&&!s?0:void 0;break;default:}return u!==void 0?u:t(n,a)},getProgramParameter:function(r,t,n,a){if(!he(r))switch(a){case 35967:return 35981;case 35971:return 0;case 35382:return 0;default:}return t(n,a)},getInternalformatParameter:function(r,t,n,a,i){if(!he(r))switch(i){case 32937:return new Int32Array([0]);default:}return r.getInternalformatParameter(n,a,i)},getTexParameter:function(r,t,n,a){switch(a){case 34046:var i=r.luma.extensions,o=i[k3];a=o&&o.TEXTURE_MAX_ANISOTROPY_EXT||34046;break;default:}return t(n,a)},getParameter:HA,hint:function(r,t,n,a){return t(n,a)}};function WA(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=N3(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function N3(e,r){if(e){if(typeof e=="string")return zA(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zA(e,r)}}function zA(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function JA(e){e.luma=e.luma||{};var r=e.luma;return r.polyfilled||(GA(e),U3(e),H3(e,Nc),j3(e,{target:r,target2:e}),r.polyfilled=!0),e}globalThis.polyfillContext=JA;function U3(e){e.luma.extensions={};var r=e.getSupportedExtensions()||[],t=WA(r),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;e.luma[a]=e.getExtension(a)}}catch(i){t.e(i)}finally{t.f()}}function j3(e,r){var t=r.target,n=r.target2;Object.keys(Ss).forEach(function(a){if(typeof Ss[a]=="function"){var i=e[a]?e[a].bind(e):function(){},o=Ss[a].bind(null,e,i);t[a]=o,n[a]=o}})}function H3(e,r){var t=WA(Object.getOwnPropertyNames(r)),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;a!=="overrides"&&V3(e,{extension:a,target:e.luma,target2:e})}}catch(i){t.e(i)}finally{t.f()}}function V3(e,r){var t=r.extension,n=r.target,a=r.target2,i=Nc[t];Ue(i);for(var o=i.meta,s=o===void 0?{}:o,u=s.suffix,f=u===void 0?"":u,l=e.getExtension(t),c=function(){var v=d[h],g="".concat(v).concat(f),y=null;v==="meta"||typeof e[v]=="function"||(l&&typeof l[g]=="function"?y=function(){return l[g].apply(l,arguments)}:typeof i[v]=="function"&&(y=i[v].bind(n))),y&&(n[v]=y,a[v]=y)},h=0,d=Object.keys(i);h<d.length;h++)c()}var Cs=m(ce()),Ie=m(St()),x=m(W());var V,N,Bt,ws=(V={},(0,x.default)(V,3042,!1),(0,x.default)(V,32773,new Float32Array([0,0,0,0])),(0,x.default)(V,32777,32774),(0,x.default)(V,34877,32774),(0,x.default)(V,32969,1),(0,x.default)(V,32968,0),(0,x.default)(V,32971,1),(0,x.default)(V,32970,0),(0,x.default)(V,3106,new Float32Array([0,0,0,0])),(0,x.default)(V,3107,[!0,!0,!0,!0]),(0,x.default)(V,2884,!1),(0,x.default)(V,2885,1029),(0,x.default)(V,2929,!1),(0,x.default)(V,2931,1),(0,x.default)(V,2932,513),(0,x.default)(V,2928,new Float32Array([0,1])),(0,x.default)(V,2930,!0),(0,x.default)(V,3024,!0),(0,x.default)(V,36006,null),(0,x.default)(V,2886,2305),(0,x.default)(V,33170,4352),(0,x.default)(V,2849,1),(0,x.default)(V,32823,!1),(0,x.default)(V,32824,0),(0,x.default)(V,10752,0),(0,x.default)(V,32938,1),(0,x.default)(V,32939,!1),(0,x.default)(V,3089,!1),(0,x.default)(V,3088,new Int32Array([0,0,1024,1024])),(0,x.default)(V,2960,!1),(0,x.default)(V,2961,0),(0,x.default)(V,2968,4294967295),(0,x.default)(V,36005,4294967295),(0,x.default)(V,2962,519),(0,x.default)(V,2967,0),(0,x.default)(V,2963,4294967295),(0,x.default)(V,34816,519),(0,x.default)(V,36003,0),(0,x.default)(V,36004,4294967295),(0,x.default)(V,2964,7680),(0,x.default)(V,2965,7680),(0,x.default)(V,2966,7680),(0,x.default)(V,34817,7680),(0,x.default)(V,34818,7680),(0,x.default)(V,34819,7680),(0,x.default)(V,2978,[0,0,1024,1024]),(0,x.default)(V,3333,4),(0,x.default)(V,3317,4),(0,x.default)(V,37440,!1),(0,x.default)(V,37441,!1),(0,x.default)(V,37443,37444),(0,x.default)(V,35723,4352),(0,x.default)(V,36010,null),(0,x.default)(V,35977,!1),(0,x.default)(V,3330,0),(0,x.default)(V,3332,0),(0,x.default)(V,3331,0),(0,x.default)(V,3314,0),(0,x.default)(V,32878,0),(0,x.default)(V,3316,0),(0,x.default)(V,3315,0),(0,x.default)(V,32877,0),V),Lr=function(r,t,n){return t?r.enable(n):r.disable(n)},qA=function(r,t,n){return r.hint(n,t)},bt=function(r,t,n){return r.pixelStorei(n,t)},z3=function(r,t){var n=he(r)?36009:36160;return r.bindFramebuffer(n,t)},W3=function(r,t){return r.bindFramebuffer(36008,t)};function Bi(e){return Array.isArray(e)||ArrayBuffer.isView(e)}var XA=(N={},(0,x.default)(N,3042,Lr),(0,x.default)(N,32773,function(r,t){return r.blendColor.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,32777,"blendEquation"),(0,x.default)(N,34877,"blendEquation"),(0,x.default)(N,32969,"blendFunc"),(0,x.default)(N,32968,"blendFunc"),(0,x.default)(N,32971,"blendFunc"),(0,x.default)(N,32970,"blendFunc"),(0,x.default)(N,3106,function(r,t){return r.clearColor.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,3107,function(r,t){return r.colorMask.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,2884,Lr),(0,x.default)(N,2885,function(r,t){return r.cullFace(t)}),(0,x.default)(N,2929,Lr),(0,x.default)(N,2931,function(r,t){return r.clearDepth(t)}),(0,x.default)(N,2932,function(r,t){return r.depthFunc(t)}),(0,x.default)(N,2928,function(r,t){return r.depthRange.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,2930,function(r,t){return r.depthMask(t)}),(0,x.default)(N,3024,Lr),(0,x.default)(N,35723,qA),(0,x.default)(N,36006,z3),(0,x.default)(N,2886,function(r,t){return r.frontFace(t)}),(0,x.default)(N,33170,qA),(0,x.default)(N,2849,function(r,t){return r.lineWidth(t)}),(0,x.default)(N,32823,Lr),(0,x.default)(N,32824,"polygonOffset"),(0,x.default)(N,10752,"polygonOffset"),(0,x.default)(N,35977,Lr),(0,x.default)(N,32938,"sampleCoverage"),(0,x.default)(N,32939,"sampleCoverage"),(0,x.default)(N,3089,Lr),(0,x.default)(N,3088,function(r,t){return r.scissor.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,2960,Lr),(0,x.default)(N,2961,function(r,t){return r.clearStencil(t)}),(0,x.default)(N,2968,function(r,t){return r.stencilMaskSeparate(1028,t)}),(0,x.default)(N,36005,function(r,t){return r.stencilMaskSeparate(1029,t)}),(0,x.default)(N,2962,"stencilFuncFront"),(0,x.default)(N,2967,"stencilFuncFront"),(0,x.default)(N,2963,"stencilFuncFront"),(0,x.default)(N,34816,"stencilFuncBack"),(0,x.default)(N,36003,"stencilFuncBack"),(0,x.default)(N,36004,"stencilFuncBack"),(0,x.default)(N,2964,"stencilOpFront"),(0,x.default)(N,2965,"stencilOpFront"),(0,x.default)(N,2966,"stencilOpFront"),(0,x.default)(N,34817,"stencilOpBack"),(0,x.default)(N,34818,"stencilOpBack"),(0,x.default)(N,34819,"stencilOpBack"),(0,x.default)(N,2978,function(r,t){return r.viewport.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,3333,bt),(0,x.default)(N,3317,bt),(0,x.default)(N,37440,bt),(0,x.default)(N,37441,bt),(0,x.default)(N,37443,bt),(0,x.default)(N,3330,bt),(0,x.default)(N,3332,bt),(0,x.default)(N,3331,bt),(0,x.default)(N,36010,W3),(0,x.default)(N,3314,bt),(0,x.default)(N,32878,bt),(0,x.default)(N,3316,bt),(0,x.default)(N,3315,bt),(0,x.default)(N,32877,bt),(0,x.default)(N,"framebuffer",function(r,t){var n=t&&"handle"in t?t.handle:t;return r.bindFramebuffer(36160,n)}),(0,x.default)(N,"blend",function(r,t){return t?r.enable(3042):r.disable(3042)}),(0,x.default)(N,"blendColor",function(r,t){return r.blendColor.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,"blendEquation",function(r,t){t=Bi(t)?t:[t,t],r.blendEquationSeparate.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,"blendFunc",function(r,t){t=Bi(t)&&t.length===2?[].concat((0,Ie.default)(t),(0,Ie.default)(t)):t,r.blendFuncSeparate.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,"clearColor",function(r,t){return r.clearColor.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,"clearDepth",function(r,t){return r.clearDepth(t)}),(0,x.default)(N,"clearStencil",function(r,t){return r.clearStencil(t)}),(0,x.default)(N,"colorMask",function(r,t){return r.colorMask.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,"cull",function(r,t){return t?r.enable(2884):r.disable(2884)}),(0,x.default)(N,"cullFace",function(r,t){return r.cullFace(t)}),(0,x.default)(N,"depthTest",function(r,t){return t?r.enable(2929):r.disable(2929)}),(0,x.default)(N,"depthFunc",function(r,t){return r.depthFunc(t)}),(0,x.default)(N,"depthMask",function(r,t){return r.depthMask(t)}),(0,x.default)(N,"depthRange",function(r,t){return r.depthRange.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,"dither",function(r,t){return t?r.enable(3024):r.disable(3024)}),(0,x.default)(N,"derivativeHint",function(r,t){r.hint(35723,t)}),(0,x.default)(N,"frontFace",function(r,t){return r.frontFace(t)}),(0,x.default)(N,"mipmapHint",function(r,t){return r.hint(33170,t)}),(0,x.default)(N,"lineWidth",function(r,t){return r.lineWidth(t)}),(0,x.default)(N,"polygonOffsetFill",function(r,t){return t?r.enable(32823):r.disable(32823)}),(0,x.default)(N,"polygonOffset",function(r,t){return r.polygonOffset.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,"sampleCoverage",function(r,t){return r.sampleCoverage.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,"scissorTest",function(r,t){return t?r.enable(3089):r.disable(3089)}),(0,x.default)(N,"scissor",function(r,t){return r.scissor.apply(r,(0,Ie.default)(t))}),(0,x.default)(N,"stencilTest",function(r,t){return t?r.enable(2960):r.disable(2960)}),(0,x.default)(N,"stencilMask",function(r,t){t=Bi(t)?t:[t,t];var n=t,a=(0,Cs.default)(n,2),i=a[0],o=a[1];r.stencilMaskSeparate(1028,i),r.stencilMaskSeparate(1029,o)}),(0,x.default)(N,"stencilFunc",function(r,t){t=Bi(t)&&t.length===3?[].concat((0,Ie.default)(t),(0,Ie.default)(t)):t;var n=t,a=(0,Cs.default)(n,6),i=a[0],o=a[1],s=a[2],u=a[3],f=a[4],l=a[5];r.stencilFuncSeparate(1028,i,o,s),r.stencilFuncSeparate(1029,u,f,l)}),(0,x.default)(N,"stencilOp",function(r,t){t=Bi(t)&&t.length===3?[].concat((0,Ie.default)(t),(0,Ie.default)(t)):t;var n=t,a=(0,Cs.default)(n,6),i=a[0],o=a[1],s=a[2],u=a[3],f=a[4],l=a[5];r.stencilOpSeparate(1028,i,o,s),r.stencilOpSeparate(1029,u,f,l)}),(0,x.default)(N,"viewport",function(r,t){return r.viewport.apply(r,(0,Ie.default)(t))}),N);function Fe(e,r,t){return r[e]!==void 0?r[e]:t[e]}var YA={blendEquation:function(r,t,n){return r.blendEquationSeparate(Fe(32777,t,n),Fe(34877,t,n))},blendFunc:function(r,t,n){return r.blendFuncSeparate(Fe(32969,t,n),Fe(32968,t,n),Fe(32971,t,n),Fe(32970,t,n))},polygonOffset:function(r,t,n){return r.polygonOffset(Fe(32824,t,n),Fe(10752,t,n))},sampleCoverage:function(r,t,n){return r.sampleCoverage(Fe(32938,t,n),Fe(32939,t,n))},stencilFuncFront:function(r,t,n){return r.stencilFuncSeparate(1028,Fe(2962,t,n),Fe(2967,t,n),Fe(2963,t,n))},stencilFuncBack:function(r,t,n){return r.stencilFuncSeparate(1029,Fe(34816,t,n),Fe(36003,t,n),Fe(36004,t,n))},stencilOpFront:function(r,t,n){return r.stencilOpSeparate(1028,Fe(2964,t,n),Fe(2965,t,n),Fe(2966,t,n))},stencilOpBack:function(r,t,n){return r.stencilOpSeparate(1029,Fe(34817,t,n),Fe(34818,t,n),Fe(34819,t,n))}},Uc={enable:function(r,t){return r((0,x.default)({},t,!0))},disable:function(r,t){return r((0,x.default)({},t,!1))},pixelStorei:function(r,t,n){return r((0,x.default)({},t,n))},hint:function(r,t,n){return r((0,x.default)({},t,n))},bindFramebuffer:function(r,t,n){var a;switch(t){case 36160:return r((a={},(0,x.default)(a,36006,n),(0,x.default)(a,36010,n),a));case 36009:return r((0,x.default)({},36006,n));case 36008:return r((0,x.default)({},36010,n));default:return null}},blendColor:function(r,t,n,a,i){return r((0,x.default)({},32773,new Float32Array([t,n,a,i])))},blendEquation:function(r,t){var n;return r((n={},(0,x.default)(n,32777,t),(0,x.default)(n,34877,t),n))},blendEquationSeparate:function(r,t,n){var a;return r((a={},(0,x.default)(a,32777,t),(0,x.default)(a,34877,n),a))},blendFunc:function(r,t,n){var a;return r((a={},(0,x.default)(a,32969,t),(0,x.default)(a,32968,n),(0,x.default)(a,32971,t),(0,x.default)(a,32970,n),a))},blendFuncSeparate:function(r,t,n,a,i){var o;return r((o={},(0,x.default)(o,32969,t),(0,x.default)(o,32968,n),(0,x.default)(o,32971,a),(0,x.default)(o,32970,i),o))},clearColor:function(r,t,n,a,i){return r((0,x.default)({},3106,new Float32Array([t,n,a,i])))},clearDepth:function(r,t){return r((0,x.default)({},2931,t))},clearStencil:function(r,t){return r((0,x.default)({},2961,t))},colorMask:function(r,t,n,a,i){return r((0,x.default)({},3107,[t,n,a,i]))},cullFace:function(r,t){return r((0,x.default)({},2885,t))},depthFunc:function(r,t){return r((0,x.default)({},2932,t))},depthRange:function(r,t,n){return r((0,x.default)({},2928,new Float32Array([t,n])))},depthMask:function(r,t){return r((0,x.default)({},2930,t))},frontFace:function(r,t){return r((0,x.default)({},2886,t))},lineWidth:function(r,t){return r((0,x.default)({},2849,t))},polygonOffset:function(r,t,n){var a;return r((a={},(0,x.default)(a,32824,t),(0,x.default)(a,10752,n),a))},sampleCoverage:function(r,t,n){var a;return r((a={},(0,x.default)(a,32938,t),(0,x.default)(a,32939,n),a))},scissor:function(r,t,n,a,i){return r((0,x.default)({},3088,new Int32Array([t,n,a,i])))},stencilMask:function(r,t){var n;return r((n={},(0,x.default)(n,2968,t),(0,x.default)(n,36005,t),n))},stencilMaskSeparate:function(r,t,n){return r((0,x.default)({},t===1028?2968:36005,n))},stencilFunc:function(r,t,n,a){var i;return r((i={},(0,x.default)(i,2962,t),(0,x.default)(i,2967,n),(0,x.default)(i,2963,a),(0,x.default)(i,34816,t),(0,x.default)(i,36003,n),(0,x.default)(i,36004,a),i))},stencilFuncSeparate:function(r,t,n,a,i){var o;return r((o={},(0,x.default)(o,t===1028?2962:34816,n),(0,x.default)(o,t===1028?2967:36003,a),(0,x.default)(o,t===1028?2963:36004,i),o))},stencilOp:function(r,t,n,a){var i;return r((i={},(0,x.default)(i,2964,t),(0,x.default)(i,2965,n),(0,x.default)(i,2966,a),(0,x.default)(i,34817,t),(0,x.default)(i,34818,n),(0,x.default)(i,34819,a),i))},stencilOpSeparate:function(r,t,n,a,i){var o;return r((o={},(0,x.default)(o,t===1028?2964:34817,n),(0,x.default)(o,t===1028?2965:34818,a),(0,x.default)(o,t===1028?2966:34819,i),o))},viewport:function(r,t,n,a,i){return r((0,x.default)({},2978,[t,n,a,i]))}},Xt=function(r,t){return r.isEnabled(t)},jc=(Bt={},(0,x.default)(Bt,3042,Xt),(0,x.default)(Bt,2884,Xt),(0,x.default)(Bt,2929,Xt),(0,x.default)(Bt,3024,Xt),(0,x.default)(Bt,32823,Xt),(0,x.default)(Bt,32926,Xt),(0,x.default)(Bt,32928,Xt),(0,x.default)(Bt,3089,Xt),(0,x.default)(Bt,2960,Xt),(0,x.default)(Bt,35977,Xt),Bt);var ZA=m(H()),$A=m(z());function Hc(e){for(var r in e)return!1;return!0}function KA(e,r){if(e===r)return!0;var t=Array.isArray(e)||ArrayBuffer.isView(e),n=Array.isArray(r)||ArrayBuffer.isView(r);if(t&&n&&e.length===r.length){for(var a=0;a<e.length;++a)if(e[a]!==r[a])return!1;return!0}return!1}function QA(e,r){var t=e[r].bind(e);e[r]=function(){var a=arguments.length<=0?void 0:arguments[0];return a in e.state.cache&&e.state.enable?e.state.cache[a]:t.apply(void 0,arguments)},Object.defineProperty(e[r],"name",{value:"".concat(r,"-from-cache"),configurable:!1})}function J3(e,r,t){var n=e[r].bind(e);e[r]=function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];var u=t.apply(void 0,[e.state._updateCache].concat(o)),f=u.valueChanged,l=u.oldValue;return f&&n.apply(void 0,o),l},Object.defineProperty(e[r],"name",{value:"".concat(r,"-to-cache"),configurable:!1})}function q3(e){var r=e.useProgram.bind(e);e.useProgram=function(n){e.state.program!==n&&(r(n),e.state.program=n)}}var X3=function(){function e(r){(0,ZA.default)(this,e);var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.copyState,a=n===void 0?!1:n,i=t.log,o=i===void 0?function(){}:i;this.gl=r,this.program=null,this.stateStack=[],this.enable=!0,this.cache=a?Wc(r):Object.assign({},ws),this.log=o,this._updateCache=this._updateCache.bind(this),Object.seal(this)}return(0,$A.default)(e,[{key:"push",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.stateStack.push({})}},{key:"pop",value:function(){Ue(this.stateStack.length>0);var t=this.stateStack[this.stateStack.length-1];Ms(this.gl,t),this.stateStack.pop()}},{key:"_updateCache",value:function(t){var n=!1,a,i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(var o in t){Ue(o!==void 0);var s=t[o],u=this.cache[o];KA(s,u)||(n=!0,a=u,i&&!(o in i)&&(i[o]=u),this.cache[o]=s)}return{valueChanged:n,oldValue:a}}}]),e}();function Vc(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.enable,n=t===void 0?!0:t,a=r.copyState;if(Ue(a!==void 0),!e.state){var i=globalThis.polyfillContext;i&&i(e),e.state=new X3(e,{copyState:a}),q3(e);for(var o in Uc){var s=Uc[o];J3(e,o,s)}QA(e,"getParameter"),QA(e,"isEnabled")}return e.state.enable=n,e}function zc(e){e.state||Vc(e,{copyState:!1}),e.state.push()}function Bs(e){Ue(e.state),e.state.pop()}function Y3(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=K3(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function K3(e,r){if(e){if(typeof e=="string")return e_(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return e_(e,r)}}function e_(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Ms(e,r){if(Ue(Es(e),"setParameters requires a WebGL context"),!Hc(r)){var t={};for(var n in r){var a=Number(n),i=XA[n];i&&(typeof i=="string"?t[i]=!0:i(e,r[n],a))}var o=e.state&&e.state.cache;if(o)for(var s in t){var u=YA[s];u(e,r,o)}}}function Wc(e,r){if(r=r||ws,typeof r=="number"){var t=r,n=jc[t];return n?n(e,t):e.getParameter(t)}var a=Array.isArray(r)?r:Object.keys(r),i={},o=Y3(a),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,f=jc[u];i[u]=f?f(e,Number(u)):e.getParameter(Number(u))}}catch(l){o.e(l)}finally{o.f()}return i}function ur(e,r,t){if(Hc(r))return t(e);var n=r.nocatch,a=n===void 0?!0:n;zc(e),Ms(e,r);var i;if(a)i=t(e),Bs(e);else try{i=t(e)}finally{Bs(e)}return i}var QW=ft();var t_=m(H()),r_=m(z());var Mi="8.5.16",Q3="set luma.log.level=1 (or higher) to trace rendering",Jc=function(){function e(){(0,t_.default)(this,e),this.stats=new Map}return(0,r_.default)(e,[{key:"get",value:function(t){return this.stats.has(t)||this.stats.set(t,new on({id:t})),this.stats.get(t)}}]),e}(),ya=new Jc;if(globalThis.luma&&globalThis.luma.VERSION!==Mi)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Mi));globalThis.luma||(ft()&&oe.log(1,"luma.gl ".concat(Mi," - ").concat(Q3))(),globalThis.luma=globalThis.luma||{VERSION:Mi,version:Mi,log:oe,stats:ya,globals:{modules:{},nodeIO:{}}});var gJ=globalThis.luma;var lb=m(W());var P_=m(H()),R_=m(z()),F_=m(at()),L_=m(Te()),k_=m(xe()),$c=m(Ae());var C_=m(ce()),w_=m(H()),B_=m(z()),M_=m(Te()),O_=m(xe()),Qc=m(Ae());var i_=m(H()),o_=m(z());function Q(e,r){if(!e)throw new Error(r||"luma.gl: assertion failed.")}function Os(e,r){if(typeof r!="string")return r;var t=Number(r);if(!isNaN(t))return t;r=r.replace(/^.*\./,"");var n=e[r];return Q(n!==void 0,"Accessing undefined constant GL.".concat(r)),n}function Tn(e,r){r=Number(r);for(var t in e)if(e[t]===r)return"GL.".concat(t);return String(r)}var qc={};function Is(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";qc[e]=qc[e]||1;var r=qc[e]++;return"".concat(e,"-").concat(r)}function Xc(e){return Q(typeof e=="number","Input must be a number"),e&&(e&e-1)===0}function n_(e,r,t,n){var a="See luma.gl ".concat(t," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),i=Object.getPrototypeOf(e);n.forEach(function(o){i.methodName||(i[o]=function(){throw oe.removed("Calling removed method ".concat(r,".").concat(o,": "),a)(),new Error(o)})})}function Z3(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=$3(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function $3(e,r){if(e){if(typeof e=="string")return a_(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return a_(e,r)}}function a_(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Aa="Resource subclass must define virtual methods",kr=function(e){function r(t){(0,i_.default)(this,r);var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ei(t);var a=n.id,i=n.userData,o=i===void 0?{}:i;this.gl=t,this.gl2=t,this.id=a||Is(this[Symbol.toStringTag]),this.userData=o,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._initStats(),this._addStats()}return(0,o_.default)(r,[{key:e,get:function(){return"Resource"}},{key:"toString",value:function(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}},{key:"handle",get:function(){return this._handle}},{key:"delete",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=n.deleteChildren,i=a===void 0?!1:a,o=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,o&&i&&o.filter(Boolean).forEach(function(s){return s.delete()}),this}},{key:"bind",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof n!="function")return this._bindHandle(n),this;var a;return this._bound?a=n():(this._bindHandle(this.handle),this._bound=!0,a=n(),this._bound=!1,this._bindHandle(null)),a}},{key:"unbind",value:function(){this.bind(null)}},{key:"getParameter",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};n=Os(this.gl,n),Q(n);var i=this.constructor.PARAMETERS||{},o=i[n];if(o){var s=he(this.gl),u=(!("webgl2"in o)||s)&&(!("extension"in o)||this.gl.getExtension(o.extension));if(!u){var f=o.webgl1,l="webgl2"in o?o.webgl2:o.webgl1,c=s?l:f;return c}}return this._getParameter(n,a)}},{key:"getParameters",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=n.parameters,i=n.keys,o=this.constructor.PARAMETERS||{},s=he(this.gl),u={},f=a||Object.keys(o),l=Z3(f),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,d=o[h],p=d&&(!("webgl2"in d)||s)&&(!("extension"in d)||this.gl.getExtension(d.extension));if(p){var v=i?Tn(this.gl,h):h;u[v]=this.getParameter(h,n),i&&d.type==="GLenum"&&(u[v]=Tn(this.gl,u[v]))}}}catch(g){l.e(g)}finally{l.f()}return u}},{key:"setParameter",value:function(n,a){n=Os(this.gl,n),Q(n);var i=this.constructor.PARAMETERS||{},o=i[n];if(o){var s=he(this.gl),u=(!("webgl2"in o)||s)&&(!("extension"in o)||this.gl.getExtension(o.extension));if(!u)throw new Error("Parameter not available on this platform");o.type==="GLenum"&&(a=Os(a))}return this._setParameter(n,a),this}},{key:"setParameters",value:function(n){for(var a in n)this.setParameter(a,n[a]);return this}},{key:"stubRemovedMethods",value:function(n,a,i){return n_(this,n,a,i)}},{key:"initialize",value:function(n){}},{key:"_createHandle",value:function(){throw new Error(Aa)}},{key:"_deleteHandle",value:function(){throw new Error(Aa)}},{key:"_bindHandle",value:function(n){throw new Error(Aa)}},{key:"_getOptsFromHandle",value:function(){throw new Error(Aa)}},{key:"_getParameter",value:function(n,a){throw new Error(Aa)}},{key:"_setParameter",value:function(n,a){throw new Error(Aa)}},{key:"_context",value:function(){return this.gl.luma=this.gl.luma||{},this.gl.luma}},{key:"_initStats",value:function(){this.gl.stats=this.gl.stats||new Jc}},{key:"_addStats",value:function(){var n=this[Symbol.toStringTag],a=ya.get("Resource Counts");a.get("Resources Created").incrementCount(),a.get("".concat(n,"s Created")).incrementCount(),a.get("".concat(n,"s Active")).incrementCount()}},{key:"_removeStats",value:function(){var n=this[Symbol.toStringTag],a=ya.get("Resource Counts");a.get("".concat(n,"s Active")).decrementCount()}},{key:"_trackAllocatedMemory",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._doTrackAllocatedMemory(n,a),this._doTrackAllocatedMemory(n,a,this.gl.stats.get("Memory Usage"))}},{key:"_doTrackAllocatedMemory",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ya.get("Memory Usage");i.get("GPU Memory").addCount(n),i.get("".concat(a," Memory")).addCount(n),this.byteLength=n}},{key:"_trackDeallocatedMemory",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._doTrackDeallocatedMemory(n),this._doTrackDeallocatedMemory(n,this.gl.stats.get("Memory Usage"))}},{key:"_doTrackDeallocatedMemory",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ya.get("Memory Usage");a.get("GPU Memory").subtractCount(this.byteLength),a.get("".concat(n," Memory")).subtractCount(this.byteLength),this.byteLength=0}}]),r}(Symbol.toStringTag);var p_=m(H()),m_=m(z()),v_=m(at()),g_=m(Te()),y_=m(xe()),Yc=m(Ae());var l_=m(s_()),c_=m(H()),h_=m(z());var rR="Failed to deduce GL constant from typed array";function Oi(e){var r=ArrayBuffer.isView(e)?e.constructor:e;switch(r){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(rR)}}function Dr(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.clamped,n=t===void 0?!0:t;switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function u_(e){var r=e.data,t=e.width,n=e.height,a=e.bytesPerPixel,i=a===void 0?4:a,o=e.temp,s=t*i;o=o||new Uint8Array(s);for(var u=0;u<n/2;++u){var f=u*s,l=(n-u-1)*s;o.set(r.subarray(f,f+s)),r.copyWithin(f,l,l+s),r.set(o,l)}}function f_(e){for(var r=e.data,t=e.width,n=e.height,a=Math.round(t/2),i=Math.round(n/2),o=new Uint8Array(a*i*4),s=0;s<i;s++)for(var u=0;u<a;u++)for(var f=0;f<4;f++)o[(s*a+u)*4+f]=r[(s*2*t+u*2)*4+f];return{data:o,width:a,height:i}}function Ii(e,r,t){var n=t.removedProps,a=n===void 0?{}:n,i=t.deprecatedProps,o=i===void 0?{}:i,s=t.replacedProps,u=s===void 0?{}:s;for(var f in a)if(f in r){var l=a[f],c=l?"".concat(e,".").concat(a[f]):"N/A";oe.removed("".concat(e,".").concat(f),c)()}for(var h in o)if(h in r){var d=o[h];oe.deprecated("".concat(e,".").concat(h),"".concat(e,".").concat(d))()}var p=null;for(var v in u)if(v in r){var g=u[v];oe.deprecated("".concat(e,".").concat(v),"".concat(e,".").concat(g))(),p=p||Object.assign({},r),p[g]=r[v],delete p[v]}return p||r}var nR={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},aR={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}},xn=function(){function e(){var r=this;(0,c_.default)(this,e);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];n.forEach(function(i){return r._assign(i)}),Object.freeze(this)}return(0,h_.default)(e,[{key:"toString",value:function(){return JSON.stringify(this)}},{key:"BYTES_PER_ELEMENT",get:function(){return e.getBytesPerElement(this)}},{key:"BYTES_PER_VERTEX",get:function(){return e.getBytesPerVertex(this)}},{key:"_assign",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t=Ii("Accessor",t,aR),t.type!==void 0&&(this.type=t.type,(t.type===5124||t.type===5125)&&(this.integer=!0)),t.size!==void 0&&(this.size=t.size),t.offset!==void 0&&(this.offset=t.offset),t.stride!==void 0&&(this.stride=t.stride),t.normalized!==void 0&&(this.normalized=t.normalized),t.integer!==void 0&&(this.integer=t.integer),t.divisor!==void 0&&(this.divisor=t.divisor),t.buffer!==void 0&&(this.buffer=t.buffer),t.index!==void 0&&(typeof t.index=="boolean"?this.index=t.index?1:0:this.index=t.index),t.instanced!==void 0&&(this.divisor=t.instanced?1:0),t.isInstanced!==void 0&&(this.divisor=t.isInstanced?1:0),this}}],[{key:"getBytesPerElement",value:function(t){var n=Dr(t.type||5126);return n.BYTES_PER_ELEMENT}},{key:"getBytesPerVertex",value:function(t){Q(t.size);var n=Dr(t.type||5126);return n.BYTES_PER_ELEMENT*t.size}},{key:"resolve",value:function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(0,l_.default)(e,[nR].concat(n))}}]),e}();function iR(e){var r=oR();return function(){var n=(0,Yc.default)(e),a;if(r){var i=(0,Yc.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,y_.default)(this,a)}}function oR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var d_=10,A_={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},sR={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:A_},uR={removedProps:A_},Kc=function(e,r){(0,g_.default)(n,e);var t=iR(n);function n(a){var i;(0,p_.default)(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i=t.call(this,a,o),i.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),i.target=o.target||(i.gl.webgl2?36662:34962),i.initialize(o),Object.seal((0,v_.default)(i)),i}return(0,m_.default)(n,[{key:r,get:function(){return"Buffer"}},{key:"getElementCount",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/xn.getBytesPerElement(i))}},{key:"getVertexCount",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/xn.getBytesPerVertex(i))}},{key:"initialize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(i)&&(i={data:i}),Number.isFinite(i)&&(i={byteLength:i}),i=Ii("Buffer",i,sR),this.usage=i.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},i,i.accessor)),i.data?this._setData(i.data,i.offset,i.byteLength):this._setByteLength(i.byteLength||0),this}},{key:"setProps",value:function(i){return i=Ii("Buffer",i,uR),"accessor"in i&&this.setAccessor(i.accessor),this}},{key:"setAccessor",value:function(i){return i=Object.assign({},i),delete i.buffer,this.accessor=new xn(i),this}},{key:"reallocate",value:function(i){return i>this.byteLength?(this._setByteLength(i),!0):(this.bytesUsed=i,!1)}},{key:"setData",value:function(i){return this.initialize(i)}},{key:"subData",value:function(i){ArrayBuffer.isView(i)&&(i={data:i});var o=i,s=o.data,u=o.offset,f=u===void 0?0:u,l=o.srcOffset,c=l===void 0?0:l,h=i.byteLength||i.length;Q(s);var d=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(d,this.handle),c!==0||h!==void 0?(Ke(this.gl),this.gl.bufferSubData(this.target,f,s,c,h)):this.gl.bufferSubData(d,f,s),this.gl.bindBuffer(d,null),this.debugData=null,this._inferType(s),this}},{key:"copyData",value:function(i){var o=i.sourceBuffer,s=i.readOffset,u=s===void 0?0:s,f=i.writeOffset,l=f===void 0?0:f,c=i.size,h=this.gl;return Ke(h),h.bindBuffer(36662,o.handle),h.bindBuffer(36663,this.handle),h.copyBufferSubData(36662,36663,u,l,c),h.bindBuffer(36662,null),h.bindBuffer(36663,null),this.debugData=null,this}},{key:"getData",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.dstData,s=o===void 0?null:o,u=i.srcByteOffset,f=u===void 0?0:u,l=i.dstOffset,c=l===void 0?0:l,h=i.length,d=h===void 0?0:h;Ke(this.gl);var p=Dr(this.accessor.type||5126,{clamped:!1}),v=this._getAvailableElementCount(f),g=c,y,b;s?(b=s.length,y=b-g):(y=Math.min(v,d||v),b=g+y);var E=Math.min(v,y);return d=d||E,Q(d<=E),s=s||new p(b),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,f,s,c,d),this.gl.bindBuffer(36662,null),s}},{key:"bind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?this.target:o,u=i.index,f=u===void 0?this.accessor&&this.accessor.index:u,l=i.offset,c=l===void 0?0:l,h=i.size;return s===35345||s===35982?h!==void 0?this.gl.bindBufferRange(s,f,this.handle,c,h):(Q(c===0),this.gl.bindBufferBase(s,f,this.handle)):this.gl.bindBuffer(s,this.handle),this}},{key:"unbind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?this.target:o,u=i.index,f=u===void 0?this.accessor&&this.accessor.index:u,l=s===35345||s===35982;return l?this.gl.bindBufferBase(s,f,null):this.gl.bindBuffer(s,null),this}},{key:"getDebugData",value:function(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(d_,this.byteLength)}),{data:this.debugData,changed:!0})}},{key:"invalidateDebugData",value:function(){this.debugData=null}},{key:"_setData",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i.byteLength+o;Q(ArrayBuffer.isView(i)),this._trackDeallocatedMemory();var u=this._getTarget();this.gl.bindBuffer(u,this.handle),this.gl.bufferData(u,s,this.usage),this.gl.bufferSubData(u,o,i),this.gl.bindBuffer(u,null),this.debugData=i.slice(0,d_),this.bytesUsed=s,this._trackAllocatedMemory(s);var f=Oi(i);return Q(f),this.setAccessor(new xn(this.accessor,{type:f})),this}},{key:"_setByteLength",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Q(i>=0),this._trackDeallocatedMemory();var s=i;i===0&&(s=new Float32Array(0));var u=this._getTarget();return this.gl.bindBuffer(u,this.handle),this.gl.bufferData(u,s,o),this.gl.bindBuffer(u,null),this.usage=o,this.debugData=null,this.bytesUsed=i,this._trackAllocatedMemory(i),this}},{key:"_getTarget",value:function(){return this.gl.webgl2?36663:this.target}},{key:"_getAvailableElementCount",value:function(i){var o=Dr(this.accessor.type||5126,{clamped:!1}),s=i/o.BYTES_PER_ELEMENT;return this.getElementCount()-s}},{key:"_inferType",value:function(i){this.accessor.type||this.setAccessor(new xn(this.accessor,{type:Oi(i)}))}},{key:"_createHandle",value:function(){return this.gl.createBuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}},{key:"_getParameter",value:function(i){this.gl.bindBuffer(this.target,this.handle);var o=this.gl.getBufferParameter(this.target,i);return this.gl.bindBuffer(this.target,null),o}},{key:"type",get:function(){return oe.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}},{key:"bytes",get:function(){return oe.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}},{key:"setByteLength",value:function(i){return oe.deprecated("setByteLength","reallocate")(),this.reallocate(i)}},{key:"updateAccessor",value:function(i){return oe.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new xn(this.accessor,i),this}}]),n}(kr,Symbol.toStringTag);var pe=m(W());var Dt,lt,Yt,Fs=(Dt={},(0,pe.default)(Dt,6407,{dataFormat:6407,types:[5121,33635]}),(0,pe.default)(Dt,6408,{dataFormat:6408,types:[5121,32819,32820]}),(0,pe.default)(Dt,6406,{dataFormat:6406,types:[5121]}),(0,pe.default)(Dt,6409,{dataFormat:6409,types:[5121]}),(0,pe.default)(Dt,6410,{dataFormat:6410,types:[5121]}),(0,pe.default)(Dt,33326,{dataFormat:6403,types:[5126],gl2:!0}),(0,pe.default)(Dt,33328,{dataFormat:33319,types:[5126],gl2:!0}),(0,pe.default)(Dt,34837,{dataFormat:6407,types:[5126],gl2:!0}),(0,pe.default)(Dt,34836,{dataFormat:6408,types:[5126],gl2:!0}),Dt),__=(lt={},(0,pe.default)(lt,6403,1),(0,pe.default)(lt,36244,1),(0,pe.default)(lt,33319,2),(0,pe.default)(lt,33320,2),(0,pe.default)(lt,6407,3),(0,pe.default)(lt,36248,3),(0,pe.default)(lt,6408,4),(0,pe.default)(lt,36249,4),(0,pe.default)(lt,6402,1),(0,pe.default)(lt,34041,1),(0,pe.default)(lt,6406,1),(0,pe.default)(lt,6409,1),(0,pe.default)(lt,6410,2),lt),b_=(Yt={},(0,pe.default)(Yt,5126,4),(0,pe.default)(Yt,5125,4),(0,pe.default)(Yt,5124,4),(0,pe.default)(Yt,5123,2),(0,pe.default)(Yt,5122,2),(0,pe.default)(Yt,5131,2),(0,pe.default)(Yt,5120,1),(0,pe.default)(Yt,5121,1),Yt);function T_(e,r){var t=Fs[r];if(!t)return!1;if(t.gl1===void 0&&t.gl2===void 0)return!0;var n=he(e)&&t.gl2||t.gl1;return typeof n=="string"?e.getExtension(n):n}function x_(e,r){var t=Fs[r];switch(t&&t.types[0]){case 5126:return e.getExtension("OES_texture_float_linear");case 5131:return e.getExtension("OES_texture_half_float_linear");default:return!0}}function fR(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=lR(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function lR(e,r){if(e){if(typeof e=="string")return E_(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return E_(e,r)}}function E_(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function cR(e){var r=hR();return function(){var n=(0,Qc.default)(e),a;if(r){var i=(0,Qc.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,O_.default)(this,a)}}function hR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dR=[9729,9728],S_=globalThis.WebGLBuffer||function(){},Zc=function(e,r){(0,M_.default)(n,e);var t=cR(n);function n(a,i){var o;(0,w_.default)(this,n);var s=i.id,u=s===void 0?Is("texture"):s,f=i.handle,l=i.target;return o=t.call(this,a,{id:u,handle:f}),o.target=l,o.textureUnit=void 0,o.loaded=!1,o.width=void 0,o.height=void 0,o.depth=void 0,o.format=void 0,o.type=void 0,o.dataFormat=void 0,o.border=void 0,o.textureUnit=void 0,o.mipmaps=void 0,o}return(0,B_.default)(n,[{key:r,get:function(){return"Texture"}},{key:"toString",value:function(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}},{key:"initialize",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=o.data;if(s instanceof Promise)return s.then(function(U){return i.initialize(Object.assign({},o,{pixels:U,data:U}))}),this;var u=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement;if(u&&s.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,s.addEventListener("loadeddata",function(){return i.initialize(o)}),this;var f=o.pixels,l=f===void 0?null:f,c=o.format,h=c===void 0?6408:c,d=o.border,p=d===void 0?0:d,v=o.recreate,g=v===void 0?!1:v,y=o.parameters,b=y===void 0?{}:y,E=o.pixelStore,T=E===void 0?{}:E,S=o.textureUnit,I=S===void 0?void 0:S;s||(s=l);var L=o.width,B=o.height,C=o.dataFormat,_=o.type,R=o.compressed,F=R===void 0?!1:R,k=o.mipmaps,D=k===void 0?!0:k,M=o.depth,O=M===void 0?0:M,P=this._deduceParameters({format:h,type:_,dataFormat:C,compressed:F,data:s,width:L,height:B});return L=P.width,B=P.height,F=P.compressed,C=P.dataFormat,_=P.type,this.width=L,this.height=B,this.depth=O,this.format=h,this.type=_,this.dataFormat=C,this.border=p,this.textureUnit=I,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),D&&this._isNPOT()&&(oe.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),D=!1,this._updateForNPOT(b)),this.mipmaps=D,this.setImageData({data:s,width:L,height:B,depth:O,format:h,type:_,dataFormat:C,border:p,mipmaps:D,parameters:T,compressed:F}),D&&this.generateMipmap(),this.setParameters(b),g&&(this.data=s),u&&(this._video={video:s,parameters:b,lastTime:s.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?s.currentTime:-1}),this}},{key:"update",value:function(){if(this._video){var i=this._video,o=i.video,s=i.parameters,u=i.lastTime;if(u===o.currentTime||o.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:o,parameters:s}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=o.currentTime}}},{key:"resize",value:function(i){var o=i.height,s=i.width,u=i.mipmaps,f=u===void 0?!1:u;return s!==this.width||o!==this.height?this.initialize({width:s,height:o,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:f}):this}},{key:"generateMipmap",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(oe.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),ur(this.gl,o,function(){i.gl.generateMipmap(i.target)}),this.gl.bindTexture(this.target,null),this)}},{key:"setImageData",value:function(i){this._trackDeallocatedMemory("Texture");var o=i.target,s=o===void 0?this.target:o,u=i.pixels,f=u===void 0?null:u,l=i.level,c=l===void 0?0:l,h=i.format,d=h===void 0?this.format:h,p=i.border,v=p===void 0?this.border:p,g=i.offset,y=g===void 0?0:g,b=i.parameters,E=b===void 0?{}:b,T=i.data,S=T===void 0?null:T,I=i.type,L=I===void 0?this.type:I,B=i.width,C=B===void 0?this.width:B,_=i.height,R=_===void 0?this.height:_,F=i.dataFormat,k=F===void 0?this.dataFormat:F,D=i.compressed,M=D===void 0?!1:D;S||(S=f);var O=this._deduceParameters({format:d,type:L,dataFormat:k,compressed:M,data:S,width:C,height:R});L=O.type,k=O.dataFormat,M=O.compressed,C=O.width,R=O.height;var P=this.gl;P.bindTexture(this.target,this.handle);var U=null,G=this._getDataType({data:S,compressed:M});S=G.data,U=G.dataType;var j,q=0;if(ur(this.gl,E,function(){switch(U){case"null":P.texImage2D(s,c,d,C,R,v,k,L,S);break;case"typed-array":P.texImage2D(s,c,d,C,R,v,k,L,S,y);break;case"buffer":j=Ke(P),j.bindBuffer(35052,S.handle||S),j.texImage2D(s,c,d,C,R,v,k,L,y),j.bindBuffer(35052,null);break;case"browser-object":he(P)?P.texImage2D(s,c,d,C,R,v,k,L,S):P.texImage2D(s,c,d,k,L,S);break;case"compressed":var we=fR(S.entries()),nt;try{for(we.s();!(nt=we.n()).done;){var je=(0,C_.default)(nt.value,2),br=je[0],Et=je[1];P.compressedTexImage2D(s,br,Et.format,Et.width,Et.height,v,Et.data),q+=Et.levelSize}}catch(Jn){we.e(Jn)}finally{we.f()}break;default:Q(!1,"Unknown image data type")}}),U==="compressed")this._trackAllocatedMemory(q,"Texture");else if(S&&S.byteLength)this._trackAllocatedMemory(S.byteLength,"Texture");else{var ne=__[this.dataFormat]||4,Re=b_[this.type]||1;this._trackAllocatedMemory(this.width*this.height*ne*Re,"Texture")}return this.loaded=!0,this}},{key:"setSubImageData",value:function(i){var o=this,s=i.target,u=s===void 0?this.target:s,f=i.pixels,l=f===void 0?null:f,c=i.data,h=c===void 0?null:c,d=i.x,p=d===void 0?0:d,v=i.y,g=v===void 0?0:v,y=i.width,b=y===void 0?this.width:y,E=i.height,T=E===void 0?this.height:E,S=i.level,I=S===void 0?0:S,L=i.format,B=L===void 0?this.format:L,C=i.type,_=C===void 0?this.type:C,R=i.dataFormat,F=R===void 0?this.dataFormat:R,k=i.compressed,D=k===void 0?!1:k,M=i.offset,O=M===void 0?0:M,P=i.border,U=P===void 0?this.border:P,G=i.parameters,j=G===void 0?{}:G,q=this._deduceParameters({format:B,type:_,dataFormat:F,compressed:D,data:h,width:b,height:T});if(_=q.type,F=q.dataFormat,D=q.compressed,b=q.width,T=q.height,Q(this.depth===0,"texSubImage not supported for 3D textures"),h||(h=l),h&&h.data){var ne=h;h=ne.data,b=ne.shape[0],T=ne.shape[1]}h instanceof Kc&&(h=h.handle),this.gl.bindTexture(this.target,this.handle),ur(this.gl,j,function(){if(D)o.gl.compressedTexSubImage2D(u,I,p,g,b,T,B,h);else if(h===null)o.gl.texSubImage2D(u,I,p,g,b,T,F,_,null);else if(ArrayBuffer.isView(h))o.gl.texSubImage2D(u,I,p,g,b,T,F,_,h,O);else if(h instanceof S_){var Re=Ke(o.gl);Re.bindBuffer(35052,h),Re.texSubImage2D(u,I,p,g,b,T,F,_,O),Re.bindBuffer(35052,null)}else if(he(o.gl)){var we=Ke(o.gl);we.texSubImage2D(u,I,p,g,b,T,F,_,h)}else o.gl.texSubImage2D(u,I,p,g,F,_,h)}),this.gl.bindTexture(this.target,null)}},{key:"copyFramebuffer",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}},{key:"getActiveUnit",value:function(){return this.gl.getParameter(34016)-33984}},{key:"bind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit,o=this.gl;return i!==void 0&&(this.textureUnit=i,o.activeTexture(33984+i)),o.bindTexture(this.target,this.handle),i}},{key:"unbind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit,o=this.gl;return i!==void 0&&(this.textureUnit=i,o.activeTexture(33984+i)),o.bindTexture(this.target,null),i}},{key:"_getDataType",value:function(i){var o=i.data,s=i.compressed,u=s===void 0?!1:s;return u?{data:o,dataType:"compressed"}:o===null?{data:o,dataType:"null"}:ArrayBuffer.isView(o)?{data:o,dataType:"typed-array"}:o instanceof Kc?{data:o.handle,dataType:"buffer"}:o instanceof S_?{data:o,dataType:"buffer"}:{data:o,dataType:"browser-object"}}},{key:"_deduceParameters",value:function(i){var o=i.format,s=i.data,u=i.width,f=i.height,l=i.dataFormat,c=i.type,h=i.compressed,d=Fs[o];l=l||d&&d.dataFormat,c=c||d&&d.types[0],h=h||d&&d.compressed;var p=this._deduceImageSize(s,u,f);return u=p.width,f=p.height,{dataFormat:l,type:c,compressed:h,width:u,height:f,format:o,data:s}}},{key:"_deduceImageSize",value:function(i,o,s){var u;return typeof ImageData<"u"&&i instanceof ImageData?u={width:i.width,height:i.height}:typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement?u={width:i.naturalWidth,height:i.naturalHeight}:typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement?u={width:i.width,height:i.height}:typeof ImageBitmap<"u"&&i instanceof ImageBitmap?u={width:i.width,height:i.height}:typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement?u={width:i.videoWidth,height:i.videoHeight}:i?u={width:o,height:s}:u={width:o>=0?o:1,height:s>=0?s:1},Q(u,"Could not deduced texture size"),Q(o===void 0||u.width===o,"Deduced texture width does not match supplied width"),Q(s===void 0||u.height===s,"Deduced texture height does not match supplied height"),u}},{key:"_createHandle",value:function(){return this.gl.createTexture()}},{key:"_deleteHandle",value:function(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}},{key:"_getParameter",value:function(i){switch(i){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);var o=this.gl.getTexParameter(this.target,i);return this.gl.bindTexture(this.target,null),o}}},{key:"_setParameter",value:function(i,o){switch(this.gl.bindTexture(this.target,this.handle),o=this._getNPOTParam(i,o),i){case 33082:case 33083:this.gl.texParameterf(this.handle,i,o);break;case 4096:case 4097:Q(!1);break;default:this.gl.texParameteri(this.target,i,o);break}return this.gl.bindTexture(this.target,null),this}},{key:"_isNPOT",value:function(){return he(this.gl)||!this.width||!this.height?!1:!Xc(this.width)||!Xc(this.height)}},{key:"_updateForNPOT",value:function(i){i[this.gl.TEXTURE_MIN_FILTER]===void 0&&(i[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),i[this.gl.TEXTURE_WRAP_S]===void 0&&(i[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),i[this.gl.TEXTURE_WRAP_T]===void 0&&(i[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}},{key:"_getNPOTParam",value:function(i,o){if(this._isNPOT())switch(i){case 10241:dR.indexOf(o)===-1&&(o=9729);break;case 10242:case 10243:o!==33071&&(o=33071);break;default:break}return o}}],[{key:"isSupported",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.format,u=o.linearFiltering,f=!0;return s&&(f=f&&T_(i,s),f=f&&(!u||x_(i,s))),f}}]),n}(kr,Symbol.toStringTag);var pR="";function I_(e,r){return Q(typeof e=="string"),e=pR+e,new Promise(function(t,n){try{var a=new Image;a.onload=function(){return t(a)},a.onerror=function(){return n(new Error("Could not load image ".concat(e,".")))},a.crossOrigin=r&&r.crossOrigin||"anonymous",a.src=e}catch(i){n(i)}})}function mR(e){var r=vR();return function(){var n=(0,$c.default)(e),a;if(r){var i=(0,$c.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,k_.default)(this,a)}}function vR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var En=function(e,r){(0,L_.default)(n,e);var t=mR(n);function n(a){var i;(0,P_.default)(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ei(a),(o instanceof Promise||typeof o=="string")&&(o={data:o}),typeof o.data=="string"&&(o=Object.assign({},o,{data:I_(o.data)})),i=t.call(this,a,Object.assign({},o,{target:3553})),i.initialize(o),Object.seal((0,F_.default)(i)),i}return(0,R_.default)(n,[{key:r,get:function(){return"Texture2D"}}],[{key:"isSupported",value:function(i,o){return Zc.isSupported(i,o)}}]),n}(Zc,Symbol.toStringTag);var Ri=m(W()),nb=m(ce()),ab=m(H()),ib=m(z()),ob=m(at()),sb=m(Zr()),ub=m(Te()),fb=m(xe()),Ds=m(Ae());var D_=m(H()),G_=m(z()),N_=m(at()),U_=m(Te()),j_=m(xe()),th=m(Ae());var ee=m(W()),Z,Sn="EXT_color_buffer_float",eh=(Z={},(0,ee.default)(Z,33189,{bpp:2}),(0,ee.default)(Z,33190,{gl2:!0,bpp:3}),(0,ee.default)(Z,36012,{gl2:!0,bpp:4}),(0,ee.default)(Z,36168,{bpp:1}),(0,ee.default)(Z,34041,{bpp:4}),(0,ee.default)(Z,35056,{gl2:!0,bpp:4}),(0,ee.default)(Z,36013,{gl2:!0,bpp:5}),(0,ee.default)(Z,32854,{bpp:2}),(0,ee.default)(Z,36194,{bpp:2}),(0,ee.default)(Z,32855,{bpp:2}),(0,ee.default)(Z,33321,{gl2:!0,bpp:1}),(0,ee.default)(Z,33330,{gl2:!0,bpp:1}),(0,ee.default)(Z,33329,{gl2:!0,bpp:1}),(0,ee.default)(Z,33332,{gl2:!0,bpp:2}),(0,ee.default)(Z,33331,{gl2:!0,bpp:2}),(0,ee.default)(Z,33334,{gl2:!0,bpp:4}),(0,ee.default)(Z,33333,{gl2:!0,bpp:4}),(0,ee.default)(Z,33323,{gl2:!0,bpp:2}),(0,ee.default)(Z,33336,{gl2:!0,bpp:2}),(0,ee.default)(Z,33335,{gl2:!0,bpp:2}),(0,ee.default)(Z,33338,{gl2:!0,bpp:4}),(0,ee.default)(Z,33337,{gl2:!0,bpp:4}),(0,ee.default)(Z,33340,{gl2:!0,bpp:8}),(0,ee.default)(Z,33339,{gl2:!0,bpp:8}),(0,ee.default)(Z,32849,{gl2:!0,bpp:3}),(0,ee.default)(Z,32856,{gl2:!0,bpp:4}),(0,ee.default)(Z,32857,{gl2:!0,bpp:4}),(0,ee.default)(Z,36220,{gl2:!0,bpp:4}),(0,ee.default)(Z,36238,{gl2:!0,bpp:4}),(0,ee.default)(Z,36975,{gl2:!0,bpp:4}),(0,ee.default)(Z,36214,{gl2:!0,bpp:8}),(0,ee.default)(Z,36232,{gl2:!0,bpp:8}),(0,ee.default)(Z,36226,{gl2:!0,bpp:16}),(0,ee.default)(Z,36208,{gl2:!0,bpp:16}),(0,ee.default)(Z,33325,{gl2:Sn,bpp:2}),(0,ee.default)(Z,33327,{gl2:Sn,bpp:4}),(0,ee.default)(Z,34842,{gl2:Sn,bpp:8}),(0,ee.default)(Z,33326,{gl2:Sn,bpp:4}),(0,ee.default)(Z,33328,{gl2:Sn,bpp:8}),(0,ee.default)(Z,34836,{gl2:Sn,bpp:16}),(0,ee.default)(Z,35898,{gl2:Sn,bpp:4}),Z);function gR(e){var r=yR();return function(){var n=(0,th.default)(e),a;if(r){var i=(0,th.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,j_.default)(this,a)}}function yR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function AR(e,r,t){var n=t[r];if(!n)return!1;var a=he(e)&&n.gl2||n.gl1;return typeof a=="string"?e.getExtension(a):a}var Pi=function(e,r){(0,U_.default)(n,e);var t=gR(n);function n(a){var i;(0,D_.default)(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i=t.call(this,a,o),i.initialize(o),Object.seal((0,N_.default)(i)),i}return(0,G_.default)(n,[{key:r,get:function(){return"Renderbuffer"}},{key:"initialize",value:function(i){var o=i.format,s=i.width,u=s===void 0?1:s,f=i.height,l=f===void 0?1:f,c=i.samples,h=c===void 0?0:c;return Q(o,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),h!==0&&he(this.gl)?this.gl.renderbufferStorageMultisample(36161,h,o,u,l):this.gl.renderbufferStorage(36161,o,u,l),this.format=o,this.width=u,this.height=l,this.samples=h,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*eh[this.format].bpp),this}},{key:"resize",value:function(i){var o=i.width,s=i.height;return o!==this.width||s!==this.height?this.initialize({width:o,height:s,format:this.format,samples:this.samples}):this}},{key:"_createHandle",value:function(){return this.gl.createRenderbuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}},{key:"_bindHandle",value:function(i){this.gl.bindRenderbuffer(36161,i)}},{key:"_syncHandle",value:function(i){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}},{key:"_getParameter",value:function(i){this.gl.bindRenderbuffer(36161,this.handle);var o=this.gl.getRenderbufferParameter(36161,i);return o}}],[{key:"isSupported",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null},s=o.format;return!s||AR(i,s,eh)}},{key:"getSamplesForFormat",value:function(i,o){var s=o.format;return i.getInternalformatParameter(36161,s,32937)}}]),n}(kr,Symbol.toStringTag);var J_=m(ce());var _R=256,bR=1024,TR=16384,H_=6144,V_=6145,z_=6146,W_=34041,q_="clear: bad arguments";function X_(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.framebuffer,n=t===void 0?null:t,a=r.color,i=a===void 0?null:a,o=r.depth,s=o===void 0?null:o,u=r.stencil,f=u===void 0?null:u,l={};n&&(l.framebuffer=n);var c=0;i&&(c|=TR,i!==!0&&(l.clearColor=i)),s&&(c|=_R,s!==!0&&(l.clearDepth=s)),f&&(c|=bR,s!==!0&&(l.clearStencil=s)),Q(c!==0,q_),ur(e,l,function(){e.clear(c)})}function Y_(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.framebuffer,n=t===void 0?null:t,a=r.buffer,i=a===void 0?H_:a,o=r.drawBuffer,s=o===void 0?0:o,u=r.value,f=u===void 0?[0,0,0,0]:u;Ke(e),ur(e,{framebuffer:n},function(){switch(i){case H_:switch(f.constructor){case Int32Array:e.clearBufferiv(i,s,f);break;case Uint32Array:e.clearBufferuiv(i,s,f);break;case Float32Array:default:e.clearBufferfv(i,s,f)}break;case V_:e.clearBufferfv(V_,0,[f]);break;case z_:e.clearBufferiv(z_,0,[f]);break;case W_:var l=(0,J_.default)(f,2),c=l[0],h=l[1];e.clearBufferfi(W_,0,c,h);break;default:Q(!1,q_)}})}function K_(e){switch(e){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Q(!1),0}}function xR(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.sourceX,n=t===void 0?0:t,a=r.sourceY,i=a===void 0?0:a,o=r.sourceFormat,s=o===void 0?6408:o,u=r.sourceAttachment,f=u===void 0?36064:u,l=r.target,c=l===void 0?null:l,h=r.sourceWidth,d=r.sourceHeight,p=r.sourceType,v=ER(e),g=v.framebuffer,y=v.deleteFramebuffer;Q(g);var b=g.gl,E=g.handle,T=g.attachments;h=h||g.width,d=d||g.height,f===36064&&E===null&&(f=1028),Q(T[f]),p=p||T[f].type,c=SR(c,p,s,h,d),p=p||Oi(c);var S=b.bindFramebuffer(36160,E);return b.readPixels(n,i,h,d,s,p,c),b.bindFramebuffer(36160,S||null),y&&g.delete(),c}function rh(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.sourceAttachment,n=t===void 0?36064:t,a=r.targetMaxHeight,i=a===void 0?Number.MAX_SAFE_INTEGER:a,o=xR(e,{sourceAttachment:n}),s=e.width,u=e.height;u>i;){var f=f_({data:o,width:s,height:u});o=f.data,s=f.width,u=f.height}u_({data:o,width:s,height:u});var l=document.createElement("canvas");l.width=s,l.height=u;var c=l.getContext("2d"),h=c.createImageData(s,u);return h.data.set(o),c.putImageData(h,0,0),l.toDataURL()}function ER(e){return e instanceof Gr?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:Q_(e),deleteFramebuffer:!0}}function SR(e,r,t,n,a){if(e)return e;r=r||5121;var i=Dr(r,{clamped:!1}),o=K_(t);return new i(n*a*o)}var Me=m(W());var Be,Ce={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function CR(e){var r=new En(e,{format:6408,type:5126,dataFormat:6408}),t=new Gr(e,{id:"test-framebuffer",check:!1,attachments:(0,Me.default)({},36064,r)}),n=t.getStatus();return r.delete(),t.delete(),n===36053}var nh=(Be={},(0,Me.default)(Be,Ce.WEBGL2,[!1,!0]),(0,Me.default)(Be,Ce.VERTEX_ARRAY_OBJECT,["OES_vertex_array_object",!0]),(0,Me.default)(Be,Ce.TIMER_QUERY,["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"]),(0,Me.default)(Be,Ce.INSTANCED_RENDERING,["ANGLE_instanced_arrays",!0]),(0,Me.default)(Be,Ce.MULTIPLE_RENDER_TARGETS,["WEBGL_draw_buffers",!0]),(0,Me.default)(Be,Ce.ELEMENT_INDEX_UINT32,["OES_element_index_uint",!0]),(0,Me.default)(Be,Ce.BLEND_EQUATION_MINMAX,["EXT_blend_minmax",!0]),(0,Me.default)(Be,Ce.FLOAT_BLEND,["EXT_float_blend"]),(0,Me.default)(Be,Ce.COLOR_ENCODING_SRGB,["EXT_sRGB",!0]),(0,Me.default)(Be,Ce.TEXTURE_DEPTH,["WEBGL_depth_texture",!0]),(0,Me.default)(Be,Ce.TEXTURE_FLOAT,["OES_texture_float",!0]),(0,Me.default)(Be,Ce.TEXTURE_HALF_FLOAT,["OES_texture_half_float",!0]),(0,Me.default)(Be,Ce.TEXTURE_FILTER_LINEAR_FLOAT,["OES_texture_float_linear"]),(0,Me.default)(Be,Ce.TEXTURE_FILTER_LINEAR_HALF_FLOAT,["OES_texture_half_float_linear"]),(0,Me.default)(Be,Ce.TEXTURE_FILTER_ANISOTROPIC,["EXT_texture_filter_anisotropic"]),(0,Me.default)(Be,Ce.COLOR_ATTACHMENT_RGBA32F,[CR,"EXT_color_buffer_float"]),(0,Me.default)(Be,Ce.COLOR_ATTACHMENT_FLOAT,[!1,"EXT_color_buffer_float"]),(0,Me.default)(Be,Ce.COLOR_ATTACHMENT_HALF_FLOAT,["EXT_color_buffer_half_float"]),(0,Me.default)(Be,Ce.GLSL_FRAG_DATA,["WEBGL_draw_buffers",!0]),(0,Me.default)(Be,Ce.GLSL_FRAG_DEPTH,["EXT_frag_depth",!0]),(0,Me.default)(Be,Ce.GLSL_DERIVATIVES,["OES_standard_derivatives",!0]),(0,Me.default)(Be,Ce.GLSL_TEXTURE_LOD,["EXT_shader_texture_lod",!0]),Be);function wR(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=BR(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function BR(e,r){if(e){if(typeof e=="string")return Z_(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Z_(e,r)}}function Z_(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var MR=2;function Ls(e,r){return ah(e,r)}function ah(e,r){return r=Array.isArray(r)?r:[r],r.every(function(t){return $_(e,t)})}function ks(e){e.luma=e.luma||{},e.luma.caps=e.luma.caps||{};for(var r in nh)e.luma.caps[r]===void 0&&(e.luma.caps[r]=$_(e,r));return e.luma.caps}function $_(e,r){return e.luma=e.luma||{},e.luma.caps=e.luma.caps||{},e.luma.caps[r]===void 0&&(e.luma.caps[r]=OR(e,r)),e.luma.caps[r]||oe.log(MR,"Feature: ".concat(r," not supported"))(),e.luma.caps[r]}function OR(e,r){var t=nh[r];Q(t,r);var n,a=he(e)&&t[1]||t[0];if(typeof a=="function")n=a(e);else if(Array.isArray(a)){n=!0;var i=wR(a),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;n=n&&Boolean(e.getExtension(s))}}catch(u){i.e(u)}finally{i.f()}}else typeof a=="string"?n=Boolean(e.getExtension(a)):typeof a=="boolean"?n=a:Q(!1);return n}function eb(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=IR(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function IR(e,r){if(e){if(typeof e=="string")return tb(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return tb(e,r)}}function tb(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function PR(e){var r=RR();return function(){var n=(0,Ds.default)(e),a;if(r){var i=(0,Ds.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,fb.default)(this,a)}}function RR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var rb="Multiple render targets not supported",Gr=function(e,r){(0,ub.default)(n,e);var t=PR(n);function n(a){var i;(0,ab.default)(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i=t.call(this,a,o),i.width=null,i.height=null,i.attachments={},i.readBuffer=36064,i.drawBuffers=[36064],i.ownResources=[],i.initialize(o),Object.seal((0,ob.default)(i)),i}return(0,ib.default)(n,[{key:r,get:function(){return"Framebuffer"}},{key:"MAX_COLOR_ATTACHMENTS",get:function(){var i=Ke(this.gl);return i.getParameter(i.MAX_COLOR_ATTACHMENTS)}},{key:"MAX_DRAW_BUFFERS",get:function(){var i=Ke(this.gl);return i.getParameter(i.MAX_DRAW_BUFFERS)}},{key:"color",get:function(){return this.attachments[36064]||null}},{key:"texture",get:function(){return this.attachments[36064]||null}},{key:"depth",get:function(){return this.attachments[36096]||this.attachments[33306]||null}},{key:"stencil",get:function(){return this.attachments[36128]||this.attachments[33306]||null}},{key:"initialize",value:function(i){var o=i.width,s=o===void 0?1:o,u=i.height,f=u===void 0?1:u,l=i.attachments,c=l===void 0?null:l,h=i.color,d=h===void 0?!0:h,p=i.depth,v=p===void 0?!0:p,g=i.stencil,y=g===void 0?!1:g,b=i.check,E=b===void 0?!0:b,T=i.readBuffer,S=T===void 0?void 0:T,I=i.drawBuffers,L=I===void 0?void 0:I;if(Q(s>=0&&f>=0,"Width and height need to be integers"),this.width=s,this.height=f,c)for(var B in c){var C=c[B],_=Array.isArray(C)?C[0]:C;_.resize({width:s,height:f})}else c=this._createDefaultAttachments(d,v,y,s,f);this.update({clearAttachments:!0,attachments:c,readBuffer:S,drawBuffers:L}),c&&E&&this.checkStatus()}},{key:"delete",value:function(){var i=eb(this.ownResources),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;s.delete()}}catch(u){i.e(u)}finally{i.f()}return(0,sb.default)((0,Ds.default)(n.prototype),"delete",this).call(this),this}},{key:"update",value:function(i){var o=i.attachments,s=o===void 0?{}:o,u=i.readBuffer,f=i.drawBuffers,l=i.clearAttachments,c=l===void 0?!1:l,h=i.resizeAttachments,d=h===void 0?!0:h;this.attach(s,{clearAttachments:c,resizeAttachments:d});var p=this.gl,v=p.bindFramebuffer(36160,this.handle);return u&&this._setReadBuffer(u),f&&this._setDrawBuffers(f),p.bindFramebuffer(36160,v||null),this}},{key:"resize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.width,s=i.height;if(this.handle===null)return Q(o===void 0&&s===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;o===void 0&&(o=this.gl.drawingBufferWidth),s===void 0&&(s=this.gl.drawingBufferHeight),o!==this.width&&s!==this.height&&oe.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(o,"x").concat(s))();for(var u in this.attachments)this.attachments[u].resize({width:o,height:s});return this.width=o,this.height=s,this}},{key:"attach",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=s.clearAttachments,f=u===void 0?!1:u,l=s.resizeAttachments,c=l===void 0?!0:l,h={};f&&Object.keys(this.attachments).forEach(function(B){h[B]=null}),Object.assign(h,i);var d=this.gl.bindFramebuffer(36160,this.handle);for(var p in h){Q(p!==void 0,"Misspelled framebuffer binding point?");var v=Number(p),g=h[v],y=g;if(!y)this._unattach(v);else if(y instanceof Pi)this._attachRenderbuffer({attachment:v,renderbuffer:y});else if(Array.isArray(g)){var b=(0,nb.default)(g,3),E=b[0],T=b[1],S=T===void 0?0:T,I=b[2],L=I===void 0?0:I;y=E,this._attachTexture({attachment:v,texture:E,layer:S,level:L})}else this._attachTexture({attachment:v,texture:y,layer:0,level:0});c&&y&&y.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,d||null),Object.assign(this.attachments,i),Object.keys(this.attachments).filter(function(B){return!o.attachments[B]}).forEach(function(B){delete o.attachments[B]})}},{key:"checkStatus",value:function(){var i=this.gl,o=this.getStatus();if(o!==36053)throw new Error(LR(o));return this}},{key:"getStatus",value:function(){var i=this.gl,o=i.bindFramebuffer(36160,this.handle),s=i.checkFramebufferStatus(36160);return i.bindFramebuffer(36160,o||null),s}},{key:"clear",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=o.color,u=o.depth,f=o.stencil,l=o.drawBuffers,c=l===void 0?[]:l,h=this.gl.bindFramebuffer(36160,this.handle);return(s||u||f)&&X_(this.gl,{color:s,depth:u,stencil:f}),c.forEach(function(d,p){Y_(i.gl,{drawBuffer:p,value:d})}),this.gl.bindFramebuffer(36160,h||null),this}},{key:"readPixels",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}},{key:"readPixelsToBuffer",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}},{key:"copyToDataUrl",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}},{key:"copyToImage",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}},{key:"copyToTexture",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}},{key:"blit",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}},{key:"invalidate",value:function(i){var o=i.attachments,s=o===void 0?[]:o,u=i.x,f=u===void 0?0:u,l=i.y,c=l===void 0?0:l,h=i.width,d=i.height,p=Ke(this.gl),v=p.bindFramebuffer(36008,this.handle),g=f===0&&c===0&&h===void 0&&d===void 0;return g?p.invalidateFramebuffer(36008,s):p.invalidateFramebuffer(36008,s,f,c,h,d),p.bindFramebuffer(36008,v),this}},{key:"getAttachmentParameter",value:function(i,o,s){var u=this._getAttachmentParameterFallback(o);return u===null&&(this.gl.bindFramebuffer(36160,this.handle),u=this.gl.getFramebufferAttachmentParameter(36160,i,o),this.gl.bindFramebuffer(36160,null)),s&&u>1e3&&(u=Tn(this.gl,u)),u}},{key:"getAttachmentParameters",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,o=arguments.length>1?arguments[1]:void 0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[],u={},f=eb(s),l;try{for(f.s();!(l=f.n()).done;){var c=l.value,h=o?Tn(this.gl,c):c;u[h]=this.getAttachmentParameter(i,c,o)}}catch(d){f.e(d)}finally{f.f()}return u}},{key:"getParameters",value:function(){for(var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,o=Object.keys(this.attachments),s={},u=0,f=o;u<f.length;u++){var l=f[u],c=Number(l),h=i?Tn(this.gl,c):c;s[h]=this.getAttachmentParameters(c,i)}return s}},{key:"show",value:function(){return typeof window<"u"&&window.open(rh(this),"luma-debug-texture"),this}},{key:"log",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(i>oe.level||typeof window>"u")return this;o=o||"Framebuffer ".concat(this.id);var s=rh(this,{targetMaxHeight:100});return oe.image({logLevel:i,message:o,image:s},o)(),this}},{key:"bind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?36160:o;return this.gl.bindFramebuffer(s,this.handle),this}},{key:"unbind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?36160:o;return this.gl.bindFramebuffer(s,null),this}},{key:"_createDefaultAttachments",value:function(i,o,s,u,f){var l=null;if(i){var c;l=l||{},l[36064]=new En(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:u,height:f,mipmaps:!1,parameters:(c={},(0,Ri.default)(c,10241,9729),(0,Ri.default)(c,10240,9729),(0,Ri.default)(c,10242,33071),(0,Ri.default)(c,10243,33071),c)}),this.ownResources.push(l[36064])}return o&&s?(l=l||{},l[33306]=new Pi(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:u,height:111}),this.ownResources.push(l[33306])):o?(l=l||{},l[36096]=new Pi(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:u,height:f}),this.ownResources.push(l[36096])):s&&Q(!1),l}},{key:"_unattach",value:function(i){var o=this.attachments[i];o&&(o instanceof Pi?this.gl.framebufferRenderbuffer(36160,i,36161,null):this.gl.framebufferTexture2D(36160,i,3553,null,0),delete this.attachments[i])}},{key:"_attachRenderbuffer",value:function(i){var o=i.attachment,s=o===void 0?36064:o,u=i.renderbuffer,f=this.gl;f.framebufferRenderbuffer(36160,s,36161,u.handle),this.attachments[s]=u}},{key:"_attachTexture",value:function(i){var o=i.attachment,s=o===void 0?36064:o,u=i.texture,f=i.layer,l=i.level,c=this.gl;switch(c.bindTexture(u.target,u.handle),u.target){case 35866:case 32879:var h=Ke(c);h.framebufferTextureLayer(36160,s,u.target,l,f);break;case 34067:var d=FR(f);c.framebufferTexture2D(36160,s,d,u.handle,l);break;case 3553:c.framebufferTexture2D(36160,s,3553,u.handle,l);break;default:Q(!1,"Illegal texture type")}c.bindTexture(u.target,null),this.attachments[s]=u}},{key:"_setReadBuffer",value:function(i){var o=Gc(this.gl);o?o.readBuffer(i):Q(i===36064||i===1029,rb),this.readBuffer=i}},{key:"_setDrawBuffers",value:function(i){var o=this.gl,s=Ke(o);if(s)s.drawBuffers(i);else{var u=o.getExtension("WEBGL_draw_buffers");u?u.drawBuffersWEBGL(i):Q(i.length===1&&(i[0]===36064||i[0]===1029),rb)}this.drawBuffers=i}},{key:"_getAttachmentParameterFallback",value:function(i){var o=ks(this.gl);switch(i){case 36052:return o.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return o.WEBGL2?null:8;case 33297:return o.WEBGL2?null:5125;case 33296:return!o.WEBGL2&&!o.EXT_sRGB?9729:null;default:return null}}},{key:"_createHandle",value:function(){return this.gl.createFramebuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteFramebuffer(this.handle)}},{key:"_bindHandle",value:function(i){return this.gl.bindFramebuffer(36160,i)}}],[{key:"isSupported",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.colorBufferFloat,u=o.colorBufferHalfFloat,f=!0;return s&&(f=Boolean(i.getExtension("EXT_color_buffer_float")||i.getExtension("WEBGL_color_buffer_float")||i.getExtension("OES_texture_float"))),u&&(f=f&&Boolean(i.getExtension("EXT_color_buffer_float")||i.getExtension("EXT_color_buffer_half_float"))),f}},{key:"getDefaultFramebuffer",value:function(i){return i.luma=i.luma||{},i.luma.defaultFramebuffer=i.luma.defaultFramebuffer||new n(i,{id:"default-framebuffer",handle:null,attachments:{}}),i.luma.defaultFramebuffer}}]),n}(kr,Symbol.toStringTag);function FR(e){return e<34069?e+34069:e}function LR(e){var r=Gr.STATUS||{};return r[e]||"Framebuffer error ".concat(e)}var kR=[36049,36048,33296,33298,33299,33300,33301,33302,33303];Gr.ATTACHMENT_PARAMETERS=kR;function Q_(e,r){var t=e.gl,n=e.width,a=e.height,i=e.id,o=new Gr(t,Object.assign({},r,{id:"framebuffer-for-".concat(i),width:n,height:a,attachments:(0,lb.default)({},36064,e)}));return o}var Gs=m(W()),hb=m(H()),db=m(z());function cb(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ih(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?cb(Object(t),!0).forEach(function(n){(0,Gs.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):cb(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var oh=function(){function e(r,t){(0,hb.default)(this,e);var n=t.attributes,a=t.material,i=t.pbrDebug,o=t.imageBasedLightingEnvironment,s=t.lights,u=t.useTangents;this.gl=r,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},Ls(r,Ce.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),i&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(n.NORMAL,"HAS_NORMALS"),this.defineIfPresent(n.TANGENT&&u,"HAS_TANGENTS"),this.defineIfPresent(n.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(s,"USE_LIGHTS"),this.defineIfPresent(i,"PBR_DEBUG"),a&&this.parseMaterial(a)}return(0,db.default)(e,[{key:"defineIfPresent",value:function(t,n){t&&(this.defines[n]=1)}},{key:"parseTexture",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=t.texture&&t.texture.sampler&&t.texture.sampler.parameters||{},o=t.texture.source.image,s,u={};o.compressed?(s=o,u=(0,Gs.default)({},this.gl.TEXTURE_MIN_FILTER,o.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR)):s={data:o};var f=new En(this.gl,ih({id:t.name||t.id,parameters:ih(ih({},i),u),pixelStore:(0,Gs.default)({},this.gl.UNPACK_FLIP_Y_WEBGL,!1)},s));this.uniforms[n]=f,this.defineIfPresent(a,a),this.generatedTextures.push(f)}},{key:"parsePbrMetallicRoughness",value:function(t){t.baseColorTexture&&this.parseTexture(t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&this.parseTexture(t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");var n=t.metallicFactor,a=n===void 0?1:n,i=t.roughnessFactor,o=i===void 0?1:i;this.uniforms.u_MetallicRoughnessValues=[a,o]}},{key:"parseMaterial",value:function(t){if(this.uniforms.pbr_uUnlit=Boolean(t.unlit),t.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(t.pbrMetallicRoughness),t.normalTexture){this.parseTexture(t.normalTexture,"u_NormalSampler","HAS_NORMALMAP");var n=t.normalTexture.scale,a=n===void 0?1:n;this.uniforms.u_NormalScale=a}if(t.occlusionTexture){this.parseTexture(t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");var i=t.occlusionTexture.strength,o=i===void 0?1:i;this.uniforms.u_OcclusionStrength=o}if(t.emissiveTexture&&(this.parseTexture(t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),t.alphaMode==="MASK"){var s=t.alphaCutoff,u=s===void 0?.5:s;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=u}else t.alphaMode==="BLEND"&&(oe.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}},{key:"delete",value:function(){this.generatedTextures.forEach(function(t){return t.delete()})}}]),e}();var Us=m(kc()),bb=m(ys());var pb=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var mb=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function vb(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Nr(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?vb(Object(t),!0).forEach(function(n){(0,Ns.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):vb(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function DR(e){var r=GR();return function(){var n=(0,Ur.default)(e),a;if(r){var i=(0,Ur.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,_b.default)(this,a)}}function GR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function NR(e){var r=e.COLOR_0||e.colors;r||(e.colors={constant:!0,value:new Float32Array([1,1,1])})}var UR={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}},js=function(e){(0,Ab.default)(t,e);var r=DR(t);function t(){return(0,gb.default)(this,t),r.apply(this,arguments)}return(0,yb.default)(t,[{key:"getShaders",value:function(){var a=(0,_a.default)((0,Ur.default)(t.prototype),"getShaders",this).call(this),i=a.modules;return i.push(Us.pbr),Nr(Nr({},a),{},{vs:pb,fs:mb})}},{key:"initializeState",value:function(){var a=this.props.featureIds;(0,_a.default)((0,Ur.default)(t.prototype),"initializeState",this).call(this);var i=this.getAttributeManager();a&&i.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}},{key:"updateState",value:function(a){(0,_a.default)((0,Ur.default)(t.prototype),"updateState",this).call(this,a);var i=a.props,o=a.oldProps;i.pbrMaterial!==o.pbrMaterial&&this.updatePbrMaterialUniforms(i.pbrMaterial)}},{key:"draw",value:function(a){var i=this.props.featureIds;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:Boolean(i)}),(0,_a.default)((0,Ur.default)(t.prototype),"draw",this).call(this,a))}},{key:"getModel",value:function(a){var i=this.props,o=i.id,s=i.pbrMaterial,u=this.parseMaterial(s,a);this.setState({materialParser:u});var f=this.getShaders();NR(a.attributes);var l=new Us.Model(this.context.gl,Nr(Nr({},this.getShaders()),{},{id:o,geometry:a,defines:Nr(Nr(Nr({},f.defines),u?.defines),{},{HAS_UV_REGIONS:a.attributes.uvRegions}),parameters:u?.parameters,isInstanced:!0}));return l}},{key:"updatePbrMaterialUniforms",value:function(a){var i=this.state.model;if(i){var o=this.props.mesh,s=this.parseMaterial(a,o);this.setState({materialParser:s}),i.setUniforms(s.uniforms)}}},{key:"parseMaterial",value:function(a,i){var o,s=Boolean(a.pbrMetallicRoughness&&a.pbrMetallicRoughness.baseColorTexture);return(o=this.state.materialParser)===null||o===void 0||o.delete(),new oh(this.context.gl,{attributes:{NORMAL:i.attributes.normals,TEXCOORD_0:i.attributes.texCoords},material:Nr({unlit:s},a),pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}},{key:"calculateFeatureIdsPickingColors",value:function(a){for(var i=this.props.featureIds,o=new Uint8ClampedArray(i.length*a.size),s=[],u=0;u<i.length;u++)this.encodePickingColor(i[u],s),o[u*3]=s[0],o[u*3+1]=s[1],o[u*3+2]=s[2];a.value=o}},{key:"finalizeState",value:function(a){var i;(0,_a.default)((0,Ur.default)(t.prototype),"finalizeState",this).call(this,a),(i=this.state.materialParser)===null||i===void 0||i.delete(),this.setState({materialParser:null})}}]),t}(bb.SimpleMeshLayer);(0,Ns.default)(js,"layerName","MeshLayer");(0,Ns.default)(js,"defaultProps",UR);var RC=m(ba());var Lh=m(ce()),tu=m(X()),KT=m(W()),QT=m(H()),ZT=m(z()),Bn=m(Y());function sh(e){if(Array.isArray(e))return e}function uh(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],a=!0,i=!1,o,s;try{for(t=t.call(e);!(a=(o=t.next()).done)&&(n.push(o.value),!(r&&n.length===r));a=!0);}catch(u){i=!0,s=u}finally{try{!a&&t.return!=null&&t.return()}finally{if(i)throw s}}return n}}function Hs(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function fh(e,r){if(e){if(typeof e=="string")return Hs(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Hs(e,r)}}function lh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ch(e,r){return sh(e)||uh(e,r)||fh(e,r)||lh()}function hh(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function xb(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dh(e,r,t){return r&&xb(e.prototype,r),t&&xb(e,t),e}function Mt(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var fr=6378137,lr=6378137,cr=6356752314245179e-9,jR={radii:[fr,lr,cr],radiiSquared:[fr*fr,lr*lr,cr*cr],oneOverRadii:[1/fr,1/lr,1/cr],oneOverRadiiSquared:[1/(fr*fr),1/(lr*lr),1/(cr*cr)],maximumRadius:Math.max(fr,lr,cr),centerToleranceSquared:.1};function Vs(e){return e}var MX=new w;function HR(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Vs;return"longitude"in e?(r[0]=t(e.longitude),r[1]=t(e.latitude),r[2]=e.height):"x"in e?(r[0]=t(e.x),r[1]=t(e.y),r[2]=e.z):(r[0]=t(e[0]),r[1]=t(e[1]),r[2]=e[2]),r}function Eb(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return HR(e,r,be._cartographicRadians?Vs:Kl)}function VR(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Vs;return"longitude"in r?(r.longitude=t(e[0]),r.latitude=t(e[1]),r.height=e[2]):"x"in r?(r.x=t(e[0]),r.y=t(e[1]),r.z=e[2]):(r[0]=t(e[0]),r[1]=t(e[1]),r[2]=e[2]),r}function Sb(e,r){return VR(e,r,be._cartographicRadians?Vs:Ql)}var Ta=new w,zR=new w,WR=new w;function ph(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],n=r.oneOverRadii,a=r.oneOverRadiiSquared,i=r.centerToleranceSquared;Ta.from(e);var o=Ta.x,s=Ta.y,u=Ta.z,f=n.x,l=n.y,c=n.z,h=o*o*f*f,d=s*s*l*l,p=u*u*c*c,v=h+d+p,g=Math.sqrt(1/v);if(Number.isFinite(g)){var y=zR;if(y.copy(e).scale(g),v<i)return y.to(t);var b=a.x,E=a.y,T=a.z,S=WR;S.set(y.x*b*2,y.y*E*2,y.z*T*2);var I=(1-g)*Ta.len()/(.5*S.len()),L=0,B,C,_,R;do{I-=L,B=1/(1+I*b),C=1/(1+I*E),_=1/(1+I*T);var F=B*B,k=C*C,D=_*_,M=F*B,O=k*C,P=D*_;R=h*F+d*k+p*D-1;var U=h*M*b+d*O*E+p*P*T,G=-2*U;L=R/G}while(Math.abs(R)>Wt.EPSILON12);return Ta.scale([B,C,_]).to(t)}}var Cb=1e-14,JR=new w,wb={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},mh={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},hr={east:new w,north:new w,up:new w,west:new w,south:new w,down:new w},qR=new w,XR=new w,YR=new w;function zs(e,r,t,n,a,i){var o=wb[r]&&wb[r][t];ue(o&&(!n||n===o));var s,u,f,l=JR.copy(a),c=Je(l.x,0,Cb)&&Je(l.y,0,Cb);if(c){var h=Math.sign(l.z);s=qR.fromArray(mh[r]),r!=="east"&&r!=="west"&&s.scale(h),u=XR.fromArray(mh[t]),t!=="east"&&t!=="west"&&u.scale(h),f=YR.fromArray(mh[n]),n!=="east"&&n!=="west"&&f.scale(h)}else{var d=hr.up,p=hr.east,v=hr.north;p.set(-l.y,l.x,0).normalize(),e.geodeticSurfaceNormal(l,d),v.copy(d).cross(p);var g=hr.down,y=hr.west,b=hr.south;g.copy(d).scale(-1),y.copy(p).scale(-1),b.copy(v).scale(-1),s=hr[r],u=hr[t],f=hr[n]}return i[0]=s.x,i[1]=s.y,i[2]=s.z,i[3]=0,i[4]=u.x,i[5]=u.y,i[6]=u.z,i[7]=0,i[8]=f.x,i[9]=f.y,i[10]=f.z,i[11]=0,i[12]=l.x,i[13]=l.y,i[14]=l.z,i[15]=1,i}var Ws=new w,Bb=new w,KR=new w,Gt=new w,QR=new w,Js=new w;var ge=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;hh(this,e),Mt(this,"radii",void 0),Mt(this,"radiiSquared",void 0),Mt(this,"radiiToTheFourth",void 0),Mt(this,"oneOverRadii",void 0),Mt(this,"oneOverRadiiSquared",void 0),Mt(this,"minimumRadius",void 0),Mt(this,"maximumRadius",void 0),Mt(this,"centerToleranceSquared",Wt.EPSILON1),Mt(this,"squaredXOverSquaredZ",void 0),ue(r>=0),ue(t>=0),ue(n>=0),this.radii=new w(r,t,n),this.radiiSquared=new w(r*r,t*t,n*n),this.radiiToTheFourth=new w(r*r*r*r,t*t*t*t,n*n*n*n),this.oneOverRadii=new w(r===0?0:1/r,t===0?0:1/t,n===0?0:1/n),this.oneOverRadiiSquared=new w(r===0?0:1/(r*r),t===0?0:1/(t*t),n===0?0:1/(n*n)),this.minimumRadius=Math.min(r,t,n),this.maximumRadius=Math.max(r,t,n),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}return dh(e,[{key:"equals",value:function(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}},{key:"toString",value:function(){return this.radii.toString()}},{key:"cartographicToCartesian",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],a=Bb,i=KR,o=ch(t,3),s=o[2];this.geodeticSurfaceNormalCartographic(t,a),i.copy(this.radiiSquared).scale(a);var u=Math.sqrt(a.dot(i));return i.scale(1/u),a.scale(s),i.add(a),i.to(n)}},{key:"cartesianToCartographic",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];Js.from(t);var a=this.scaleToGeodeticSurface(Js,Gt);if(a){var i=this.geodeticSurfaceNormal(a,Bb),o=QR;o.copy(Js).subtract(a);var s=Math.atan2(i.y,i.x),u=Math.asin(i.z),f=Math.sign(ui(o,Js))*wl(o);return Sb([s,u,f],n)}}},{key:"eastNorthUpToFixedFrame",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new $;return zs(this,"east","north","up",t,n)}},{key:"localFrameToFixedFrame",value:function(t,n,a,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:new $;return zs(this,t,n,a,i,o)}},{key:"geocentricSurfaceNormal",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Ws.from(t).normalize().to(n)}},{key:"geodeticSurfaceNormalCartographic",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],a=Eb(t),i=a[0],o=a[1],s=Math.cos(o);return Ws.set(s*Math.cos(i),s*Math.sin(i),Math.sin(o)).normalize(),Ws.to(n)}},{key:"geodeticSurfaceNormal",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Ws.from(t).scale(this.oneOverRadiiSquared).normalize().to(n)}},{key:"scaleToGeodeticSurface",value:function(t,n){return ph(t,this,n)}},{key:"scaleToGeocentricSurface",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];Gt.from(t);var a=Gt.x,i=Gt.y,o=Gt.z,s=this.oneOverRadiiSquared,u=1/Math.sqrt(a*a*s.x+i*i*s.y+o*o*s.z);return Gt.multiplyScalar(u).to(n)}},{key:"transformPositionToScaledSpace",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Gt.from(t).scale(this.oneOverRadii).to(n)}},{key:"transformPositionFromScaledSpace",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return Gt.from(t).scale(this.radii).to(n)}},{key:"getSurfaceNormalIntersectionWithZAxis",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,0];ue(Je(this.radii.x,this.radii.y,Wt.EPSILON15)),ue(this.radii.z>0),Gt.from(t);var i=Gt.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-n))return Gt.set(0,0,i).to(a)}}]),e}();Mt(ge,"WGS84",new ge(fr,lr,cr));var Fb=m(H()),Lb=m(z());var Ib=m(H()),Pb=m(z());var Mb=m(H());var Ob=function e(r,t,n){(0,Mb.default)(this,e),A(this,"item",void 0),A(this,"previous",void 0),A(this,"next",void 0),this.item=r,this.previous=t,this.next=n};var Rb=function(){function e(){(0,Ib.default)(this,e),A(this,"head",null),A(this,"tail",null),A(this,"_length",0)}return(0,Pb.default)(e,[{key:"length",get:function(){return this._length}},{key:"add",value:function(t){var n=new Ob(t,this.tail,null);return this.tail?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n),++this._length,n}},{key:"remove",value:function(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}},{key:"splice",value:function(t,n){t!==n&&(this.remove(n),this._insert(t,n))}},{key:"_insert",value:function(t,n){var a=t.next;t.next=n,this.tail===t?this.tail=n:a.previous=n,n.next=a,n.previous=t,++this._length}}]),e}();function vh(e){return e!=null}var kb=function(){function e(){(0,Fb.default)(this,e),A(this,"_list",void 0),A(this,"_sentinel",void 0),A(this,"_trimTiles",void 0),this._list=new Rb,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}return(0,Lb.default)(e,[{key:"reset",value:function(){this._list.splice(this._list.tail,this._sentinel)}},{key:"touch",value:function(t){var n=t._cacheNode;vh(n)&&this._list.splice(this._sentinel,n)}},{key:"add",value:function(t,n,a){vh(n._cacheNode)||(n._cacheNode=this._list.add(n),a&&a(t,n))}},{key:"unloadTile",value:function(t,n,a){var i=n._cacheNode;vh(i)&&(this._list.remove(i),n._cacheNode=void 0,a&&a(t,n))}},{key:"unloadTiles",value:function(t,n){var a=this._trimTiles;this._trimTiles=!1;for(var i=this._list,o=t.maximumMemoryUsage*1024*1024,s=this._sentinel,u=i.head;u!==s&&(t.gpuMemoryUsageInBytes>o||a);){var f=u.item;u=u.next,this.unloadTile(t,f,n)}}},{key:"trim",value:function(){this._trimTiles=!0}}]),e}();function Db(e,r){te(e),te(r);var t=r.rtcCenter,n=r.gltfUpAxis,a=e.computedTransform,i=e.boundingVolume.center,o=new $(a);switch(t&&o.translate(t),n){case"Z":break;case"Y":var s=new $().rotateX(Math.PI/2);o=o.multiplyRight(s);break;case"X":var u=new $().rotateY(-Math.PI/2);o=o.multiplyRight(u);break;default:break}r.isQuantized&&o.translate(r.quantizedVolumeOffset).scale(r.quantizedVolumeScale);var f=new w(i);r.cartesianModelMatrix=o,r.cartesianOrigin=f;var l=ge.WGS84.cartesianToCartographic(f,new w),c=ge.WGS84.eastNorthUpToFixedFrame(f),h=c.invert();r.cartographicModelMatrix=h.multiplyRight(o),r.cartographicOrigin=l,r.coordinateSystem||(r.modelMatrix=r.cartographicModelMatrix)}var yh=m(ce());function ZR(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=$R(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function $R(e,r){if(e){if(typeof e=="string")return Gb(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Gb(e,r)}}function Gb(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Nb=new w,gh=new w,Ah=new pt([new ke,new ke,new ke,new ke,new ke,new ke]);function jb(e,r){var t=e.cameraDirection,n=e.cameraUp,a=e.height,i=e.distanceScales.metersPerUnit,o=qs(e,e.center),s=ge.WGS84.eastNorthUpToFixedFrame(o),u=e.unprojectPosition(e.cameraPosition),f=ge.WGS84.cartographicToCartesian(u,new w),l=new w(s.transformAsVector(new w(t).scale(i))).normalize(),c=new w(s.transformAsVector(new w(n).scale(i))).normalize();eF(e);var h=e.constructor,d=e.longitude,p=e.latitude,v=e.width,g=e.bearing,y=e.zoom,b=new h({longitude:d,latitude:p,height:a,width:v,bearing:g,zoom:y,pitch:0});return{camera:{position:f,direction:l,up:c},viewport:e,topDownViewport:b,height:a,cullingVolume:Ah,frameNumber:r,sseDenominator:1.15}}function Hb(e,r,t){if(t===0||e.length<=t)return[e,[]];var n=[],a=r.viewport,i=a.longitude,o=a.latitude,s=ZR(e.entries()),u;try{for(s.s();!(u=s.n()).done;){var f=(0,yh.default)(u.value,2),l=f[0],c=f[1],h=(0,yh.default)(c.header.mbs,2),d=h[0],p=h[1],v=Math.abs(i-d),g=Math.abs(o-p),y=Math.sqrt(g*g+v*v);n.push([l,y])}}catch(L){s.e(L)}finally{s.f()}for(var b=n.sort(function(L,B){return L[1]-B[1]}),E=[],T=0;T<t;T++)E.push(e[b[T][0]]);for(var S=[],I=t;I<b.length;I++)S.push(e[b[I][0]]);return[E,S]}function eF(e){var r=e.getFrustumPlanes(),t=Ub(r.near,e.cameraPosition),n=qs(e,t),a=qs(e,e.cameraPosition,gh),i=0;Ah.planes[i++].fromPointNormal(n,Nb.copy(n).subtract(a));for(var o in r)if(o!=="near"){var s=r[o],u=Ub(s,t,gh),f=qs(e,u,gh);Ah.planes[i++].fromPointNormal(f,Nb.copy(n).subtract(f))}}function Ub(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new w,n=e.normal.dot(r);return t.copy(e.normal).scale(e.distance-n).add(r),t}function qs(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new w,n=e.unprojectPosition(r);return ge.WGS84.cartographicToCartesian(n,t)}var zb=m(ce());var tF=6378137,rF=6378137,_h=6356752314245179e-9,Vb=new w;function Wb(e,r){if(e instanceof mn){var t=e.halfAxes,n=nF(t);return Math.log2(_h/(n+r[2]))}else if(e instanceof Or){var a=e.radius;return Math.log2(_h/(a+r[2]))}else if(e.width&&e.height){var i=e.width,o=e.height,s=Math.log2(tF/i),u=Math.log2(rF/o);return(s+u)/2}return 1}function bh(e,r,t){var n=ge.WGS84.cartographicToCartesian([e.xmax,e.ymax,e.zmax],new w),a=Math.sqrt(Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2)+Math.pow(n[2]-t[2],2));return Math.log2(_h/(a+r[2]))}function Jb(e,r,t){var n=(0,zb.default)(e,4),a=n[0],i=n[1],o=n[2],s=n[3];return bh({xmin:a,xmax:o,ymin:i,ymax:s,zmin:0,zmax:0},r,t)}function nF(e){e.getColumn(0,Vb);var r=e.getColumn(1),t=e.getColumn(2),n=Vb.add(r).add(t),a=n.len();return a}var Bh=m(W()),mT=m(X()),vT=m(H()),gT=m(z()),wh=m(Y());var yT=m(ba());var ct={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},mt={ADD:1,REPLACE:2},dr={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},tt={I3S:"I3S",TILES3D:"TILES3D"},Cn={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},qb={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};var wn=m(St()),Th=m(ce());function Yb(e){return e!=null}var rt=new w,Xs=new w,aF=new w,iF=new w;function Ys(e,r,t){if(te(e,"3D Tile: boundingVolume must be defined"),e.box)return oF(e.box,r,t);if(e.region){var n=(0,Th.default)(e.region,6),a=n[0],i=n[1],o=n[2],s=n[3],u=n[4],f=n[5],l=ge.WGS84.cartographicToCartesian([kt(a),kt(s),u],aF),c=ge.WGS84.cartographicToCartesian([kt(o),kt(i),f],iF),h=new w().addVectors(l,c).multiplyScalar(.5),d=new w().subVectors(l,c).len()/2;return Xb([h[0],h[1],h[2],d],new $)}if(e.sphere)return Xb(e.sphere,r,t);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function Kb(e,r){if(e.box)return sF(r);if(e.region){var t=(0,Th.default)(e.region,6),n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5];return[[kt(n),kt(a),s],[kt(i),kt(o),u]]}if(e.sphere)return uF(r);throw new Error("Unkown boundingVolume type")}function oF(e,r,t){var n=new w(e[0],e[1],e[2]);r.transform(n,n);var a=[];if(e.length===10){var i=e.slice(3,6),o=new Mr;o.fromArray(e,6);var s=new w([1,0,0]),u=new w([0,1,0]),f=new w([0,0,1]);s.transformByQuaternion(o),s.scale(i[0]),u.transformByQuaternion(o),u.scale(i[1]),f.transformByQuaternion(o),f.scale(i[2]),a=[].concat((0,wn.default)(s.toArray()),(0,wn.default)(u.toArray()),(0,wn.default)(f.toArray()))}else a=[].concat((0,wn.default)(e.slice(3,6)),(0,wn.default)(e.slice(6,9)),(0,wn.default)(e.slice(9,12)));var l=r.transformAsVector(a.slice(0,3)),c=r.transformAsVector(a.slice(3,6)),h=r.transformAsVector(a.slice(6,9)),d=new ye([l[0],l[1],l[2],c[0],c[1],c[2],h[0],h[1],h[2]]);return Yb(t)?(t.center=n,t.halfAxes=d,t):new mn(n,d)}function Xb(e,r,t){var n=new w(e[0],e[1],e[2]);r.transform(n,n);var a=r.getScale(Xs),i=Math.max(Math.max(a[0],a[1]),a[2]),o=e[3]*i;return Yb(t)?(t.center=n,t.radius=o,t):new Or(n,o)}function sF(e){for(var r=Qb(),t=e.halfAxes,n=new w(t.getColumn(0)),a=new w(t.getColumn(1)),i=new w(t.getColumn(2)),o=0;o<2;o++){for(var s=0;s<2;s++){for(var u=0;u<2;u++)rt.copy(e.center),rt.add(n),rt.add(a),rt.add(i),Zb(r,rt),i.negate();a.negate()}n.negate()}return r}function uF(e){var r=Qb(),t=e.center,n=e.radius,a=ge.WGS84.scaleToGeodeticSurface(t,rt),i;a?i=ge.WGS84.geodeticSurfaceNormal(a):i=new w(0,0,1);var o=new w(i[2],-i[1],0);o.len()>0?o.normalize():o=new w(0,1,0);for(var s=o.clone().cross(i),u=0,f=[o,s,i];u<f.length;u++){var l=f[u];Xs.copy(l).scale(n);for(var c=0;c<2;c++)rt.copy(t),rt.add(Xs),Zb(r,rt),Xs.negate()}return r}function Qb(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function Zb(e,r){ge.WGS84.cartesianToCartographic(r,rt),e[0][0]=Math.min(e[0][0],rt[0]),e[0][1]=Math.min(e[0][1],rt[1]),e[0][2]=Math.min(e[0][2],rt[2]),e[1][0]=Math.max(e[1][0],rt[0]),e[1][1]=Math.max(e[1][1],rt[1]),e[1][2]=Math.max(e[1][2],rt[2])}var T7=new w,x7=new w,E7=new $,S7=new w,C7=new w,w7=new w;function fF(e,r){var t=e*r;return 1-Math.exp(-(t*t))}function lF(e,r){if(e.dynamicScreenSpaceError&&e.dynamicScreenSpaceErrorComputedDensity){var t=e.dynamicScreenSpaceErrorComputedDensity,n=e.dynamicScreenSpaceErrorFactor,a=fF(r,t)*n;return a}return 0}function $b(e,r,t){var n=e.tileset,a=e.parent&&e.parent.lodMetricValue||e.lodMetricValue,i=t?a:e.lodMetricValue;if(i===0)return 0;var o=Math.max(e._distanceToCamera,1e-7),s=r.height,u=r.sseDenominator,f=n.options.viewDistanceScale,l=i*s*(f||1)/(o*u);return l-=lF(n,o),l}var nT=m(St());var xh=new w,eT=new w,jr=new w,tT=new w,cF=new w,Eh=new $,rT=new $;function aT(e,r){if(e.lodMetricValue===0||isNaN(e.lodMetricValue))return"DIG";var t=2*Sh(e,r);return t<2?"OUT":!e.header.children||t<=e.lodMetricValue?"DRAW":e.header.children?"DIG":"OUT"}function Sh(e,r){var t=r.topDownViewport,n=e.header.mbs[1],a=e.header.mbs[0],i=e.header.mbs[2],o=e.header.mbs[3],s=(0,nT.default)(e.boundingVolume.center),u=t.unprojectPosition(t.cameraPosition);ge.WGS84.cartographicToCartesian(u,xh),eT.copy(xh).subtract(s).normalize(),ge.WGS84.eastNorthUpToFixedFrame(s,Eh),rT.copy(Eh).invert(),jr.copy(xh).transform(rT);var f=Math.sqrt(jr[0]*jr[0]+jr[1]*jr[1]),l=f*f/jr[2];tT.copy([jr[0],jr[1],l]);var c=tT.transform(Eh),h=c.subtract(s).normalize(),d=eT.cross(h).normalize().scale(o),p=d.add(s),v=ge.WGS84.cartesianToCartographic(p),g=t.project([a,n,i]),y=t.project(v),b=cF.copy(g).subtract(y).magnitude();return b}function iT(e){return{assetGltfUpAxis:e.asset&&e.asset.gltfUpAxis||"Y"}}var lT=m(W()),cT=m(H()),hT=m(z());var oT=m(H()),sT=m(z());var Ch=function(){function e(){(0,oT.default)(this,e);var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;A(this,"_map",new Map),A(this,"_array",void 0),A(this,"_length",void 0),this._array=new Array(r),this._length=r}return(0,sT.default)(e,[{key:"length",get:function(){return this._length},set:function(t){this._length=t,t>this._array.length&&(this._array.length=t)}},{key:"values",get:function(){return this._array}},{key:"get",value:function(t){return te(t<this._array.length),this._array[t]}},{key:"set",value:function(t,n){te(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=n,this._map.set(n,t)}},{key:"delete",value:function(t){var n=this._map.get(t);n>=0&&(this._array.splice(n,1),this._map.delete(t),this.length--)}},{key:"peek",value:function(){return this._array[this._length-1]}},{key:"push",value:function(t){if(!this._map.has(t)){var n=this.length++;this._array[n]=t,this._map.set(t,n)}}},{key:"pop",value:function(){var t=this._array[--this.length];return this._map.delete(t),t}},{key:"reserve",value:function(t){te(t>=0),t>this._array.length&&(this._array.length=t)}},{key:"resize",value:function(t){te(t>=0),this.length=t}},{key:"trim",value:function(t){t==null&&(t=this.length),this._array.length=t}},{key:"reset",value:function(){this._array=[],this._map=new Map,this._length=0}},{key:"find",value:function(t){return this._map.has(t)}}]),e}();function Ks(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=hF(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function hF(e,r){if(e){if(typeof e=="string")return uT(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return uT(e,r)}}function uT(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function fT(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Qs(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?fT(Object(t),!0).forEach(function(n){(0,lT.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fT(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var dF={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:function(){},viewportTraversersMap:{},basePath:""},Hr=function(){function e(r){(0,cT.default)(this,e),A(this,"options",void 0),A(this,"root",void 0),A(this,"requestedTiles",void 0),A(this,"selectedTiles",void 0),A(this,"emptyTiles",void 0),A(this,"lastUpdate",new Date().getTime()),A(this,"updateDebounceTime",1e3),A(this,"_traversalStack",void 0),A(this,"_emptyTraversalStack",void 0),A(this,"_frameNumber",void 0),this.options=Qs(Qs({},dF),r),this._traversalStack=new Ch,this._emptyTraversalStack=new Ch,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}return(0,hT.default)(e,[{key:"traversalFinished",value:function(t){return!0}},{key:"traverse",value:function(t,n,a){this.root=t,this.options=Qs(Qs({},this.options),a),this.reset(),this.updateTile(t,n),this._frameNumber=n.frameNumber,this.executeTraversal(t,n)}},{key:"reset",value:function(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}},{key:"executeTraversal",value:function(t,n){var a=this._traversalStack;for(t._selectionDepth=1,a.push(t);a.length>0;){var i=a.pop(),o=!1;this.canTraverse(i,n)&&(this.updateChildTiles(i,n),o=this.updateAndPushChildren(i,n,a,i.hasRenderContent?i._selectionDepth+1:i._selectionDepth));var s=i.parent,u=Boolean(!s||s._shouldRefine),f=!o;i.hasRenderContent?i.refine===mt.ADD?(this.loadTile(i,n),this.selectTile(i,n)):i.refine===mt.REPLACE&&(this.loadTile(i,n),f&&this.selectTile(i,n)):(this.emptyTiles[i.id]=i,this.loadTile(i,n),f&&this.selectTile(i,n)),this.touchTile(i,n),i._shouldRefine=o&&u}var l=new Date().getTime();(this.traversalFinished(n)||l-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=l,this.options.onTraversalEnd(n))}},{key:"updateChildTiles",value:function(t,n){var a=t.children,i=Ks(a),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;this.updateTile(s,n)}}catch(u){i.e(u)}finally{i.f()}return!0}},{key:"updateAndPushChildren",value:function(t,n,a,i){var o=this.options,s=o.loadSiblings,u=o.skipLevelOfDetail,f=t.children;f.sort(this.compareDistanceToCamera.bind(this));var l=t.refine===mt.REPLACE&&t.hasRenderContent&&!u,c=!1,h=!0,d=Ks(f),p;try{for(d.s();!(p=d.n()).done;){var v=p.value;if(v._selectionDepth=i,v.isVisibleAndInRequestVolume?(a.find(v)&&a.delete(v),a.push(v),c=!0):(l||s)&&(this.loadTile(v,n),this.touchTile(v,n)),l){var g=void 0;if(v._inRequestVolume?v.hasRenderContent?g=v.contentAvailable:g=this.executeEmptyTraversal(v,n):g=!1,h=h&&g,!h)return!1}}}catch(y){d.e(y)}finally{d.f()}return c||(h=!1),h}},{key:"updateTile",value:function(t,n){this.updateTileVisibility(t,n)}},{key:"selectTile",value:function(t,n){this.shouldSelectTile(t)&&(t._selectedFrame=n.frameNumber,this.selectedTiles[t.id]=t)}},{key:"loadTile",value:function(t,n){this.shouldLoadTile(t)&&(t._requestedFrame=n.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}},{key:"touchTile",value:function(t,n){t.tileset._cache.touch(t),t._touchedFrame=n.frameNumber}},{key:"canTraverse",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return t.hasChildren?t.hasTilesetContent?!t.contentExpired:!i&&!t.isVisibleAndInRequestVolume?!1:this.shouldRefine(t,n,a):!1}},{key:"shouldLoadTile",value:function(t){return t.hasUnloadedContent||t.contentExpired}},{key:"shouldSelectTile",value:function(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}},{key:"shouldRefine",value:function(t,n,a){var i=t._screenSpaceError;return a&&(i=t.getScreenSpaceError(n,!0)),i>this.options.maximumScreenSpaceError}},{key:"updateTileVisibility",value:function(t,n){var a=[];if(this.options.viewportTraversersMap)for(var i in this.options.viewportTraversersMap){var o=this.options.viewportTraversersMap[i];o===n.viewport.id&&a.push(i)}else a.push(n.viewport.id);t.updateVisibility(n,a)}},{key:"compareDistanceToCamera",value:function(t,n){return t._distanceToCamera-n._distanceToCamera}},{key:"anyChildrenVisible",value:function(t,n){var a=!1,i=Ks(t.children),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;s.updateVisibility(n),a=a||s.isVisibleAndInRequestVolume}}catch(u){i.e(u)}finally{i.f()}return a}},{key:"executeEmptyTraversal",value:function(t,n){var a=!0,i=this._emptyTraversalStack;for(i.push(t);i.length>0&&a;){var o=i.pop();this.updateTile(o,n),o.isVisibleAndInRequestVolume||this.loadTile(o,n),this.touchTile(o,n);var s=!o.hasRenderContent&&this.canTraverse(o,n,!1,!0);if(s){var u=o.children,f=Ks(u),l;try{for(f.s();!(l=f.n()).done;){var c=l.value;i.find(c)&&i.delete(c),i.push(c)}}catch(h){f.e(h)}finally{f.f()}}else o.contentAvailable||(a=!1)}return a}}]),e}();function dT(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function xa(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?dT(Object(t),!0).forEach(function(n){(0,Bh.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):dT(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var pT=new w;function pF(e){return e!=null}var Fi=function(){function e(r,t,n){(0,vT.default)(this,e);var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";A(this,"tileset",void 0),A(this,"header",void 0),A(this,"id",void 0),A(this,"url",void 0),A(this,"parent",void 0),A(this,"refine",void 0),A(this,"type",void 0),A(this,"contentUrl",void 0),A(this,"lodMetricType",void 0),A(this,"lodMetricValue",void 0),A(this,"boundingVolume",void 0),A(this,"content",void 0),A(this,"contentState",void 0),A(this,"gpuMemoryUsageInBytes",void 0),A(this,"children",void 0),A(this,"depth",void 0),A(this,"viewportIds",void 0),A(this,"transform",void 0),A(this,"extensions",void 0),A(this,"implicitTiling",void 0),A(this,"userData",void 0),A(this,"computedTransform",void 0),A(this,"hasEmptyContent",void 0),A(this,"hasTilesetContent",void 0),A(this,"traverser",void 0),A(this,"_cacheNode",void 0),A(this,"_frameNumber",void 0),A(this,"_lodJudge",void 0),A(this,"_expireDate",void 0),A(this,"_expiredContent",void 0),A(this,"_shouldRefine",void 0),A(this,"_boundingBox",void 0),A(this,"_distanceToCamera",void 0),A(this,"_centerZDepth",void 0),A(this,"_screenSpaceError",void 0),A(this,"_visibilityPlaneMask",void 0),A(this,"_visible",void 0),A(this,"_inRequestVolume",void 0),A(this,"_stackLength",void 0),A(this,"_selectionDepth",void 0),A(this,"_touchedFrame",void 0),A(this,"_visitedFrame",void 0),A(this,"_selectedFrame",void 0),A(this,"_requestedFrame",void 0),A(this,"_priority",void 0),A(this,"_contentBoundingVolume",void 0),A(this,"_viewerRequestVolume",void 0),A(this,"_initialTransform",void 0),this.header=t,this.tileset=r,this.id=a||t.id,this.url=t.url,this.parent=n,this.refine=this._getRefine(t.refine),this.type=t.type,this.contentUrl=t.contentUrl,this.lodMetricType="geometricError",this.lodMetricValue=0,this.boundingVolume=null,this.content=null,this.contentState=ct.UNLOADED,this.gpuMemoryUsageInBytes=0,this.children=[],this.hasEmptyContent=!1,this.hasTilesetContent=!1,this.depth=0,this.viewportIds=[],this.userData={},this.extensions=null,this._priority=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._screenSpaceError=0,this._cacheNode=null,this._frameNumber=null,this._cacheNode=null,this.traverser=new Hr({}),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._initialTransform=new $,this.transform=new $,this._initializeLodMetric(t),this._initializeTransforms(t),this._initializeBoundingVolumes(t),this._initializeContent(t),this._initializeRenderingState(t),this._lodJudge=null,this._expireDate=null,this._expiredContent=null,this.implicitTiling=null,Object.seal(this)}return(0,gT.default)(e,[{key:"destroy",value:function(){this.header=null}},{key:"isDestroyed",value:function(){return this.header===null}},{key:"selected",get:function(){return this._selectedFrame===this.tileset._frameNumber}},{key:"isVisible",get:function(){return this._visible}},{key:"isVisibleAndInRequestVolume",get:function(){return this._visible&&this._inRequestVolume}},{key:"hasRenderContent",get:function(){return!this.hasEmptyContent&&!this.hasTilesetContent}},{key:"hasChildren",get:function(){return this.children.length>0||this.header.children&&this.header.children.length>0}},{key:"contentReady",get:function(){return this.contentState===ct.READY||this.hasEmptyContent}},{key:"contentAvailable",get:function(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}},{key:"hasUnloadedContent",get:function(){return this.hasRenderContent&&this.contentUnloaded}},{key:"contentUnloaded",get:function(){return this.contentState===ct.UNLOADED}},{key:"contentExpired",get:function(){return this.contentState===ct.EXPIRED}},{key:"contentFailed",get:function(){return this.contentState===ct.FAILED}},{key:"distanceToCamera",get:function(){return this._distanceToCamera}},{key:"screenSpaceError",get:function(){return this._screenSpaceError}},{key:"boundingBox",get:function(){return this._boundingBox||(this._boundingBox=Kb(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}},{key:"getScreenSpaceError",value:function(t,n){switch(this.tileset.type){case tt.I3S:return Sh(this,t);case tt.TILES3D:return $b(this,t,n);default:throw new Error("Unsupported tileset type")}}},{key:"unselect",value:function(){this._selectedFrame=0}},{key:"_getPriority",value:function(){var t=this.tileset._traverser,n=t.options.skipLevelOfDetail,a=this.refine===mt.ADD||n;if(a&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===ct.UNLOADED)return-1;var i=this.parent,o=i&&(!a||this._screenSpaceError===0||i.hasTilesetContent),s=o?i._screenSpaceError:this._screenSpaceError,u=t.root?t.root._screenSpaceError:0;return Math.max(u-s,0)}},{key:"loadContent",value:function(){var r=(0,mT.default)(wh.default.mark(function n(){var a,i,o,s,u;return wh.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this.hasEmptyContent){l.next=2;break}return l.abrupt("return",!1);case 2:if(!this.content){l.next=4;break}return l.abrupt("return",!0);case 4:return a=this.contentExpired,a&&(this._expireDate=null),this.contentState=ct.LOADING,l.next=9,this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));case 9:if(i=l.sent,i){l.next=13;break}return this.contentState=ct.UNLOADED,l.abrupt("return",!1);case 13:return l.prev=13,o=this.tileset.getTileUrl(this.contentUrl),s=this.tileset.loader,u=xa(xa({},this.tileset.loadOptions),{},(0,Bh.default)({},s.id,xa(xa({},this.tileset.loadOptions[s.id]),{},{isTileset:this.type==="json"},this._getLoaderSpecificOptions(s.id)))),l.next=19,(0,yT.load)(o,s,u);case 19:if(this.content=l.sent,!this.tileset.options.contentLoader){l.next=23;break}return l.next=23,this.tileset.options.contentLoader(this);case 23:return this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=ct.READY,this._onContentLoaded(),l.abrupt("return",!0);case 29:throw l.prev=29,l.t0=l.catch(13),this.contentState=ct.FAILED,l.t0;case 33:return l.prev=33,i.done(),l.finish(33);case 36:case"end":return l.stop()}},n,this,[[13,29,33,36]])}));function t(){return r.apply(this,arguments)}return t}()},{key:"unloadContent",value:function(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=ct.UNLOADED,!0}},{key:"updateVisibility",value:function(t,n){if(this._frameNumber!==t.frameNumber){var a=this.parent,i=a?a._visibilityPlaneMask:pt.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){var o=a?a.computedTransform:this.tileset.modelMatrix;this._updateTransform(o)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,i),this._visible=this._visibilityPlaneMask!==pt.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=n}}},{key:"visibility",value:function(t,n){var a=t.cullingVolume,i=this.boundingVolume;return a.computeVisibilityWithPlaneMask(i,n)}},{key:"contentVisibility",value:function(){return!0}},{key:"distanceToTile",value:function(t){var n=this.boundingVolume;return Math.sqrt(Math.max(n.distanceSquaredTo(t.camera.position),0))}},{key:"cameraSpaceZDepth",value:function(t){var n=t.camera,a=this.boundingVolume;return pT.subVectors(a.center,n.position),n.direction.dot(pT)}},{key:"insideViewerRequestVolume",value:function(t){var n=this._viewerRequestVolume;return!n||n.distanceSquaredTo(t.camera.position)<=0}},{key:"updateExpiration",value:function(){if(pF(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){var t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=ct.EXPIRED,this._expiredContent=this.content)}}},{key:"extras",get:function(){return this.header.extras}},{key:"_initializeLodMetric",value:function(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}},{key:"_initializeTransforms",value:function(t){this.transform=t.transform?new $(t.transform):new $;var n=this.parent,a=this.tileset,i=n&&n.computedTransform?n.computedTransform.clone():a.modelMatrix.clone();this.computedTransform=new $(i).multiplyRight(this.transform);var o=n&&n._initialTransform?n._initialTransform.clone():new $;this._initialTransform=new $(o).multiplyRight(this.transform)}},{key:"_initializeBoundingVolumes",value:function(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}},{key:"_initializeContent",value:function(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=ct.UNLOADED,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}},{key:"_initializeRenderingState",value:function(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=pt.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}},{key:"_getRefine",value:function(t){return t||this.parent&&this.parent.refine||mt.REPLACE}},{key:"_isTileset",value:function(){return this.contentUrl.indexOf(".json")!==-1}},{key:"_onContentLoaded",value:function(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break;default:}this._isTileset()&&(this.hasTilesetContent=!0)}},{key:"_updateBoundingVolume",value:function(t){this.boundingVolume=Ys(t.boundingVolume,this.computedTransform,this.boundingVolume);var n=t.content;n&&(n.boundingVolume&&(this._contentBoundingVolume=Ys(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=Ys(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}},{key:"_updateTransform",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new $,n=t.clone().multiplyRight(this.transform),a=!n.equals(this.computedTransform);a&&(this.computedTransform=n,this._updateBoundingVolume(this.header))}},{key:"_getLoaderSpecificOptions",value:function(t){switch(t){case"i3s":return xa(xa({},this.tileset.options.i3s),{},{_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1});case"3d-tiles":case"cesium-ion":default:return iT(this.tileset.tileset)}}}]),e}();var AT=m(H()),_T=m(z()),bT=m(Zr()),TT=m(Te()),xT=m(xe()),Zs=m(Ae());function mF(e){var r=vF();return function(){var n=(0,Zs.default)(e),a;if(r){var i=(0,Zs.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,xT.default)(this,a)}}function vF(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ET=function(e){(0,TT.default)(t,e);var r=mF(t);function t(){return(0,AT.default)(this,t),r.apply(this,arguments)}return(0,_T.default)(t,[{key:"compareDistanceToCamera",value:function(a,i){return i._distanceToCamera===0&&a._distanceToCamera===0?i._centerZDepth-a._centerZDepth:i._distanceToCamera-a._distanceToCamera}},{key:"updateTileVisibility",value:function(a,i){if((0,bT.default)((0,Zs.default)(t.prototype),"updateTileVisibility",this).call(this,a,i),!!a.isVisibleAndInRequestVolume){var o=a.children.length>0;if(a.hasTilesetContent&&o){var s=a.children[0];this.updateTileVisibility(s,i),a._visible=s._visible;return}if(this.meetsScreenSpaceErrorEarly(a,i)){a._visible=!1;return}var u=a.refine===mt.REPLACE,f=a._optimChildrenWithinParent===qb.USE_OPTIMIZATION;if(u&&f&&o&&!this.anyChildrenVisible(a,i)){a._visible=!1;return}}}},{key:"meetsScreenSpaceErrorEarly",value:function(a,i){var o=a.parent;return!o||o.hasTilesetContent||o.refine!==mt.ADD?!1:!this.shouldRefine(a,i,!0)}}]),t}(Hr);var RT=m(W()),FT=m(X()),LT=m(H()),kT=m(z()),DT=m(at()),GT=m(Te()),NT=m(xe()),Oh=m(Ae()),Ih=m(Y());var UT=m(ba());var BT=m(H()),MT=m(z());var ST=m(H()),CT=m(z());var wT=function(){function e(){(0,ST.default)(this,e),A(this,"frameNumberMap",new Map)}return(0,CT.default)(e,[{key:"register",value:function(t,n){var a=this.frameNumberMap.get(t)||new Map,i=a.get(n)||0;a.set(n,i+1),this.frameNumberMap.set(t,a)}},{key:"deregister",value:function(t,n){var a=this.frameNumberMap.get(t);if(a){var i=a.get(n)||1;a.set(n,i-1)}}},{key:"isZero",value:function(t,n){var a,i=((a=this.frameNumberMap.get(t))===null||a===void 0?void 0:a.get(n))||0;return i===0}}]),e}();var Mh={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"},OT=function(){function e(){(0,BT.default)(this,e),A(this,"_statusMap",void 0),A(this,"pendingTilesRegister",new wT),this._statusMap={}}return(0,MT.default)(e,[{key:"add",value:function(t,n,a,i){var o=this;if(!this._statusMap[n]){var s=i.frameNumber,u=i.viewport.id;this._statusMap[n]={request:t,callback:a,key:n,frameState:i,status:Mh.REQUESTED},this.pendingTilesRegister.register(u,s),t().then(function(f){o._statusMap[n].status=Mh.COMPLETED;var l=o._statusMap[n].frameState,c=l.frameNumber,h=l.viewport.id;o.pendingTilesRegister.deregister(h,c),o._statusMap[n].callback(f,i)}).catch(function(f){o._statusMap[n].status=Mh.ERROR;var l=o._statusMap[n].frameState,c=l.frameNumber,h=l.viewport.id;o.pendingTilesRegister.deregister(h,c),a(f)})}}},{key:"update",value:function(t,n){if(this._statusMap[t]){var a=this._statusMap[t].frameState,i=a.frameNumber,o=a.viewport.id;this.pendingTilesRegister.deregister(o,i);var s=n.frameNumber,u=n.viewport.id;this.pendingTilesRegister.register(u,s),this._statusMap[t].frameState=n}}},{key:"find",value:function(t){return this._statusMap[t]}},{key:"hasPendingTiles",value:function(t,n){return!this.pendingTilesRegister.isZero(t,n)}}]),e}();function IT(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function $s(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?IT(Object(t),!0).forEach(function(n){(0,RT.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):IT(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function gF(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=yF(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function yF(e,r){if(e){if(typeof e=="string")return PT(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return PT(e,r)}}function PT(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function AF(e){var r=_F();return function(){var n=(0,Oh.default)(e),a;if(r){var i=(0,Oh.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,NT.default)(this,a)}}function _F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jT=function(e){(0,GT.default)(t,e);var r=AF(t);function t(n){var a;return(0,LT.default)(this,t),a=r.call(this,n),A((0,DT.default)(a),"_tileManager",void 0),a._tileManager=new OT,a}return(0,kT.default)(t,[{key:"traversalFinished",value:function(a){return!this._tileManager.hasPendingTiles(a.viewport.id,this._frameNumber||0)}},{key:"shouldRefine",value:function(a,i){return a._lodJudge=aT(a,i),a._lodJudge==="DIG"}},{key:"updateChildTiles",value:function(a,i){var o=this,s=a.header.children||[],u=a.children,f=a.tileset,l=gF(s),c;try{var h=function(){var p=c.value,v="".concat(p.id,"-").concat(i.viewport.id),g=u&&u.find(function(E){return E.id===v});if(g)g&&o.updateTile(g,i);else{var y=function(){return o._loadTile(p.id,f)},b=o._tileManager.find(v);b?o._tileManager.update(v,i):(f.tileset.nodePages&&(y=function(){return f.tileset.nodePagesTile.formTileFromNodePages(p.id)}),o._tileManager.add(y,v,function(E){return o._onTileLoad(E,a,v)},i))}};for(l.s();!(c=l.n()).done;)h()}catch(d){l.e(d)}finally{l.f()}return!1}},{key:"_loadTile",value:function(){var n=(0,FT.default)(Ih.default.mark(function i(o,s){var u,f,l;return Ih.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u=s.loader,f=s.getTileUrl("".concat(s.url,"/nodes/").concat(o)),l=$s($s({},s.loadOptions),{},{i3s:$s($s({},s.loadOptions.i3s),{},{isTileHeader:!0})}),h.next=5,(0,UT.load)(f,u,l);case 5:return h.abrupt("return",h.sent);case 6:case"end":return h.stop()}},i)}));function a(i,o){return n.apply(this,arguments)}return a}()},{key:"_onTileLoad",value:function(a,i,o){var s=new Fi(i.tileset,a,i,o);i.children.push(s);var u=this._tileManager.find(s.id).frameState;this.updateTile(s,u),this._frameNumber===u.frameNumber&&(this.traversalFinished(u)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(s,u)}}]),t}(Hr);function pr(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=bF(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function bF(e,r){if(e){if(typeof e=="string")return HT(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return HT(e,r)}}function HT(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function VT(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ea(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?VT(Object(t),!0).forEach(function(n){(0,KT.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):VT(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var TF={description:"",ellipsoid:ge.WGS84,modelMatrix:new $,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:function(){},onTileUnload:function(){},onTileError:function(){},onTraversalComplete:function(r){return r},contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},eu="Tiles In Tileset(s)",Ph="Tiles In Memory",zT="Tiles In View",WT="Tiles To Render",JT="Tiles Loaded",Rh="Tiles Loading",qT="Tiles Unloaded",XT="Failed Tile Loads",YT="Points/Vertices",Fh="Tile Memory Use",kh=function(){function e(r,t){(0,QT.default)(this,e),A(this,"options",void 0),A(this,"loadOptions",void 0),A(this,"type",void 0),A(this,"tileset",void 0),A(this,"loader",void 0),A(this,"url",void 0),A(this,"basePath",void 0),A(this,"modelMatrix",void 0),A(this,"ellipsoid",void 0),A(this,"lodMetricType",void 0),A(this,"lodMetricValue",void 0),A(this,"refine",void 0),A(this,"root",void 0),A(this,"roots",void 0),A(this,"asset",void 0),A(this,"description",void 0),A(this,"properties",void 0),A(this,"extras",void 0),A(this,"attributions",void 0),A(this,"credits",void 0),A(this,"stats",void 0),A(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1}),A(this,"traverseCounter",void 0),A(this,"geometricError",void 0),A(this,"selectedTiles",void 0),A(this,"updatePromise",null),A(this,"tilesetInitializationPromise",void 0),A(this,"cartographicCenter",void 0),A(this,"cartesianCenter",void 0),A(this,"zoom",void 0),A(this,"boundingVolume",void 0),A(this,"gpuMemoryUsageInBytes",void 0),A(this,"dynamicScreenSpaceErrorComputedDensity",void 0),A(this,"_traverser",void 0),A(this,"_cache",void 0),A(this,"_requestScheduler",void 0),A(this,"_frameNumber",void 0),A(this,"_queryParamsString",void 0),A(this,"_queryParams",void 0),A(this,"_extensionsUsed",void 0),A(this,"_tiles",void 0),A(this,"_pendingCount",void 0),A(this,"lastUpdatedVieports",void 0),A(this,"_requestedTiles",void 0),A(this,"_emptyTiles",void 0),A(this,"frameStateData",void 0),A(this,"maximumMemoryUsage",void 0),te(r),this.options=Ea(Ea({},TF),t),this.tileset=r,this.loader=r.loader,this.type=r.type,this.url=r.url,this.basePath=r.basePath||Xn.dirname(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=r.lodMetricType,this.lodMetricValue=r.lodMetricValue,this.refine=r.root.refine,this.loadOptions=this.options.loadOptions||{},this.root=null,this.roots={},this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this.traverseCounter=0,this.geometricError=0,this._traverser=this._initializeTraverser(),this._cache=new kb,this._requestScheduler=new Xa({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this._frameNumber=0,this._pendingCount=0,this._tiles={},this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this.frameStateData={},this.lastUpdatedVieports=null,this._queryParams={},this._queryParamsString="",this.maximumMemoryUsage=this.options.maximumMemoryUsage||32,this.gpuMemoryUsageInBytes=0,this.stats=new on({id:this.url}),this._initializeStats(),this._extensionsUsed=void 0,this.dynamicScreenSpaceErrorComputedDensity=0,this.extras=null,this.asset={},this.credits={},this.description=this.options.description||"",this.tilesetInitializationPromise=this._initializeTileSet(r)}return(0,ZT.default)(e,[{key:"destroy",value:function(){this._destroy()}},{key:"isLoaded",value:function(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}},{key:"tiles",get:function(){return Object.values(this._tiles)}},{key:"frameNumber",get:function(){return this._frameNumber}},{key:"queryParams",get:function(){return this._queryParamsString||(this._queryParamsString=xF(this._queryParams)),this._queryParamsString}},{key:"setProps",value:function(t){this.options=Ea(Ea({},this.options),t)}},{key:"setOptions",value:function(t){this.options=Ea(Ea({},this.options),t)}},{key:"getTileUrl",value:function(t){var n=t.startsWith("data:");return n?t:"".concat(t).concat(this.queryParams)}},{key:"hasExtension",value:function(t){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(t)>-1)}},{key:"update",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.tilesetInitializationPromise.then(function(){!n&&t.lastUpdatedVieports?n=t.lastUpdatedVieports:t.lastUpdatedVieports=n,n&&t.doUpdate(n)})}},{key:"selectTiles",value:function(){var r=(0,tu.default)(Bn.default.mark(function n(){var a=this,i,o=arguments;return Bn.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return i=o.length>0&&o[0]!==void 0?o[0]:null,u.next=3,this.tilesetInitializationPromise;case 3:return i&&(this.lastUpdatedVieports=i),this.updatePromise||(this.updatePromise=new Promise(function(f){setTimeout(function(){a.lastUpdatedVieports&&a.doUpdate(a.lastUpdatedVieports),f(a._frameNumber),a.updatePromise=null},a.options.debounceTime)})),u.abrupt("return",this.updatePromise);case 6:case"end":return u.stop()}},n,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"doUpdate",value:function(t){if(!("loadTiles"in this.options&&!this.options.loadTiles)&&!(this.traverseCounter>0)){var n=t instanceof Array?t:[t];this._cache.reset(),this._frameNumber++,this.traverseCounter=n.length;var a=[],i=pr(n),o;try{for(i.s();!(o=i.n()).done;){var s=o.value,u=s.id;this._needTraverse(u)?a.push(u):this.traverseCounter--}}catch(p){i.e(p)}finally{i.f()}var f=pr(n),l;try{for(f.s();!(l=f.n()).done;){var c=l.value,h=c.id;if(this.roots[h]||(this.roots[h]=this._initializeTileHeaders(this.tileset,null)),!!a.includes(h)){var d=jb(c,this._frameNumber);this._traverser.traverse(this.roots[h],d,this.options)}}}catch(p){f.e(p)}finally{f.f()}}}},{key:"_needTraverse",value:function(t){var n=t;return this.options.viewportTraversersMap&&(n=this.options.viewportTraversersMap[t]),n===t}},{key:"_onTraversalEnd",value:function(t){var n=t.viewport.id;this.frameStateData[n]||(this.frameStateData[n]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});var a=this.frameStateData[n],i=Object.values(this._traverser.selectedTiles),o=Hb(i,t,this.options.maximumTilesSelected),s=(0,Lh.default)(o,2),u=s[0],f=s[1];a.selectedTiles=u;var l=pr(f),c;try{for(l.s();!(c=l.n()).done;){var h=c.value;h.unselect()}}catch(d){l.e(d)}finally{l.f()}a._requestedTiles=Object.values(this._traverser.requestedTiles),a._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}},{key:"_updateTiles",value:function(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(var t in this.frameStateData){var n=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(n.selectedTiles),this._requestedTiles=this._requestedTiles.concat(n._requestedTiles),this._emptyTiles=this._emptyTiles.concat(n._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);var a=pr(this.selectedTiles),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;this._tiles[o.id]=o}}catch(s){a.e(s)}finally{a.f()}this._loadTiles(),this._unloadTiles(),this._updateStats()}},{key:"_tilesChanged",value:function(t,n){if(t.length!==n.length)return!0;var a=new Set(t.map(function(s){return s.id})),i=new Set(n.map(function(s){return s.id})),o=t.filter(function(s){return!i.has(s.id)}).length>0;return o=o||n.filter(function(s){return!a.has(s.id)}).length>0,o}},{key:"_loadTiles",value:function(){var t=pr(this._requestedTiles),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;a.contentUnloaded&&this._loadTile(a)}}catch(i){t.e(i)}finally{t.f()}}},{key:"_unloadTiles",value:function(){this._cache.unloadTiles(this,function(t,n){return t._unloadTile(n)})}},{key:"_updateStats",value:function(){var t=0,n=0,a=pr(this.selectedTiles),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;o.contentAvailable&&o.content&&(t++,o.content.pointCount?n+=o.content.pointCount:n+=o.content.vertexCount)}}catch(s){a.e(s)}finally{a.f()}this.stats.get(zT).count=this.selectedTiles.length,this.stats.get(WT).count=t,this.stats.get(YT).count=n}},{key:"_initializeTileSet",value:function(){var r=(0,tu.default)(Bn.default.mark(function n(a){return Bn.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.type!==tt.I3S){o.next=5;break}return this.calculateViewPropsI3S(),o.next=4,a.root;case 4:a.root=o.sent;case 5:this.root=this._initializeTileHeaders(a,null),this.type===tt.TILES3D&&(this._initializeTiles3DTileset(a),this.calculateViewPropsTiles3D()),this.type===tt.I3S&&this._initializeI3STileset();case 8:case"end":return o.stop()}},n,this)}));function t(n){return r.apply(this,arguments)}return t}()},{key:"calculateViewPropsI3S",value:function(){var t,n=this.tileset.fullExtent;if(n){var a=n.xmin,i=n.xmax,o=n.ymin,s=n.ymax,u=n.zmin,f=n.zmax;this.cartographicCenter=new w(a+(i-a)/2,o+(s-o)/2,u+(f-u)/2),this.cartesianCenter=ge.WGS84.cartographicToCartesian(this.cartographicCenter,new w),this.zoom=bh(n,this.cartographicCenter,this.cartesianCenter);return}var l=(t=this.tileset.store)===null||t===void 0?void 0:t.extent;if(l){var c=(0,Lh.default)(l,4),h=c[0],d=c[1],p=c[2],v=c[3];this.cartographicCenter=new w(h+(p-h)/2,d+(v-d)/2,0),this.cartesianCenter=ge.WGS84.cartographicToCartesian(this.cartographicCenter,new w),this.zoom=Jb(l,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new w,this.zoom=1}},{key:"calculateViewPropsTiles3D",value:function(){var t=this.root;te(t);var n=t.boundingVolume.center;if(!n){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new w,this.zoom=1;return}n[0]!==0||n[1]!==0||n[2]!==0?this.cartographicCenter=ge.WGS84.cartesianToCartographic(n,new w):this.cartographicCenter=new w(0,0,-ge.WGS84.radii[0]),this.cartesianCenter=n,this.zoom=Wb(t.boundingVolume,this.cartographicCenter)}},{key:"_initializeStats",value:function(){this.stats.get(eu),this.stats.get(Rh),this.stats.get(Ph),this.stats.get(zT),this.stats.get(WT),this.stats.get(JT),this.stats.get(qT),this.stats.get(XT),this.stats.get(YT),this.stats.get(Fh,"memory")}},{key:"_initializeTileHeaders",value:function(t,n){var a=new Fi(this,t.root,n);if(n&&(n.children.push(a),a.depth=n.depth+1),this.type===tt.TILES3D){var i=[];for(i.push(a);i.length>0;){var o=i.pop();this.stats.get(eu).incrementCount();var s=o.header.children||[],u=pr(s),f;try{for(u.s();!(f=u.n()).done;){var l=f.value,c=new Fi(this,l,o);o.children.push(c),c.depth=o.depth+1,i.push(c)}}catch(h){u.e(h)}finally{u.f()}}}return a}},{key:"_initializeTraverser",value:function(){var t,n=this.type;switch(n){case tt.TILES3D:t=ET;break;case tt.I3S:t=jT;break;default:t=Hr}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}},{key:"_destroyTileHeaders",value:function(t){this._destroySubtree(t)}},{key:"_loadTile",value:function(){var r=(0,tu.default)(Bn.default.mark(function n(a){var i;return Bn.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,this._onStartTileLoading(),s.next=4,a.loadContent();case 4:i=s.sent,s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),this._onTileLoadError(a,s.t0);case 10:return s.prev=10,this._onEndTileLoading(),this._onTileLoad(a,i),s.finish(10);case 14:case"end":return s.stop()}},n,this,[[0,7,10,14]])}));function t(n){return r.apply(this,arguments)}return t}()},{key:"_onTileLoadError",value:function(t,n){this.stats.get(XT).incrementCount();var a=n.message||n.toString(),i=t.url;console.error("A 3D tile failed to load: ".concat(t.url," ").concat(a)),this.options.onTileError(t,a,i)}},{key:"_onTileLoad",value:function(t,n){if(n){if(this.type===tt.I3S){var a,i,o=((a=this.tileset)===null||a===void 0||(i=a.nodePagesTile)===null||i===void 0?void 0:i.nodesInNodePages)||0;this.stats.get(eu).reset(),this.stats.get(eu).addCount(o)}t&&t.content&&Db(t,t.content),this.updateContentTypes(t),this._addTileToCache(t),this.options.onTileLoad(t)}}},{key:"updateContentTypes",value:function(t){if(this.type===tt.I3S)switch(t.header.isDracoGeometry&&(this.contentFormats.draco=!0),t.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break;default:}else if(this.type===tt.TILES3D){var n,a=((n=t.content)===null||n===void 0?void 0:n.gltf)||{},i=a.extensionsRemoved,o=i===void 0?[]:i;o.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),o.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),o.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}},{key:"_onStartTileLoading",value:function(){this._pendingCount++,this.stats.get(Rh).incrementCount()}},{key:"_onEndTileLoading",value:function(){this._pendingCount--,this.stats.get(Rh).decrementCount()}},{key:"_addTileToCache",value:function(t){this._cache.add(this,t,function(n){return n._updateCacheStats(t)})}},{key:"_updateCacheStats",value:function(t){this.stats.get(JT).incrementCount(),this.stats.get(Ph).incrementCount(),this.gpuMemoryUsageInBytes+=t.content.byteLength||0,this.stats.get(Fh).count=this.gpuMemoryUsageInBytes}},{key:"_unloadTile",value:function(t){this.gpuMemoryUsageInBytes-=t.content&&t.content.byteLength||0,this.stats.get(Ph).decrementCount(),this.stats.get(qT).incrementCount(),this.stats.get(Fh).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}},{key:"_destroy",value:function(){var t=[];for(this.root&&t.push(this.root);t.length>0;){var n=t.pop(),a=pr(n.children),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;t.push(o)}}catch(s){a.e(s)}finally{a.f()}this._destroyTile(n)}this.root=null}},{key:"_destroySubtree",value:function(t){var n=t,a=[];for(a.push(n);a.length>0;){t=a.pop();var i=pr(t.children),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;a.push(s)}}catch(u){i.e(u)}finally{i.f()}t!==n&&this._destroyTile(t)}n.children=[]}},{key:"_destroyTile",value:function(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}},{key:"_initializeTiles3DTileset",value:function(t){if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed,this.extras=t.extras}},{key:"_initializeI3STileset",value:function(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}]),e}();function xF(e){for(var r=[],t=0,n=Object.keys(e);t<n.length;t++){var a=n[t];r.push("".concat(a,"=").concat(e[a]))}switch(r.length){case 0:return"";case 1:return"?".concat(r[0]);default:return"?".concat(r.join("&"))}}var Fu=m(X()),jn=m(Y());var ru="3.3.3";var cC=m(X()),wp=m(Y());var Mn={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"},MY=Object.keys(Mn);function Dh(e,r,t){te(e instanceof ArrayBuffer);var n=new TextDecoder("utf8"),a=new Uint8Array(e,r,t),i=n.decode(a);return i}function $T(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new DataView(e);return"".concat(String.fromCharCode(t.getUint8(r+0))).concat(String.fromCharCode(t.getUint8(r+1))).concat(String.fromCharCode(t.getUint8(r+2))).concat(String.fromCharCode(t.getUint8(r+3)))}var SE=m(W()),yu=m(X()),Pn=m(Y());var aE=m(X()),iE=m(W()),Kh=m(Y());var tx=m(Xe());var ex="3.3.3";var EF={draco:{decoderType:(typeof WebAssembly>"u"?"undefined":(0,tx.default)(WebAssembly))==="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},rx={name:"Draco",id:rr?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:ex,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:EF};var Wh=m(St()),Jx=m(ce()),qx=m(W()),Xx=m(H()),Yx=m(z());function On(e){for(var r=1/0,t=1/0,n=1/0,a=-1/0,i=-1/0,o=-1/0,s=e.POSITION?e.POSITION.value:[],u=s&&s.length,f=0;f<u;f+=3){var l=s[f],c=s[f+1],h=s[f+2];r=l<r?l:r,t=c<t?c:t,n=h<n?h:n,a=l>a?l:a,i=c>i?c:i,o=h>o?h:o}return[[r,t,n],[a,i,o]]}var Gh=m(St()),ox=m(H()),sx=m(z());function nx(e,r){if(!e)throw new Error(r||"loader assertion failed.")}function Nh(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=SF(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function SF(e,r){if(e){if(typeof e=="string")return ax(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ax(e,r)}}function ax(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Li=function(){function e(r,t){(0,ox.default)(this,e),A(this,"fields",void 0),A(this,"metadata",void 0),nx(Array.isArray(r)),CF(r),this.fields=r,this.metadata=t||new Map}return(0,sx.default)(e,[{key:"compareTo",value:function(t){if(this.metadata!==t.metadata||this.fields.length!==t.fields.length)return!1;for(var n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(t.fields[n]))return!1;return!0}},{key:"select",value:function(){for(var t=Object.create(null),n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];for(var o=0,s=a;o<s.length;o++){var u=s[o];t[u]=!0}var f=this.fields.filter(function(l){return t[l.name]});return new e(f,this.metadata)}},{key:"selectAt",value:function(){for(var t=this,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.map(function(s){return t.fields[s]}).filter(Boolean);return new e(o,this.metadata)}},{key:"assign",value:function(t){var n,a=this.metadata;if(t instanceof e){var i=t;n=i.fields,a=ix(ix(new Map,this.metadata),i.metadata)}else n=t;var o=Object.create(null),s=Nh(this.fields),u;try{for(s.s();!(u=s.n()).done;){var f=u.value;o[f.name]=f}}catch(p){s.e(p)}finally{s.f()}var l=Nh(n),c;try{for(l.s();!(c=l.n()).done;){var h=c.value;o[h.name]=h}}catch(p){l.e(p)}finally{l.f()}var d=Object.values(o);return new e(d,a)}}]),e}();function CF(e){var r={},t=Nh(e),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;r[a.name]&&console.warn("Schema: duplicated field name",a.name,a),r[a.name]=!0}}catch(i){t.e(i)}finally{t.f()}}function ix(e,r){return new Map([].concat((0,Gh.default)(e||new Map),(0,Gh.default)(r||new Map)))}var ux=m(H()),fx=m(z());var ki=function(){function e(r,t){(0,ux.default)(this,e);var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;A(this,"name",void 0),A(this,"type",void 0),A(this,"nullable",void 0),A(this,"metadata",void 0),this.name=r,this.type=t,this.nullable=n,this.metadata=a}return(0,fx.default)(e,[{key:"typeId",get:function(){return this.type&&this.type.typeId}},{key:"clone",value:function(){return new e(this.name,this.type,this.nullable,this.metadata)}},{key:"compareTo",value:function(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}},{key:"toString",value:function(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}]),e}();var Tt=m(at()),le=m(Te()),lx=m(xe()),Uh=m(Ae()),se=m(H()),vt=m(z());var fe;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth"})(fe||(fe={}));function de(e){var r=wF();return function(){var n=(0,Uh.default)(e),a;if(r){var i=(0,Uh.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,lx.default)(this,a)}}function wF(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var cx,hx,dx,px,mx,vx,gx,yx,gt=function(){function e(){(0,se.default)(this,e)}return(0,vt.default)(e,[{key:"typeId",get:function(){return fe.NONE}},{key:"compareTo",value:function(t){return this===t}}],[{key:"isNull",value:function(t){return t&&t.typeId===fe.Null}},{key:"isInt",value:function(t){return t&&t.typeId===fe.Int}},{key:"isFloat",value:function(t){return t&&t.typeId===fe.Float}},{key:"isBinary",value:function(t){return t&&t.typeId===fe.Binary}},{key:"isUtf8",value:function(t){return t&&t.typeId===fe.Utf8}},{key:"isBool",value:function(t){return t&&t.typeId===fe.Bool}},{key:"isDecimal",value:function(t){return t&&t.typeId===fe.Decimal}},{key:"isDate",value:function(t){return t&&t.typeId===fe.Date}},{key:"isTime",value:function(t){return t&&t.typeId===fe.Time}},{key:"isTimestamp",value:function(t){return t&&t.typeId===fe.Timestamp}},{key:"isInterval",value:function(t){return t&&t.typeId===fe.Interval}},{key:"isList",value:function(t){return t&&t.typeId===fe.List}},{key:"isStruct",value:function(t){return t&&t.typeId===fe.Struct}},{key:"isUnion",value:function(t){return t&&t.typeId===fe.Union}},{key:"isFixedSizeBinary",value:function(t){return t&&t.typeId===fe.FixedSizeBinary}},{key:"isFixedSizeList",value:function(t){return t&&t.typeId===fe.FixedSizeList}},{key:"isMap",value:function(t){return t&&t.typeId===fe.Map}},{key:"isDictionary",value:function(t){return t&&t.typeId===fe.Dictionary}}]),e}(),Ax=function(e,r){(0,le.default)(n,e);var t=de(n);function n(){return(0,se.default)(this,n),t.apply(this,arguments)}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.Null}},{key:r,get:function(){return"Null"}},{key:"toString",value:function(){return"Null"}}]),n}(gt,Symbol.toStringTag),_x=function(e,r){(0,le.default)(n,e);var t=de(n);function n(){return(0,se.default)(this,n),t.apply(this,arguments)}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.Bool}},{key:r,get:function(){return"Bool"}},{key:"toString",value:function(){return"Bool"}}]),n}(gt,Symbol.toStringTag);cx=Symbol.toStringTag;var Kt=function(e,r){(0,le.default)(n,e);var t=de(n);function n(a,i){var o;return(0,se.default)(this,n),o=t.call(this),A((0,Tt.default)(o),"isSigned",void 0),A((0,Tt.default)(o),"bitWidth",void 0),o.isSigned=a,o.bitWidth=i,o}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.Int}},{key:r,get:function(){return"Int"}},{key:"toString",value:function(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}]),n}(gt,cx),nu=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,!0,8)}return t}(Kt),au=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,!0,16)}return t}(Kt),iu=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,!0,32)}return t}(Kt),bx=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,!0,64)}return t}(Kt),ou=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,!1,8)}return t}(Kt),su=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,!1,16)}return t}(Kt),uu=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,!1,32)}return t}(Kt),Tx=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,!1,64)}return t}(Kt),jh={HALF:16,SINGLE:32,DOUBLE:64};hx=Symbol.toStringTag;var Di=function(e,r){(0,le.default)(n,e);var t=de(n);function n(a){var i;return(0,se.default)(this,n),i=t.call(this),A((0,Tt.default)(i),"precision",void 0),i.precision=a,i}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.Float}},{key:r,get:function(){return"Float"}},{key:"toString",value:function(){return"Float".concat(this.precision)}}]),n}(gt,hx),xx=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,jh.HALF)}return t}(Di),fu=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,jh.SINGLE)}return t}(Di),lu=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,jh.DOUBLE)}return t}(Di),Ex=function(e,r){(0,le.default)(n,e);var t=de(n);function n(){return(0,se.default)(this,n),t.call(this)}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.Binary}},{key:"toString",value:function(){return"Binary"}},{key:r,get:function(){return"Binary"}}]),n}(gt,Symbol.toStringTag),Sx=function(e,r){(0,le.default)(n,e);var t=de(n);function n(){return(0,se.default)(this,n),t.apply(this,arguments)}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.Utf8}},{key:r,get:function(){return"Utf8"}},{key:"toString",value:function(){return"Utf8"}}]),n}(gt,Symbol.toStringTag),Hh={DAY:0,MILLISECOND:1};dx=Symbol.toStringTag;var cu=function(e,r){(0,le.default)(n,e);var t=de(n);function n(a){var i;return(0,se.default)(this,n),i=t.call(this),A((0,Tt.default)(i),"unit",void 0),i.unit=a,i}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.Date}},{key:r,get:function(){return"Date"}},{key:"toString",value:function(){return"Date".concat((this.unit+1)*32,"<").concat(Hh[this.unit],">")}}]),n}(gt,dx),Cx=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,Hh.DAY)}return t}(cu),wx=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,Hh.MILLISECOND)}return t}(cu),Vr={SECOND:1,MILLISECOND:1e3,MICROSECOND:1e6,NANOSECOND:1e9};px=Symbol.toStringTag;var hu=function(e,r){(0,le.default)(n,e);var t=de(n);function n(a,i){var o;return(0,se.default)(this,n),o=t.call(this),A((0,Tt.default)(o),"unit",void 0),A((0,Tt.default)(o),"bitWidth",void 0),o.unit=a,o.bitWidth=i,o}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.Time}},{key:"toString",value:function(){return"Time".concat(this.bitWidth,"<").concat(Vr[this.unit],">")}},{key:r,get:function(){return"Time"}}]),n}(gt,px),Bx=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,Vr.SECOND,32)}return t}(hu),Mx=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,Vr.MILLISECOND,32)}return t}(hu);mx=Symbol.toStringTag;var Sa=function(e,r){(0,le.default)(n,e);var t=de(n);function n(a){var i;(0,se.default)(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return i=t.call(this),A((0,Tt.default)(i),"unit",void 0),A((0,Tt.default)(i),"timezone",void 0),i.unit=a,i.timezone=o,i}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.Timestamp}},{key:r,get:function(){return"Timestamp"}},{key:"toString",value:function(){return"Timestamp<".concat(Vr[this.unit]).concat(this.timezone?", ".concat(this.timezone):"",">")}}]),n}(gt,mx),Ox=function(e){(0,le.default)(t,e);var r=de(t);function t(){(0,se.default)(this,t);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,Vr.SECOND,n)}return t}(Sa),Ix=function(e){(0,le.default)(t,e);var r=de(t);function t(){(0,se.default)(this,t);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,Vr.MILLISECOND,n)}return t}(Sa),Px=function(e){(0,le.default)(t,e);var r=de(t);function t(){(0,se.default)(this,t);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,Vr.MICROSECOND,n)}return t}(Sa),Rx=function(e){(0,le.default)(t,e);var r=de(t);function t(){(0,se.default)(this,t);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,Vr.NANOSECOND,n)}return t}(Sa),Vh={DAY_TIME:0,YEAR_MONTH:1};vx=Symbol.toStringTag;var du=function(e,r){(0,le.default)(n,e);var t=de(n);function n(a){var i;return(0,se.default)(this,n),i=t.call(this),A((0,Tt.default)(i),"unit",void 0),i.unit=a,i}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.Interval}},{key:r,get:function(){return"Interval"}},{key:"toString",value:function(){return"Interval<".concat(Vh[this.unit],">")}}]),n}(gt,vx),Fx=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,Vh.DAY_TIME)}return t}(du),Lx=function(e){(0,le.default)(t,e);var r=de(t);function t(){return(0,se.default)(this,t),r.call(this,Vh.YEAR_MONTH)}return t}(du);gx=Symbol.toStringTag;var pu=function(e,r){(0,le.default)(n,e);var t=de(n);function n(a,i){var o;return(0,se.default)(this,n),o=t.call(this),A((0,Tt.default)(o),"listSize",void 0),A((0,Tt.default)(o),"children",void 0),o.listSize=a,o.children=[i],o}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.FixedSizeList}},{key:"valueType",get:function(){return this.children[0].type}},{key:"valueField",get:function(){return this.children[0]}},{key:r,get:function(){return"FixedSizeList"}},{key:"toString",value:function(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}]),n}(gt,gx);yx=Symbol.toStringTag;var kx=function(e,r){(0,le.default)(n,e);var t=de(n);function n(a){var i;return(0,se.default)(this,n),i=t.call(this),A((0,Tt.default)(i),"children",void 0),i.children=a,i}return(0,vt.default)(n,[{key:"typeId",get:function(){return fe.Struct}},{key:"toString",value:function(){return"Struct<{".concat(this.children.map(function(i){return"".concat(i.name,":").concat(i.type)}).join(", "),"}>")}},{key:r,get:function(){return"Struct"}}]),n}(gt,yx);function Dx(e){switch(e.constructor){case Int8Array:return new nu;case Uint8Array:return new ou;case Int16Array:return new au;case Uint16Array:return new su;case Int32Array:return new iu;case Uint32Array:return new uu;case Float32Array:return new fu;case Float64Array:return new lu;default:throw new Error("array type not supported")}}function zh(e,r,t){var n=Dx(r.value),a=t||Gx(r),i=new ki(e,new pu(r.size,new ki("value",n)),!1,a);return i}function Gx(e){var r=new Map;return"byteOffset"in e&&r.set("byteOffset",e.byteOffset.toString(10)),"byteStride"in e&&r.set("byteStride",e.byteStride.toString(10)),"normalized"in e&&r.set("normalized",e.normalized.toString()),r}function Ux(e,r,t){var n=jx(r.metadata),a=[],i=BF(r.attributes);for(var o in e){var s=e[o],u=Nx(o,s,i[o]);a.push(u)}if(t){var f=Nx("indices",t);a.push(f)}return new Li(a,n)}function BF(e){var r={};for(var t in e){var n=e[t];r[n.name||"undefined"]=n}return r}function Nx(e,r,t){var n=t?jx(t.metadata):void 0,a=zh(e,r,n);return a}function jx(e){var r=new Map;for(var t in e)r.set("".concat(t,".string"),JSON.stringify(e[t]));return r}function MF(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=OF(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function OF(e,r){if(e){if(typeof e=="string")return Hx(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Hx(e,r)}}function Hx(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Vx(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function zx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Vx(Object(t),!0).forEach(function(n){(0,qx.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Vx(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Wx={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},IF={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},PF=4,Kx=function(){function e(r){(0,Xx.default)(this,e),A(this,"draco",void 0),A(this,"decoder",void 0),A(this,"metadataQuerier",void 0),this.draco=r,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}return(0,Yx.default)(e,[{key:"destroy",value:function(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}},{key:"parseSync",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=new this.draco.DecoderBuffer;a.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(n);var i=this.decoder.GetEncodedGeometryType(a),o=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{var s;switch(i){case this.draco.TRIANGULAR_MESH:s=this.decoder.DecodeBufferToMesh(a,o);break;case this.draco.POINT_CLOUD:s=this.decoder.DecodeBufferToPointCloud(a,o);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!s.ok()||!o.ptr){var u="DRACO decompression failed: ".concat(s.error_msg());throw new Error(u)}var f=this._getDracoLoaderData(o,i,n),l=this._getMeshData(o,f,n),c=On(l.attributes),h=Ux(l.attributes,f,l.indices),d=zx(zx({loader:"draco",loaderData:f,header:{vertexCount:o.num_points(),boundingBox:c}},l),{},{schema:h});return d}finally{this.draco.destroy(a),o&&this.draco.destroy(o)}}},{key:"_getDracoLoaderData",value:function(t,n,a){var i=this._getTopLevelMetadata(t),o=this._getDracoAttributes(t,a);return{geometry_type:n,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:i,attributes:o}}},{key:"_getDracoAttributes",value:function(t,n){for(var a={},i=0;i<t.num_attributes();i++){var o=this.decoder.GetAttribute(t,i),s=this._getAttributeMetadata(t,i);a[o.unique_id()]={unique_id:o.unique_id(),attribute_type:o.attribute_type(),data_type:o.data_type(),num_components:o.num_components(),byte_offset:o.byte_offset(),byte_stride:o.byte_stride(),normalized:o.normalized(),attribute_index:i,metadata:s};var u=this._getQuantizationTransform(o,n);u&&(a[o.unique_id()].quantization_transform=u);var f=this._getOctahedronTransform(o,n);f&&(a[o.unique_id()].octahedron_transform=f)}return a}},{key:"_getMeshData",value:function(t,n,a){var i=this._getMeshAttributes(n,t,a),o=i.POSITION;if(!o)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(a.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:i}}},{key:"_getMeshAttributes",value:function(t,n,a){for(var i={},o=0,s=Object.values(t.attributes);o<s.length;o++){var u=s[o],f=this._deduceAttributeName(u,a);u.name=f;var l=this._getAttributeValues(n,u),c=l.value,h=l.size;i[f]={value:c,size:h,byteOffset:u.byte_offset,byteStride:u.byte_stride,normalized:u.normalized}}return i}},{key:"_getTriangleListIndices",value:function(t){var n=t.num_faces(),a=n*3,i=a*PF,o=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(t,i,o),new Uint32Array(this.draco.HEAPF32.buffer,o,a).slice()}finally{this.draco._free(o)}}},{key:"_getTriangleStripIndices",value:function(t){var n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,n),LF(n)}finally{this.draco.destroy(n)}}},{key:"_getAttributeValues",value:function(t,n){var a=IF[n.data_type],i=n.num_components,o=t.num_points(),s=o*i,u=s*a.BYTES_PER_ELEMENT,f=RF(this.draco,a),l,c=this.draco._malloc(u);try{var h=this.decoder.GetAttribute(t,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,h,f,u,c),l=new a(this.draco.HEAPF32.buffer,c,s).slice()}finally{this.draco._free(c)}return{value:l,size:i}}},{key:"_deduceAttributeName",value:function(t,n){for(var a=t.unique_id,i=0,o=Object.entries(n.extraAttributes||{});i<o.length;i++){var s=(0,Jx.default)(o[i],2),u=s[0],f=s[1];if(f===a)return u}var l=t.attribute_type;for(var c in Wx){var h=this.draco[c];if(h===l)return Wx[c]}var d=n.attributeNameEntry||"name";return t.metadata[d]?t.metadata[d].string:"CUSTOM_ATTRIBUTE_".concat(a)}},{key:"_getTopLevelMetadata",value:function(t){var n=this.decoder.GetMetadata(t);return this._getDracoMetadata(n)}},{key:"_getAttributeMetadata",value:function(t,n){var a=this.decoder.GetAttributeMetadata(t,n);return this._getDracoMetadata(a)}},{key:"_getDracoMetadata",value:function(t){if(!t||!t.ptr)return{};for(var n={},a=this.metadataQuerier.NumEntries(t),i=0;i<a;i++){var o=this.metadataQuerier.GetEntryName(t,i);n[o]=this._getDracoMetadataField(t,o)}return n}},{key:"_getDracoMetadataField",value:function(t,n){var a=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,n,a);var i=FF(a);return{int:this.metadataQuerier.GetIntEntry(t,n),string:this.metadataQuerier.GetStringEntry(t,n),double:this.metadataQuerier.GetDoubleEntry(t,n),intArray:i}}finally{this.draco.destroy(a)}}},{key:"_disableAttributeTransforms",value:function(t){var n=t.quantizedAttributes,a=n===void 0?[]:n,i=t.octahedronAttributes,o=i===void 0?[]:i,s=[].concat((0,Wh.default)(a),(0,Wh.default)(o)),u=MF(s),f;try{for(u.s();!(f=u.n()).done;){var l=f.value;this.decoder.SkipAttributeTransform(this.draco[l])}}catch(c){u.e(c)}finally{u.f()}}},{key:"_getQuantizationTransform",value:function(t,n){var a=this,i=n.quantizedAttributes,o=i===void 0?[]:i,s=t.attribute_type(),u=o.map(function(l){return a.decoder[l]}).includes(s);if(u){var f=new this.draco.AttributeQuantizationTransform;try{if(f.InitFromAttribute(t))return{quantization_bits:f.quantization_bits(),range:f.range(),min_values:new Float32Array([1,2,3]).map(function(l){return f.min_value(l)})}}finally{this.draco.destroy(f)}}return null}},{key:"_getOctahedronTransform",value:function(t,n){var a=this,i=n.octahedronAttributes,o=i===void 0?[]:i,s=t.attribute_type(),u=o.map(function(l){return a.decoder[l]}).includes(s);if(u){var f=new this.draco.AttributeQuantizationTransform;try{if(f.InitFromAttribute(t))return{quantization_bits:f.quantization_bits()}}finally{this.draco.destroy(f)}}return null}}]),e}();function RF(e,r){switch(r){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32;default:return e.DT_INVALID}}function FF(e){for(var r=e.size(),t=new Int32Array(r),n=0;n<r;n++)t[n]=e.GetValue(n);return t}function LF(e){for(var r=e.size(),t=new Int32Array(r),n=0;n<r;n++)t[n]=e.GetValue(n);return t}var $x=m(ce()),eE=m(W()),Xh=m(X()),Ni=m(Y());function Qx(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Zx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Qx(Object(t),!0).forEach(function(n){(0,eE.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Qx(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var kF="1.5.5",DF="1.4.1",Yh="https://www.gstatic.com/draco/versioned/decoders/".concat(kF),GF="".concat(Yh,"/draco_decoder.js"),NF="".concat(Yh,"/draco_wasm_wrapper.js"),UF="".concat(Yh,"/draco_decoder.wasm"),gK="https://raw.githubusercontent.com/google/draco/".concat(DF,"/javascript/draco_encoder.js"),Gi;function tE(e){return Jh.apply(this,arguments)}function Jh(){return Jh=(0,Xh.default)(Ni.default.mark(function e(r){var t;return Ni.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=r.modules||{},t.draco3d?Gi=Gi||t.draco3d.createDecoderModule({}).then(function(i){return{draco:i}}):Gi=Gi||jF(r),a.next=4,Gi;case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},e)})),Jh.apply(this,arguments)}function jF(e){return qh.apply(this,arguments)}function qh(){return qh=(0,Xh.default)(Ni.default.mark(function e(r){var t,n,a,i;return Ni.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:s.t0=r.draco&&r.draco.decoderType,s.next=s.t0==="js"?3:(s.t0==="wasm",7);break;case 3:return s.next=5,Ht(GF,"draco",r);case 5:return t=s.sent,s.abrupt("break",21);case 7:return s.t1=Promise,s.next=10,Ht(NF,"draco",r);case 10:return s.t2=s.sent,s.next=13,Ht(UF,"draco",r);case 13:return s.t3=s.sent,s.t4=[s.t2,s.t3],s.next=17,s.t1.all.call(s.t1,s.t4);case 17:a=s.sent,i=(0,$x.default)(a,2),t=i[0],n=i[1];case 21:return t=t||globalThis.DracoDecoderModule,s.next=24,HF(t,n);case 24:return s.abrupt("return",s.sent);case 25:case"end":return s.stop()}},e)})),qh.apply(this,arguments)}function HF(e,r){var t={};return r&&(t.wasmBinary=r),new Promise(function(n){e(Zx(Zx({},t),{},{onModuleLoaded:function(i){return n({draco:i})}}))})}function rE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function nE(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?rE(Object(t),!0).forEach(function(n){(0,iE.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):rE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var mu=nE(nE({},rx),{},{parse:VF});function VF(e,r){return Qh.apply(this,arguments)}function Qh(){return Qh=(0,aE.default)(Kh.default.mark(function e(r,t){var n,a,i;return Kh.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,tE(t);case 2:return n=s.sent,a=n.draco,i=new Kx(a),s.prev=5,s.abrupt("return",i.parseSync(r,t?.draco));case 7:return s.prev=7,i.destroy(),s.finish(7);case 10:case"end":return s.stop()}},e,null,[[5,,7,10]])})),Qh.apply(this,arguments)}var oE=m(H()),sE=m(z()),mr=m(W());var Qt,Zh=(Qt={},(0,mr.default)(Qt,5130,Float64Array),(0,mr.default)(Qt,5126,Float32Array),(0,mr.default)(Qt,5123,Uint16Array),(0,mr.default)(Qt,5125,Uint32Array),(0,mr.default)(Qt,5121,Uint8Array),(0,mr.default)(Qt,5120,Int8Array),(0,mr.default)(Qt,5122,Int16Array),(0,mr.default)(Qt,5124,Int32Array),Qt),zF={DOUBLE:5130,FLOAT:5126,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,UNSIGNED_BYTE:5121,BYTE:5120,SHORT:5122,INT:5124},$h="Failed to convert GL type",zr=function(){function e(){(0,oE.default)(this,e)}return(0,sE.default)(e,null,[{key:"fromTypedArray",value:function(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(var n in Zh){var a=Zh[n];if(a===t)return n}throw new Error($h)}},{key:"fromName",value:function(t){var n=zF[t];if(!n)throw new Error($h);return n}},{key:"getArrayType",value:function(t){switch(t){case 33635:case 32819:case 32820:return Uint16Array;default:var n=Zh[t];if(!n)throw new Error($h);return n}}},{key:"getByteSize",value:function(t){var n=e.getArrayType(t);return n.BYTES_PER_ELEMENT}},{key:"validate",value:function(t){return Boolean(e.getArrayType(t))}},{key:"createTypedArray",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;i===void 0&&(i=(n.byteLength-a)/e.getByteSize(t));var o=e.getArrayType(t);return new o(n,a,i)}}]),e}();function uE(e,r){if(!e)throw new Error("math.gl assertion failed. ".concat(r))}function ed(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],t=e>>11&31,n=e>>5&63,a=e&31;return r[0]=t<<3,r[1]=n<<2,r[2]=a<<3,r}var BK=1/256;var MK=new pn,OK=new w,IK=new pn,PK=new pn,RK=new Uint8Array(1);function fE(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;return Wo(e,0,r)/r*2-1}function lE(e){return e<0?-1:1}function cE(e,r,t,n){if(uE(n),e<0||e>t||r<0||r>t)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(t));if(n.x=fE(e,t),n.y=fE(r,t),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){var a=n.x;n.x=(1-Math.abs(n.y))*lE(a),n.y=(1-Math.abs(a))*lE(n.y)}return n.normalize()}function td(e,r,t){return cE(e,r,255,t)}var hE=m(H()),dE=m(z());var Ca=function(){function e(r,t){(0,hE.default)(this,e),A(this,"json",void 0),A(this,"buffer",void 0),A(this,"featuresLength",0),A(this,"_cachedTypedArrays",{}),this.json=r,this.buffer=t}return(0,dE.default)(e,[{key:"getExtension",value:function(t){return this.json.extensions&&this.json.extensions[t]}},{key:"hasProperty",value:function(t){return Boolean(this.json[t])}},{key:"getGlobalProperty",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5125,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=this.json[t];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(t,n,a,1,i.byteOffset):i}},{key:"getPropertyArray",value:function(t,n,a){var i=this.json[t];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(n=zr.fromName(i.componentType)),this._getTypedArrayFromBinary(t,n,a,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(t,n,i)}},{key:"getProperty",value:function(t,n,a,i,o){var s=this.json[t];if(!s)return s;var u=this.getPropertyArray(t,n,a);if(a===1)return u[i];for(var f=0;f<a;++f)o[f]=u[a*i+f];return o}},{key:"_getTypedArrayFromBinary",value:function(t,n,a,i,o){var s=this._cachedTypedArrays,u=s[t];return u||(u=zr.createTypedArray(n,this.buffer.buffer,this.buffer.byteOffset+o,i*a),s[t]=u),u}},{key:"_getTypedArrayFromArray",value:function(t,n,a){var i=this._cachedTypedArrays,o=i[t];return o||(o=zr.createTypedArray(n,a),i[t]=o),o}}]),e}();var gE=m(St()),yE=m(H()),AE=m(z());var WF={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},JF={SCALAR:function(r,t){return r[t]},VEC2:function(r,t){return[r[2*t+0],r[2*t+1]]},VEC3:function(r,t){return[r[3*t+0],r[3*t+1],r[3*t+2]]},VEC4:function(r,t){return[r[4*t+0],r[4*t+1],r[4*t+2],r[4*t+3]]},MAT2:function(r,t){return[r[4*t+0],r[4*t+1],r[4*t+2],r[4*t+3]]},MAT3:function(r,t){return[r[9*t+0],r[9*t+1],r[9*t+2],r[9*t+3],r[9*t+4],r[9*t+5],r[9*t+6],r[9*t+7],r[9*t+8]]},MAT4:function(r,t){return[r[16*t+0],r[16*t+1],r[16*t+2],r[16*t+3],r[16*t+4],r[16*t+5],r[16*t+6],r[16*t+7],r[16*t+8],r[16*t+9],r[16*t+10],r[16*t+11],r[16*t+12],r[16*t+13],r[16*t+14],r[16*t+15]]}},qF={SCALAR:function(r,t,n){t[n]=r},VEC2:function(r,t,n){t[2*n+0]=r[0],t[2*n+1]=r[1]},VEC3:function(r,t,n){t[3*n+0]=r[0],t[3*n+1]=r[1],t[3*n+2]=r[2]},VEC4:function(r,t,n){t[4*n+0]=r[0],t[4*n+1]=r[1],t[4*n+2]=r[2],t[4*n+3]=r[3]},MAT2:function(r,t,n){t[4*n+0]=r[0],t[4*n+1]=r[1],t[4*n+2]=r[2],t[4*n+3]=r[3]},MAT3:function(r,t,n){t[9*n+0]=r[0],t[9*n+1]=r[1],t[9*n+2]=r[2],t[9*n+3]=r[3],t[9*n+4]=r[4],t[9*n+5]=r[5],t[9*n+6]=r[6],t[9*n+7]=r[7],t[9*n+8]=r[8],t[9*n+9]=r[9]},MAT4:function(r,t,n){t[16*n+0]=r[0],t[16*n+1]=r[1],t[16*n+2]=r[2],t[16*n+3]=r[3],t[16*n+4]=r[4],t[16*n+5]=r[5],t[16*n+6]=r[6],t[16*n+7]=r[7],t[16*n+8]=r[8],t[16*n+9]=r[9],t[16*n+10]=r[10],t[16*n+11]=r[11],t[16*n+12]=r[12],t[16*n+13]=r[13],t[16*n+14]=r[14],t[16*n+15]=r[15]}};function pE(e,r,t,n){var a=e.componentType;te(e.componentType);var i=typeof a=="string"?zr.fromName(a):a,o=WF[e.type],s=JF[e.type],u=qF[e.type];t+=e.byteOffset;var f=zr.createTypedArray(i,r,t,o*n);return{values:f,type:i,size:o,unpacker:s,packer:u}}var Zt=function(r){return r!==void 0};function mE(e,r,t){if(!r)return null;var n=e.getExtension("3DTILES_batch_table_hierarchy"),a=r.HIERARCHY;return a&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),r.extensions=r.extensions||{},r.extensions["3DTILES_batch_table_hierarchy"]=a,n=a),n?XF(n,t):null}function XF(e,r){var t,n,a,i=e.instancesLength,o=e.classes,s=e.classIds,u=e.parentCounts,f=e.parentIds,l=i;Zt(s.byteOffset)&&(s.componentType=defaultValue(s.componentType,5123),s.type=AttributeType.SCALAR,a=getBinaryAccessor(s),s=a.createArrayBufferView(r.buffer,r.byteOffset+s.byteOffset,i));var c;if(Zt(u))for(Zt(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,5123),u.type=AttributeType.SCALAR,a=getBinaryAccessor(u),u=a.createArrayBufferView(r.buffer,r.byteOffset+u.byteOffset,i)),c=new Uint16Array(i),l=0,t=0;t<i;++t)c[t]=l,l+=u[t];Zt(f)&&Zt(f.byteOffset)&&(f.componentType=defaultValue(f.componentType,5123),f.type=AttributeType.SCALAR,a=getBinaryAccessor(f),f=a.createArrayBufferView(r.buffer,r.byteOffset+f.byteOffset,l));var h=o.length;for(t=0;t<h;++t){var d=o[t].length,p=o[t].instances,v=getBinaryProperties(d,p,r);o[t].instances=combine(v,p)}var g=new Array(h).fill(0),y=new Uint16Array(i);for(t=0;t<i;++t)n=s[t],y[t]=g[n],++g[n];var b={classes:o,classIds:s,classIndexes:y,parentCounts:u,parentIndexes:c,parentIds:f};return QF(b),b}function wa(e,r,t){if(e){var n=e.parentCounts,a=e.parentIds;return a?t(e,r):n>0?YF(e,r,t):KF(e,r,t)}}function YF(e,r,t){var n=e.classIds,a=e.parentCounts,i=e.parentIds,o=e.parentIndexes,s=n.length,u=scratchVisited;u.length=Math.max(u.length,s);var f=++marker,l=scratchStack;for(l.length=0,l.push(r);l.length>0;)if(r=l.pop(),u[r]!==f){u[r]=f;var c=t(e,r);if(Zt(c))return c;for(var h=a[r],d=o[r],p=0;p<h;++p){var v=i[d+p];v!==r&&l.push(v)}}return null}function KF(e,r,t){for(var n=!0;n;){var a=t(e,r);if(Zt(a))return a;var i=e.parentIds[r];n=i!==r,r=i}throw new Error("traverseHierarchySingleParent")}function QF(e){for(var r=[],t=e.classIds,n=t.length,a=0;a<n;++a)vE(e,a,stack)}function vE(e,r,t){var n=e.parentCounts,a=e.parentIds,i=e.parentIndexes,o=e.classIds,s=o.length;if(Zt(a)){assert(r<s,"Parent index ".concat(r," exceeds the total number of instances: ").concat(s)),assert(t.indexOf(r)===-1,"Circular dependency detected in the batch table hierarchy."),t.push(r);for(var u=Zt(n)?n[r]:1,f=Zt(n)?i[r]:r,l=0;l<u;++l){var c=a[f+l];c!==r&&vE(e,c,t)}t.pop(r)}}function yt(e){return e!=null}var vu=function(r,t){return r},ZF={HIERARCHY:!0,extensions:!0,extras:!0},gu=function(){function e(r,t,n){(0,yE.default)(this,e);var a,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};A(this,"json",void 0),A(this,"binary",void 0),A(this,"featureCount",void 0),A(this,"_extensions",void 0),A(this,"_properties",void 0),A(this,"_binaryProperties",void 0),A(this,"_hierarchy",void 0),te(n>=0),this.json=r||{},this.binary=t,this.featureCount=n,this._extensions=((a=this.json)===null||a===void 0?void 0:a.extensions)||{},this._properties={};for(var o in this.json)ZF[o]||(this._properties[o]=this.json[o]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=mE(this,this.json,this.binary))}return(0,AE.default)(e,[{key:"getExtension",value:function(t){return this.json&&this.json.extensions&&this.json.extensions[t]}},{key:"memorySizeInBytes",value:function(){return 0}},{key:"isClass",value:function(t,n){if(this._checkBatchId(t),te(typeof n=="string",n),this._hierarchy){var a=wa(this._hierarchy,t,function(i,o){var s=i.classIds[o],u=i.classes[s];return u.name===n});return yt(a)}return!1}},{key:"isExactClass",value:function(t,n){return te(typeof n=="string",n),this.getExactClassName(t)===n}},{key:"getExactClassName",value:function(t){if(this._checkBatchId(t),this._hierarchy){var n=this._hierarchy.classIds[t],a=this._hierarchy.classes[n];return a.name}}},{key:"hasProperty",value:function(t,n){return this._checkBatchId(t),te(typeof n=="string",n),yt(this._properties[n])||this._hasPropertyInHierarchy(t,n)}},{key:"getPropertyNames",value:function(t,n){var a;this._checkBatchId(t),n=yt(n)?n:[],n.length=0;var i=Object.keys(this._properties);return(a=n).push.apply(a,(0,gE.default)(i)),this._hierarchy&&this._getPropertyNamesInHierarchy(t,n),n}},{key:"getProperty",value:function(t,n){if(this._checkBatchId(t),te(typeof n=="string",n),this._binaryProperties){var a=this._binaryProperties[n];if(yt(a))return this._getBinaryProperty(a,t)}var i=this._properties[n];if(yt(i))return vu(i[t],!0);if(this._hierarchy){var o=this._getHierarchyProperty(t,n);if(yt(o))return o}}},{key:"setProperty",value:function(t,n,a){var i=this.featureCount;if(this._checkBatchId(t),te(typeof n=="string",n),this._binaryProperties){var o=this._binaryProperties[n];if(o){this._setBinaryProperty(o,t,a);return}}if(!(this._hierarchy&&this._setHierarchyProperty(this,t,n,a))){var s=this._properties[n];yt(s)||(this._properties[n]=new Array(i),s=this._properties[n]),s[t]=vu(a,!0)}}},{key:"_checkBatchId",value:function(t){var n=t>=0&&t<this.featureCount;if(!n)throw new Error("batchId not in range [0, featureCount - 1].")}},{key:"_getBinaryProperty",value:function(t,n){return t.unpack(t.typedArray,n)}},{key:"_setBinaryProperty",value:function(t,n,a){t.pack(a,t.typedArray,n)}},{key:"_initializeBinaryProperties",value:function(){var t=null;for(var n in this._properties){var a=this._properties[n],i=this._initializeBinaryProperty(n,a);i&&(t=t||{},t[n]=i)}return t}},{key:"_initializeBinaryProperty",value:function(t,n){if("byteOffset"in n){var a=n;te(this.binary,"Property ".concat(t," requires a batch table binary.")),te(a.type,"Property ".concat(t," requires a type."));var i=pE(a,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}},{key:"_hasPropertyInHierarchy",value:function(t,n){if(!this._hierarchy)return!1;var a=wa(this._hierarchy,t,function(i,o){var s=i.classIds[o],u=i.classes[s].instances;return yt(u[n])});return yt(a)}},{key:"_getPropertyNamesInHierarchy",value:function(t,n){wa(this._hierarchy,t,function(a,i){var o=a.classIds[i],s=a.classes[o].instances;for(var u in s)s.hasOwnProperty(u)&&n.indexOf(u)===-1&&n.push(u)})}},{key:"_getHierarchyProperty",value:function(t,n){var a=this;return wa(this._hierarchy,t,function(i,o){var s=i.classIds[o],u=i.classes[s],f=i.classIndexes[o],l=u.instances[n];return yt(l)?yt(l.typedArray)?a._getBinaryProperty(l,f):vu(l[f],!0):null})}},{key:"_setHierarchyProperty",value:function(t,n,a,i){var o=this,s=wa(this._hierarchy,n,function(u,f){var l=u.classIds[f],c=u.classes[l],h=u.classIndexes[f],d=c.instances[a];return yt(d)?(te(f===n,'Inherited property "'.concat(a,'" is read-only.')),yt(d.typedArray)?o._setBinaryProperty(d,h,i):d[h]=vu(i,!0),!0):!1});return yt(s)}}]),e}();var rd=4;function Wr(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=new DataView(r);if(e.magic=n.getUint32(t,!0),t+=rd,e.version=n.getUint32(t,!0),t+=rd,e.byteLength=n.getUint32(t,!0),t+=rd,e.version!==1)throw new Error("3D Tile Version ".concat(e.version," not supported"));return t}var Ba=4,_E="b3dm tile in legacy format.";function Ma(e,r,t){var n=new DataView(r),a;e.header=e.header||{};var i=n.getUint32(t,!0);t+=Ba;var o=n.getUint32(t,!0);t+=Ba;var s=n.getUint32(t,!0);t+=Ba;var u=n.getUint32(t,!0);return t+=Ba,s>=570425344?(t-=Ba*2,a=i,s=o,u=0,i=0,o=0,console.warn(_E)):u>=570425344&&(t-=Ba,a=s,s=i,u=o,i=0,o=0,console.warn(_E)),e.header.featureTableJsonByteLength=i,e.header.featureTableBinaryByteLength=o,e.header.batchTableJsonByteLength=s,e.header.batchTableBinaryByteLength=u,e.header.batchLength=a,t}function Oa(e,r,t,n){return t=$F(e,r,t,n),t=eL(e,r,t,n),t}function $F(e,r,t,n){var a=e.header,i=a.featureTableJsonByteLength,o=a.featureTableBinaryByteLength,s=a.batchLength;if(e.featureTableJson={BATCH_LENGTH:s||0},i>0){var u=Dh(r,t,i);e.featureTableJson=JSON.parse(u)}return t+=i,e.featureTableBinary=new Uint8Array(r,t,o),t+=o,t}function eL(e,r,t,n){var a=e.header,i=a.batchTableJsonByteLength,o=a.batchTableBinaryByteLength;if(i>0){var s=Dh(r,t,i);e.batchTableJson=JSON.parse(s),t+=i,o>0&&(e.batchTableBinary=new Uint8Array(r,t,o),e.batchTableBinary=new Uint8Array(e.batchTableBinary),t+=o)}return t}function nd(e,r,t){if(!r&&(!e||!e.batchIds||!t))return null;var n=e.batchIds,a=e.isRGB565,i=e.pointCount;if(n&&t){for(var o=new Uint8ClampedArray(i*3),s=0;s<i;s++){var u=n[s],f=t.getProperty(u,"dimensions"),l=f.map(function(p){return p*255});o[s*3]=l[0],o[s*3+1]=l[1],o[s*3+2]=l[2]}return{type:5121,value:o,size:3,normalized:!0}}if(a){for(var c=new Uint8ClampedArray(i*3),h=0;h<i;h++){var d=ed(r[h]);c[h*3]=d[0],c[h*3+1]=d[1],c[h*3+2]=d[2]}return{type:5121,value:c,size:3,normalized:!0}}return r&&r.length===i*3?{type:5121,value:r,size:3,normalized:!0}:{type:5121,value:r,size:4,normalized:!0}}var bE=new w;function TE(e,r){if(!r)return null;if(e.isOctEncoded16P){for(var t=new Float32Array(e.pointsLength*3),n=0;n<e.pointsLength;n++)td(r[n*2],r[n*2+1],bE),bE.toArray(t,n*3);return{type:5126,size:2,value:t}}return{type:5126,size:2,value:r}}function xE(e,r,t){return e.isQuantized?t["3d-tiles"]&&t["3d-tiles"].decodeQuantizedPositions?(e.isQuantized=!1,tL(e,r)):{type:5123,value:r,size:3,normalized:!0}:r}function tL(e,r){for(var t=new w,n=new Float32Array(e.pointCount*3),a=0;a<e.pointCount;a++)t.set(r[a*3],r[a*3+1],r[a*3+2]).scale(1/e.quantizedRange).multiply(e.quantizedVolumeScale).add(e.quantizedVolumeOffset).toArray(n,a*3);return n}function EE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function In(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?EE(Object(t),!0).forEach(function(n){(0,SE.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):EE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function CE(e,r,t,n,a){return ad.apply(this,arguments)}function ad(){return ad=(0,yu.default)(Pn.default.mark(function e(r,t,n,a,i){var o,s,u;return Pn.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return n=Wr(r,t,n),n=Ma(r,t,n),n=Oa(r,t,n,a),rL(r),o=nL(r),s=o.featureTable,u=o.batchTable,l.next=7,uL(r,s,u,a,i);case 7:return aL(r,s,a),iL(r,s,u),oL(r,s),l.abrupt("return",n);case 11:case"end":return l.stop()}},e)})),ad.apply(this,arguments)}function rL(e){e.attributes={positions:null,colors:null,normals:null,batchIds:null},e.isQuantized=!1,e.isTranslucent=!1,e.isRGB565=!1,e.isOctEncoded16P=!1}function nL(e){var r=new Ca(e.featureTableJson,e.featureTableBinary),t=r.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(t))throw new Error("POINTS_LENGTH must be defined");r.featuresLength=t,e.featuresLength=t,e.pointsLength=t,e.pointCount=t,e.rtcCenter=r.getGlobalProperty("RTC_CENTER",5126,3);var n=sL(e,r);return{featureTable:r,batchTable:n}}function aL(e,r,t){if(!e.attributes.positions){if(r.hasProperty("POSITION"))e.attributes.positions=r.getPropertyArray("POSITION",5126,3);else if(r.hasProperty("POSITION_QUANTIZED")){var n=r.getPropertyArray("POSITION_QUANTIZED",5123,3);if(e.isQuantized=!0,e.quantizedRange=(1<<16)-1,e.quantizedVolumeScale=r.getGlobalProperty("QUANTIZED_VOLUME_SCALE",5126,3),!e.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(e.quantizedVolumeOffset=r.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",5126,3),!e.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e.attributes.positions=xE(e,n,t)}}if(!e.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function iL(e,r,t){if(!e.attributes.colors){var n=null;r.hasProperty("RGBA")?(n=r.getPropertyArray("RGBA",5121,4),e.isTranslucent=!0):r.hasProperty("RGB")?n=r.getPropertyArray("RGB",5121,3):r.hasProperty("RGB565")&&(n=r.getPropertyArray("RGB565",5123,1),e.isRGB565=!0),e.attributes.colors=nd(e,n,t)}r.hasProperty("CONSTANT_RGBA")&&(e.constantRGBA=r.getGlobalProperty("CONSTANT_RGBA",5121,4))}function oL(e,r){if(!e.attributes.normals){var t=null;r.hasProperty("NORMAL")?t=r.getPropertyArray("NORMAL",5126,3):r.hasProperty("NORMAL_OCT16P")&&(t=r.getPropertyArray("NORMAL_OCT16P",5121,2),e.isOctEncoded16P=!0),e.attributes.normals=TE(e,t)}}function sL(e,r){var t=null;if(!e.batchIds&&r.hasProperty("BATCH_ID")&&(e.batchIds=r.getPropertyArray("BATCH_ID",5123,1),e.batchIds)){var n=r.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");var a=e.batchTableJson,i=e.batchTableBinary;t=new gu(a,i,n)}return t}function uL(e,r,t,n,a){return id.apply(this,arguments)}function id(){return id=(0,yu.default)(Pn.default.mark(function e(r,t,n,a,i){var o,s,u,f,l,c,h,d;return Pn.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(f=r.batchTableJson&&r.batchTableJson.extensions&&r.batchTableJson.extensions["3DTILES_draco_point_compression"],f&&(u=f.properties),l=t.getExtension("3DTILES_draco_point_compression"),!l){v.next=15;break}if(s=l.properties,c=l.byteOffset,h=l.byteLength,!(!s||!Number.isFinite(c)||!h)){v.next=9;break}throw new Error("Draco properties, byteOffset, and byteLength must be defined");case 9:o=r.featureTableBinary.slice(c,c+h),r.hasPositions=Number.isFinite(s.POSITION),r.hasColors=Number.isFinite(s.RGB)||Number.isFinite(s.RGBA),r.hasNormals=Number.isFinite(s.NORMAL),r.hasBatchIds=Number.isFinite(s.BATCH_ID),r.isTranslucent=Number.isFinite(s.RGBA);case 15:if(o){v.next=17;break}return v.abrupt("return",!0);case 17:return d={buffer:o,properties:In(In({},s),u),featureTableProperties:s,batchTableProperties:u,dequantizeInShader:!1},v.next=20,fL(r,d,a,i);case 20:return v.abrupt("return",v.sent);case 21:case"end":return v.stop()}},e)})),id.apply(this,arguments)}function fL(e,r,t,n){return od.apply(this,arguments)}function od(){return od=(0,yu.default)(Pn.default.mark(function e(r,t,n,a){var i,o,s,u,f,l,c,h,d,p,v,g,y,b,E;return Pn.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return i=a.parse,o=In(In({},n),{},{draco:In(In({},n.draco),{},{extraAttributes:t.batchTableProperties||{}})}),delete o["3d-tiles"],S.next=5,i(t.buffer,mu,o);case 5:if(s=S.sent,u=s.attributes.POSITION&&s.attributes.POSITION.value,f=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,l=s.attributes.NORMAL&&s.attributes.NORMAL.value,c=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,h=u&&s.attributes.POSITION.value.quantization,d=l&&s.attributes.NORMAL.value.quantization,h&&(p=s.POSITION.data.quantization,v=p.range,r.quantizedVolumeScale=new w(v,v,v),r.quantizedVolumeOffset=new w(p.minValues),r.quantizedRange=(1<<p.quantizationBits)-1,r.isQuantizedDraco=!0),d&&(r.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,r.isOctEncodedDraco=!0),g={},t.batchTableProperties)for(y=0,b=Object.keys(t.batchTableProperties);y<b.length;y++)E=b[y],s.attributes[E]&&s.attributes[E].value&&(g[E.toLowerCase()]=s.attributes[E].value);r.attributes=In({positions:u,colors:nd(r,f,void 0),normals:l,batchIds:c},g);case 17:case"end":return S.stop()}},e)})),od.apply(this,arguments)}var nC=m(X()),Ap=m(Y());var rC=m(X()),gp=m(Y());var eC=m(W()),tC=m(X()),mp=m(Y());var wE="3.3.3";var Xi=m(X()),yr=m(Y());var BE="3.3.3";var XE=m(W());var VE=m(Xe()),zE=m(X()),gd=m(Y());var dd=m(ce()),Ui=m(X()),vr=m(Y());var ME="3.3.3",lL="https://unpkg.com/@loaders.gl/textures@".concat(ME,"/dist/libs/basis_encoder.wasm"),cL="https://unpkg.com/@loaders.gl/textures@".concat(ME,"/dist/libs/basis_encoder.js"),sd;function pd(e){return fd.apply(this,arguments)}function fd(){return fd=(0,Ui.default)(vr.default.mark(function e(r){var t;return vr.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=r.modules||{},!t.basis){a.next=3;break}return a.abrupt("return",t.basis);case 3:return sd=sd||hL(r),a.next=6,sd;case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}},e)})),fd.apply(this,arguments)}function hL(e){return ld.apply(this,arguments)}function ld(){return ld=(0,Ui.default)(vr.default.mark(function e(r){var t,n,a,i;return vr.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=null,n=null,s.t0=Promise,s.next=5,Ht("basis_transcoder.js","textures",r);case 5:return s.t1=s.sent,s.next=8,Ht("basis_transcoder.wasm","textures",r);case 8:return s.t2=s.sent,s.t3=[s.t1,s.t2],s.next=12,s.t0.all.call(s.t0,s.t3);case 12:return a=s.sent,i=(0,dd.default)(a,2),t=i[0],n=i[1],t=t||globalThis.BASIS,s.next=19,dL(t,n);case 19:return s.abrupt("return",s.sent);case 20:case"end":return s.stop()}},e)})),ld.apply(this,arguments)}function dL(e,r){var t={};return r&&(t.wasmBinary=r),new Promise(function(n){e(t).then(function(a){var i=a.BasisFile,o=a.initializeBasis;o(),n({BasisFile:i})})})}var ud;function md(e){return cd.apply(this,arguments)}function cd(){return cd=(0,Ui.default)(vr.default.mark(function e(r){var t;return vr.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=r.modules||{},!t.basisEncoder){a.next=3;break}return a.abrupt("return",t.basisEncoder);case 3:return ud=ud||pL(r),a.next=6,ud;case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}},e)})),cd.apply(this,arguments)}function pL(e){return hd.apply(this,arguments)}function hd(){return hd=(0,Ui.default)(vr.default.mark(function e(r){var t,n,a,i;return vr.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=null,n=null,s.t0=Promise,s.next=5,Ht(cL,"textures",r);case 5:return s.t1=s.sent,s.next=8,Ht(lL,"textures",r);case 8:return s.t2=s.sent,s.t3=[s.t1,s.t2],s.next=12,s.t0.all.call(s.t0,s.t3);case 12:return a=s.sent,i=(0,dd.default)(a,2),t=i[0],n=i[1],t=t||globalThis.BASIS,s.next=19,mL(t,n);case 19:return s.abrupt("return",s.sent);case 20:case"end":return s.stop()}},e)})),hd.apply(this,arguments)}function mL(e,r){var t={};return r&&(t.wasmBinary=r),new Promise(function(n){e(t).then(function(a){var i=a.BasisFile,o=a.KTX2File,s=a.initializeBasis,u=a.BasisEncoder;s(),n({BasisFile:i,KTX2File:o,BasisEncoder:u})})})}var Rn={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919};function vL(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=gL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function gL(e,r){if(e){if(typeof e=="string")return OE(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return OE(e,r)}}function OE(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var yL=["","WEBKIT_","MOZ_"],IE={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"},Au=null;function PE(e){if(!Au){e=e||AL()||void 0,Au=new Set;var r=vL(yL),t;try{for(r.s();!(t=r.n()).done;){var n=t.value;for(var a in IE)if(e&&e.getExtension("".concat(n).concat(a))){var i=IE[a];Au.add(i)}}}catch(o){r.e(o)}finally{r.f()}}return Au}function AL(){try{var e=document.createElement("canvas");return e.getContext("webgl")}catch{return null}}var NQ=new Uint8Array([0]);var RE,FE,LE,kE,DE,GE,NE,UE;(function(e){e[e.NONE=0]="NONE",e[e.BASISLZ=1]="BASISLZ",e[e.ZSTD=2]="ZSTD",e[e.ZLIB=3]="ZLIB"})(RE||(RE={})),function(e){e[e.BASICFORMAT=0]="BASICFORMAT"}(FE||(FE={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.ETC1S=163]="ETC1S",e[e.UASTC=166]="UASTC"}(LE||(LE={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.SRGB=1]="SRGB"}(kE||(kE={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LINEAR=1]="LINEAR",e[e.SRGB=2]="SRGB",e[e.ITU=3]="ITU",e[e.NTSC=4]="NTSC",e[e.SLOG=5]="SLOG",e[e.SLOG2=6]="SLOG2"}(DE||(DE={})),function(e){e[e.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",e[e.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(GE||(GE={})),function(e){e[e.RGB=0]="RGB",e[e.RRR=3]="RRR",e[e.GGG=4]="GGG",e[e.AAA=15]="AAA"}(NE||(NE={})),function(e){e[e.RGB=0]="RGB",e[e.RGBA=3]="RGBA",e[e.RRR=4]="RRR",e[e.RRRG=5]="RRRG"}(UE||(UE={}));var xt=[171,75,84,88,32,50,48,187,13,10,26,10];function jE(e){var r=new Uint8Array(e),t=r.byteLength<xt.length||r[0]!==xt[0]||r[1]!==xt[1]||r[2]!==xt[2]||r[3]!==xt[3]||r[4]!==xt[4]||r[5]!==xt[5]||r[6]!==xt[6]||r[7]!==xt[7]||r[8]!==xt[8]||r[9]!==xt[9]||r[10]!==xt[10]||r[11]!==xt[11];return!t}var _L={etc1:{basisFormat:0,compressed:!0,format:Rn.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:Rn.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:Rn.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:Rn.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:Rn.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:Rn.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};function Ad(e,r){return yd.apply(this,arguments)}function yd(){return yd=(0,zE.default)(gd.default.mark(function e(r,t){var n,a,i,o,s,u;return gd.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t.basis.containerFormat!=="auto"){l.next=11;break}if(!jE(r)){l.next=6;break}return l.next=4,md(t);case 4:return n=l.sent,l.abrupt("return",HE(n.KTX2File,r,t));case 6:return l.next=8,pd(t);case 8:return a=l.sent,i=a.BasisFile,l.abrupt("return",vd(i,r,t));case 11:l.t0=t.basis.module,l.next=l.t0==="encoder"?14:(l.t0==="transcoder",22);break;case 14:return l.next=16,md(t);case 16:o=l.sent,l.t1=t.basis.containerFormat,l.next=l.t1==="ktx2"?20:(l.t1==="basis",21);break;case 20:return l.abrupt("return",HE(o.KTX2File,r,t));case 21:return l.abrupt("return",vd(o.BasisFile,r,t));case 22:return l.next=24,pd(t);case 24:return s=l.sent,u=s.BasisFile,l.abrupt("return",vd(u,r,t));case 27:case"end":return l.stop()}},e)})),yd.apply(this,arguments)}function vd(e,r,t){var n=new e(new Uint8Array(r));try{if(!n.startTranscoding())throw new Error("Failed to start basis transcoding");for(var a=n.getNumImages(),i=[],o=0;o<a;o++){for(var s=n.getNumLevels(o),u=[],f=0;f<s;f++)u.push(bL(n,o,f,t));i.push(u)}return i}finally{n.close(),n.delete()}}function bL(e,r,t,n){var a=e.getImageWidth(r,t),i=e.getImageHeight(r,t),o=e.getHasAlpha(),s=WE(n,o),u=s.compressed,f=s.format,l=s.basisFormat,c=e.getImageTranscodedSizeInBytes(r,t,l),h=new Uint8Array(c);if(!e.transcodeImage(h,r,t,l,0,0))throw new Error("failed to start Basis transcoding");return{width:a,height:i,data:h,compressed:u,format:f,hasAlpha:o}}function HE(e,r,t){var n=new e(new Uint8Array(r));try{if(!n.startTranscoding())throw new Error("failed to start KTX2 transcoding");for(var a=n.getLevels(),i=[],o=0;o<a;o++){i.push(TL(n,o,t));break}return[i]}finally{n.close(),n.delete()}}function TL(e,r,t){var n=e.getImageLevelInfo(r,0,0),a=n.alphaFlag,i=n.height,o=n.width,s=WE(t,a),u=s.compressed,f=s.format,l=s.basisFormat,c=e.getImageTranscodedSizeInBytes(r,0,0,l),h=new Uint8Array(c);if(!e.transcodeImage(h,r,0,0,l,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:o,height:i,data:h,compressed:u,levelSize:c,hasAlpha:a,format:f}}function WE(e,r){var t=e&&e.basis&&e.basis.format;return t==="auto"&&(t=_u()),(0,VE.default)(t)==="object"&&(t=r?t.alpha:t.noAlpha),t=t.toLowerCase(),_L[t]}function _u(){var e=PE();return e.has("astc")?"astc-4x4":e.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:e.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:e.has("etc1")?"etc1":e.has("etc2")?"etc2":"rgb565"}function JE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function qE(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?JE(Object(t),!0).forEach(function(n){(0,XE.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):JE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var YE={name:"Basis",id:rr?"basis":"basis-nodejs",module:"textures",version:BE,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},_d=qE(qE({},YE),{},{parse:Ad});function qe(e,r){if(!e)throw new Error(r||"assert failed: gltf")}function bd(e,r){var t=e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:");if(t)return e;var n=r.baseUri||r.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(e));return n.substr(0,n.lastIndexOf("/")+1)+e}function KE(e,r,t){var n=e.bufferViews[t];qe(n);var a=n.buffer,i=r[a];qe(i);var o=(n.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,n.byteLength)}var OS=m(X()),ap=m(Y());var Od={};It(Od,{decode:()=>zL,name:()=>VL});var Bd=m(X()),ji=m(Y());var tS=m(Xe()),rS=m(W()),nS=m(H()),aS=m(z());var QE=["SCALAR","VEC2","VEC3","VEC4"],xL=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],EL=new Map(xL),SL={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},CL={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},wL={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function bu(e){var r=QE[e-1];return r||QE[0]}function Tu(e){var r=EL.get(e.constructor);if(!r)throw new Error("Illegal typed array");return r}function Ia(e,r){var t=wL[e.componentType],n=SL[e.type],a=CL[e.componentType],i=e.count*n,o=e.count*n*a;return qe(o>=0&&o<=r.byteLength),{ArrayType:t,length:i,byteLength:o}}function ZE(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=BL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function BL(e,r){if(e){if(typeof e=="string")return $E(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return $E(e,r)}}function $E(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function eS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ML(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?eS(Object(t),!0).forEach(function(n){(0,rS.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var OL={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},Oe=function(){function e(r){(0,nS.default)(this,e),A(this,"gltf",void 0),A(this,"sourceBuffers",void 0),A(this,"byteLength",void 0),this.gltf=r||{json:ML({},OL),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}return(0,aS.default)(e,[{key:"json",get:function(){return this.gltf.json}},{key:"getApplicationData",value:function(t){var n=this.json[t];return n}},{key:"getExtraData",value:function(t){var n=this.json.extras||{};return n[t]}},{key:"getExtension",value:function(t){var n=this.getUsedExtensions().find(function(i){return i===t}),a=this.json.extensions||{};return n?a[t]||!0:null}},{key:"getRequiredExtension",value:function(t){var n=this.getRequiredExtensions().find(function(a){return a===t});return n?this.getExtension(t):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getRemovedExtensions",value:function(){return this.json.extensionsRemoved||[]}},{key:"getObjectExtension",value:function(t,n){var a=t.extensions||{};return a[n]}},{key:"getScene",value:function(t){return this.getObject("scenes",t)}},{key:"getNode",value:function(t){return this.getObject("nodes",t)}},{key:"getSkin",value:function(t){return this.getObject("skins",t)}},{key:"getMesh",value:function(t){return this.getObject("meshes",t)}},{key:"getMaterial",value:function(t){return this.getObject("materials",t)}},{key:"getAccessor",value:function(t){return this.getObject("accessors",t)}},{key:"getTexture",value:function(t){return this.getObject("textures",t)}},{key:"getSampler",value:function(t){return this.getObject("samplers",t)}},{key:"getImage",value:function(t){return this.getObject("images",t)}},{key:"getBufferView",value:function(t){return this.getObject("bufferViews",t)}},{key:"getBuffer",value:function(t){return this.getObject("buffers",t)}},{key:"getObject",value:function(t,n){if((0,tS.default)(n)==="object")return n;var a=this.json[t]&&this.json[t][n];if(!a)throw new Error("glTF file error: Could not find ".concat(t,"[").concat(n,"]"));return a}},{key:"getTypedArrayForBufferView",value:function(t){t=this.getBufferView(t);var n=t.buffer,a=this.gltf.buffers[n];qe(a);var i=(t.byteOffset||0)+a.byteOffset;return new Uint8Array(a.arrayBuffer,i,t.byteLength)}},{key:"getTypedArrayForAccessor",value:function(t){t=this.getAccessor(t);var n=this.getBufferView(t.bufferView),a=this.getBuffer(n.buffer),i=a.data,o=Ia(t,n),s=o.ArrayType,u=o.length,f=n.byteOffset+t.byteOffset;return new s(i,f,u)}},{key:"getTypedArrayForImageData",value:function(t){t=this.getAccessor(t);var n=this.getBufferView(t.bufferView),a=this.getBuffer(n.buffer),i=a.data,o=n.byteOffset||0;return new Uint8Array(i,o,n.byteLength)}},{key:"addApplicationData",value:function(t,n){return this.json[t]=n,this}},{key:"addExtraData",value:function(t,n){return this.json.extras=this.json.extras||{},this.json.extras[t]=n,this}},{key:"addObjectExtension",value:function(t,n,a){return t.extensions=t.extensions||{},t.extensions[n]=a,this.registerUsedExtension(n),this}},{key:"setObjectExtension",value:function(t,n,a){var i=t.extensions||{};i[n]=a}},{key:"removeObjectExtension",value:function(t,n){var a=t.extensions||{},i=a[n];return delete a[n],i}},{key:"addExtension",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return qe(n),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=n,this.registerUsedExtension(t),n}},{key:"addRequiredExtension",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return qe(n),this.addExtension(t,n),this.registerRequiredExtension(t),n}},{key:"registerUsedExtension",value:function(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(function(n){return n===t})||this.json.extensionsUsed.push(t)}},{key:"registerRequiredExtension",value:function(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(function(n){return n===t})||this.json.extensionsRequired.push(t)}},{key:"removeExtension",value:function(t){if(this.getExtension(t)){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);var n=this.json.extensionsRemoved;n.includes(t)||n.push(t)}}},{key:"setDefaultScene",value:function(t){this.json.scene=t}},{key:"addScene",value:function(t){var n=t.nodeIndices;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}},{key:"addNode",value:function(t){var n=t.meshIndex,a=t.matrix;this.json.nodes=this.json.nodes||[];var i={mesh:n};return a&&(i.matrix=a),this.json.nodes.push(i),this.json.nodes.length-1}},{key:"addMesh",value:function(t){var n=t.attributes,a=t.indices,i=t.material,o=t.mode,s=o===void 0?4:o,u=this._addAttributes(n),f={primitives:[{attributes:u,mode:s}]};if(a){var l=this._addIndices(a);f.primitives[0].indices=l}return Number.isFinite(i)&&(f.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(f),this.json.meshes.length-1}},{key:"addPointCloud",value:function(t){var n=this._addAttributes(t),a={primitives:[{attributes:n,mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}},{key:"addImage",value:function(t,n){var a=sn(t),i=n||a?.mimeType,o=this.addBufferView(t),s={bufferView:o,mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(s),this.json.images.length-1}},{key:"addBufferView",value:function(t){var n=t.byteLength;qe(Number.isFinite(n)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);var a={buffer:0,byteOffset:this.byteLength,byteLength:n};return this.byteLength+=Er(n,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(a),this.json.bufferViews.length-1}},{key:"addAccessor",value:function(t,n){var a={bufferView:t,type:bu(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(a),this.json.accessors.length-1}},{key:"addBinaryBuffer",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3},a=this.addBufferView(t),i={min:n.min,max:n.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(t,n.size));var o={size:n.size,componentType:Tu(t),count:Math.round(t.length/n.size),min:i.min,max:i.max};return this.addAccessor(a,Object.assign(o,n))}},{key:"addTexture",value:function(t){var n=t.imageIndex,a={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(a),this.json.textures.length-1}},{key:"addMaterial",value:function(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}},{key:"createBinaryChunk",value:function(){var t,n;this.gltf.buffers=[];var a=this.byteLength,i=new ArrayBuffer(a),o=new Uint8Array(i),s=0,u=ZE(this.sourceBuffers||[]),f;try{for(u.s();!(f=u.n()).done;){var l=f.value;s=kf(l,o,s)}}catch(c){u.e(c)}finally{u.f()}(t=this.json)!==null&&t!==void 0&&(n=t.buffers)!==null&&n!==void 0&&n[0]?this.json.buffers[0].byteLength=a:this.json.buffers=[{byteLength:a}],this.gltf.binary=i,this.sourceBuffers=[i]}},{key:"_removeStringFromArray",value:function(t,n){for(var a=!0;a;){var i=t.indexOf(n);i>-1?t.splice(i,1):a=!1}}},{key:"_addAttributes",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n={};for(var a in t){var i=t[a],o=this._getGltfAttributeName(a),s=this.addBinaryBuffer(i.value,i);n[o]=s}return n}},{key:"_addIndices",value:function(t){return this.addBinaryBuffer(t,{size:1})}},{key:"_getGltfAttributeName",value:function(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}},{key:"_getAccessorMinMax",value:function(t,n){var a={min:null,max:null};if(t.length<n)return a;a.min=[],a.max=[];var i=t.subarray(0,n),o=ZE(i),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;a.min.push(u),a.max.push(u)}}catch(c){o.e(c)}finally{o.f()}for(var f=n;f<t.length;f+=n)for(var l=0;l<n;l++)a.min[0+l]=Math.min(a.min[0+l],t[f+l]),a.max[0+l]=Math.max(a.max[0+l],t[f+l]);return a}}]),e}();var xu=m(X()),iS=m(Xe()),Fn=m(Y()),pZ=(typeof WebAssembly>"u"?"undefined":(0,iS.default)(WebAssembly))!=="object",IL="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",PL="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",RL=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),FL=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),LL={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},kL={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};function oS(e,r,t,n,a){return xd.apply(this,arguments)}function xd(){return xd=(0,xu.default)(Fn.default.mark(function e(r,t,n,a,i){var o,s,u=arguments;return Fn.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return o=u.length>5&&u[5]!==void 0?u[5]:"NONE",l.next=3,DL();case 3:s=l.sent,UL(s,s.exports[kL[i]],r,t,n,a,s.exports[LL[o||"NONE"]]);case 5:case"end":return l.stop()}},e)})),xd.apply(this,arguments)}var Td;function DL(){return Ed.apply(this,arguments)}function Ed(){return Ed=(0,xu.default)(Fn.default.mark(function e(){return Fn.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Td||(Td=GL()),t.abrupt("return",Td);case 2:case"end":return t.stop()}},e)})),Ed.apply(this,arguments)}function GL(){return Sd.apply(this,arguments)}function Sd(){return Sd=(0,xu.default)(Fn.default.mark(function e(){var r,t;return Fn.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=IL,WebAssembly.validate(RL)&&(r=PL,console.log("Warning: meshopt_decoder is using experimental SIMD support")),a.next=4,WebAssembly.instantiate(NL(r),{});case 4:return t=a.sent,a.next=7,t.instance.exports.__wasm_call_ctors();case 7:return a.abrupt("return",t.instance);case 8:case"end":return a.stop()}},e)})),Sd.apply(this,arguments)}function NL(e){for(var r=new Uint8Array(e.length),t=0;t<e.length;++t){var n=e.charCodeAt(t);r[t]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}for(var a=0,i=0;i<e.length;++i)r[a++]=r[i]<60?FL[r[i]]:(r[i]-60)*64+r[++i];return r.buffer.slice(0,a)}function UL(e,r,t,n,a,i,o){var s=e.exports.sbrk,u=n+3&-4,f=s(u*a),l=s(i.length),c=new Uint8Array(e.exports.memory.buffer);c.set(i,l);var h=r(f,n,a,l,i.length);if(h===0&&o&&o(f,u,a),t.set(c.subarray(f,f+n*a)),s(f-s(0)),h!==0)throw new Error("Malformed buffer data: ".concat(h))}function jL(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=HL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function HL(e,r){if(e){if(typeof e=="string")return sS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return sS(e,r)}}function sS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Md="EXT_meshopt_compression",VL=Md;function zL(e,r){return Cd.apply(this,arguments)}function Cd(){return Cd=(0,Bd.default)(ji.default.mark(function e(r,t){var n,a,i,o,s,u;return ji.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=new Oe(r),t!=null&&(n=t.gltf)!==null&&n!==void 0&&n.decompressMeshes){l.next=3;break}return l.abrupt("return");case 3:i=[],o=jL(r.json.bufferViews||[]);try{for(o.s();!(s=o.n()).done;)u=s.value,i.push(WL(a,u))}catch(c){o.e(c)}finally{o.f()}return l.next=8,Promise.all(i);case 8:a.removeExtension(Md);case 9:case"end":return l.stop()}},e)})),Cd.apply(this,arguments)}function WL(e,r){return wd.apply(this,arguments)}function wd(){return wd=(0,Bd.default)(ji.default.mark(function e(r,t){var n,a,i,o,s,u,f,l,c,h,d,p,v,g;return ji.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(n=r.getObjectExtension(t,Md),!n){b.next=9;break}return a=n.byteOffset,i=a===void 0?0:a,o=n.byteLength,s=o===void 0?0:o,u=n.byteStride,f=n.count,l=n.mode,c=n.filter,h=c===void 0?"NONE":c,d=n.buffer,p=r.gltf.buffers[d],v=new Uint8Array(p.arrayBuffer,p.byteOffset+i,s),g=new Uint8Array(r.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength),b.next=8,oS(g,f,u,v,l,h);case 8:return b.abrupt("return",g);case 9:return b.abrupt("return",null);case 10:case"end":return b.stop()}},e)})),wd.apply(this,arguments)}var Id={};It(Id,{name:()=>XL,preprocess:()=>YL});function JL(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=qL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function qL(e,r){if(e){if(typeof e=="string")return uS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return uS(e,r)}}function uS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Pa="EXT_texture_webp",XL=Pa;function YL(e,r){var t=new Oe(e);if(!tl("image/webp")){if(t.getRequiredExtensions().includes(Pa))throw new Error("gltf: Required extension ".concat(Pa," not supported by browser"));return}var n=t.json,a=JL(n.textures||[]),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.getObjectExtension(o,Pa);s&&(o.source=s.source),t.removeObjectExtension(o,Pa)}}catch(u){a.e(u)}finally{a.f()}t.removeExtension(Pa)}var Pd={};It(Pd,{name:()=>ZL,preprocess:()=>$L});function KL(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=QL(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function QL(e,r){if(e){if(typeof e=="string")return fS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return fS(e,r)}}function fS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Eu="KHR_texture_basisu",ZL=Eu;function $L(e,r){var t=new Oe(e),n=t.json,a=KL(n.textures||[]),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.getObjectExtension(o,Eu);s&&(o.source=s.source),t.removeObjectExtension(o,Eu)}}catch(u){a.e(u)}finally{a.f()}t.removeExtension(Eu)}var Nd={};It(Nd,{decode:()=>sk,encode:()=>uk,name:()=>ik,preprocess:()=>ok});var dS=m(ce()),kd=m(W()),Dd=m(X()),Ln=m(Y());function lS(e){var r={};for(var t in e){var n=e[t];if(t!=="indices"){var a=Rd(n);r[t]=a}}return r}function Rd(e){var r=ek(e),t=r.buffer,n=r.size,a=r.count,i={value:t,size:n,byteOffset:0,count:a,type:bu(n),componentType:Tu(t)};return i}function ek(e){var r=e,t=1,n=0;return e&&e.value&&(r=e.value,t=e.size||1),r&&(ArrayBuffer.isView(r)||(r=tk(r,Float32Array)),n=r.length/t),{buffer:r,size:t,count:n}}function tk(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e?Array.isArray(e)?new r(e):t&&!(e instanceof r)?new r(e):e:null}function cS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function rk(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?cS(Object(t),!0).forEach(function(n){(0,kd.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):cS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var nk=Ln.default.mark(Gd);function Hi(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=ak(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function ak(e,r){if(e){if(typeof e=="string")return hS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return hS(e,r)}}function hS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var kn="KHR_draco_mesh_compression",ik=kn;function ok(e,r,t){var n=new Oe(e),a=Hi(Gd(n)),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;n.getObjectExtension(o,kn)}}catch(s){a.e(s)}finally{a.f()}}function sk(e,r,t){return Fd.apply(this,arguments)}function Fd(){return Fd=(0,Dd.default)(Ln.default.mark(function e(r,t,n){var a,i,o,s,u,f;return Ln.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t!=null&&(a=t.gltf)!==null&&a!==void 0&&a.decompressMeshes){c.next=2;break}return c.abrupt("return");case 2:i=new Oe(r),o=[],s=Hi(Gd(i));try{for(s.s();!(u=s.n()).done;)f=u.value,i.getObjectExtension(f,kn)&&o.push(fk(i,f,t,n))}catch(h){s.e(h)}finally{s.f()}return c.next=8,Promise.all(o);case 8:i.removeExtension(kn);case 9:case"end":return c.stop()}},e)})),Fd.apply(this,arguments)}function uk(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=new Oe(e),n=Hi(t.json.meshes||[]),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;lk(i,r),t.addRequiredExtension(kn)}}catch(o){n.e(o)}finally{n.f()}}function fk(e,r,t,n){return Ld.apply(this,arguments)}function Ld(){return Ld=(0,Dd.default)(Ln.default.mark(function e(r,t,n,a){var i,o,s,u,f,l,c,h,d,p,v,g,y,b;return Ln.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(i=r.getObjectExtension(t,kn),i){T.next=3;break}return T.abrupt("return");case 3:return o=r.getTypedArrayForBufferView(i.bufferView),s=an(o.buffer,o.byteOffset),u=a.parse,f=rk({},n),delete f["3d-tiles"],T.next=10,u(s,mu,f,a);case 10:for(l=T.sent,c=lS(l.attributes),h=0,d=Object.entries(c);h<d.length;h++)p=(0,dS.default)(d[h],2),v=p[0],g=p[1],v in t.attributes&&(y=t.attributes[v],b=r.getAccessor(y),b!=null&&b.min&&b!==null&&b!==void 0&&b.max&&(g.min=b.min,g.max=b.max));t.attributes=c,l.indices&&(t.indices=Rd(l.indices)),ck(t);case 16:case"end":return T.stop()}},e)})),Ld.apply(this,arguments)}function lk(e,r){var t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(!a.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");var o=a.DracoWriter.encodeSync({attributes:e}),s=i==null||(t=i.parseSync)===null||t===void 0?void 0:t.call(i,{attributes:e}),u=a._addFauxAttributes(s.attributes),f=a.addBufferView(o),l={primitives:[{attributes:u,mode:n,extensions:(0,kd.default)({},kn,{bufferView:f,attributes:u})}]};return l}function ck(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function Gd(e){var r,t,n,a,i,o;return Ln.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=Hi(e.json.meshes||[]),u.prev=1,r.s();case 3:if((t=r.n()).done){u.next=24;break}n=t.value,a=Hi(n.primitives),u.prev=6,a.s();case 8:if((i=a.n()).done){u.next=14;break}return o=i.value,u.next=12,o;case 12:u.next=8;break;case 14:u.next=19;break;case 16:u.prev=16,u.t0=u.catch(6),a.e(u.t0);case 19:return u.prev=19,a.f(),u.finish(19);case 22:u.next=3;break;case 24:u.next=29;break;case 26:u.prev=26,u.t1=u.catch(1),r.e(u.t1);case 29:return u.prev=29,r.f(),u.finish(29);case 32:case"end":return u.stop()}},nk,null,[[1,26,29,32],[6,16,19,22]])}var Vd={};It(Vd,{decode:()=>vk,name:()=>dk});var yS=m(ce()),AS=m(X()),Ud=m(Y());var pS={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},mS={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4};function vS(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=hk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function hk(e,r){if(e){if(typeof e=="string")return gS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return gS(e,r)}}function gS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Hd="KHR_texture_transform",dk=Hd,Su=new w,pk=new ye,mk=new ye;function vk(e,r){return jd.apply(this,arguments)}function jd(){return jd=(0,AS.default)(Ud.default.mark(function e(r,t){var n,a,i,o;return Ud.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(n=new Oe(r),a=n.getExtension(Hd),a){u.next=4;break}return u.abrupt("return");case 4:for(i=r.json.materials||[],o=0;o<i.length;o++)gk(o,r);case 6:case"end":return u.stop()}},e)})),jd.apply(this,arguments)}function gk(e,r){var t,n,a,i=[],o=(t=r.json.materials)===null||t===void 0?void 0:t[e],s=o==null||(n=o.pbrMetallicRoughness)===null||n===void 0?void 0:n.baseColorTexture;s&&Vi(r,e,s,i);var u=o?.emissiveTexture;u&&Vi(r,e,u,i);var f=o?.normalTexture;f&&Vi(r,e,f,i);var l=o?.occlusionTexture;l&&Vi(r,e,l,i);var c=o==null||(a=o.pbrMetallicRoughness)===null||a===void 0?void 0:a.metallicRoughnessTexture;c&&Vi(r,e,c,i)}function Vi(e,r,t,n){var a=yk(t,n);if(a){var i=e.json.meshes||[],o=vS(i),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,f=vS(u.primitives),l;try{for(f.s();!(l=f.n()).done;){var c=l.value,h=c.material;Number.isFinite(h)&&r===h&&Ak(e,c,a)}}catch(d){f.e(d)}finally{f.f()}}}catch(d){o.e(d)}finally{o.f()}}}function yk(e,r){var t,n=(t=e.extensions)===null||t===void 0?void 0:t[Hd],a=e.texCoord,i=a===void 0?0:a,o=n.texCoord,s=o===void 0?i:o,u=r.findIndex(function(l){var c=(0,yS.default)(l,2),h=c[0],d=c[1];return h===i&&d===s})!==-1;if(!u){var f=Tk(n);return i!==s&&(e.texCoord=s),r.push([i,s]),{originalTexCoord:i,texCoord:s,matrix:f}}return null}function Ak(e,r,t){var n=t.originalTexCoord,a=t.texCoord,i=t.matrix,o=r.attributes["TEXCOORD_".concat(n)];if(Number.isFinite(o)){var s,u=(s=e.json.accessors)===null||s===void 0?void 0:s[o];if(u&&u.bufferView){var f,l=(f=e.json.bufferViews)===null||f===void 0?void 0:f[u.bufferView];if(l){for(var c=e.buffers[l.buffer],h=c.arrayBuffer,d=c.byteOffset,p=(d||0)+(u.byteOffset||0)+(l.byteOffset||0),v=Ia(u,l),g=v.ArrayType,y=v.length,b=mS[u.componentType],E=pS[u.type],T=l.byteStride||b*E,S=new Float32Array(y),I=0;I<u.count;I++){var L=new g(h,p+I*T,2);Su.set(L[0],L[1],1),Su.transformByMatrix3(i),S.set([Su[0],Su[1]],I*E)}n===a?_k(u,l,e.buffers,S):bk(a,u,r,e,S)}}}}function _k(e,r,t,n){e.componentType=5126,t.push({arrayBuffer:n.buffer,byteOffset:0,byteLength:n.buffer.byteLength}),r.buffer=t.length-1,r.byteLength=n.buffer.byteLength,r.byteOffset=0,delete r.byteStride}function bk(e,r,t,n,a){n.buffers.push({arrayBuffer:a.buffer,byteOffset:0,byteLength:a.buffer.byteLength});var i=n.json.bufferViews;if(i){i.push({buffer:n.buffers.length-1,byteLength:a.buffer.byteLength,byteOffset:0});var o=n.json.accessors;o&&(o.push({bufferView:i?.length-1,byteOffset:0,componentType:5126,count:r.count,type:"VEC2"}),t.attributes["TEXCOORD_".concat(e)]=o.length-1)}}function Tk(e){var r=e.offset,t=r===void 0?[0,0]:r,n=e.rotation,a=n===void 0?0:n,i=e.scale,o=i===void 0?[1,1]:i,s=new ye().set(1,0,0,0,1,0,t[0],t[1],1),u=pk.set(Math.cos(a),Math.sin(a),0,-Math.sin(a),Math.cos(a),0,0,0,1),f=mk.set(o[0],0,0,0,o[1],0,0,0,1);return s.multiplyRight(u).multiplyRight(f)}var qd={};It(qd,{decode:()=>Sk,encode:()=>Ck,name:()=>Ek});var Jd=m(X()),zi=m(Y());function bS(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=xk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function xk(e,r){if(e){if(typeof e=="string")return _S(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _S(e,r)}}function _S(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Dn="KHR_lights_punctual",Ek=Dn;function Sk(e){return zd.apply(this,arguments)}function zd(){return zd=(0,Jd.default)(zi.default.mark(function e(r){var t,n,a,i,o,s,u;return zi.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:t=new Oe(r),n=t.json,a=t.getExtension(Dn),a&&(t.json.lights=a.lights,t.removeExtension(Dn)),i=bS(n.nodes||[]);try{for(i.s();!(o=i.n()).done;)s=o.value,u=t.getObjectExtension(s,Dn),u&&(s.light=u.light),t.removeObjectExtension(s,Dn)}catch(c){i.e(c)}finally{i.f()}case 6:case"end":return l.stop()}},e)})),zd.apply(this,arguments)}function Ck(e){return Wd.apply(this,arguments)}function Wd(){return Wd=(0,Jd.default)(zi.default.mark(function e(r){var t,n,a,i,o,s,u;return zi.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t=new Oe(r),n=t.json,n.lights&&(a=t.addExtension(Dn),qe(!a.lights),a.lights=n.lights,delete n.lights),t.json.lights){i=bS(t.json.lights);try{for(i.s();!(o=i.n()).done;)s=o.value,u=s.node,t.addObjectExtension(u,Dn,s)}catch(c){i.e(c)}finally{i.f()}delete t.json.lights}case 4:case"end":return l.stop()}},e)})),Wd.apply(this,arguments)}var Kd={};It(Kd,{decode:()=>Mk,encode:()=>Ok,name:()=>Bk});var xS=m(X()),Xd=m(Y());function ES(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=wk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function wk(e,r){if(e){if(typeof e=="string")return TS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return TS(e,r)}}function TS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Wi="KHR_materials_unlit",Bk=Wi;function Mk(e){return Yd.apply(this,arguments)}function Yd(){return Yd=(0,xS.default)(Xd.default.mark(function e(r){var t,n,a,i,o,s;return Xd.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:t=new Oe(r),n=t.json,a=ES(n.materials||[]);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.extensions&&o.extensions.KHR_materials_unlit,s&&(o.unlit=!0),t.removeObjectExtension(o,Wi)}catch(l){a.e(l)}finally{a.f()}t.removeExtension(Wi);case 5:case"end":return f.stop()}},e)})),Yd.apply(this,arguments)}function Ok(e){var r=new Oe(e),t=r.json;if(r.materials){var n=ES(t.materials||[]),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;i.unlit&&(delete i.unlit,r.addObjectExtension(i,Wi,{}),r.addExtension(Wi))}}catch(o){n.e(o)}finally{n.f()}}}var ep={};It(ep,{decode:()=>Fk,encode:()=>Lk,name:()=>Rk});var CS=m(Xe()),$d=m(X()),qi=m(Y());function Ik(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Pk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Pk(e,r){if(e){if(typeof e=="string")return SS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return SS(e,r)}}function SS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var Ji="KHR_techniques_webgl",Rk=Ji;function Fk(e){return Qd.apply(this,arguments)}function Qd(){return Qd=(0,$d.default)(qi.default.mark(function e(r){var t,n,a,i,o,s,u,f;return qi.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t=new Oe(r),n=t.json,a=t.getExtension(Ji),a){i=kk(a,t),o=Ik(n.materials||[]);try{for(o.s();!(s=o.n()).done;)u=s.value,f=t.getObjectExtension(u,Ji),f&&(u.technique=Object.assign({},f,i[f.technique]),u.technique.values=Dk(u.technique,t)),t.removeObjectExtension(u,Ji)}catch(h){o.e(h)}finally{o.f()}t.removeExtension(Ji)}case 4:case"end":return c.stop()}},e)})),Qd.apply(this,arguments)}function Lk(e,r){return Zd.apply(this,arguments)}function Zd(){return Zd=(0,$d.default)(qi.default.mark(function e(r,t){return qi.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}},e)})),Zd.apply(this,arguments)}function kk(e,r){var t=e.programs,n=t===void 0?[]:t,a=e.shaders,i=a===void 0?[]:a,o=e.techniques,s=o===void 0?[]:o,u=new TextDecoder;return i.forEach(function(f){if(Number.isFinite(f.bufferView))f.code=u.decode(r.getTypedArrayForBufferView(f.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(function(f){f.fragmentShader=i[f.fragmentShader],f.vertexShader=i[f.vertexShader]}),s.forEach(function(f){f.program=n[f.program]}),s}function Dk(e,r){var t=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach(function(n){e.uniforms[n].value&&!(n in t)&&(t[n]=e.uniforms[n].value)}),Object.keys(t).forEach(function(n){(0,CS.default)(t[n])==="object"&&t[n].index!==void 0&&(t[n].texture=r.getTexture(t[n].index))}),t}var np={};It(np,{decode:()=>Nk,name:()=>Gk});var wS=m(X()),tp=m(Y());var BS="EXT_feature_metadata",Gk=BS;function Nk(e){return rp.apply(this,arguments)}function rp(){return rp=(0,wS.default)(tp.default.mark(function e(r){var t;return tp.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t=new Oe(r),Uk(t);case 2:case"end":return a.stop()}},e)})),rp.apply(this,arguments)}function Uk(e){var r,t=e.getExtension(BS),n=t==null||(r=t.schema)===null||r===void 0?void 0:r.classes,a=t?.featureTables,i=t?.featureTextures;if(i&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),n&&a)for(var o in n){var s=n[o],u=Vk(a,o);u&&jk(e,u,s)}}function jk(e,r,t){for(var n in t.properties){var a,i=t.properties[n],o=r==null||(a=r.properties)===null||a===void 0?void 0:a[n],s=r.count;if(o){var u=Hk(e,i,s,o);o.data=u}}}function Hk(e,r,t,n){var a=n.bufferView,i=e.getTypedArrayForBufferView(a);switch(r.type){case"STRING":{var o=n.stringOffsetBufferView,s=e.getTypedArrayForBufferView(o);i=zk(i,s,t);break}default:}return i}function Vk(e,r){for(var t in e){var n=e[t];if(n.class===r)return n}return null}function zk(e,r,t){for(var n=[],a=new TextDecoder("utf8"),i=0,o=4,s=0;s<t;s++){var u=r[(s+1)*o]-r[s*o],f=e.subarray(i,u+i),l=a.decode(f);n.push(l),i+=u}return n}function IS(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Wk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Wk(e,r){if(e){if(typeof e=="string")return MS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return MS(e,r)}}function MS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var PS=[Od,Id,Pd,Nd,qd,Kd,ep,Vd,np];function RS(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0,n=PS.filter(function(u){return LS(u.name,r)}),a=IS(n),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s;(s=o.preprocess)===null||s===void 0||s.call(o,e,r,t)}}catch(u){a.e(u)}finally{a.f()}}function FS(e){return ip.apply(this,arguments)}function ip(){return ip=(0,OS.default)(ap.default.mark(function e(r){var t,n,a,i,o,s,u,f=arguments;return ap.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:t=f.length>1&&f[1]!==void 0?f[1]:{},n=f.length>2?f[2]:void 0,a=PS.filter(function(h){return LS(h.name,t)}),i=IS(a),c.prev=4,i.s();case 6:if((o=i.n()).done){c.next=12;break}return s=o.value,c.next=10,(u=s.decode)===null||u===void 0?void 0:u.call(s,r,t,n);case 10:c.next=6;break;case 12:c.next=17;break;case 14:c.prev=14,c.t0=c.catch(4),i.e(c.t0);case 17:return c.prev=17,i.f(),c.finish(17);case 20:case"end":return c.stop()}},e,null,[[4,14,17,20]])})),ip.apply(this,arguments)}function LS(e,r){var t,n=(r==null||(t=r.gltf)===null||t===void 0?void 0:t.excludeExtensions)||{},a=e in n&&!n[e];return!a}var US=m(H()),jS=m(z());function Jk(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=qk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function qk(e,r){if(e){if(typeof e=="string")return kS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return kS(e,r)}}function kS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var op="KHR_binary_glTF";function DS(e){var r=new Oe(e),t=r.json,n=Jk(t.images||[]),a;try{for(n.s();!(a=n.n()).done;){var i=a.value,o=r.getObjectExtension(i,op);o&&Object.assign(i,o),r.removeObjectExtension(i,op)}}catch(s){n.e(s)}finally{n.f()}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,r.removeExtension(op)}function Jr(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Yk(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Yk(e,r){if(e){if(typeof e=="string")return GS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return GS(e,r)}}function GS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var NS={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Kk={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},Qk=function(){function e(){(0,US.default)(this,e),A(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),A(this,"json",void 0)}return(0,jS.default)(e,[{key:"normalize",value:function(t,n){this.json=t.json;var a=t.json;switch(a.asset&&a.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(a.asset.version));return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(a),this._convertTopLevelObjectsToArrays(a),DS(t),this._convertObjectIdsToArrayIndices(a),this._updateObjects(a),this._updateMaterial(a)}},{key:"_addAsset",value:function(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}},{key:"_convertTopLevelObjectsToArrays",value:function(t){for(var n in NS)this._convertTopLevelObjectToArray(t,n)}},{key:"_convertTopLevelObjectToArray",value:function(t,n){var a=t[n];if(!(!a||Array.isArray(a))){t[n]=[];for(var i in a){var o=a[i];o.id=o.id||i;var s=t[n].length;t[n].push(o),this.idToIndexMap[n][i]=s}}}},{key:"_convertObjectIdsToArrayIndices",value:function(t){for(var n in NS)this._convertIdsToIndices(t,n);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));var a=Jr(t.textures),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;this._convertTextureIds(o)}}catch(g){a.e(g)}finally{a.f()}var s=Jr(t.meshes),u;try{for(s.s();!(u=s.n()).done;){var f=u.value;this._convertMeshIds(f)}}catch(g){s.e(g)}finally{s.f()}var l=Jr(t.nodes),c;try{for(l.s();!(c=l.n()).done;){var h=c.value;this._convertNodeIds(h)}}catch(g){l.e(g)}finally{l.f()}var d=Jr(t.scenes),p;try{for(d.s();!(p=d.n()).done;){var v=p.value;this._convertSceneIds(v)}}catch(g){d.e(g)}finally{d.f()}}},{key:"_convertTextureIds",value:function(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}},{key:"_convertMeshIds",value:function(t){var n=Jr(t.primitives),a;try{for(n.s();!(a=n.n()).done;){var i=a.value,o=i.attributes,s=i.indices,u=i.material;for(var f in o)o[f]=this._convertIdToIndex(o[f],"accessor");s&&(i.indices=this._convertIdToIndex(s,"accessor")),u&&(i.material=this._convertIdToIndex(u,"material"))}}catch(l){n.e(l)}finally{n.f()}}},{key:"_convertNodeIds",value:function(t){var n=this;t.children&&(t.children=t.children.map(function(a){return n._convertIdToIndex(a,"node")})),t.meshes&&(t.meshes=t.meshes.map(function(a){return n._convertIdToIndex(a,"mesh")}))}},{key:"_convertSceneIds",value:function(t){var n=this;t.nodes&&(t.nodes=t.nodes.map(function(a){return n._convertIdToIndex(a,"node")}))}},{key:"_convertIdsToIndices",value:function(t,n){t[n]||(console.warn("gltf v1: json doesn't contain attribute ".concat(n)),t[n]=[]);var a=Jr(t[n]),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;for(var s in o){var u=o[s],f=this._convertIdToIndex(u,s);o[s]=f}}}catch(l){a.e(l)}finally{a.f()}}},{key:"_convertIdToIndex",value:function(t,n){var a=Kk[n];if(a in this.idToIndexMap){var i=this.idToIndexMap[a][t];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(n," with id ").concat(t));return i}return t}},{key:"_updateObjects",value:function(t){var n=Jr(this.json.buffers),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;delete i.type}}catch(o){n.e(o)}finally{n.f()}}},{key:"_updateMaterial",value:function(t){var n=Jr(t.materials),a;try{var i=function(){var l=a.value;l.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};var c=((o=l.values)===null||o===void 0?void 0:o.tex)||((s=l.values)===null||s===void 0?void 0:s.texture2d_0)||((u=l.values)===null||u===void 0?void 0:u.diffuseTex),h=t.textures.findIndex(function(d){return d.id===c});h!==-1&&(l.pbrMetallicRoughness.baseColorTexture={index:h})};for(n.s();!(a=n.n()).done;){var o,s,u;i()}}catch(f){n.e(f)}finally{n.f()}}}]),e}();function HS(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Qk().normalize(e,r)}var zS=m(Xe()),WS=m(H()),JS=m(z()),Fa=m(W());var Ra;function VS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function gr(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?VS(Object(t),!0).forEach(function(n){(0,Fa.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):VS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Zk={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},$k={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Ot={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},eD={magFilter:Ot.TEXTURE_MAG_FILTER,minFilter:Ot.TEXTURE_MIN_FILTER,wrapS:Ot.TEXTURE_WRAP_S,wrapT:Ot.TEXTURE_WRAP_T},tD=(Ra={},(0,Fa.default)(Ra,Ot.TEXTURE_MAG_FILTER,Ot.LINEAR),(0,Fa.default)(Ra,Ot.TEXTURE_MIN_FILTER,Ot.NEAREST_MIPMAP_LINEAR),(0,Fa.default)(Ra,Ot.TEXTURE_WRAP_S,Ot.REPEAT),(0,Fa.default)(Ra,Ot.TEXTURE_WRAP_T,Ot.REPEAT),Ra);function rD(e){return $k[e]}function nD(e){return Zk[e]}var aD=function(){function e(){(0,WS.default)(this,e),A(this,"baseUri",""),A(this,"json",{}),A(this,"buffers",[]),A(this,"images",[])}return(0,JS.default)(e,[{key:"postProcess",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=t.json,i=t.buffers,o=i===void 0?[]:i,s=t.images,u=s===void 0?[]:s,f=t.baseUri,l=f===void 0?"":f;return qe(a),this.baseUri=l,this.json=a,this.buffers=o,this.images=u,this._resolveTree(this.json,n),this.json}},{key:"_resolveTree",value:function(t){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t.bufferViews&&(t.bufferViews=t.bufferViews.map(function(i,o){return n._resolveBufferView(i,o)})),t.images&&(t.images=t.images.map(function(i,o){return n._resolveImage(i,o)})),t.samplers&&(t.samplers=t.samplers.map(function(i,o){return n._resolveSampler(i,o)})),t.textures&&(t.textures=t.textures.map(function(i,o){return n._resolveTexture(i,o)})),t.accessors&&(t.accessors=t.accessors.map(function(i,o){return n._resolveAccessor(i,o)})),t.materials&&(t.materials=t.materials.map(function(i,o){return n._resolveMaterial(i,o)})),t.meshes&&(t.meshes=t.meshes.map(function(i,o){return n._resolveMesh(i,o)})),t.nodes&&(t.nodes=t.nodes.map(function(i,o){return n._resolveNode(i,o)})),t.skins&&(t.skins=t.skins.map(function(i,o){return n._resolveSkin(i,o)})),t.scenes&&(t.scenes=t.scenes.map(function(i,o){return n._resolveScene(i,o)})),t.scene!==void 0&&(t.scene=t.scenes[this.json.scene])}},{key:"getScene",value:function(t){return this._get("scenes",t)}},{key:"getNode",value:function(t){return this._get("nodes",t)}},{key:"getSkin",value:function(t){return this._get("skins",t)}},{key:"getMesh",value:function(t){return this._get("meshes",t)}},{key:"getMaterial",value:function(t){return this._get("materials",t)}},{key:"getAccessor",value:function(t){return this._get("accessors",t)}},{key:"getCamera",value:function(t){return null}},{key:"getTexture",value:function(t){return this._get("textures",t)}},{key:"getSampler",value:function(t){return this._get("samplers",t)}},{key:"getImage",value:function(t){return this._get("images",t)}},{key:"getBufferView",value:function(t){return this._get("bufferViews",t)}},{key:"getBuffer",value:function(t){return this._get("buffers",t)}},{key:"_get",value:function(t,n){if((0,zS.default)(n)==="object")return n;var a=this.json[t]&&this.json[t][n];return a||console.warn("glTF file error: Could not find ".concat(t,"[").concat(n,"]")),a}},{key:"_resolveScene",value:function(t,n){var a=this;return t.id=t.id||"scene-".concat(n),t.nodes=(t.nodes||[]).map(function(i){return a.getNode(i)}),t}},{key:"_resolveNode",value:function(t,n){var a=this;return t.id=t.id||"node-".concat(n),t.children&&(t.children=t.children.map(function(i){return a.getNode(i)})),t.mesh!==void 0?t.mesh=this.getMesh(t.mesh):t.meshes!==void 0&&t.meshes.length&&(t.mesh=t.meshes.reduce(function(i,o){var s=a.getMesh(o);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),t.camera!==void 0&&(t.camera=this.getCamera(t.camera)),t.skin!==void 0&&(t.skin=this.getSkin(t.skin)),t}},{key:"_resolveSkin",value:function(t,n){return t.id=t.id||"skin-".concat(n),t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}},{key:"_resolveMesh",value:function(t,n){var a=this;return t.id=t.id||"mesh-".concat(n),t.primitives&&(t.primitives=t.primitives.map(function(i){i=gr({},i);var o=i.attributes;i.attributes={};for(var s in o)i.attributes[s]=a.getAccessor(o[s]);return i.indices!==void 0&&(i.indices=a.getAccessor(i.indices)),i.material!==void 0&&(i.material=a.getMaterial(i.material)),i})),t}},{key:"_resolveMaterial",value:function(t,n){if(t.id=t.id||"material-".concat(n),t.normalTexture&&(t.normalTexture=gr({},t.normalTexture),t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture=gr({},t.occlustionTexture),t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture=gr({},t.emmisiveTexture),t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.emissiveFactor||(t.emissiveFactor=t.emmisiveTexture?[1,1,1]:[0,0,0]),t.pbrMetallicRoughness){t.pbrMetallicRoughness=gr({},t.pbrMetallicRoughness);var a=t.pbrMetallicRoughness;a.baseColorTexture&&(a.baseColorTexture=gr({},a.baseColorTexture),a.baseColorTexture.texture=this.getTexture(a.baseColorTexture.index)),a.metallicRoughnessTexture&&(a.metallicRoughnessTexture=gr({},a.metallicRoughnessTexture),a.metallicRoughnessTexture.texture=this.getTexture(a.metallicRoughnessTexture.index))}return t}},{key:"_resolveAccessor",value:function(t,n){if(t.id=t.id||"accessor-".concat(n),t.bufferView!==void 0&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=rD(t.componentType),t.components=nD(t.type),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){var a=t.bufferView.buffer,i=Ia(t,t.bufferView),o=i.ArrayType,s=i.byteLength,u=(t.bufferView.byteOffset||0)+(t.byteOffset||0)+a.byteOffset,f=a.arrayBuffer.slice(u,u+s);t.bufferView.byteStride&&(f=this._getValueFromInterleavedBuffer(a,u,t.bufferView.byteStride,t.bytesPerElement,t.count)),t.value=new o(f)}return t}},{key:"_getValueFromInterleavedBuffer",value:function(t,n,a,i,o){for(var s=new Uint8Array(o*i),u=0;u<o;u++){var f=n+u*a;s.set(new Uint8Array(t.arrayBuffer.slice(f,f+i)),u*i)}return s.buffer}},{key:"_resolveTexture",value:function(t,n){return t.id=t.id||"texture-".concat(n),t.sampler="sampler"in t?this.getSampler(t.sampler):tD,t.source=this.getImage(t.source),t}},{key:"_resolveSampler",value:function(t,n){t.id=t.id||"sampler-".concat(n),t.parameters={};for(var a in t){var i=this._enumSamplerParameter(a);i!==void 0&&(t.parameters[i]=t[a])}return t}},{key:"_enumSamplerParameter",value:function(t){return eD[t]}},{key:"_resolveImage",value:function(t,n){t.id=t.id||"image-".concat(n),t.bufferView!==void 0&&(t.bufferView=this.getBufferView(t.bufferView));var a=this.images[n];return a&&(t.image=a),t}},{key:"_resolveBufferView",value:function(t,n){var a=t.buffer,i=gr(gr({id:"bufferView-".concat(n)},t),{},{buffer:this.buffers[a]}),o=this.buffers[a].arrayBuffer,s=this.buffers[a].byteOffset||0;return"byteOffset"in t&&(s+=t.byteOffset),i.data=new Uint8Array(o,s,t.byteLength),i}},{key:"_resolveCamera",value:function(t,n){return t.id=t.id||"camera-".concat(n),t.perspective,t.orthographic,t}}]),e}();function qS(e,r){return new aD().postProcess(e,r)}var XS=1735152710,fp=12,Cu=8,iD=1313821514,oD=5130562,sD=0,uD=1,fD=0,La=!0;function lD(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return"".concat(String.fromCharCode(e.getUint8(r+0))).concat(String.fromCharCode(e.getUint8(r+1))).concat(String.fromCharCode(e.getUint8(r+2))).concat(String.fromCharCode(e.getUint8(r+3)))}function YS(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=new DataView(e),a=t.magic,i=a===void 0?XS:a,o=n.getUint32(r,!1);return o===i||o===XS}function lp(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=new DataView(r),i=lD(a,t+0),o=a.getUint32(t+4,La),s=a.getUint32(t+8,La);switch(Object.assign(e,{header:{byteOffset:t,byteLength:s,hasBinChunk:!1},type:i,version:o,json:{},binChunks:[]}),t+=fp,e.version){case 1:return cD(e,a,t);case 2:return hD(e,a,t,n={});default:throw new Error("Invalid GLB version ".concat(e.version,". Only supports v1 and v2."))}}function cD(e,r,t){te(e.header.byteLength>fp+Cu);var n=r.getUint32(t+0,La),a=r.getUint32(t+4,La);return t+=Cu,te(a===fD),sp(e,r,t,n),t+=n,t+=up(e,r,t,e.header.byteLength),t}function hD(e,r,t,n){return te(e.header.byteLength>fp+Cu),dD(e,r,t,n),t+e.header.byteLength}function dD(e,r,t,n){for(;t+8<=e.header.byteLength;){var a=r.getUint32(t+0,La),i=r.getUint32(t+4,La);switch(t+=Cu,i){case iD:sp(e,r,t,a);break;case oD:up(e,r,t,a);break;case sD:n.strict||sp(e,r,t,a);break;case uD:n.strict||up(e,r,t,a);break;default:break}t+=Er(a,4)}return t}function sp(e,r,t,n){var a=new Uint8Array(r.buffer,t,n),i=new TextDecoder("utf8"),o=i.decode(a);return e.json=JSON.parse(o),Er(n,4)}function up(e,r,t,n){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:t,byteLength:n,arrayBuffer:r.buffer}),Er(n,4)}function QS(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=pD(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function pD(e,r){if(e){if(typeof e=="string")return KS(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return KS(e,r)}}function KS(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ZS(e,r){return cp.apply(this,arguments)}function cp(){return cp=(0,Xi.default)(yr.default.mark(function e(r,t){var n,a,i,o,s,u,f,l,c,h,d=arguments;return yr.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(s=d.length>2&&d[2]!==void 0?d[2]:0,u=d.length>3?d[3]:void 0,f=d.length>4?d[4]:void 0,mD(r,t,s,u),HS(r,{normalize:u==null||(n=u.gltf)===null||n===void 0?void 0:n.normalize}),RS(r,u,f),l=[],!(u!=null&&(a=u.gltf)!==null&&a!==void 0&&a.loadBuffers&&r.json.buffers)){v.next=10;break}return v.next=10,vD(r,u,f);case 10:return u!=null&&(i=u.gltf)!==null&&i!==void 0&&i.loadImages&&(c=gD(r,u,f),l.push(c)),h=FS(r,u,f),l.push(h),v.next=15,Promise.all(l);case 15:return v.abrupt("return",u!=null&&(o=u.gltf)!==null&&o!==void 0&&o.postProcess?qS(r,u):r);case 16:case"end":return v.stop()}},e)})),cp.apply(this,arguments)}function mD(e,r,t,n){if(n.uri&&(e.baseUri=n.uri),r instanceof ArrayBuffer&&!YS(r,t,n)){var a=new TextDecoder;r=a.decode(r)}if(typeof r=="string")e.json=Lf(r);else if(r instanceof ArrayBuffer){var i={};t=lp(i,r,t,n.glb),qe(i.type==="glTF","Invalid GLB magic string ".concat(i.type)),e._glb=i,e.json=i.json}else qe(!1,"GLTF: must be ArrayBuffer or string");var o=e.json.buffers||[];if(e.buffers=new Array(o.length).fill(null),e._glb&&e._glb.header.hasBinChunk){var s=e._glb.binChunks;e.buffers[0]={arrayBuffer:s[0].arrayBuffer,byteOffset:s[0].byteOffset,byteLength:s[0].byteLength}}var u=e.json.images||[];e.images=new Array(u.length).fill({})}function vD(e,r,t){return hp.apply(this,arguments)}function hp(){return hp=(0,Xi.default)(yr.default.mark(function e(r,t,n){var a,i,o,s,u,f,l,c,h;return yr.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:a=r.json.buffers||[],i=0;case 2:if(!(i<a.length)){p.next=22;break}if(o=a[i],!o.uri){p.next=18;break}return f=n.fetch,qe(f),l=bd(o.uri,t),p.next=10,n==null||(s=n.fetch)===null||s===void 0?void 0:s.call(n,l);case 10:return c=p.sent,p.next=13,c==null||(u=c.arrayBuffer)===null||u===void 0?void 0:u.call(c);case 13:h=p.sent,r.buffers[i]={arrayBuffer:h,byteOffset:0,byteLength:h.byteLength},delete o.uri,p.next=19;break;case 18:r.buffers[i]===null&&(r.buffers[i]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength});case 19:++i,p.next=2;break;case 22:case"end":return p.stop()}},e)})),hp.apply(this,arguments)}function gD(e,r,t){return dp.apply(this,arguments)}function dp(){return dp=(0,Xi.default)(yr.default.mark(function e(r,t,n){var a,i,o,s,u,f;return yr.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:a=yD(r),i=r.json.images||[],o=[],s=QS(a);try{for(s.s();!(u=s.n()).done;)f=u.value,o.push(AD(r,i[f],f,t,n))}catch(h){s.e(h)}finally{s.f()}return c.next=7,Promise.all(o);case 7:return c.abrupt("return",c.sent);case 8:case"end":return c.stop()}},e)})),dp.apply(this,arguments)}function yD(e){var r=new Set,t=e.json.textures||[],n=QS(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;i.source!==void 0&&r.add(i.source)}}catch(o){n.e(o)}finally{n.f()}return Array.from(r).sort()}function AD(e,r,t,n,a){return pp.apply(this,arguments)}function pp(){return pp=(0,Xi.default)(yr.default.mark(function e(r,t,n,a,i){var o,s,u,f,l,c,h;return yr.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(o=i.fetch,s=i.parse,!(t.uri&&!t.hasOwnProperty("bufferView"))){p.next=10;break}return f=bd(t.uri,a),p.next=5,o(f);case 5:return l=p.sent,p.next=8,l.arrayBuffer();case 8:u=p.sent,t.bufferView={data:u};case 10:return Number.isFinite(t.bufferView)&&(c=KE(r.json,r.buffers,t.bufferView),u=an(c.buffer,c.byteOffset,c.byteLength)),qe(u,"glTF image has no data"),p.next=14,s(u,[nr,_d],{mimeType:t.mimeType,basis:a.basis||{format:_u()}},i);case 14:h=p.sent,h&&h[0]&&(h={compressed:!0,mipmaps:!1,width:h[0].width,height:h[0].height,data:h[0]}),r.images=r.images||[],r.images[n]=h;case 18:case"end":return p.stop()}},e)})),pp.apply(this,arguments)}function $S(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function wu(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?$S(Object(t),!0).forEach(function(n){(0,eC.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$S(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Gn={name:"glTF",id:"gltf",module:"gltf",version:wE,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:_D,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function _D(e){return vp.apply(this,arguments)}function vp(){return vp=(0,tC.default)(mp.default.mark(function e(r){var t,n,a,i,o,s,u=arguments;return mp.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=u.length>1&&u[1]!==void 0?u[1]:{},n=u.length>2?u[2]:void 0,t=wu(wu({},Gn.options),t),t.gltf=wu(wu({},Gn.options.gltf),t.gltf),a=t,i=a.byteOffset,o=i===void 0?0:i,s={},l.next=8,ZS(s,r,o,t,n);case 8:return l.abrupt("return",l.sent);case 9:case"end":return l.stop()}},e)})),vp.apply(this,arguments)}var Bu={URI:0,EMBEDDED:1};function Mu(e,r,t,n){e.rotateYtoZ=!0;var a=e.byteOffset+e.byteLength-t;if(a===0)throw new Error("glTF byte length must be greater than 0.");return e.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",e.gltfArrayBuffer=an(r,t,a),e.gltfByteOffset=0,e.gltfByteLength=a,t%4===0||console.warn("".concat(e.type,": embedded glb is not aligned to a 4-byte boundary.")),e.byteOffset+e.byteLength}function Ou(e,r,t,n){return yp.apply(this,arguments)}function yp(){return yp=(0,rC.default)(gp.default.mark(function e(r,t,n,a){var i,o,s;return gp.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(i=n["3d-tiles"]||{},bD(r,t,n),!i.loadGLTF){f.next=16;break}if(o=a.parse,s=a.fetch,!r.gltfUrl){f.next=9;break}return f.next=7,s(r.gltfUrl,n);case 7:r.gltfArrayBuffer=f.sent,r.gltfByteOffset=0;case 9:if(!r.gltfArrayBuffer){f.next=16;break}return f.next=12,o(r.gltfArrayBuffer,Gn,n,a);case 12:r.gltf=f.sent,delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength;case 16:case"end":return f.stop()}},e)})),yp.apply(this,arguments)}function bD(e,r,t){switch(r){case Bu.URI:var n=new Uint8Array(e.gltfArrayBuffer,e.gltfByteOffset),a=new TextDecoder,i=a.decode(n);e.gltfUrl=i.replace(/[\s\0]+$/,""),delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;break;case Bu.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}function aC(e,r,t,n,a){return _p.apply(this,arguments)}function _p(){return _p=(0,nC.default)(Ap.default.mark(function e(r,t,n,a,i){var o,s;return Ap.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return n=TD(r,t,n,a,i),f.next=3,Ou(r,Bu.EMBEDDED,a,i);case 3:return s=r==null||(o=r.gltf)===null||o===void 0?void 0:o.extensions,s&&s.CESIUM_RTC&&(r.rtcCenter=s.CESIUM_RTC.center),f.abrupt("return",n);case 6:case"end":return f.stop()}},e)})),_p.apply(this,arguments)}function TD(e,r,t,n,a){t=Wr(e,r,t),t=Ma(e,r,t),t=Oa(e,r,t,n),t=Mu(e,r,t,n);var i=new Ca(e.featureTableJson,e.featureTableBinary);return e.rtcCenter=i.getGlobalProperty("RTC_CENTER",5126,3),t}var iC=m(X()),bp=m(Y());function oC(e,r,t,n,a){return Tp.apply(this,arguments)}function Tp(){return Tp=(0,iC.default)(bp.default.mark(function e(r,t,n,a,i){return bp.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=xD(r,t,n,a,i),s.next=3,Ou(r,r.gltfFormat,a,i);case 3:return s.abrupt("return",n);case 4:case"end":return s.stop()}},e)})),Tp.apply(this,arguments)}function xD(e,r,t,n,a){if(t=Wr(e,r,t),e.version!==1)throw new Error("Instanced 3D Model version ".concat(e.version," is not supported"));t=Ma(e,r,t);var i=new DataView(r);if(e.gltfFormat=i.getUint32(t,!0),t+=4,t=Oa(e,r,t,n),t=Mu(e,r,t,n),e.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");var o=new Ca(e.featureTableJson,e.featureTableBinary),s=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");e.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),e.rtcCenter=o.getGlobalProperty("RTC_CENTER",5126,3);var u=new gu(e.batchTableJson,e.batchTableBinary,s);return ED(e,o,u,s),t}function ED(e,r,t,n){for(var a={instances:new Array(n),batchTable:e._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]},i=a.instances,o=new w,s=new w,u=new w,f=new w,l=new ye,c=new Mr,h=new w,d={},p=new $,v=[],g=[],y=new w,b=new w,E=0;E<n;E++){var T=void 0;if(r.hasProperty("POSITION"))T=r.getProperty("POSITION",5126,3,E,o);else if(r.hasProperty("POSITION_QUANTIZED")){T=r.getProperty("POSITION_QUANTIZED",5123,3,E,o);var S=r.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",5126,3,y);if(!S)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var I=r.getGlobalProperty("QUANTIZED_VOLUME_SCALE",5126,3,b);if(!I)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var L=65535,B=0;B<3;B++)T[B]=T[B]/L*I[B]+S[B]}if(!T)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");o.copy(T),d.translation=o,e.normalUp=r.getProperty("NORMAL_UP",5126,3,E,v),e.normalRight=r.getProperty("NORMAL_RIGHT",5126,3,E,g);var C=!1;if(e.normalUp){if(!e.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");e.hasCustomOrientation=!0}else{if(e.octNormalUp=r.getProperty("NORMAL_UP_OCT32P",5123,2,v),e.octNormalRight=r.getProperty("NORMAL_RIGHT_OCT32P",5123,2,g),e.octNormalUp)throw e.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");e.eastNorthUp?(ge.WGS84.eastNorthUpToFixedFrame(o,p),p.getRotationMatrix3(l)):l.identity()}C&&(f.copy(s).cross(u).normalize(),l.setColumn(0,s),l.setColumn(1,u),l.setColumn(2,f)),c.fromMatrix3(l),d.rotation=c,h.set(1,1,1);var _=r.getProperty("SCALE",5126,1,E);Number.isFinite(_)&&h.multiplyByScalar(_);var R=r.getProperty("SCALE_NON_UNIFORM",5126,3,E,v);R&&h.scale(R),d.scale=h;var F=r.getProperty("BATCH_ID",5123,1,E);F===void 0&&(F=E);var k=new $().fromQuaternion(d.rotation);p.identity(),p.translate(d.translation),p.multiplyRight(k),p.scale(d.scale);var D=p.clone();i[E]={modelMatrix:D,batchId:F}}e.instances=i}var sC=m(X()),xp=m(Y());function uC(e,r,t,n,a,i){return Ep.apply(this,arguments)}function Ep(){return Ep=(0,sC.default)(xp.default.mark(function e(r,t,n,a,i,o){var s,u;return xp.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:n=Wr(r,t,n),s=new DataView(t),r.tilesLength=s.getUint32(n,!0),n+=4,r.tiles=[];case 5:if(!(r.tiles.length<r.tilesLength&&r.byteLength-n>12)){l.next=13;break}return u={},r.tiles.push(u),l.next=10,o(t,n,a,i,u);case 10:n=l.sent,l.next=5;break;case 13:return l.abrupt("return",n);case 14:case"end":return l.stop()}},e)})),Ep.apply(this,arguments)}var fC=m(X()),Sp=m(Y());function lC(e,r,t,n){return Cp.apply(this,arguments)}function Cp(){return Cp=(0,fC.default)(Sp.default.mark(function e(r,t,n,a){var i;return Sp.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return r.rotateYtoZ=!0,r.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",i=a.parse,s.next=5,i(t,Gn,n,a);case 5:r.gltf=s.sent;case 6:case"end":return s.stop()}},e)})),Cp.apply(this,arguments)}function Mp(e){return Bp.apply(this,arguments)}function Bp(){return Bp=(0,cC.default)(wp.default.mark(function e(r){var t,n,a,i,o=arguments;return wp.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:t=o.length>1&&o[1]!==void 0?o[1]:0,n=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=o.length>4&&o[4]!==void 0?o[4]:{},i.byteOffset=t,i.type=$T(r,t),u.t0=i.type,u.next=u.t0===Mn.COMPOSITE?9:u.t0===Mn.BATCHED_3D_MODEL?12:u.t0===Mn.GLTF?15:u.t0===Mn.INSTANCED_3D_MODEL?18:u.t0===Mn.POINT_CLOUD?21:24;break;case 9:return u.next=11,uC(i,r,t,n,a,Mp);case 11:return u.abrupt("return",u.sent);case 12:return u.next=14,aC(i,r,t,n,a);case 14:return u.abrupt("return",u.sent);case 15:return u.next=17,lC(i,r,n,a);case 17:return u.abrupt("return",u.sent);case 18:return u.next=20,oC(i,r,t,n,a);case 20:return u.abrupt("return",u.sent);case 21:return u.next=23,CE(i,r,t,n,a);case 23:return u.abrupt("return",u.sent);case 24:throw new Error("3DTileLoader: unknown type ".concat(i.type));case 25:case"end":return u.stop()}},e)})),Bp.apply(this,arguments)}var Ru=m(X()),Un=m(Y());var Rp=m(X()),Yi=m(Y()),SD=1952609651,CD=1;function Fp(e,r,t){return Ip.apply(this,arguments)}function Ip(){return Ip=(0,Rp.default)(Yi.default.mark(function e(r,t,n){var a,i,o,s,u,f,l,c,h;return Yi.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(a=new Uint32Array(r.slice(0,4)),a[0]===SD){p.next=3;break}throw new Error("Wrong subtree file magic number");case 3:if(i=new Uint32Array(r.slice(4,8)),i[0]===CD){p.next=6;break}throw new Error("Wrong subtree file verson, must be 1");case 6:if(o=hC(r.slice(8,16)),s=new Uint8Array(r,24,o),u=new TextDecoder("utf8"),f=u.decode(s),l=JSON.parse(f),c=hC(r.slice(16,24)),h=new ArrayBuffer(0),c&&(h=r.slice(24+o)),!("bufferView"in l.tileAvailability)){p.next=18;break}return p.next=17,Op(l,"tileAvailability",h,n);case 17:l.tileAvailability.explicitBitstream=p.sent;case 18:if(!("bufferView"in l.contentAvailability)){p.next=22;break}return p.next=21,Op(l,"contentAvailability",h,n);case 21:l.contentAvailability.explicitBitstream=p.sent;case 22:if(!("bufferView"in l.childSubtreeAvailability)){p.next=26;break}return p.next=25,Op(l,"childSubtreeAvailability",h,n);case 25:l.childSubtreeAvailability.explicitBitstream=p.sent;case 26:return p.abrupt("return",l);case 27:case"end":return p.stop()}},e)})),Ip.apply(this,arguments)}function wD(e,r){var t=r.startsWith("http");if(t){var n=new URL(e,r);return decodeURI(n.toString())}var a="http://".concat(r),i=new URL(e,a);return"/".concat(i.host).concat(i.pathname)}function Op(e,r,t,n){return Pp.apply(this,arguments)}function Pp(){return Pp=(0,Rp.default)(Yi.default.mark(function e(r,t,n,a){var i,o,s,u,f,l;return Yi.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(i=r[t].bufferView,o=r.bufferViews[i],s=r.buffers[o.buffer],!(!(a!=null&&a.url)||!a.fetch)){h.next=5;break}throw new Error("Url is not provided");case 5:if(a.fetch){h.next=7;break}throw new Error("fetch is not provided");case 7:if(!s.uri){h.next=16;break}return u=wD(s.uri,a?.url),h.next=11,a.fetch(u);case 11:return f=h.sent,h.next=14,f.arrayBuffer();case 14:return l=h.sent,h.abrupt("return",new Uint8Array(l,o.byteOffset,o.byteLength));case 16:return h.abrupt("return",new Uint8Array(n,o.byteOffset,o.byteLength));case 17:case"end":return h.stop()}},e)})),Pp.apply(this,arguments)}function hC(e){var r=new DataView(e),t=r.getUint32(0,!0),n=r.getUint32(4,!0);return t+Math.pow(2,32)*n}var Iu={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:ru,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:Fp,options:{}};var _C=m(ba());var dC=m(ce()),pC=m(X()),kp=m(Y());var mC=m(ba()),BD=4,MD=8,OD={QUADTREE:BD,OCTREE:MD};function Gp(e){return Dp.apply(this,arguments)}function Dp(){return Dp=(0,pC.default)(kp.default.mark(function e(r){var t,n,a,i,o,s,u,f,l,c,h,d,p,v,g,y,b,E,T,S,I,L,B,C,_,R,F,k,D,M,O,P,U,G,j,q,ne,Re,we,nt,je,br,Et,Jn;return kp.default.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:if(t=r.options,n=r.parentData,a=n===void 0?{mortonIndex:0,x:0,y:0,z:0}:n,i=r.childIndex,o=i===void 0?0:i,s=r.globalData,u=s===void 0?{level:0,mortonIndex:0,x:0,y:0,z:0}:s,f=r.subtree,l=r.level,c=l===void 0?0:l,h=t.subdivisionScheme,d=t.subtreeLevels,p=t.maximumLevel,v=t.contentUrlTemplate,g=t.subtreesUriTemplate,y=t.basePath,b={children:[],lodMetricValue:0,contentUrl:""},E=OD[h],T=o&1,S=o>>1&1,I=o>>2&1,L=(Math.pow(E,c)-1)/(E-1),B=Nn(a.mortonIndex,o),C=L+B,_=Nn(a.x,T),R=Nn(a.y,S),F=Nn(a.z,I),k=!1,c+1>d&&(k=Lp(f.childSubtreeAvailability,B)),D=Nn(u.x,_),M=Nn(u.y,R),O=Nn(u.z,F),P=c+u.level,!k){At.next=38;break}return U="".concat(y,"/").concat(g),G=Pu(U,P,D,M,O),At.next=25,(0,mC.load)(G,Iu);case 25:j=At.sent,f=j,u.mortonIndex=B,u.x=_,u.y=R,u.z=F,u.level=c,B=0,C=0,_=0,R=0,F=0,c=0;case 38:if(q=Lp(f.tileAvailability,C),!(!q||c>p)){At.next=41;break}return At.abrupt("return",b);case 41:ne=Lp(f.contentAvailability,C),ne&&(b.contentUrl=Pu(v,P,D,M,O)),Re=c+1,we={mortonIndex:B,x:_,y:R,z:F},nt=0;case 46:if(!(nt<E)){At.next=54;break}return At.next=49,Gp({subtree:f,options:t,parentData:we,childIndex:nt,level:Re,globalData:u});case 49:je=At.sent,(je.contentUrl||je.children.length)&&(br=P+1,Et={childTileX:_,childTileY:R,childTileZ:F},Jn=ID(je,br,Et,t),b.children.push(Jn));case 51:nt++,At.next=46;break;case 54:return At.abrupt("return",b);case 55:case"end":return At.stop()}},e)})),Dp.apply(this,arguments)}function Lp(e,r){return"constant"in e?Boolean(e.constant):e.explicitBitstream?FD(r,e.explicitBitstream):!1}function ID(e,r,t,n){var a=n.basePath,i=n.refine,o=n.getRefine,s=n.lodMetricType,u=n.getTileType,f=n.rootLodMetricValue,l=n.rootBoundingVolume,c=e.contentUrl&&e.contentUrl.replace("".concat(a,"/"),""),h=f/Math.pow(2,r),d=PD(r,l,t);return{children:e.children,contentUrl:e.contentUrl,content:{uri:c},id:e.contentUrl,refine:o(i),type:u(e),lodMetricType:s,lodMetricValue:h,geometricError:h,transform:e.transform,boundingVolume:d}}function PD(e,r,t){if(r.region){var n=t.childTileX,a=t.childTileY,i=t.childTileZ,o=(0,dC.default)(r.region,6),s=o[0],u=o[1],f=o[2],l=o[3],c=o[4],h=o[5],d=Math.pow(2,e),p=(f-s)/d,v=(l-u)/d,g=(h-c)/d,y=s+p*n,b=s+p*(n+1),E=u+v*a,T=u+v*(a+1),S=c+g*i,I=c+g*(i+1);return{region:[y,E,b,T,S,I]}}return console.warn("Unsupported bounding volume type: ",r),null}function Nn(e,r){return parseInt(e.toString(2)+r.toString(2),2)}function Pu(e,r,t,n,a){var i=RD({level:r,x:t,y:n,z:a});return e.replace(/{level}|{x}|{y}|{z}/gi,function(o){return i[o]})}function RD(e){var r={};for(var t in e)r["{".concat(t,"}")]=e[t];return r}function FD(e,r){var t=Math.floor(e/8),n=e%8,a=r[t]>>n&1;return a===1}function LD(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=kD(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function kD(e,r){if(e){if(typeof e=="string")return vC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return vC(e,r)}}function vC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Vp(e){if(!e.contentUrl)return dr.EMPTY;var r=e.contentUrl,t=r.split(".").pop();switch(t){case"pnts":return dr.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return dr.SCENEGRAPH;default:return t}}function zp(e){switch(e){case"REPLACE":case"replace":return mt.REPLACE;case"ADD":case"add":return mt.ADD;default:return e}}function Np(e,r){var t=/^[a-z][0-9a-z+.-]*:/i;if(t.test(r)){var n=new URL(e,"".concat(r,"/"));return decodeURI(n.toString())}else if(e.startsWith("/"))return e;return"".concat(r,"/").concat(e)}function gC(e,r){if(!e)return null;if(e.content){var t=e.content.uri||e.content.url;e.contentUrl=Np(t,r.basePath)}return e.id=e.contentUrl,e.lodMetricType=Cn.GEOMETRIC_ERROR,e.lodMetricValue=e.geometricError,e.transformMatrix=e.transform,e.type=Vp(e),e.refine=zp(e.refine),e}function bC(e,r){return Up.apply(this,arguments)}function Up(){return Up=(0,Ru.default)(Un.default.mark(function e(r,t){var n,a,i,o,s,u,f,l,c,h;return Un.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(n=r.basePath,i=AC(r?.root),!(i&&r.root)){p.next=8;break}return p.next=5,yC(r.root,r,i,t);case 5:a=p.sent,p.next=9;break;case 8:a=gC(r.root,r);case 9:o=[],o.push(a);case 11:if(!(o.length>0)){p.next=40;break}s=o.pop()||{},u=s.children||[],f=LD(u),p.prev=15,f.s();case 17:if((l=f.n()).done){p.next=30;break}if(c=l.value,h=AC(c),!h){p.next=26;break}return p.next=23,yC(c,r,h,t);case 23:c=p.sent,p.next=27;break;case 26:gC(c,{basePath:n});case 27:o.push(c);case 28:p.next=17;break;case 30:p.next=35;break;case 32:p.prev=32,p.t0=p.catch(15),f.e(p.t0);case 35:return p.prev=35,f.f(),p.finish(35);case 38:p.next=11;break;case 40:return p.abrupt("return",a);case 41:case"end":return p.stop()}},e,null,[[15,32,35,38]])})),Up.apply(this,arguments)}function yC(e,r,t,n){return jp.apply(this,arguments)}function jp(){return jp=(0,Ru.default)(Un.default.mark(function e(r,t,n,a){var i,o,s,u,f,l,c,h,d,p,v,g,y,b;return Un.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return o=t.basePath,s=n.subdivisionScheme,u=n.maximumLevel,f=n.subtreeLevels,l=n.subtrees.uri,c=Pu(l,0,0,0,0),h=Np(c,o),T.next=6,(0,_C.load)(h,Iu,a);case 6:return d=T.sent,p=Np(r.content.uri,o),v=t==null||(i=t.root)===null||i===void 0?void 0:i.refine,g=r.geometricError,y=r.boundingVolume,b={contentUrlTemplate:p,subtreesUriTemplate:l,subdivisionScheme:s,subtreeLevels:f,maximumLevel:u,refine:v,basePath:o,lodMetricType:Cn.GEOMETRIC_ERROR,rootLodMetricValue:g,rootBoundingVolume:y,getTileType:Vp,getRefine:zp},T.next=14,DD(r,d,b);case 14:return T.abrupt("return",T.sent);case 15:case"end":return T.stop()}},e)})),jp.apply(this,arguments)}function DD(e,r,t){return Hp.apply(this,arguments)}function Hp(){return Hp=(0,Ru.default)(Un.default.mark(function e(r,t,n){var a,i,o;return Un.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(r){u.next=2;break}return u.abrupt("return",null);case 2:return r.lodMetricType=Cn.GEOMETRIC_ERROR,r.lodMetricValue=r.geometricError,r.transformMatrix=r.transform,u.next=7,Gp({subtree:t,options:n});case 7:return a=u.sent,i=a.children,o=a.contentUrl,o&&(r.contentUrl=o,r.content={uri:o.replace("".concat(n.basePath,"/"),"")}),r.refine=zp(r.refine),r.type=Vp(r),r.children=i,r.id=r.contentUrl,u.abrupt("return",r);case 16:case"end":return u.stop()}},e)})),Hp.apply(this,arguments)}function AC(e){var r;return(e==null||(r=e.extensions)===null||r===void 0?void 0:r["3DTILES_implicit_tiling"])||e?.implicitTiling}var Lu={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:ru,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:jD,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function GD(e){return Xn.dirname(e.url)}function ND(e,r,t){return Wp.apply(this,arguments)}function Wp(){return Wp=(0,Fu.default)(jn.default.mark(function e(r,t,n){var a,i;return jn.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a={content:{featureIds:null}},i=0,s.next=4,Mp(r,i,t,n,a.content);case 4:return s.abrupt("return",a.content);case 5:case"end":return s.stop()}},e)})),Wp.apply(this,arguments)}function UD(e,r,t){return Jp.apply(this,arguments)}function Jp(){return Jp=(0,Fu.default)(jn.default.mark(function e(r,t,n){var a,i;return jn.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=JSON.parse(new TextDecoder().decode(r)),i.loader=t.loader||Lu,i.url=n.url,i.basePath=GD(i),s.next=6,bC(i,t);case 6:return i.root=s.sent,i.type=tt.TILES3D,i.lodMetricType=Cn.GEOMETRIC_ERROR,i.lodMetricValue=((a=i.root)===null||a===void 0?void 0:a.lodMetricValue)||0,s.abrupt("return",i);case 11:case"end":return s.stop()}},e)})),Jp.apply(this,arguments)}function jD(e,r,t){return qp.apply(this,arguments)}function qp(){return qp=(0,Fu.default)(jn.default.mark(function e(r,t,n){var a,i;return jn.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(a=t["3d-tiles"]||{},a.isTileset==="auto"?i=n.url&&n.url.indexOf(".json")!==-1:i=a.isTileset,!i){s.next=8;break}return s.next=5,UD(r,t,n);case 5:r=s.sent,s.next=11;break;case 8:return s.next=10,ND(r,t,n);case 10:r=s.sent;case 11:return s.abrupt("return",r);case 12:case"end":return s.stop()}},e)})),qp.apply(this,arguments)}function TC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ka(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?TC(Object(t),!0).forEach(function(n){(0,Ki.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):TC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function HD(e){var r=VD();return function(){var n=(0,Xp.default)(e),a;if(r){var i=(0,Xp.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,MC.default)(this,a)}}function VD(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var xC=[0],zD={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:Lu,onTilesetLoad:{type:"function",value:function(r){}},onTileLoad:{type:"function",value:function(r){}},onTileUnload:{type:"function",value:function(r){}},onTileError:{type:"function",value:function(r,t,n){}},_getMeshColor:{type:"function",value:function(r){return[255,255,255]}}},ku=function(e){(0,BC.default)(t,e);var r=HD(t);function t(){var n;(0,SC.default)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=r.call.apply(r,[this].concat(i)),(0,Ki.default)((0,wC.default)(n),"state",void 0),n}return(0,CC.default)(t,[{key:"initializeState",value:function(){"onTileLoadFail"in this.props&&qr.log.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}},{key:"isLoaded",get:function(){var a=this.state.tileset3d;return a!==null&&a.isLoaded()}},{key:"shouldUpdateState",value:function(a){var i=a.changeFlags;return i.somethingChanged}},{key:"updateState",value:function(a){var i=a.props,o=a.oldProps,s=a.changeFlags;if(i.data&&i.data!==o.data&&this._loadTileset(i.data),s.viewportChanged){var u=this.state.activeViewports,f=Object.keys(u).length;f&&(this._updateTileset(u),this.state.lastUpdatedViewports=u,this.state.activeViewports={})}if(s.propsChanged){var l=this.state.layerMap;for(var c in l)l[c].needsUpdate=!0}}},{key:"activateViewport",value:function(a){var i=this.state,o=i.activeViewports,s=i.lastUpdatedViewports;this.internalState.viewport=a,o[a.id]=a;var u=s?.[a.id];(!u||!a.equals(u))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}},{key:"getPickingInfo",value:function(a){var i=a.info,o=a.sourceLayer,s=o&&o.props.tile;return i.picked&&(i.object=s),i.sourceTile=s,i}},{key:"filterSubLayer",value:function(a){var i=a.layer,o=a.viewport,s=i.props,u=s.tile,f=o.id;return u.selected&&u.viewportIds.includes(f)}},{key:"_updateAutoHighlight",value:function(a){var i=a.sourceTile,o=this.state.layerMap[i?.id];o&&o.layer&&o.layer.updateAutoHighlight(a)}},{key:"_loadTileset",value:function(){var n=(0,EC.default)(Yp.default.mark(function i(o){var s,u,f,l,c,h,d;return Yp.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(s=this.props.loadOptions,u=s===void 0?{}:s,f=this.props.loader||this.props.loaders,Array.isArray(f)&&(f=f[0]),l={loadOptions:ka({},u)},!f.preload){v.next=10;break}return v.next=7,f.preload(o,u);case 7:c=v.sent,c.headers&&(l.loadOptions.fetch=ka(ka({},l.loadOptions.fetch),{},{headers:c.headers})),Object.assign(l,c);case 10:return v.next=12,(0,RC.load)(o,f,l.loadOptions);case 12:h=v.sent,d=new kh(h,ka({onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError},l)),this.setState({tileset3d:d,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(d);case 17:case"end":return v.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_onTileLoad",value:function(a){var i=this.state.lastUpdatedViewports;this.props.onTileLoad(a),this._updateTileset(i),this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(a){delete this.state.layerMap[a.id],this.props.onTileUnload(a)}},{key:"_updateTileset",value:function(a){var i=this;if(a){var o=this.state.tileset3d,s=this.context.timeline,u=Object.keys(a).length;!s||!u||!o||o.selectTiles(Object.values(a)).then(function(f){var l=i.state.frameNumber!==f;l&&i.setState({frameNumber:f})})}}},{key:"_getSubLayer",value:function(a,i){if(!a.content)return null;switch(a.type){case dr.POINTCLOUD:return this._makePointCloudLayer(a,i);case dr.SCENEGRAPH:return this._make3DModelLayer(a);case dr.MESH:return this._makeSimpleMeshLayer(a,i);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(a.content.type))}}},{key:"_makePointCloudLayer",value:function(a,i){var o=a.content,s=o.attributes,u=o.pointCount,f=o.constantRGBA,l=o.cartographicOrigin,c=o.modelMatrix,h=s.positions,d=s.normals,p=s.colors;if(!h)return null;var v=i&&i.props.data||{header:{vertexCount:u},attributes:{POSITION:h,NORMAL:d,COLOR_0:p}},g=this.props,y=g.pointSize,b=g.getPointColor,E=this.getSubLayerClass("pointcloud",IC.PointCloudLayer);return new E({pointSize:y},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(a.id),tile:a,data:v,coordinateSystem:qr.COORDINATE_SYSTEM.METER_OFFSETS,coordinateOrigin:l,modelMatrix:c,getColor:f||b,_offset:0})}},{key:"_make3DModelLayer",value:function(a){var i=a.content,o=i.gltf,s=i.instances,u=i.cartographicOrigin,f=i.modelMatrix,l=this.getSubLayerClass("scenegraph",PC.ScenegraphLayer);return new l({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(a.id),tile:a,data:s||xC,scenegraph:o,coordinateSystem:qr.COORDINATE_SYSTEM.METER_OFFSETS,coordinateOrigin:u,modelMatrix:f,getTransformMatrix:function(h){return h.modelMatrix},getPosition:[0,0,0],_offset:0})}},{key:"_makeSimpleMeshLayer",value:function(a,i){var o=a.content,s=o.attributes,u=o.indices,f=o.modelMatrix,l=o.cartographicOrigin,c=o.coordinateSystem,h=c===void 0?qr.COORDINATE_SYSTEM.METER_OFFSETS:c,d=o.material,p=o.featureIds,v=this.props._getMeshColor,g=i&&i.props.mesh||new OC.Geometry({drawMode:4,attributes:WD(s),indices:u}),y=this.getSubLayerClass("mesh",js);return new y(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(a.id),tile:a,mesh:g,data:xC,getColor:v(a),pbrMaterial:d,modelMatrix:f,coordinateOrigin:l,coordinateSystem:h,featureIds:p,_offset:0})}},{key:"renderLayers",value:function(){var a=this,i=this.state,o=i.tileset3d,s=i.layerMap;return o?o.tiles.map(function(u){var f=s[u.id]=s[u.id]||{tile:u},l=f.layer;return u.selected&&(l?f.needsUpdate&&(l=a._getSubLayer(u,l),f.needsUpdate=!1):l=a._getSubLayer(u)),f.layer=l,l}).filter(Boolean):null}}]),t}(qr.CompositeLayer);(0,Ki.default)(ku,"defaultProps",zD);(0,Ki.default)(ku,"layerName","Tile3DLayer");function WD(e){var r={};return r.positions=ka(ka({},e.positions),{},{value:new Float32Array(e.positions.value)}),e.normals&&(r.normals=e.normals),e.texCoords&&(r.texCoords=e.texCoords),e.colors&&(r.colors=e.colors),e.uvRegions&&(r.uvRegions=e.uvRegions),r}var nm=m(St()),$C=m(ce()),ew=m(H()),tw=m(z()),rw=m(at()),nw=m(Te()),aw=m(xe()),am=m(Ae()),eo=m(W()),zu=m(Rt()),im=m(ys()),iw=m(Rt());var XC=m(X()),YC=m(W()),rm=m(Y());var kC=m(ce());var LC=m(ce());function JD(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=qD(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function qD(e,r){if(e){if(typeof e=="string")return FC(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return FC(e,r)}}function FC(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var XD=new Map([["centerX",Float64Array.BYTES_PER_ELEMENT],["centerY",Float64Array.BYTES_PER_ELEMENT],["centerZ",Float64Array.BYTES_PER_ELEMENT],["minHeight",Float32Array.BYTES_PER_ELEMENT],["maxHeight",Float32Array.BYTES_PER_ELEMENT],["boundingSphereCenterX",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterY",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterZ",Float64Array.BYTES_PER_ELEMENT],["boundingSphereRadius",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointX",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointY",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointZ",Float64Array.BYTES_PER_ELEMENT]]);function Kp(e){return e>>1^-(e&1)}function YD(e){var r=0,t={},n=JD(XD),a;try{for(n.s();!(a=n.n()).done;){var i=(0,LC.default)(a.value,2),o=i[0],s=i[1],u=s===8?e.getFloat64:e.getFloat32;t[o]=u.call(e,r,!0),r+=s}}catch(f){n.e(f)}finally{n.f()}return{header:t,headerEndPosition:r}}function KD(e,r){var t=r,n=3,a=e.getUint32(t,!0),i=new Uint16Array(a*n);t+=Uint32Array.BYTES_PER_ELEMENT;for(var o=Uint16Array.BYTES_PER_ELEMENT,s=a*o,u=t,f=u+s,l=f+s,c=0,h=0,d=0,p=0;p<a;p++)c+=Kp(e.getUint16(u+o*p,!0)),h+=Kp(e.getUint16(f+o*p,!0)),d+=Kp(e.getUint16(l+o*p,!0)),i[p]=c,i[p+a]=h,i[p+a*2]=d;return t+=s*3,{vertexData:i,vertexDataEndPosition:t}}function Qi(e,r,t,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i;if(n===2?i=new Uint16Array(e,r,t):i=new Uint32Array(e,r,t),!a)return i;for(var o=0,s=0;s<i.length;++s){var u=i[s];i[s]=o-u,u===0&&++o}return i}function QD(e,r,t){var n=t,a=3,i=r.length/a,o=i>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT;n%o!==0&&(n+=o-n%o);var s=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var u=s*3,f=Qi(e.buffer,n,u,o);return n+=u*o,{triangleIndicesEndPosition:n,triangleIndices:f}}function ZD(e,r,t){var n=t,a=3,i=r.length/a,o=i>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT,s=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var u=Qi(e.buffer,n,s,o,!1);n+=s*o;var f=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var l=Qi(e.buffer,n,f,o,!1);n+=f*o;var c=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var h=Qi(e.buffer,n,c,o,!1);n+=c*o;var d=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var p=Qi(e.buffer,n,d,o,!1);return n+=d*o,{edgeIndicesEndPosition:n,westIndices:u,southIndices:l,eastIndices:h,northIndices:p}}function $D(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function eG(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function tG(e,r){var t={};if(e.byteLength<=r)return{extensions:t,extensionsEndPosition:r};for(var n=r;n<e.byteLength;){var a=e.getUint8(n,!0);n+=Uint8Array.BYTES_PER_ELEMENT;var i=e.getUint32(n,!0);n+=Uint32Array.BYTES_PER_ELEMENT;var o=new DataView(e.buffer,n,i);switch(a){case 1:{t.vertexNormals=$D(o);break}case 2:{t.waterMask=eG(o);break}default:}n+=i}return{extensions:t,extensionsEndPosition:n}}var Hn={header:0,vertices:1,triangleIndices:2,edgeIndices:3,extensions:4},rG={maxDecodingStep:Hn.extensions};function Qp(e,r){var t=Object.assign({},rG,r),n=new DataView(e),a=YD(n),i=a.header,o=a.headerEndPosition;if(t.maxDecodingStep<Hn.vertices)return{header:i};var s=KD(n,o),u=s.vertexData,f=s.vertexDataEndPosition;if(t.maxDecodingStep<Hn.triangleIndices)return{header:i,vertexData:u};var l=QD(n,u,f),c=l.triangleIndices,h=l.triangleIndicesEndPosition;if(t.maxDecodingStep<Hn.edgeIndices)return{header:i,vertexData:u,triangleIndices:c};var d=ZD(n,u,h),p=d.westIndices,v=d.southIndices,g=d.eastIndices,y=d.northIndices,b=d.edgeIndicesEndPosition;if(t.maxDecodingStep<Hn.extensions)return{header:i,vertexData:u,triangleIndices:c,westIndices:p,northIndices:y,eastIndices:g,southIndices:v};var E=tG(n,b),T=E.extensions;return{header:i,vertexData:u,triangleIndices:c,westIndices:p,northIndices:y,eastIndices:g,southIndices:v,extensions:T}}var Zi=m(St());function Du(e,r,t,n){for(var a=n?aG(n,e.POSITION.value):nG(r),i=new e.POSITION.value.constructor(a.length*6),o=new e.TEXCOORD_0.value.constructor(a.length*4),s=new r.constructor(a.length*6),u=0;u<a.length;u++){var f=a[u];iG({edge:f,edgeIndex:u,attributes:e,skirtHeight:t,newPosition:i,newTexcoord0:o,newTriangles:s})}e.POSITION.value=Ja(e.POSITION.value,i),e.TEXCOORD_0.value=Ja(e.TEXCOORD_0.value,o);var l=r instanceof Array?r.concat(s):Ja(r,s);return{attributes:e,triangles:l}}function nG(e){for(var r=[],t=0;t<e.length;t+=3)r.push([e[t],e[t+1]]),r.push([e[t+1],e[t+2]]),r.push([e[t+2],e[t]]);r.sort(function(s,u){return Math.min.apply(Math,(0,Zi.default)(s))-Math.min.apply(Math,(0,Zi.default)(u))||Math.max.apply(Math,(0,Zi.default)(s))-Math.max.apply(Math,(0,Zi.default)(u))});for(var n=[],a=0;a<r.length;){var i,o;r[a][0]===((i=r[a+1])===null||i===void 0?void 0:i[1])&&r[a][1]===((o=r[a+1])===null||o===void 0?void 0:o[0])?a+=2:(n.push(r[a]),a++)}return n}function aG(e,r){e.westIndices.sort(function(o,s){return r[3*o+1]-r[3*s+1]}),e.eastIndices.sort(function(o,s){return r[3*s+1]-r[3*o+1]}),e.southIndices.sort(function(o,s){return r[3*s]-r[3*o]}),e.northIndices.sort(function(o,s){return r[3*o]-r[3*s]});var t=[];for(var n in e)for(var a=e[n],i=0;i<a.length-1;i++)t.push([a[i],a[i+1]]);return t}function iG(e){var r=e.edge,t=e.edgeIndex,n=e.attributes,a=e.skirtHeight,i=e.newPosition,o=e.newTexcoord0,s=e.newTriangles,u=n.POSITION.value.length,f=t*2,l=t*2+1;i.set(n.POSITION.value.subarray(r[0]*3,r[0]*3+3),f*3),i[f*3+2]=i[f*3+2]-a,i.set(n.POSITION.value.subarray(r[1]*3,r[1]*3+3),l*3),i[l*3+2]=i[l*3+2]-a,o.set(n.TEXCOORD_0.value.subarray(r[0]*2,r[0]*2+2),f*2),o.set(n.TEXCOORD_0.value.subarray(r[1]*2,r[1]*2+2),l*2);var c=t*2*3;s[c]=r[0],s[c+1]=u/3+l,s[c+2]=r[1],s[c+3]=u/3+l,s[c+4]=r[0],s[c+5]=u/3+f}function oG(e,r,t){for(var n=r.minHeight,a=r.maxHeight,i=t||[0,0,1,1],o=(0,kC.default)(i,4),s=o[0],u=o[1],f=o[2],l=o[3],c=f-s,h=l-u,d=a-n,p=e.length/3,v=new Float32Array(p*3),g=new Float32Array(p*2),y=0;y<p;y++){var b=e[y]/32767,E=e[y+p]/32767,T=e[y+p*2]/32767;v[3*y+0]=b*c+s,v[3*y+1]=E*h+u,v[3*y+2]=T*d+n,g[2*y+0]=b,g[2*y+1]=E}return{POSITION:{value:v,size:3},TEXCOORD_0:{value:g,size:2}}}function sG(e,r){if(!e)return null;var t=r.bounds,n=Qp(e,Hn.triangleIndices),a=n.header,i=n.vertexData,o=n.triangleIndices,s=n.westIndices,u=n.northIndices,f=n.eastIndices,l=n.southIndices,c=o,h=oG(i,a,t),d=On(h);if(r.skirtHeight){var p=Du(h,c,r.skirtHeight,{westIndices:s,northIndices:u,eastIndices:f,southIndices:l}),v=p.attributes,g=p.triangles;h=v,c=g}return{loaderData:{header:{}},header:{vertexCount:c.length,boundingBox:d},mode:4,indices:{value:c,size:1},attributes:h}}function Gu(e,r){return sG(e,r["quantized-mesh"])}var VC=m(W()),zC=m(X()),WC=m(ce()),$p=m(Y());var $i=class{constructor(r=257){this.gridSize=r;let t=r-1;if(t&t-1)throw new Error(`Expected grid size to be 2^n+1, got ${r}.`);this.numTriangles=t*t*2-2,this.numParentTriangles=this.numTriangles-t*t,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(this.numTriangles*4);for(let n=0;n<this.numTriangles;n++){let a=n+2,i=0,o=0,s=0,u=0,f=0,l=0;for(a&1?s=u=f=t:i=o=l=t;(a>>=1)>1;){let h=i+s>>1,d=o+u>>1;a&1?(s=i,u=o,i=f,o=l):(i=s,o=u,s=f,u=l),f=h,l=d}let c=n*4;this.coords[c+0]=i,this.coords[c+1]=o,this.coords[c+2]=s,this.coords[c+3]=u}}createTile(r){return new Zp(r,this)}},Zp=class{constructor(r,t){let n=t.gridSize;if(r.length!==n*n)throw new Error(`Expected terrain data of length ${n*n} (${n} x ${n}), got ${r.length}.`);this.terrain=r,this.martini=t,this.errors=new Float32Array(r.length),this.update()}update(){let{numTriangles:r,numParentTriangles:t,coords:n,gridSize:a}=this.martini,{terrain:i,errors:o}=this;for(let s=r-1;s>=0;s--){let u=s*4,f=n[u+0],l=n[u+1],c=n[u+2],h=n[u+3],d=f+c>>1,p=l+h>>1,v=d+p-l,g=p+f-d,y=(i[l*a+f]+i[h*a+c])/2,b=p*a+d,E=Math.abs(y-i[b]);if(o[b]=Math.max(o[b],E),s<t){let T=(l+g>>1)*a+(f+v>>1),S=(h+g>>1)*a+(c+v>>1);o[b]=Math.max(o[b],o[T],o[S])}}}getMesh(r=0){let{gridSize:t,indices:n}=this.martini,{errors:a}=this,i=0,o=0,s=t-1;n.fill(0);function u(d,p,v,g,y,b){let E=d+v>>1,T=p+g>>1;Math.abs(d-y)+Math.abs(p-b)>1&&a[T*t+E]>r?(u(y,b,d,p,E,T),u(v,g,y,b,E,T)):(n[p*t+d]=n[p*t+d]||++i,n[g*t+v]=n[g*t+v]||++i,n[b*t+y]=n[b*t+y]||++i,o++)}u(0,0,s,s,s,0),u(s,s,0,0,0,s);let f=new Uint16Array(i*2),l=new Uint32Array(o*3),c=0;function h(d,p,v,g,y,b){let E=d+v>>1,T=p+g>>1;if(Math.abs(d-y)+Math.abs(p-b)>1&&a[T*t+E]>r)h(y,b,d,p,E,T),h(v,g,y,b,E,T);else{let S=n[p*t+d]-1,I=n[g*t+v]-1,L=n[b*t+y]-1;f[2*S]=d,f[2*S+1]=p,f[2*I]=v,f[2*I+1]=g,f[2*L]=y,f[2*L+1]=b,l[c++]=S,l[c++]=I,l[c++]=L}}return h(0,0,s,s,s,0),h(s,s,0,0,0,s),{vertices:f,triangles:l}}};var DC=m(H()),GC=m(z()),NC=function(){function e(r,t){(0,DC.default)(this,e);var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;this.data=r,this.width=t,this.height=n,this.coords=[],this.triangles=[],this._halfedges=[],this._candidates=[],this._queueIndices=[],this._queue=[],this._errors=[],this._rms=[],this._pending=[],this._pendingLen=0,this._rmsSum=0;var a=t-1,i=n-1,o=this._addPoint(0,0),s=this._addPoint(a,0),u=this._addPoint(0,i),f=this._addPoint(a,i),l=this._addTriangle(f,o,u,-1,-1,-1);this._addTriangle(o,f,s,l,-1,-1),this._flush()}return(0,GC.default)(e,[{key:"run",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this.getMaxError()>t;)this.refine()}},{key:"refine",value:function(){this._step(),this._flush()}},{key:"getMaxError",value:function(){return this._errors[0]}},{key:"getRMSD",value:function(){return this._rmsSum>0?Math.sqrt(this._rmsSum/(this.width*this.height)):0}},{key:"heightAt",value:function(t,n){return this.data[this.width*n+t]}},{key:"_flush",value:function(){for(var t=this.coords,n=0;n<this._pendingLen;n++){var a=this._pending[n],i=2*this.triangles[a*3+0],o=2*this.triangles[a*3+1],s=2*this.triangles[a*3+2];this._findCandidate(t[i],t[i+1],t[o],t[o+1],t[s],t[s+1],a)}this._pendingLen=0}},{key:"_findCandidate",value:function(t,n,a,i,o,s,u){for(var f=Math.min(t,a,o),l=Math.min(n,i,s),c=Math.max(t,a,o),h=Math.max(n,i,s),d=Vn(a,i,o,s,f,l),p=Vn(o,s,t,n,f,l),v=Vn(t,n,a,i,f,l),g=i-n,y=t-a,b=s-i,E=a-o,T=n-s,S=o-t,I=Vn(t,n,a,i,o,s),L=this.heightAt(t,n)/I,B=this.heightAt(a,i)/I,C=this.heightAt(o,s)/I,_=0,R=0,F=0,k=0,D=l;D<=h;D++){var M=0;d<0&&b!==0&&(M=Math.max(M,Math.floor(-d/b))),p<0&&T!==0&&(M=Math.max(M,Math.floor(-p/T))),v<0&&g!==0&&(M=Math.max(M,Math.floor(-v/g)));for(var O=d+b*M,P=p+T*M,U=v+g*M,G=!1,j=f+M;j<=c;j++){if(O>=0&&P>=0&&U>=0){G=!0;var q=L*O+B*P+C*U,ne=Math.abs(q-this.heightAt(j,D));k+=ne*ne,ne>_&&(_=ne,R=j,F=D)}else if(G)break;O+=b,P+=T,U+=g}d+=E,p+=S,v+=y}(R===t&&F===n||R===a&&F===i||R===o&&F===s)&&(_=0),this._candidates[2*u]=R,this._candidates[2*u+1]=F,this._rms[u]=k,this._queuePush(u,_,k)}},{key:"_step",value:function(){var t=this._queuePop(),n=t*3+0,a=t*3+1,i=t*3+2,o=this.triangles[n],s=this.triangles[a],u=this.triangles[i],f=this.coords[2*o],l=this.coords[2*o+1],c=this.coords[2*s],h=this.coords[2*s+1],d=this.coords[2*u],p=this.coords[2*u+1],v=this._candidates[2*t],g=this._candidates[2*t+1],y=this._addPoint(v,g);if(Vn(f,l,c,h,v,g)===0)this._handleCollinear(y,n);else if(Vn(c,h,d,p,v,g)===0)this._handleCollinear(y,a);else if(Vn(d,p,f,l,v,g)===0)this._handleCollinear(y,i);else{var b=this._halfedges[n],E=this._halfedges[a],T=this._halfedges[i],S=this._addTriangle(o,s,y,b,-1,-1,n),I=this._addTriangle(s,u,y,E,-1,S+1),L=this._addTriangle(u,o,y,T,S+2,I+1);this._legalize(S),this._legalize(I),this._legalize(L)}}},{key:"_addPoint",value:function(t,n){var a=this.coords.length>>1;return this.coords.push(t,n),a}},{key:"_addTriangle",value:function(t,n,a,i,o,s){var u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:this.triangles.length,f=u/3;return this.triangles[u+0]=t,this.triangles[u+1]=n,this.triangles[u+2]=a,this._halfedges[u+0]=i,this._halfedges[u+1]=o,this._halfedges[u+2]=s,i>=0&&(this._halfedges[i]=u+0),o>=0&&(this._halfedges[o]=u+1),s>=0&&(this._halfedges[s]=u+2),this._candidates[2*f+0]=0,this._candidates[2*f+1]=0,this._queueIndices[f]=-1,this._rms[f]=0,this._pending[this._pendingLen++]=f,u}},{key:"_legalize",value:function(t){var n=this._halfedges[t];if(!(n<0)){var a=t-t%3,i=n-n%3,o=a+(t+1)%3,s=a+(t+2)%3,u=i+(n+2)%3,f=i+(n+1)%3,l=this.triangles[s],c=this.triangles[t],h=this.triangles[o],d=this.triangles[u],p=this.coords;if(uG(p[2*l],p[2*l+1],p[2*c],p[2*c+1],p[2*h],p[2*h+1],p[2*d],p[2*d+1])){var v=this._halfedges[o],g=this._halfedges[s],y=this._halfedges[u],b=this._halfedges[f];this._queueRemove(a/3),this._queueRemove(i/3);var E=this._addTriangle(l,d,h,-1,y,v,a),T=this._addTriangle(d,l,c,E,g,b,i);this._legalize(E+1),this._legalize(T+2)}}}},{key:"_handleCollinear",value:function(t,n){var a=n-n%3,i=a+(n+1)%3,o=a+(n+2)%3,s=this.triangles[o],u=this.triangles[n],f=this.triangles[i],l=this._halfedges[i],c=this._halfedges[o],h=this._halfedges[n];if(h<0){var d=this._addTriangle(t,s,u,-1,c,-1,a),p=this._addTriangle(s,t,f,d,-1,l);this._legalize(d+1),this._legalize(p+2);return}var v=h-h%3,g=v+(h+2)%3,y=v+(h+1)%3,b=this.triangles[g],E=this._halfedges[g],T=this._halfedges[y];this._queueRemove(v/3);var S=this._addTriangle(s,u,t,c,-1,-1,a),I=this._addTriangle(u,b,t,T,-1,S+1,v),L=this._addTriangle(b,f,t,E,-1,I+1),B=this._addTriangle(f,s,t,l,S+2,L+1);this._legalize(S),this._legalize(I),this._legalize(L),this._legalize(B)}},{key:"_queuePush",value:function(t,n,a){var i=this._queue.length;this._queueIndices[t]=i,this._queue.push(t),this._errors.push(n),this._rmsSum+=a,this._queueUp(i)}},{key:"_queuePop",value:function(){var t=this._queue.length-1;return this._queueSwap(0,t),this._queueDown(0,t),this._queuePopBack()}},{key:"_queuePopBack",value:function(){var t=this._queue.pop();return this._errors.pop(),this._rmsSum-=this._rms[t],this._queueIndices[t]=-1,t}},{key:"_queueRemove",value:function(t){var n=this._queueIndices[t];if(n<0){var a=this._pending.indexOf(t);if(a!==-1)this._pending[a]=this._pending[--this._pendingLen];else throw new Error("Broken triangulation (something went wrong).");return}var i=this._queue.length-1;i!==n&&(this._queueSwap(n,i),this._queueDown(n,i)||this._queueUp(n)),this._queuePopBack()}},{key:"_queueLess",value:function(t,n){return this._errors[t]>this._errors[n]}},{key:"_queueSwap",value:function(t,n){var a=this._queue[t],i=this._queue[n];this._queue[t]=i,this._queue[n]=a,this._queueIndices[a]=n,this._queueIndices[i]=t;var o=this._errors[t];this._errors[t]=this._errors[n],this._errors[n]=o}},{key:"_queueUp",value:function(t){for(var n=t;;){var a=n-1>>1;if(a===n||!this._queueLess(n,a))break;this._queueSwap(a,n),n=a}}},{key:"_queueDown",value:function(t,n){for(var a=t;;){var i=2*a+1;if(i>=n||i<0)break;var o=i+1,s=i;if(o<n&&this._queueLess(o,i)&&(s=o),!this._queueLess(s,a))break;this._queueSwap(a,s),a=s}return a>t}}]),e}();function Vn(e,r,t,n,a,i){return(t-a)*(r-i)-(n-i)*(e-a)}function uG(e,r,t,n,a,i,o,s){var u=e-o,f=r-s,l=t-o,c=n-s,h=a-o,d=i-s,p=u*u+f*f,v=l*l+c*c,g=h*h+d*d;return u*(c*g-v*d)-f*(l*g-v*h)+p*(l*d-c*h)<0}function UC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Nu(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?UC(Object(t),!0).forEach(function(n){(0,VC.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):UC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Uu(e,r,t,n,a){for(var i=n.rScaler,o=n.bScaler,s=n.gScaler,u=n.offset,f=new Float32Array((r+1)*(t+1)),l=0,c=0;c<t;c++)for(var h=0;h<r;h++,l++){var d=l*4,p=e[d+0],v=e[d+1],g=e[d+2];f[l+c]=p*i+v*s+g*o+u}if(a==="martini"){for(var y=(r+1)*r,b=0;b<r;b++,y++)f[y]=f[y-r-1];for(var E=t,T=0;T<t+1;T++,E+=t+1)f[E]=f[E-1]}return f}function fG(e,r,t,n,a){for(var i=t+1,o=e.length/2,s=new Float32Array(o*3),u=new Float32Array(o*2),f=a||[0,0,t,n],l=(0,WC.default)(f,4),c=l[0],h=l[1],d=l[2],p=l[3],v=(d-c)/t,g=(p-h)/n,y=0;y<o;y++){var b=e[y*2],E=e[y*2+1],T=E*i+b;s[3*y+0]=b*v+c,s[3*y+1]=-E*g+p,s[3*y+2]=r[T],u[2*y+0]=b/t,u[2*y+1]=E/n}return{POSITION:{value:s,size:3},TEXCOORD_0:{value:u,size:2}}}function lG(e,r){if(e===null)return null;var t=r.meshMaxError,n=r.bounds,a=r.elevationDecoder,i=e.data,o=e.width,s=e.height,u,f;switch(r.tesselator){case"martini":u=Uu(i,o,s,a,r.tesselator),f=jC(t,o,u);break;case"delatin":u=Uu(i,o,s,a,r.tesselator),f=HC(t,o,s,u);break;default:o===s&&!(s&o-1)?(u=Uu(i,o,s,a,"martini"),f=jC(t,o,u)):(u=Uu(i,o,s,a,"delatin"),f=HC(t,o,s,u));break}var l=f,c=l.vertices,h=f,d=h.triangles,p=fG(c,u,o,s,n),v=On(p);if(r.skirtHeight){var g=Du(p,d,r.skirtHeight),y=g.attributes,b=g.triangles;p=y,d=b}return{loaderData:{header:{}},header:{vertexCount:d.length,boundingBox:v},mode:4,indices:{value:Uint32Array.from(d),size:1},attributes:p}}function jC(e,r,t){var n=r+1,a=new $i(n),i=a.createTile(t),o=i.getMesh(e),s=o.vertices,u=o.triangles;return{vertices:s,triangles:u}}function HC(e,r,t,n){var a=new NC(n,r+1,t+1);a.run(e);var i=a.coords,o=a.triangles,s=i;return{vertices:s,triangles:o}}function tm(e,r,t){return em.apply(this,arguments)}function em(){return em=(0,zC.default)($p.default.mark(function e(r,t,n){var a,i;return $p.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=Nu(Nu({},t),{},{mimeType:"application/x.image",image:Nu(Nu({},t.image),{},{type:"data"})}),s.next=3,n.parse(r,a);case 3:return i=s.sent,s.abrupt("return",lG(i,t.terrain));case 5:case"end":return s.stop()}},e)})),em.apply(this,arguments)}var ju="3.3.3";var Hu={name:"Terrain",id:"terrain",module:"terrain",version:ju,worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:null,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:null}}};var JC={name:"Quantized Mesh",id:"quantized-mesh",module:"terrain",version:ju,worker:!0,extensions:["terrain"],mimeTypes:["application/vnd.quantized-mesh"],options:{"quantized-mesh":{bounds:[0,0,1,1],skirtHeight:null}}};function qC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Vu(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?qC(Object(t),!0).forEach(function(n){(0,YC.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):qC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Bee=Vu(Vu({},Hu),{},{parse:tm});var Mee=Vu(Vu({},JC),{},{parseSync:Gu,parse:function(){var e=(0,XC.default)(rm.default.mark(function t(n,a){return rm.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Gu(n,a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}()});function cG(e){var r=hG();return function(){var n=(0,am.default)(e),a;if(r){var i=(0,am.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,aw.default)(this,a)}}function hG(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function KC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Xr(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?KC(Object(t),!0).forEach(function(n){(0,eo.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):KC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var QC=[1],dG=Xr(Xr({},sr.defaultProps),{},{elevationData:Rr,texture:Xr(Xr({},Rr),{},{optional:!0}),meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:"",wireframe:!1,material:!0,loaders:[Hu]});function ZC(e){return Array.isArray(e)?e.join(";"):e||""}var Wu=function(e){(0,nw.default)(t,e);var r=cG(t);function t(){var n;(0,ew.default)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=r.call.apply(r,[this].concat(i)),(0,eo.default)((0,rw.default)(n),"state",void 0),n}return(0,tw.default)(t,[{key:"updateState",value:function(a){var i=a.props,o=a.oldProps,s=i.elevationData!==o.elevationData;if(s){var u=i.elevationData,f=u&&(Array.isArray(u)||u.includes("{x}")&&u.includes("{y}"));this.setState({isTiled:f})}var l=s||i.meshMaxError!==o.meshMaxError||i.elevationDecoder!==o.elevationDecoder||i.bounds!==o.bounds;if(!this.state.isTiled&&l){var c=this.loadTerrain(i);this.setState({terrain:c})}i.workerUrl&&zu.log.removed("workerUrl","loadOptions.terrain.workerUrl")()}},{key:"loadTerrain",value:function(a){var i,o=a.elevationData,s=a.bounds,u=a.elevationDecoder,f=a.meshMaxError,l=a.signal;if(!o)return null;var c=this.getLoadOptions();c=Xr(Xr({},c),{},{terrain:Xr(Xr({skirtHeight:this.state.isTiled?f*2:0},(i=c)===null||i===void 0?void 0:i.terrain),{},{bounds:s,meshMaxError:f,elevationDecoder:u})});var h=this.props.fetch;return h(o,{propName:"elevationData",layer:this,loadOptions:c,signal:l})}},{key:"getTiledTerrainData",value:function(a){var i=this.props,o=i.elevationData,s=i.fetch,u=i.texture,f=i.elevationDecoder,l=i.meshMaxError,c=this.context.viewport,h=qt(o,a),d=u&&qt(u,a),p=a.signal,v=[0,0],g=[0,0];if(c.isGeospatial){var y=a.bbox;v=c.projectFlat([y.west,y.south]),g=c.projectFlat([y.east,y.north])}else{var b=a.bbox;v=[b.left,b.bottom],g=[b.right,b.top]}var E=[v[0],v[1],g[0],g[1]],T=this.loadTerrain({elevationData:h,bounds:E,elevationDecoder:f,meshMaxError:l,signal:p}),S=d?s(d,{propName:"texture",layer:this,loaders:[],signal:p}).catch(function(I){return null}):Promise.resolve(null);return Promise.all([T,S])}},{key:"renderSubLayers",value:function(a){var i=this.getSubLayerClass("mesh",im.SimpleMeshLayer),o=this.props,s=o.color,u=o.wireframe,f=o.material,l=a.data;if(!l)return null;var c=(0,$C.default)(l,2),h=c[0],d=c[1];return new i(a,{data:QC,mesh:h,texture:d,_instanced:!1,coordinateSystem:iw.COORDINATE_SYSTEM.CARTESIAN,getPosition:function(v){return[0,0,0]},getColor:s,wireframe:u,material:f})}},{key:"onViewportLoad",value:function(a){if(a){var i=this.state.zRange,o=a.map(function(f){return f.content}).filter(Boolean).map(function(f){var l=f[0].header.boundingBox;return l.map(function(c){return c[2]})});if(o.length!==0){var s=Math.min.apply(Math,(0,nm.default)(o.map(function(f){return f[0]}))),u=Math.max.apply(Math,(0,nm.default)(o.map(function(f){return f[1]})));(!i||s<i[0]||u>i[1])&&this.setState({zRange:[s,u]})}}}},{key:"renderLayers",value:function(){var a=this.props,i=a.color,o=a.material,s=a.elevationData,u=a.texture,f=a.wireframe,l=a.meshMaxError,c=a.elevationDecoder,h=a.tileSize,d=a.maxZoom,p=a.minZoom,v=a.extent,g=a.maxRequests,y=a.onTileLoad,b=a.onTileUnload,E=a.onTileError,T=a.maxCacheSize,S=a.maxCacheByteSize,I=a.refinementStrategy;if(this.state.isTiled)return new sr(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:ZC(s),texture:ZC(u),meshMaxError:l,elevationDecoder:c}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:h,maxZoom:d,minZoom:p,extent:v,maxRequests:g,onTileLoad:y,onTileUnload:b,onTileError:E,maxCacheSize:T,maxCacheByteSize:S,refinementStrategy:I});var L=this.getSubLayerClass("mesh",im.SimpleMeshLayer);return new L(this.getSubLayerProps({id:"mesh"}),{data:QC,mesh:this.state.terrain,texture:u,_instanced:!1,getPosition:function(C){return[0,0,0]},getColor:i,material:o,wireframe:f})}}]),t}(zu.CompositeLayer);(0,eo.default)(Wu,"defaultProps",dG);(0,eo.default)(Wu,"layerName","TerrainLayer");var MB=m(St()),OB=m(X()),IB=m(H()),PB=m(z()),Kr=m(Zr()),RB=m(Te()),FB=m(xe()),$t=m(Ae()),nf=m(W()),Om=m(Y()),af=m(Rt()),Im=m(Pt()),LB=m(sw());var dB=m(X()),pB=m(W()),Em=m(Y());var lB=m(ce());var Tw=m(W());var cw=m(H()),hw=m(z());function om(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=uw(e,t);return n!==r?(pG(e,t),!0):!1}function uw(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Math.sign(Ar(e,r))}function Ar(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.start,n=t===void 0?0:t,a=r.end,i=a===void 0?e.length:a,o=r.size||2,s=0,u=n,f=i-o;u<i;u+=o)s+=(e[u]-e[f])*(e[u+1]+e[f+1]),f=u;return s/2}function sm(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.start,a=n===void 0?0:n,i=t.end,o=i===void 0?e.length:i,s=t.size,u=s===void 0?2:s,f=t.isClosed,l=(o-a)/u,c=0;c<l-1;++c)r(e[a+c*u],e[a+c*u+1],e[a+(c+1)*u],e[a+(c+1)*u+1],c,c+1);var h=a+(l-1)*u,d=f||Je(e[a],e[h])&&Je(e[a+1],e[h+1]);d||r(e[h],e[h+1],e[a],e[a+1],l-1,0)}function pG(e,r){for(var t=r.start,n=t===void 0?0:t,a=r.end,i=a===void 0?e.length:a,o=r.size,s=o===void 0?2:o,u=(i-n)/s,f=Math.floor(u/2),l=0;l<f;++l)for(var c=n+l*s,h=n+(u-1-l)*s,d=0;d<s;++d){var p=e[c+d];e[c+d]=e[h+d],e[h+d]=p}}function fw(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=mG(e,t);return n!==r?(e.reverse(),!0):!1}function mG(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Math.sign(um(e,r))}function um(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.start,n=t===void 0?0:t,a=r.end,i=a===void 0?e.length:a,o=0,s=n,u=i-1;s<i;++s)o+=(e[s][0]-e[u][0])*(e[s][1]+e[u][1]),u=s;return o/2}function lw(e,r){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.start,a=n===void 0?0:n,i=t.end,o=i===void 0?e.length:i,s=t.isClosed,u=a;u<o-1;++u)r(e[u],e[u+1],u,u+1);var f=s||Je(e[o-1],e[0]);f||r(e[o-1],e[0],o-1,0)}var dw=function(){function e(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,cw.default)(this,e),A(this,"points",void 0),A(this,"isFlatArray",void 0),A(this,"options",void 0),this.points=r,this.isFlatArray=!ot(r[0]),this.options={start:t.start||0,end:t.end||r.length,size:t.size||2,isClosed:t.isClosed},Object.freeze(this)}return(0,hw.default)(e,[{key:"getSignedArea",value:function(){return this.isFlatArray?Ar(this.points,this.options):um(this.points,this.options)}},{key:"getArea",value:function(){return Math.abs(this.getSignedArea())}},{key:"getWindingDirection",value:function(){return Math.sign(this.getSignedArea())}},{key:"forEachSegment",value:function(t){this.isFlatArray?sm(this.points,function(n,a,i,o,s,u){t([n,a],[i,o],s,u)},this.options):lw(this.points,t,this.options)}},{key:"modifyWindingDirection",value:function(t){return this.isFlatArray?om(this.points,t,this.options):fw(this.points,t,this.options)}}]),e}();function cm(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:2,n=arguments.length>3?arguments[3]:void 0,a=r&&r.length,i=a?r[0]*t:e.length,o=mw(e,0,i,t,!0,n&&n[0]),s=[];if(!o||o.next===o.prev)return s;var u,f,l,c,h,d,p;if(a&&(o=_G(e,r,o,t,n)),e.length>80*t){c=f=e[0],h=l=e[1];for(var v=t;v<i;v+=t)d=e[v],p=e[v+1],d<c&&(c=d),p<h&&(h=p),d>f&&(f=d),p>l&&(l=p);u=Math.max(f-c,l-h),u=u!==0?1/u:0}return to(o,s,t,c,h,u),s}function mw(e,r,t,n,a,i){var o,s;if(i===void 0&&(i=Ar(e,{start:r,end:t,size:n})),a===i<0)for(o=r;o<t;o+=n)s=pw(o,e[o],e[o+1],s);else for(o=t-n;o>=r;o-=n)s=pw(o,e[o],e[o+1],s);return s&&Xu(s,s.next)&&(no(s),s=s.next),s}function Yr(e,r){if(!e)return e;r||(r=e);var t=e,n;do if(n=!1,!t.steiner&&(Xu(t,t.next)||Pe(t.prev,t,t.next)===0)){if(no(t),t=r=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==r);return r}function to(e,r,t,n,a,i,o){if(e){!o&&i&&SG(e,n,a,i);for(var s=e,u,f;e.prev!==e.next;){if(u=e.prev,f=e.next,i?gG(e,n,a,i):vG(e)){r.push(u.i/t),r.push(e.i/t),r.push(f.i/t),no(e),e=f.next,s=f.next;continue}if(e=f,e===s){o?o===1?(e=yG(Yr(e),r,t),to(e,r,t,n,a,i,2)):o===2&&AG(e,r,t,n,a,i):to(Yr(e),r,t,n,a,i,1);break}}}}function vG(e){var r=e.prev,t=e,n=e.next;if(Pe(r,t,n)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(Da(r.x,r.y,t.x,t.y,n.x,n.y,a.x,a.y)&&Pe(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function gG(e,r,t,n){var a=e.prev,i=e,o=e.next;if(Pe(a,i,o)>=0)return!1;for(var s=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,u=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,f=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,l=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y,c=fm(s,u,r,t,n),h=fm(f,l,r,t,n),d=e.prevZ,p=e.nextZ;d&&d.z>=c&&p&&p.z<=h;){if(d!==e.prev&&d!==e.next&&Da(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&Pe(d.prev,d,d.next)>=0||(d=d.prevZ,p!==e.prev&&p!==e.next&&Da(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&Pe(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;d&&d.z>=c;){if(d!==e.prev&&d!==e.next&&Da(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&Pe(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&Da(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&Pe(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function yG(e,r,t){var n=e;do{var a=n.prev,i=n.next.next;!Xu(a,i)&&vw(a,n,n.next,i)&&ro(a,i)&&ro(i,a)&&(r.push(a.i/t),r.push(n.i/t),r.push(i.i/t),no(n),no(n.next),n=e=i),n=n.next}while(n!==e);return Yr(n)}function AG(e,r,t,n,a,i){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&BG(o,s)){var u=gw(o,s);o=Yr(o,o.next),u=Yr(u,u.next),to(o,r,t,n,a,i),to(u,r,t,n,a,i);return}s=s.next}o=o.next}while(o!==e)}function _G(e,r,t,n,a){var i=[],o,s,u,f,l;for(o=0,s=r.length;o<s;o++)u=r[o]*n,f=o<s-1?r[o+1]*n:e.length,l=mw(e,u,f,n,!1,a&&a[o+1]),l===l.next&&(l.steiner=!0),i.push(wG(l));for(i.sort(bG),o=0;o<i.length;o++)TG(i[o],t),t=Yr(t,t.next);return t}function bG(e,r){return e.x-r.x}function TG(e,r){if(r=xG(e,r),r){var t=gw(r,e);Yr(r,r.next),Yr(t,t.next)}}function xG(e,r){var t=r,n=e.x,a=e.y,i=-1/0,o;do{if(a<=t.y&&a>=t.next.y&&t.next.y!==t.y){var s=t.x+(a-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(s<=n&&s>i){if(i=s,s===n){if(a===t.y)return t;if(a===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==r);if(!o)return null;if(n===i)return o;var u=o,f=o.x,l=o.y,c=1/0,h;t=o;do n>=t.x&&t.x>=f&&n!==t.x&&Da(a<l?n:i,a,f,l,a<l?i:n,a,t.x,t.y)&&(h=Math.abs(a-t.y)/(n-t.x),ro(t,e)&&(h<c||h===c&&(t.x>o.x||t.x===o.x&&EG(o,t)))&&(o=t,c=h)),t=t.next;while(t!==u);return o}function EG(e,r){return Pe(e.prev,e,r.prev)<0&&Pe(r.next,e,e.next)<0}function SG(e,r,t,n){var a=e;do a.z===null&&(a.z=fm(a.x,a.y,r,t,n)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,CG(a)}function CG(e){var r,t,n=1,a,i,o,s,u,f;do{for(i=e,e=null,f=null,a=0;i;){for(a++,s=i,o=0,t=0;t<n&&(o++,s=s.nextZ,!!s);t++);for(u=n;o>0||u>0&&s;)o!==0&&(u===0||!s||i.z<=s.z)?(r=i,i=i.nextZ,o--):(r=s,s=s.nextZ,u--),f?f.nextZ=r:e=r,r.prevZ=f,f=r;i=s}f.nextZ=null,n*=2}while(a>1);return e}function fm(e,r,t,n,a){return e=32767*(e-t)*a,r=32767*(r-n)*a,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e|r<<1}function wG(e){var r=e,t=e;do(r.x<t.x||r.x===t.x&&r.y<t.y)&&(t=r),r=r.next;while(r!==e);return t}function Da(e,r,t,n,a,i,o,s){return(a-o)*(r-s)-(e-o)*(i-s)>=0&&(e-o)*(n-s)-(t-o)*(r-s)>=0&&(t-o)*(i-s)-(a-o)*(n-s)>=0}function BG(e,r){return e.next.i!==r.i&&e.prev.i!==r.i&&!MG(e,r)&&(ro(e,r)&&ro(r,e)&&OG(e,r)&&(Pe(e.prev,e,r.prev)||Pe(e,r.prev,r))||Xu(e,r)&&Pe(e.prev,e,e.next)>0&&Pe(r.prev,r,r.next)>0)}function Pe(e,r,t){return(r.y-e.y)*(t.x-r.x)-(r.x-e.x)*(t.y-r.y)}function Xu(e,r){return e.x===r.x&&e.y===r.y}function vw(e,r,t,n){var a=qu(Pe(e,r,t)),i=qu(Pe(e,r,n)),o=qu(Pe(t,n,e)),s=qu(Pe(t,n,r));return!!(a!==i&&o!==s||a===0&&Ju(e,t,r)||i===0&&Ju(e,n,r)||o===0&&Ju(t,e,n)||s===0&&Ju(t,r,n))}function Ju(e,r,t){return r.x<=Math.max(e.x,t.x)&&r.x>=Math.min(e.x,t.x)&&r.y<=Math.max(e.y,t.y)&&r.y>=Math.min(e.y,t.y)}function qu(e){return e>0?1:e<0?-1:0}function MG(e,r){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==r.i&&t.next.i!==r.i&&vw(t,t.next,e,r))return!0;t=t.next}while(t!==e);return!1}function ro(e,r){return Pe(e.prev,e,e.next)<0?Pe(e,r,e.next)>=0&&Pe(e,e.prev,r)>=0:Pe(e,r,e.prev)<0||Pe(e,e.next,r)<0}function OG(e,r){var t=e,n=!1,a=(e.x+r.x)/2,i=(e.y+r.y)/2;do t.y>i!=t.next.y>i&&t.next.y!==t.y&&a<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==e);return n}function gw(e,r){var t=new lm(e.i,e.x,e.y),n=new lm(r.i,r.x,r.y),a=e.next,i=r.prev;return e.next=r,r.prev=e,t.next=a,a.prev=t,n.next=t,t.prev=n,i.next=n,n.prev=i,n}function pw(e,r,t,n){var a=new lm(e,r,t);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}function no(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function lm(e,r,t){this.i=e,this.x=r,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function pm(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=FG(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function FG(e,r){if(e){if(typeof e=="string")return _w(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _w(e,r)}}function _w(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function bw(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function zn(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?bw(Object(t),!0).forEach(function(n){(0,Tw.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):bw(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function mm(e,r,t){var n=LG(e),a=Object.keys(n).filter(function(i){return n[i]!==Array});return kG(e,zn({propArrayTypes:n},r),{numericPropKeys:t&&t.numericPropKeys||a,PositionDataType:t?t.PositionDataType:Float32Array})}function LG(e){var r={},t=pm(e),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;if(a.properties)for(var i in a.properties){var o=a.properties[i];r[i]=HG(o,r[i])}}}catch(s){t.e(s)}finally{t.f()}return r}function kG(e,r,t){for(var n=r.pointPositionsCount,a=r.pointFeaturesCount,i=r.linePositionsCount,o=r.linePathsCount,s=r.lineFeaturesCount,u=r.polygonPositionsCount,f=r.polygonObjectsCount,l=r.polygonRingsCount,c=r.polygonFeaturesCount,h=r.propArrayTypes,d=r.coordLength,p=t.numericPropKeys,v=p===void 0?[]:p,g=t.PositionDataType,y=g===void 0?Float32Array:g,b=e[0]&&("id"in e[0]),E=e.length>65535?Uint32Array:Uint16Array,T={type:"Point",positions:new y(n*d),globalFeatureIds:new E(n),featureIds:a>65535?new Uint32Array(n):new Uint16Array(n),numericProps:{},properties:[],fields:[]},S={type:"LineString",pathIndices:i>65535?new Uint32Array(o+1):new Uint16Array(o+1),positions:new y(i*d),globalFeatureIds:new E(i),featureIds:s>65535?new Uint32Array(i):new Uint16Array(i),numericProps:{},properties:[],fields:[]},I={type:"Polygon",polygonIndices:u>65535?new Uint32Array(f+1):new Uint16Array(f+1),primitivePolygonIndices:u>65535?new Uint32Array(l+1):new Uint16Array(l+1),positions:new y(u*d),triangles:[],globalFeatureIds:new E(u),featureIds:c>65535?new Uint32Array(u):new Uint16Array(u),numericProps:{},properties:[],fields:[]},L=0,B=[T,S,I];L<B.length;L++){var C=B[L],_=pm(v),R;try{for(_.s();!(R=_.n()).done;){var F=R.value,k=h[F];C.numericProps[F]=new k(C.positions.length/d)}}catch(j){_.e(j)}finally{_.f()}}S.pathIndices[o]=i,I.polygonIndices[f]=u,I.primitivePolygonIndices[l]=u;var D={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0},M=pm(e),O;try{for(M.s();!(O=M.n()).done;){var P=O.value,U=P.geometry,G=P.properties||{};switch(U.type){case"Point":DG(U,T,D,d,G),T.properties.push(dm(G,v)),b&&T.fields.push({id:P.id}),D.pointFeature++;break;case"LineString":GG(U,S,D,d,G),S.properties.push(dm(G,v)),b&&S.fields.push({id:P.id}),D.lineFeature++;break;case"Polygon":NG(U,I,D,d,G),I.properties.push(dm(G,v)),b&&I.fields.push({id:P.id}),D.polygonFeature++;break;default:throw new Error("Invalid geometry type")}D.feature++}}catch(j){M.e(j)}finally{M.f()}return jG(T,S,I,d)}function DG(e,r,t,n,a){r.positions.set(e.data,t.pointPosition*n);var i=e.data.length/n;vm(r,a,t.pointPosition,i),r.globalFeatureIds.fill(t.feature,t.pointPosition,t.pointPosition+i),r.featureIds.fill(t.pointFeature,t.pointPosition,t.pointPosition+i),t.pointPosition+=i}function GG(e,r,t,n,a){r.positions.set(e.data,t.linePosition*n);var i=e.data.length/n;vm(r,a,t.linePosition,i),r.globalFeatureIds.fill(t.feature,t.linePosition,t.linePosition+i),r.featureIds.fill(t.lineFeature,t.linePosition,t.linePosition+i);for(var o=0,s=e.indices.length;o<s;++o){var u=e.indices[o],f=o===s-1?e.data.length:e.indices[o+1];r.pathIndices[t.linePath++]=t.linePosition,t.linePosition+=(f-u)/n}}function NG(e,r,t,n,a){r.positions.set(e.data,t.polygonPosition*n);var i=e.data.length/n;vm(r,a,t.polygonPosition,i),r.globalFeatureIds.fill(t.feature,t.polygonPosition,t.polygonPosition+i),r.featureIds.fill(t.polygonFeature,t.polygonPosition,t.polygonPosition+i);for(var o=0,s=e.indices.length;o<s;++o){var u=t.polygonPosition;r.polygonIndices[t.polygonObject++]=u;for(var f=e.areas[o],l=e.indices[o],c=e.indices[o+1],h=0,d=l.length;h<d;++h){var p=l[h],v=h===d-1?c===void 0?e.data.length:c[0]:l[h+1];r.primitivePolygonIndices[t.polygonRing++]=t.polygonPosition,t.polygonPosition+=(v-p)/n}var g=t.polygonPosition;UG(r,f,l,{startPosition:u,endPosition:g,coordLength:n})}}function UG(e,r,t,n){for(var a=n.startPosition,i=n.endPosition,o=n.coordLength,s=a*o,u=i*o,f=e.positions.subarray(s,u),l=t[0],c=t.slice(1).map(function(v){return(v-l)/o}),h=cm(f,c,o,r),d=0,p=h.length;d<p;++d)e.triangles.push(a+h[d])}function hm(e,r){var t={};for(var n in e)t[n]={value:e[n],size:r};return t}function jG(e,r,t,n){return{points:zn(zn({},e),{},{positions:{value:e.positions,size:n},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:hm(e.numericProps,1)}),lines:zn(zn({},r),{},{positions:{value:r.positions,size:n},pathIndices:{value:r.pathIndices,size:1},globalFeatureIds:{value:r.globalFeatureIds,size:1},featureIds:{value:r.featureIds,size:1},numericProps:hm(r.numericProps,1)}),polygons:zn(zn({},t),{},{positions:{value:t.positions,size:n},polygonIndices:{value:t.polygonIndices,size:1},primitivePolygonIndices:{value:t.primitivePolygonIndices,size:1},triangles:{value:new Uint32Array(t.triangles),size:1},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:hm(t.numericProps,1)})}}function vm(e,r,t,n){for(var a in e.numericProps)if(a in r){var i=r[a];e.numericProps[a].fill(i,t,t+n)}}function dm(e,r){var t={};for(var n in e)r.includes(n)||(t[n]=e[n]);return t}function HG(e,r){return r===Array||!Number.isFinite(e)?Array:r===Float64Array||Math.fround(e)!==e?Float64Array:Float32Array}var Sw=m(W());function xw(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function VG(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?xw(Object(t),!0).forEach(function(n){(0,Sw.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):xw(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Cw(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=zG(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function zG(e,r){if(e){if(typeof e=="string")return Ew(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ew(e,r)}}function Ew(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Qu(e,r){var t=r?.globalFeatureId;return t!==void 0?WG(e,t):JG(e,r?.type)}function WG(e,r){var t=Bw(e),n=Cw(t),a;try{for(n.s();!(a=n.n()).done;){for(var i=a.value,o=0,s=i.featureIds.value[0],u=0;u<i.featureIds.value.length;u++){var f=i.featureIds.value[u];if(f!==s){if(r===i.globalFeatureIds.value[o])return Yu(i,o,u);o=u,s=f}}if(r===i.globalFeatureIds.value[o])return Yu(i,o,i.featureIds.value.length)}}catch(l){n.e(l)}finally{n.f()}throw new Error("featureId:".concat(r," not found"))}function JG(e,r){var t=Bw(e,r);return qG(t)}function ww(e,r,t){switch(e.type){case"Point":return QG(e,r,t);case"LineString":return KG(e,r,t);case"Polygon":return Mw(e,r,t);default:var n=e;throw new Error("Unsupported geometry type: ".concat(n?.type))}}function Bw(e,r){var t=Boolean(e.points||e.lines||e.polygons);if(!t)return e.type=r||ZG(e),[e];var n=[];return e.points&&(e.points.type="Point",n.push(e.points)),e.lines&&(e.lines.type="LineString",n.push(e.lines)),e.polygons&&(e.polygons.type="Polygon",n.push(e.polygons)),n}function qG(e){var r=[],t=Cw(e),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;if(a.featureIds.value.length!==0){for(var i=0,o=a.featureIds.value[0],s=0;s<a.featureIds.value.length;s++){var u=a.featureIds.value[s];u!==o&&(r.push(Yu(a,i,s)),i=s,o=u)}r.push(Yu(a,i,a.featureIds.value.length))}}}catch(f){t.e(f)}finally{t.f()}return r}function Yu(e,r,t){var n=ww(e,r,t),a=YG(e,r,t),i=XG(e,r,t);return VG({type:"Feature",geometry:n,properties:a},i)}function XG(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0;return e.fields&&e.fields[e.featureIds.value[r]]}function YG(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0,n=Object.assign({},e.properties[e.featureIds.value[r]]);for(var a in e.numericProps)n[a]=e.numericProps[a].value[r];return n}function Mw(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1/0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1/0,n=e.positions,a=e.polygonIndices.value.filter(function(y){return y>=r&&y<=t}),i=e.primitivePolygonIndices.value.filter(function(y){return y>=r&&y<=t}),o=a.length>2;if(!o){for(var s=[],u=0;u<i.length-1;u++){var f=i[u],l=i[u+1],c=Ku(n,f,l);s.push(c)}return{type:"Polygon",coordinates:s}}for(var h=[],d=0;d<a.length-1;d++){var p=a[d],v=a[d+1],g=Mw(e,p,v).coordinates;h.push(g)}return{type:"MultiPolygon",coordinates:h}}function KG(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1/0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1/0,n=e.positions,a=e.pathIndices.value.filter(function(l){return l>=r&&l<=t}),i=a.length>2;if(!i){var o=Ku(n,a[0],a[1]);return{type:"LineString",coordinates:o}}for(var s=[],u=0;u<a.length-1;u++){var f=Ku(n,a[u],a[u+1]);s.push(f)}return{type:"MultiLineString",coordinates:s}}function QG(e,r,t){var n=e.positions,a=Ku(n,r,t),i=a.length>1;return i?{type:"MultiPoint",coordinates:a}:{type:"Point",coordinates:a[0]}}function Ku(e,r,t){r=r||0,t=t||e.value.length/e.size;for(var n=[],a=r;a<t;a++){for(var i=Array(),o=a*e.size;o<(a+1)*e.size;o++)i.push(Number(e.value[o]));n.push(i)}return n}function ZG(e){return e.pathIndices?"LineString":e.polygonIndices?"Polygon":"Point"}var xm=m(kw());var Ww=m(H());var Hw=m(H()),Vw=m(z());var Nw=m(H()),Uw=m(z());function Dw(e){var r=e.length;if(r<=1)return[e];for(var t=[],n,a,i=0;i<r;i++){var o=vN(e[i]);o!==0&&(a===void 0&&(a=o<0),a===o<0?(n&&t.push(n),n=[e[i]]):n&&n.push(e[i]))}return n&&t.push(n),t}function vN(e){for(var r=0,t=0,n=e.length-1,a,i;t<e.length;n=t++)a=e[t],i=e[n],r+=(i[0]-a[0])*(a[1]+i[1]);return r}function Gw(e,r,t){r&&t&&(e===1?r.id=t.readVarint():e===2?gN(t,r):e===3?r.type=t.readVarint():e===4&&(r._geometry=t.pos))}function gN(e,r){for(var t=e.readVarint()+e.pos;e.pos<t;){var n=r._keys[e.readVarint()],a=r._values[e.readVarint()];r.properties[n]=a}}var jw=function(){function e(r,t,n,a,i){(0,Nw.default)(this,e),A(this,"properties",void 0),A(this,"extent",void 0),A(this,"type",void 0),A(this,"id",void 0),A(this,"_pbf",void 0),A(this,"_geometry",void 0),A(this,"_keys",void 0),A(this,"_values",void 0),this.properties={},this.extent=n,this.type=0,this.id=null,this._pbf=r,this._geometry=-1,this._keys=a,this._values=i,r.readFields(Gw,this,t)}return(0,Uw.default)(e,[{key:"loadGeometry",value:function(){var t=this._pbf;t.pos=this._geometry;for(var n=t.readVarint()+t.pos,a=1,i=0,o=0,s=0,u=[],f;t.pos<n;){if(i<=0){var l=t.readVarint();a=l&7,i=l>>3}if(i--,a===1||a===2)o+=t.readSVarint(),s+=t.readSVarint(),a===1&&(f&&u.push(f),f=[]),f&&f.push([o,s]);else if(a===7)f&&f.push(f[0].slice());else throw new Error("unknown command ".concat(a))}return f&&u.push(f),u}},{key:"bbox",value:function(){var t=this._pbf;t.pos=this._geometry;for(var n=t.readVarint()+t.pos,a=1,i=0,o=0,s=0,u=1/0,f=-1/0,l=1/0,c=-1/0;t.pos<n;){if(i<=0){var h=t.readVarint();a=h&7,i=h>>3}if(i--,a===1||a===2)o+=t.readSVarint(),s+=t.readSVarint(),o<u&&(u=o),o>f&&(f=o),s<l&&(l=s),s>c&&(c=s);else if(a!==7)throw new Error("unknown command ".concat(a))}return[u,l,f,c]}},{key:"_toGeoJSON",value:function(t){var n=this.loadGeometry(),a=e.types[this.type],i,o;switch(this.type){case 1:var s=[];for(i=0;i<n.length;i++)s[i]=n[i][0];n=s,t(n,this);break;case 2:for(i=0;i<n.length;i++)t(n[i],this);break;case 3:for(n=Dw(n),i=0;i<n.length;i++)for(o=0;o<n[i].length;o++)t(n[i][o],this);break}n.length===1?n=n[0]:a="Multi".concat(a);var u={type:"Feature",geometry:{type:a,coordinates:n},properties:this.properties};return this.id!==null&&(u.id=this.id),u}},{key:"toGeoJSON",value:function(t){if(typeof t=="function")return this._toGeoJSON(t);var n=t.x,a=t.y,i=t.z,o=this.extent*Math.pow(2,i),s=this.extent*n,u=this.extent*a;function f(l){for(var c=0;c<l.length;c++){var h=l[c];h[0]=(h[0]+s)*360/o-180;var d=180-(h[1]+u)*360/o;h[1]=360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90}}return this._toGeoJSON(f)}}],[{key:"types",get:function(){return["Unknown","Point","LineString","Polygon"]}}]),e}();var zw=function(){function e(r,t){(0,Hw.default)(this,e),A(this,"version",void 0),A(this,"name",void 0),A(this,"extent",void 0),A(this,"length",void 0),A(this,"_pbf",void 0),A(this,"_keys",void 0),A(this,"_values",void 0),A(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(yN,this,t),this.length=this._features.length}return(0,Vw.default)(e,[{key:"feature",value:function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var n=this._pbf.readVarint()+this._pbf.pos;return new jw(this._pbf,n,this.extent,this._keys,this._values)}}]),e}();function yN(e,r,t){r&&t&&(e===15?r.version=t.readVarint():e===1?r.name=t.readString():e===5?r.extent=t.readVarint():e===2?r._features.push(t.pos):e===3?r._keys.push(t.readString()):e===4&&r._values.push(AN(t)))}function AN(e){for(var r=null,t=e.readVarint()+e.pos;e.pos<t;){var n=e.readVarint()>>3;r=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return r}var Jw=function e(r,t){(0,Ww.default)(this,e),A(this,"layers",void 0),this.layers=r.readFields(_N,{},t)};function _N(e,r,t){if(e===3&&t){var n=new zw(t,t.readVarint()+t.pos);n.length&&r&&(r[n.name]=n)}}var sB=m(H());var aB=m(H()),iB=m(z());var eB=m(W()),tB=m(H()),rB=m(z());function qw(e){var r=e.indices.length,t="Polygon";if(r<=1)return{type:t,data:e.data,areas:[[Ar(e.data)]],indices:[e.indices]};for(var n=[],a=[],i=[],o=[],s,u=0,f,l=0,c;l<r;l++){c=e.indices[l]-u,f=e.indices[l+1]-u||e.data.length;var h=e.data.slice(c,f),d=Ar(h);if(d===0){var p=e.data.slice(0,c),v=e.data.slice(f);e.data=p.concat(v),u+=f-c;continue}s===void 0&&(s=d<0),s===d<0?(o.length&&(n.push(i),a.push(o)),o=[c],i=[d]):(i.push(d),o.push(c))}return i&&n.push(i),o.length&&a.push(o),{type:t,areas:n,indices:a,data:e.data}}function Xw(e,r,t,n){for(var a=0,i=e.length;a<i;a+=2){e[a]=(e[a]+r)*360/n-180;var o=180-(e[a+1]+t)*360/n;e[a+1]=360/Math.PI*Math.atan(Math.exp(o*Math.PI/180))-90}}function Yw(e,r,t){r&&t&&(e===1?r.id=t.readVarint():e===2?bN(t,r):e===3?r.type=t.readVarint():e===4&&(r._geometry=t.pos))}function bN(e,r){for(var t=e.readVarint()+e.pos;e.pos<t;){var n=r._keys[e.readVarint()],a=r._values[e.readVarint()];r.properties[n]=a}}function TN(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=xN(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function xN(e,r){if(e){if(typeof e=="string")return Kw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Kw(e,r)}}function Kw(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Qw(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Zw(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Qw(Object(t),!0).forEach(function(n){(0,eB.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Qw(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var $w,Wn,Am,ef,_m,bm,ao;var nB=function(){function e(r,t,n,a,i,o){(0,tB.default)(this,e),A(this,"properties",void 0),A(this,"extent",void 0),A(this,"type",void 0),A(this,"id",void 0),A(this,"_pbf",void 0),A(this,"_geometry",void 0),A(this,"_keys",void 0),A(this,"_values",void 0),A(this,"_geometryInfo",void 0),this.properties={},this.extent=n,this.type=0,this.id=null,this._pbf=r,this._geometry=-1,this._keys=a,this._values=i,this._geometryInfo=o,r.readFields(Yw,this,t)}return(0,rB.default)(e,[{key:"loadGeometry",value:function(){var t=this._pbf;t.pos=this._geometry,$w=t.readVarint()+t.pos,Wn=1,ef=0,_m=0,bm=0,ao=0;for(var n=[],a=[];t.pos<$w;)if(ef<=0&&(Am=t.readVarint(),Wn=Am&7,ef=Am>>3),ef--,Wn===1||Wn===2)_m+=t.readSVarint(),bm+=t.readSVarint(),Wn===1&&n.push(ao),a.push(_m,bm),ao+=2;else if(Wn===7){if(ao>0){var i=n[n.length-1];a.push(a[i],a[i+1]),ao+=2}}else throw new Error("unknown command ".concat(Wn));return{data:a,indices:n}}},{key:"_toBinaryCoordinates",value:function(t){var n=this.loadGeometry(),a;t(n.data,this);var i=2;switch(this.type){case 1:this._geometryInfo.pointFeaturesCount++,this._geometryInfo.pointPositionsCount+=n.indices.length,a=Zw({type:"Point"},n);break;case 2:this._geometryInfo.lineFeaturesCount++,this._geometryInfo.linePathsCount+=n.indices.length,this._geometryInfo.linePositionsCount+=n.data.length/i,a=Zw({type:"LineString"},n);break;case 3:a=qw(n),this._geometryInfo.polygonFeaturesCount++,this._geometryInfo.polygonObjectsCount+=a.indices.length;var o=TN(a.indices),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;this._geometryInfo.polygonRingsCount+=u.length}}catch(l){o.e(l)}finally{o.f()}this._geometryInfo.polygonPositionsCount+=a.data.length/i;break;default:throw new Error("Invalid geometry type: ".concat(this.type))}var f={type:"Feature",geometry:a,properties:this.properties};return this.id!==null&&(f.id=this.id),f}},{key:"toBinaryCoordinates",value:function(t){if(typeof t=="function")return this._toBinaryCoordinates(t);var n=t.x,a=t.y,i=t.z,o=this.extent*Math.pow(2,i),s=this.extent*n,u=this.extent*a;return this._toBinaryCoordinates(function(f){return Xw(f,s,u,o)})}}]),e}();var oB=function(){function e(r,t){(0,aB.default)(this,e),A(this,"version",void 0),A(this,"name",void 0),A(this,"extent",void 0),A(this,"length",void 0),A(this,"_pbf",void 0),A(this,"_keys",void 0),A(this,"_values",void 0),A(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(EN,this,t),this.length=this._features.length}return(0,iB.default)(e,[{key:"feature",value:function(t,n){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var a=this._pbf.readVarint()+this._pbf.pos;return new nB(this._pbf,a,this.extent,this._keys,this._values,n)}}]),e}();function EN(e,r,t){r&&t&&(e===15?r.version=t.readVarint():e===1?r.name=t.readString():e===5?r.extent=t.readVarint():e===2?r._features.push(t.pos):e===3?r._keys.push(t.readString()):e===4&&r._values.push(SN(t)))}function SN(e){for(var r=null,t=e.readVarint()+e.pos;e.pos<t;){var n=e.readVarint()>>3;r=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return r}var uB=function e(r,t){(0,sB.default)(this,e),A(this,"layers",void 0),this.layers=r.readFields(CN,{},t)};function CN(e,r,t){if(e===3&&t){var n=new oB(t,t.readVarint()+t.pos);n.length&&r&&(r[n.name]=n)}}function tf(e,r){var t,n,a=BN(r),i=(r==null||(t=r.gis)===null||t===void 0?void 0:t.format)||(r==null||(n=r.mvt)===null||n===void 0?void 0:n.shape);switch(i){case"columnar-table":return{shape:"columnar-table",data:Tm(e,a)};case"geojson-row-table":{var o={shape:"geojson-row-table",data:fB(e,a)};return o}case"geojson":return fB(e,a);case"binary-geometry":return Tm(e,a);case"binary":return Tm(e,a);default:throw new Error(i)}}function Tm(e,r){var t=wN(e,r),n=(0,lB.default)(t,2),a=n[0],i=n[1],o=mm(a,i);return o.byteLength=e.byteLength,o}function wN(e,r){var t=[],n={coordLength:2,pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(e.byteLength<=0)return[t,n];var a=new uB(new xm.default(e)),i=r&&Array.isArray(r.layers)?r.layers:Object.keys(a.layers);return i.forEach(function(o){var s=a.layers[o];if(s)for(var u=0;u<s.length;u++){var f=s.feature(u,n),l=ON(f,r,o);t.push(l)}}),[t,n]}function fB(e,r){if(e.byteLength<=0)return[];var t=[],n=new Jw(new xm.default(e)),a=Array.isArray(r.layers)?r.layers:Object.keys(n.layers);return a.forEach(function(i){var o=n.layers[i];if(o)for(var s=0;s<o.length;s++){var u=o.feature(s),f=MN(u,r,i);t.push(f)}}),t}function BN(e){var r;if(!(e!=null&&e.mvt))throw new Error("mvt options required");var t=((r=e.mvt)===null||r===void 0?void 0:r.coordinates)==="wgs84",n=e.mvt.tileIndex,a=n&&Number.isFinite(n.x)&&Number.isFinite(n.y)&&Number.isFinite(n.z);if(t&&!a)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property");return e.mvt}function MN(e,r,t){var n=e.toGeoJSON(r.coordinates==="wgs84"?r.tileIndex:IN);return r.layerProperty&&(n.properties[r.layerProperty]=t),n}function ON(e,r,t){var n=e.toBinaryCoordinates(r.coordinates==="wgs84"?r.tileIndex:PN);return r.layerProperty&&n.properties&&(n.properties[r.layerProperty]=t),n}function IN(e,r){for(var t=r.extent,n=0;n<e.length;n++){var a=e[n];a[0]/=t,a[1]/=t}}function PN(e,r){for(var t=r.extent,n=0,a=e.length;n<a;++n)e[n]/=t}function cB(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function hB(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?cB(Object(t),!0).forEach(function(n){(0,pB.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):cB(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var RN="3.3.3",FN={mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:null}},rf={name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:RN,extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:FN},LN=hB(hB({},rf),{},{parse:function(){var e=(0,dB.default)(Em.default.mark(function t(n,a){return Em.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",tf(n,a));case 1:case"end":return o.stop()}},t)}));function r(t,n){return e.apply(this,arguments)}return r}(),parseSync:tf,binary:!0});var gB=m(W()),Sm=m(ce());function mB(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function vB(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?mB(Object(t),!0).forEach(function(n){(0,gB.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):mB(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var kN={Point:yB,MultiPoint:DN,LineString:AB,MultiLineString:GN,Polygon:_B,MultiPolygon:NN};function yB(e,r,t){var n=(0,Sm.default)(e,2),a=n[0],i=n[1],o=(0,Sm.default)(r,2),s=o[0],u=o[1],f=wr(s[0],u[0],a),l=wr(s[1],u[1],i);return t.unprojectFlat([f,l])}function Cm(e,r,t){return e.map(function(n){return yB(n,r,t)})}function DN(e,r,t){return Cm(e,r,t)}function AB(e,r,t){return Cm(e,r,t)}function GN(e,r,t){return e.map(function(n){return AB(n,r,t)})}function _B(e,r,t){return e.map(function(n){return Cm(n,r,t)})}function NN(e,r,t){return e.map(function(n){return _B(n,r,t)})}function bB(e,r,t){var n=t.projectFlat([r.west,r.north]),a=t.projectFlat([r.east,r.south]),i=[n,a];return vB(vB({},e),{},{coordinates:kN[e.type](e.coordinates,i,t)})}function UN(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=jN(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function jN(e,r){if(e){if(typeof e=="string")return TB(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return TB(e,r)}}function TB(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var HN=["points","lines","polygons"];function wm(e,r,t,n){var a=UN(HN),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e[o]&&VN(e[o],r,t,n);if(s>=0)return s}}catch(u){a.e(u)}finally{a.f()}return-1}function VN(e,r,t,n){var a=e.featureIds.value;if(!a.length)return-1;var i=0,o=a[a.length-1]+1;if(n){var s=zN(e,n);if(s)i=s[0],o=s[1]+1;else return-1}var u=-1;if(r in e.numericProps){var f=e.numericProps[r].value.findIndex(function(l,c){return l===t&&a[c]>=i&&a[c]<o});return f>=0?e.globalFeatureIds.value[f]:-1}else r?u=xB(e.properties,function(l){return l[r]===t},i,o):e.fields&&(u=xB(e.fields,function(l){return l.id===t},i,o));return u>=0?WN(e,u):-1}function zN(e,r){if(!e.__layers){for(var t={},n=e.properties,a=0;a<n.length;a++){var i=n[a],o=i.layerName;o&&(t[o]?t[o][1]=a:t[o]=[a,a])}e.__layers=t}return e.__layers[r]}function WN(e,r){if(!e.__ids){for(var t=[],n=e.featureIds.value,a=e.globalFeatureIds.value,i=0;i<n.length;i++)t[n[i]]=a[i];e.__ids=t}return e.__ids[r]}function xB(e,r,t,n){for(var a=t;a<n;a++)if(r(e[a],a))return a;return-1}function JN(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=qN(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(e)},n:function(){var f=t.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function qN(e,r){if(e){if(typeof e=="string")return EB(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return EB(e,r)}}function EB(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function XN(e){var r=YN();return function(){var n=(0,$t.default)(e),a;if(r){var i=(0,$t.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,FB.default)(this,a)}}function YN(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function SB(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Qr(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?SB(Object(t),!0).forEach(function(n){(0,nf.default)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):SB(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Bm=512,KN=Qr(Qr({},Im.GeoJsonLayer.defaultProps),{},{data:Rr,onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[rf],binary:!0}),of=function(e){(0,RB.default)(t,e);var r=XN(t);function t(){return(0,IB.default)(this,t),r.apply(this,arguments)}return(0,PB.default)(t,[{key:"initializeState",value:function(){(0,Kr.default)((0,$t.default)(t.prototype),"initializeState",this).call(this);var a=this.context.viewport.resolution!==void 0?!1:this.props.binary;this.setState({binary:a,data:null,tileJSON:null})}},{key:"isLoaded",get:function(){return this.state&&this.state.data&&this.state.tileset&&(0,Kr.default)((0,$t.default)(t.prototype),"isLoaded",this)}},{key:"updateState",value:function(a){var i,o=a.props,s=a.oldProps,u=a.context,f=a.changeFlags;f.dataChanged&&this._updateTileData(),(i=this.state)!==null&&i!==void 0&&i.data&&((0,Kr.default)((0,$t.default)(t.prototype),"updateState",this).call(this,{props:o,oldProps:s,context:u,changeFlags:f}),this._setWGS84PropertyForTiles());var l=o.highlightColor;l!==s.highlightColor&&Array.isArray(l)&&this.setState({highlightColor:l})}},{key:"_updateTileData",value:function(){var n=(0,OB.default)(Om.default.mark(function i(){var o,s,u,f,l;return Om.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(o=this.props.data,s=null,!(typeof o=="string"&&!Sc(o))){h.next=18;break}return u=this.props,f=u.onDataLoad,l=u.fetch,this.setState({data:null,tileJSON:null}),h.prev=5,h.next=8,l(o,{propName:"data",layer:this,loaders:[]});case 8:s=h.sent,h.next=15;break;case 11:h.prev=11,h.t0=h.catch(5),this.raiseError(h.t0,"loading TileJSON"),o=null;case 15:f&&f(s,{propName:"data",layer:this}),h.next=19;break;case 18:o.tilejson&&(s=o);case 19:s&&(o=s.tiles),this.setState({data:o,tileJSON:s});case 21:case"end":return h.stop()}},i,this,[[5,11]])}));function a(){return n.apply(this,arguments)}return a}()},{key:"_getTilesetOptions",value:function(){var a=(0,Kr.default)((0,$t.default)(t.prototype),"_getTilesetOptions",this).call(this),i=this.state.tileJSON,o=this.props,s=o.minZoom,u=o.maxZoom;return i&&(Number.isFinite(i.minzoom)&&i.minzoom>s&&(a.minZoom=i.minzoom),Number.isFinite(i.maxzoom)&&(!Number.isFinite(u)||i.maxzoom<u)&&(a.maxZoom=i.maxzoom)),a}},{key:"renderLayers",value:function(){var a;return(a=this.state)!==null&&a!==void 0&&a.data?(0,Kr.default)((0,$t.default)(t.prototype),"renderLayers",this).call(this):null}},{key:"getTileData",value:function(a){var i,o=this.state,s=o.data,u=o.binary,f=a.index,l=a.signal,c=qt(s,a);if(!c)return Promise.reject("Invalid URL");var h=this.getLoadOptions(),d=this.props.fetch;return h=Qr(Qr({},h),{},{mimeType:"application/x-protobuf",mvt:Qr(Qr({},(i=h)===null||i===void 0?void 0:i.mvt),{},{coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:f}),gis:u?{format:"binary"}:{}}),d(c,{propName:"data",layer:this,loadOptions:h,signal:l})}},{key:"renderSubLayers",value:function(a){var i=a.tile.index,o=i.x,s=i.y,u=i.z,f=Math.pow(2,u),l=Bm/f,c=-l,h=Bm*o/f,d=Bm*(1-s/f),p=new $().scale([l,c,1]);a.autoHighlight=!1,this.context.viewport.resolution||(a.modelMatrix=p,a.coordinateOrigin=[h,d,0],a.coordinateSystem=af.COORDINATE_SYSTEM.CARTESIAN,a.extensions=[].concat((0,MB.default)(a.extensions||[]),[new LB.ClipExtension]));var v=(0,Kr.default)((0,$t.default)(t.prototype),"renderSubLayers",this).call(this,a);return this.state.binary&&!(v instanceof Im.GeoJsonLayer)&&af.log.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),v}},{key:"_updateAutoHighlight",value:function(a){var i=this.props.uniqueIdProperty,o=this.state,s=o.hoveredFeatureId,u=o.hoveredFeatureLayerName,f=a.object,l,c;f&&(l=Mm(f,i),c=CB(f));var h=this.props.highlightColor;typeof h=="function"&&(h=h(a)),(s!==l||u!==c)&&this.setState({highlightColor:h,hoveredFeatureId:l,hoveredFeatureLayerName:c})}},{key:"getPickingInfo",value:function(a){var i=(0,Kr.default)((0,$t.default)(t.prototype),"getPickingInfo",this).call(this,a),o=Boolean(this.context.viewport.resolution);if(this.state.binary&&i.index!==-1){var s=a.sourceLayer.props.data;i.object=Qu(s,{globalFeatureId:i.index})}return i.object&&!o&&(i.object=BB(i.object,i.tile.bbox,this.context.viewport)),i}},{key:"getSubLayerPropsByTile",value:function(a){return{highlightedObjectIndex:this.getHighlightedObjectIndex(a),highlightColor:this.state.highlightColor}}},{key:"getHighlightedObjectIndex",value:function(a){var i=this.state,o=i.hoveredFeatureId,s=i.hoveredFeatureLayerName,u=i.binary,f=this.props,l=f.uniqueIdProperty,c=f.highlightedFeatureId,h=a.content,d=wB(c),p=wB(o)||d;if(!p)return-1;var v=d?c:o;return Array.isArray(h)?h.findIndex(function(g){var y=Mm(g,l)===v,b=d||CB(g)===s;return y&&b}):h&&u?wm(h,l,v,d?"":s):-1}},{key:"_pickObjects",value:function(a){var i=this.context,o=i.deck,s=i.viewport,u=s.width,f=s.height,l=s.x,c=s.y,h=[this.id];return o.pickObjects({x:l,y:c,width:u,height:f,layerIds:h,maxObjects:a})}},{key:"getRenderedFeatures",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this._pickObjects(a),o=new Set,s=[],u=JN(i),f;try{for(u.s();!(f=u.n()).done;){var l=f.value,c=Mm(l.object,this.props.uniqueIdProperty);c===void 0?s.push(l.object):o.has(c)||(o.add(c),s.push(l.object))}}catch(h){u.e(h)}finally{u.f()}return s}},{key:"_setWGS84PropertyForTiles",value:function(){var a=this,i="dataInWGS84",o=this.state.tileset;o.selectedTiles.forEach(function(s){s.hasOwnProperty(i)||Object.defineProperty(s,i,{get:function(){if(!s.content)return null;if(a.state.binary&&Array.isArray(s.content)&&!s.content.length)return[];var f=s.bbox;if(s._contentWGS84===void 0&&Cc(f)){var l=a.state.binary?Qu(s.content):s.content;s._contentWGS84=l.map(function(c){return BB(c,f,a.context.viewport)})}return s._contentWGS84}})})}}]),t}(sr);(0,nf.default)(of,"layerName","MVTLayer");(0,nf.default)(of,"defaultProps",KN);function Mm(e,r){if(e.properties&&r)return e.properties[r];if("id"in e)return e.id}function CB(e){var r;return((r=e.properties)===null||r===void 0?void 0:r.layerName)||null}function wB(e){return e!=null&&e!==""}function BB(e,r,t){var n=Qr(Qr({},e),{},{geometry:{type:e.geometry.type}});return Object.defineProperty(n.geometry,"coordinates",{get:function(){var i=bB(e.geometry,r,t);return i.coordinates}}),n}var UB=m(H()),jB=m(z()),HB=m(Te()),VB=m(xe()),Pm=m(Ae()),Rm=m(W());var DB=m(ce()),kB="0123456789bcdefghjkmnpqrstuvwxyz",GB={};for(io=0;io<kB.length;io++)GB[kB.charAt(io)]=io;var io,QN=-90,ZN=90,$N=-180,eU=180;function tU(e){for(var r=!0,t=ZN,n=QN,a=eU,i=$N,o,s=0,u=0,f=e.length;u<f;u++){var l=e[u].toLowerCase();s=GB[l];for(var c=4;c>=0;c--){var h=s>>c&1;r?(o=(a+i)/2,h===1?i=o:a=o):(o=(t+n)/2,h===1?n=o:t=o),r=!r}}return[n,i,t,a]}function NB(e){var r=tU(e),t=(0,DB.default)(r,4),n=t[0],a=t[1],i=t[2],o=t[3];return[o,i,o,n,a,n,a,i,o,i]}function rU(e){var r=nU();return function(){var n=(0,Pm.default)(e),a;if(r){var i=(0,Pm.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,VB.default)(this,a)}}function nU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var aU={getGeohash:{type:"accessor",value:function(r){return r.geohash}}},sf=function(e){(0,HB.default)(t,e);var r=rU(t);function t(){return(0,UB.default)(this,t),r.apply(this,arguments)}return(0,jB.default)(t,[{key:"indexToBounds",value:function(){var a=this.props,i=a.data,o=a.getGeohash;return{data:i,_normalize:!1,positionFormat:"XY",getPolygon:function(u,f){return NB(o(u,f))}}}}]),t}(Ct);(0,Rm.default)(sf,"layerName","GeohashLayer");(0,Rm.default)(sf,"defaultProps",aU);return YB(oo);})();
      return __exports__;
      });
